function Ro(){}const Tp=D=>D;function xd(D,Y){for(const ut in Y)D[ut]=Y[ut];return D}function Gh(D){return D()}function Hh(){return Object.create(null)}function Nl(D){D.forEach(Gh)}function rc(D){return typeof D=="function"}function bd(D,Y){return D!=D?Y==Y:D!==Y||D&&typeof D=="object"||typeof D=="function"}let jc;function Kd(D,Y){return jc||(jc=document.createElement("a")),jc.href=Y,D===jc.href}function wd(D){return Object.keys(D).length===0}function Ep(D,...Y){if(D==null)return Ro;const ut=D.subscribe(...Y);return ut.unsubscribe?()=>ut.unsubscribe():ut}function Yd(D){let Y;return Ep(D,ut=>Y=ut)(),Y}function Jd(D,Y,ut){D.$$.on_destroy.push(Ep(Y,ut))}function Qd(D,Y,ut,gt){if(D){const Yt=Wh(D,Y,ut,gt);return D[0](Yt)}}function Wh(D,Y,ut,gt){return D[1]&&gt?xd(ut.ctx.slice(),D[1](gt(Y))):ut.ctx}function $d(D,Y,ut,gt){if(D[2]&&gt){const Yt=D[2](gt(ut));if(Y.dirty===void 0)return Yt;if(typeof Yt=="object"){const ht=[],l=Math.max(Y.dirty.length,Yt.length);for(let Ut=0;Ut<l;Ut+=1)ht[Ut]=Y.dirty[Ut]|Yt[Ut];return ht}return Y.dirty|Yt}return Y.dirty}function tm(D,Y,ut,gt,Yt,ht){if(Yt){const l=Wh(Y,ut,gt,ht);D.p(l,Yt)}}function em(D){if(D.ctx.length>32){const Y=[],ut=D.ctx.length/32;for(let gt=0;gt<ut;gt++)Y[gt]=-1;return Y}return-1}function rm(D){return D&&rc(D.destroy)?D.destroy:Ro}const Xh=typeof window!="undefined";let qc=Xh?()=>window.performance.now():()=>Date.now(),Ip=Xh?D=>requestAnimationFrame(D):Ro;const wu=new Set;function Kh(D){wu.forEach(Y=>{Y.c(D)||(wu.delete(Y),Y.f())}),wu.size!==0&&Ip(Kh)}function Ap(D){let Y;return wu.size===0&&Ip(Kh),{promise:new Promise(ut=>{wu.add(Y={c:D,f:ut})}),abort(){wu.delete(Y)}}}let Zc=!1;function Sd(){Zc=!0}function Td(){Zc=!1}function Ed(D,Y,ut,gt){for(;D<Y;){const Yt=D+(Y-D>>1);ut(Yt)<=gt?D=Yt+1:Y=Yt}return D}function Id(D){if(D.hydrate_init)return;D.hydrate_init=!0;let Y=D.childNodes;if(D.nodeName==="HEAD"){const G=[];for(let St=0;St<Y.length;St++){const Vt=Y[St];Vt.claim_order!==void 0&&G.push(Vt)}Y=G}const ut=new Int32Array(Y.length+1),gt=new Int32Array(Y.length);ut[0]=-1;let Yt=0;for(let G=0;G<Y.length;G++){const St=Y[G].claim_order,Vt=(Yt>0&&Y[ut[Yt]].claim_order<=St?Yt+1:Ed(1,Yt,vt=>Y[ut[vt]].claim_order,St))-1;gt[G]=ut[Vt]+1;const We=Vt+1;ut[We]=G,Yt=Math.max(We,Yt)}const ht=[],l=[];let Ut=Y.length-1;for(let G=ut[Yt]+1;G!=0;G=gt[G-1]){for(ht.push(Y[G-1]);Ut>=G;Ut--)l.push(Y[Ut]);Ut--}for(;Ut>=0;Ut--)l.push(Y[Ut]);ht.reverse(),l.sort((G,St)=>G.claim_order-St.claim_order);for(let G=0,St=0;G<l.length;G++){for(;St<ht.length&&l[G].claim_order>=ht[St].claim_order;)St++;const Vt=St<ht.length?ht[St]:null;D.insertBefore(l[G],Vt)}}function Ad(D,Y){D.appendChild(Y)}function Yh(D){if(!D)return document;const Y=D.getRootNode?D.getRootNode():D.ownerDocument;return Y&&Y.host?Y:D.ownerDocument}function Cd(D){const Y=Jh("style");return zd(Yh(D),Y),Y.sheet}function zd(D,Y){Ad(D.head||D,Y)}function Pd(D,Y){if(Zc){for(Id(D),(D.actual_end_child===void 0||D.actual_end_child!==null&&D.actual_end_child.parentElement!==D)&&(D.actual_end_child=D.firstChild);D.actual_end_child!==null&&D.actual_end_child.claim_order===void 0;)D.actual_end_child=D.actual_end_child.nextSibling;Y!==D.actual_end_child?(Y.claim_order!==void 0||Y.parentNode!==D)&&D.insertBefore(Y,D.actual_end_child):D.actual_end_child=Y.nextSibling}else(Y.parentNode!==D||Y.nextSibling!==null)&&D.appendChild(Y)}function im(D,Y,ut){Zc&&!ut?Pd(D,Y):(Y.parentNode!==D||Y.nextSibling!=ut)&&D.insertBefore(Y,ut||null)}function kd(D){D.parentNode.removeChild(D)}function nm(D,Y){for(let ut=0;ut<D.length;ut+=1)D[ut]&&D[ut].d(Y)}function Jh(D){return document.createElement(D)}function Md(D){return document.createElementNS("http://www.w3.org/2000/svg",D)}function Cp(D){return document.createTextNode(D)}function am(){return Cp(" ")}function om(){return Cp("")}function sm(D,Y,ut,gt){return D.addEventListener(Y,ut,gt),()=>D.removeEventListener(Y,ut,gt)}function Dd(D,Y,ut){ut==null?D.removeAttribute(Y):D.getAttribute(Y)!==ut&&D.setAttribute(Y,ut)}function lm(D,Y){for(const ut in Y)Dd(D,ut,Y[ut])}function Ld(D){return Array.from(D.childNodes)}function Rd(D){D.claim_info===void 0&&(D.claim_info={last_index:0,total_claimed:0})}function Qh(D,Y,ut,gt,Yt=!1){Rd(D);const ht=(()=>{for(let l=D.claim_info.last_index;l<D.length;l++){const Ut=D[l];if(Y(Ut)){const G=ut(Ut);return G===void 0?D.splice(l,1):D[l]=G,Yt||(D.claim_info.last_index=l),Ut}}for(let l=D.claim_info.last_index-1;l>=0;l--){const Ut=D[l];if(Y(Ut)){const G=ut(Ut);return G===void 0?D.splice(l,1):D[l]=G,Yt?G===void 0&&D.claim_info.last_index--:D.claim_info.last_index=l,Ut}}return gt()})();return ht.claim_order=D.claim_info.total_claimed,D.claim_info.total_claimed+=1,ht}function $h(D,Y,ut,gt){return Qh(D,Yt=>Yt.nodeName===Y,Yt=>{const ht=[];for(let l=0;l<Yt.attributes.length;l++){const Ut=Yt.attributes[l];ut[Ut.name]||ht.push(Ut.name)}ht.forEach(l=>Yt.removeAttribute(l))},()=>gt(Y))}function um(D,Y,ut){return $h(D,Y,ut,Jh)}function cm(D,Y,ut){return $h(D,Y,ut,Md)}function Bd(D,Y){return Qh(D,ut=>ut.nodeType===3,ut=>{const gt=""+Y;if(ut.data.startsWith(gt)){if(ut.data.length!==gt.length)return ut.splitText(gt.length)}else ut.data=gt},()=>Cp(Y),!0)}function pm(D){return Bd(D," ")}function hm(D,Y){Y=""+Y,D.wholeText!==Y&&(D.data=Y)}function fm(D,Y,ut,gt){ut===null?D.style.removeProperty(Y):D.style.setProperty(Y,ut,gt?"important":"")}function dm(D,Y,ut){D.classList[ut?"add":"remove"](Y)}function Od(D,Y,ut=!1){const gt=document.createEvent("CustomEvent");return gt.initCustomEvent(D,ut,!1,Y),gt}const Gc=new Map;let Hc=0;function Fd(D){let Y=5381,ut=D.length;for(;ut--;)Y=(Y<<5)-Y^D.charCodeAt(ut);return Y>>>0}function Ud(D,Y){const ut={stylesheet:Cd(Y),rules:{}};return Gc.set(D,ut),ut}function tf(D,Y,ut,gt,Yt,ht,l,Ut=0){const G=16.666/gt;let St=`{
`;for(let Lt=0;Lt<=1;Lt+=G){const Z=Y+(ut-Y)*ht(Lt);St+=Lt*100+`%{${l(Z,1-Z)}}
`}const Vt=St+`100% {${l(ut,1-ut)}}
}`,We=`__svelte_${Fd(Vt)}_${Ut}`,vt=Yh(D),{stylesheet:wr,rules:kr}=Gc.get(vt)||Ud(vt,D);kr[We]||(kr[We]=!0,wr.insertRule(`@keyframes ${We} ${Vt}`,wr.cssRules.length));const Bt=D.style.animation||"";return D.style.animation=`${Bt?`${Bt}, `:""}${We} ${gt}ms linear ${Yt}ms 1 both`,Hc+=1,We}function zp(D,Y){const ut=(D.style.animation||"").split(", "),gt=ut.filter(Y?ht=>ht.indexOf(Y)<0:ht=>ht.indexOf("__svelte")===-1),Yt=ut.length-gt.length;Yt&&(D.style.animation=gt.join(", "),Hc-=Yt,Hc||Vd())}function Vd(){Ip(()=>{Hc||(Gc.forEach(D=>{const{stylesheet:Y}=D;let ut=Y.cssRules.length;for(;ut--;)Y.deleteRule(ut);D.rules={}}),Gc.clear())})}let ic;function nc(D){ic=D}function Wc(){if(!ic)throw new Error("Function called outside component initialization");return ic}function mm(D){Wc().$$.on_mount.push(D)}function ym(D){Wc().$$.after_update.push(D)}function vm(D,Y){Wc().$$.context.set(D,Y)}function _m(D){return Wc().$$.context.get(D)}const ac=[],ef=[],Xc=[],rf=[],nf=Promise.resolve();let Pp=!1;function af(){Pp||(Pp=!0,nf.then(of))}function gm(){return af(),nf}function oc(D){Xc.push(D)}const kp=new Set;let Kc=0;function of(){const D=ic;do{for(;Kc<ac.length;){const Y=ac[Kc];Kc++,nc(Y),Nd(Y.$$)}for(nc(null),ac.length=0,Kc=0;ef.length;)ef.pop()();for(let Y=0;Y<Xc.length;Y+=1){const ut=Xc[Y];kp.has(ut)||(kp.add(ut),ut())}Xc.length=0}while(ac.length);for(;rf.length;)rf.pop()();Pp=!1,kp.clear(),nc(D)}function Nd(D){if(D.fragment!==null){D.update(),Nl(D.before_update);const Y=D.dirty;D.dirty=[-1],D.fragment&&D.fragment.p(D.ctx,Y),D.after_update.forEach(oc)}}let sc;function sf(){return sc||(sc=Promise.resolve(),sc.then(()=>{sc=null})),sc}function Yc(D,Y,ut){D.dispatchEvent(Od(`${Y?"intro":"outro"}${ut}`))}const Jc=new Set;let gl;function xm(){gl={r:0,c:[],p:gl}}function bm(){gl.r||Nl(gl.c),gl=gl.p}function jd(D,Y){D&&D.i&&(Jc.delete(D),D.i(Y))}function wm(D,Y,ut,gt){if(D&&D.o){if(Jc.has(D))return;Jc.add(D),gl.c.push(()=>{Jc.delete(D),gt&&(ut&&D.d(1),gt())}),D.o(Y)}}const lf={duration:0};function Sm(D,Y,ut){let gt=Y(D,ut),Yt=!1,ht,l,Ut=0;function G(){ht&&zp(D,ht)}function St(){const{delay:We=0,duration:vt=300,easing:wr=Tp,tick:kr=Ro,css:Bt}=gt||lf;Bt&&(ht=tf(D,0,1,vt,We,wr,Bt,Ut++)),kr(0,1);const Lt=qc()+We,Z=Lt+vt;l&&l.abort(),Yt=!0,oc(()=>Yc(D,!0,"start")),l=Ap(bt=>{if(Yt){if(bt>=Z)return kr(1,0),Yc(D,!0,"end"),G(),Yt=!1;if(bt>=Lt){const wt=wr((bt-Lt)/vt);kr(wt,1-wt)}}return Yt})}let Vt=!1;return{start(){Vt||(Vt=!0,zp(D),rc(gt)?(gt=gt(),sf().then(St)):St())},invalidate(){Vt=!1},end(){Yt&&(G(),Yt=!1)}}}function Tm(D,Y,ut){let gt=Y(D,ut),Yt=!0,ht;const l=gl;l.r+=1;function Ut(){const{delay:G=0,duration:St=300,easing:Vt=Tp,tick:We=Ro,css:vt}=gt||lf;vt&&(ht=tf(D,1,0,St,G,Vt,vt));const wr=qc()+G,kr=wr+St;oc(()=>Yc(D,!1,"start")),Ap(Bt=>{if(Yt){if(Bt>=kr)return We(0,1),Yc(D,!1,"end"),--l.r||Nl(l.c),!1;if(Bt>=wr){const Lt=Vt((Bt-wr)/St);We(1-Lt,Lt)}}return Yt})}return rc(gt)?sf().then(()=>{gt=gt(),Ut()}):Ut(),{end(G){G&&gt.tick&&gt.tick(1,0),Yt&&(ht&&zp(D,ht),Yt=!1)}}}function Em(D,Y){const ut={},gt={},Yt={$$scope:1};let ht=D.length;for(;ht--;){const l=D[ht],Ut=Y[ht];if(Ut){for(const G in l)G in Ut||(gt[G]=1);for(const G in Ut)Yt[G]||(ut[G]=Ut[G],Yt[G]=1);D[ht]=Ut}else for(const G in l)Yt[G]=1}for(const l in gt)l in ut||(ut[l]=void 0);return ut}function Im(D){return typeof D=="object"&&D!==null?D:{}}function Am(D){D&&D.c()}function Cm(D,Y){D&&D.l(Y)}function qd(D,Y,ut,gt){const{fragment:Yt,on_mount:ht,on_destroy:l,after_update:Ut}=D.$$;Yt&&Yt.m(Y,ut),gt||oc(()=>{const G=ht.map(Gh).filter(rc);l?l.push(...G):Nl(G),D.$$.on_mount=[]}),Ut.forEach(oc)}function Zd(D,Y){const ut=D.$$;ut.fragment!==null&&(Nl(ut.on_destroy),ut.fragment&&ut.fragment.d(Y),ut.on_destroy=ut.fragment=null,ut.ctx=[])}function Gd(D,Y){D.$$.dirty[0]===-1&&(ac.push(D),af(),D.$$.dirty.fill(0)),D.$$.dirty[Y/31|0]|=1<<Y%31}function zm(D,Y,ut,gt,Yt,ht,l,Ut=[-1]){const G=ic;nc(D);const St=D.$$={fragment:null,ctx:null,props:ht,update:Ro,not_equal:Yt,bound:Hh(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(Y.context||(G?G.$$.context:[])),callbacks:Hh(),dirty:Ut,skip_bound:!1,root:Y.target||G.$$.root};l&&l(St.root);let Vt=!1;if(St.ctx=ut?ut(D,Y.props||{},(We,vt,...wr)=>{const kr=wr.length?wr[0]:vt;return St.ctx&&Yt(St.ctx[We],St.ctx[We]=kr)&&(!St.skip_bound&&St.bound[We]&&St.bound[We](kr),Vt&&Gd(D,We)),vt}):[],St.update(),Vt=!0,Nl(St.before_update),St.fragment=gt?gt(St.ctx):!1,Y.target){if(Y.hydrate){Sd();const We=Ld(Y.target);St.fragment&&St.fragment.l(We),We.forEach(kd)}else St.fragment&&St.fragment.c();Y.intro&&jd(D.$$.fragment),qd(D,Y.target,Y.anchor,Y.customElement),Td(),of()}nc(G)}class Pm{$destroy(){Zd(this,1),this.$destroy=Ro}$on(Y,ut){const gt=this.$$.callbacks[Y]||(this.$$.callbacks[Y]=[]);return gt.push(ut),()=>{const Yt=gt.indexOf(ut);Yt!==-1&&gt.splice(Yt,1)}}$set(Y){this.$$set&&!wd(Y)&&(this.$$.skip_bound=!0,this.$$set(Y),this.$$.skip_bound=!1)}}const Su=[];function Hd(D,Y){return{subscribe:uf(D,Y).subscribe}}function uf(D,Y=Ro){let ut;const gt=new Set;function Yt(Ut){if(bd(D,Ut)&&(D=Ut,ut)){const G=!Su.length;for(const St of gt)St[1](),Su.push(St,D);if(G){for(let St=0;St<Su.length;St+=2)Su[St][0](Su[St+1]);Su.length=0}}}function ht(Ut){Yt(Ut(D))}function l(Ut,G=Ro){const St=[Ut,G];return gt.add(St),gt.size===1&&(ut=Y(Yt)||Ro),Ut(D),()=>{gt.delete(St),gt.size===0&&(ut(),ut=null)}}return{set:Yt,update:ht,subscribe:l}}function km(D,Y,ut){const gt=!Array.isArray(D),Yt=gt?[D]:D,ht=Y.length<2;return Hd(ut,l=>{let Ut=!1;const G=[];let St=0,Vt=Ro;const We=()=>{if(St)return;Vt();const wr=Y(gt?G[0]:G,l);ht?l(wr):Vt=rc(wr)?wr:Ro},vt=Yt.map((wr,kr)=>Ep(wr,Bt=>{G[kr]=Bt,St&=~(1<<kr),Ut&&We()},()=>{St|=1<<kr}));return Ut=!0,We(),function(){Nl(vt),Vt()}})}var cf=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},Wd={exports:{}};(function(D,Y){(function(ut,gt){D.exports=gt()})(cf,function(){var ut,gt,Yt;function ht(l,Ut){if(!ut)ut=Ut;else if(!gt)gt=Ut;else{var G="var sharedChunk = {}; ("+ut+")(sharedChunk); ("+gt+")(sharedChunk);",St={};ut(St),Yt=Ut(St),typeof window!="undefined"&&(Yt.workerUrl=window.URL.createObjectURL(new Blob([G],{type:"text/javascript"})))}}return ht(["exports"],function(l){function Ut(t,e){return t(e={exports:{}},e.exports),e.exports}var G=St;function St(t,e,r,o){this.cx=3*t,this.bx=3*(r-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(o-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=o,this.p2x=r,this.p2y=o}St.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},St.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},St.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},St.prototype.solveCurveX=function(t,e){var r,o,u,c,h;for(e===void 0&&(e=1e-6),u=t,h=0;h<8;h++){if(c=this.sampleCurveX(u)-t,Math.abs(c)<e)return u;var m=this.sampleCurveDerivativeX(u);if(Math.abs(m)<1e-6)break;u-=c/m}if((u=t)<(r=0))return r;if(u>(o=1))return o;for(;r<o;){if(c=this.sampleCurveX(u),Math.abs(c-t)<e)return u;t>c?r=u:o=u,u=.5*(o-r)+r}return u},St.prototype.solve=function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))};var Vt=We;function We(t,e){this.x=t,this.y=e}We.prototype={clone:function(){return new We(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,r=t.y-this.y;return e*e+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=e,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),r=Math.sin(t),o=r*this.x+e*this.y;return this.x=e*this.x-r*this.y,this.y=o,this},_rotateAround:function(t,e){var r=Math.cos(t),o=Math.sin(t),u=e.y+o*(this.x-e.x)+r*(this.y-e.y);return this.x=e.x+r*(this.x-e.x)-o*(this.y-e.y),this.y=u,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},We.convert=function(t){return t instanceof We?t:Array.isArray(t)?new We(t[0],t[1]):t};var vt=typeof self!="undefined"?self:{},wr=Math.pow(2,53)-1;function kr(t,e,r,o){var u=new G(t,e,r,o);return function(c){return u.solve(c)}}var Bt=kr(.25,.1,.25,1);function Lt(t,e,r){return Math.min(r,Math.max(e,t))}function Z(t,e,r){var o=r-e,u=((t-e)%o+o)%o+e;return u===e?r:u}function bt(t){for(var e=[],r=arguments.length-1;r-- >0;)e[r]=arguments[r+1];for(var o=0,u=e;o<u.length;o+=1){var c=u[o];for(var h in c)t[h]=c[h]}return t}var wt=1;function At(){return wt++}function ue(){return function t(e){return e?(e^16*Math.random()>>e/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,t)}()}function pr(t){return!!t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)}function sr(t,e){t.forEach(function(r){e[r]&&(e[r]=e[r].bind(e))})}function he(t,e){return t.indexOf(e,t.length-e.length)!==-1}function Te(t,e,r){var o={};for(var u in t)o[u]=e.call(r||this,t[u],u,t);return o}function _r(t,e,r){var o={};for(var u in t)e.call(r||this,t[u],u,t)&&(o[u]=t[u]);return o}function ze(t){return Array.isArray(t)?t.map(ze):typeof t=="object"&&t?Te(t,ze):t}var Jr={};function Gt(t){Jr[t]||(typeof console!="undefined"&&console.warn(t),Jr[t]=!0)}function ke(t,e,r){return(r.y-t.y)*(e.x-t.x)>(e.y-t.y)*(r.x-t.x)}function Xe(t){for(var e=0,r=0,o=t.length,u=o-1,c=void 0,h=void 0;r<o;u=r++)e+=((h=t[u]).x-(c=t[r]).x)*(c.y+h.y);return e}function ce(){return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope}function fr(t){var e={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(o,u,c,h){var m=c||h;return e[u]=!m||m.toLowerCase(),""}),e["max-age"]){var r=parseInt(e["max-age"],10);isNaN(r)?delete e["max-age"]:e["max-age"]=r}return e}var nn=null;function Ze(t){if(nn==null){var e=t.navigator?t.navigator.userAgent:null;nn=!!t.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return nn}function ei(t){try{var e=vt[t];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch{return!1}}var $t,ar,Sr,je,et=vt.performance&&vt.performance.now?vt.performance.now.bind(vt.performance):Date.now.bind(Date),ft=vt.requestAnimationFrame||vt.mozRequestAnimationFrame||vt.webkitRequestAnimationFrame||vt.msRequestAnimationFrame,it=vt.cancelAnimationFrame||vt.mozCancelAnimationFrame||vt.webkitCancelAnimationFrame||vt.msCancelAnimationFrame,_t={now:et,frame:function(t){var e=ft(t);return{cancel:function(){return it(e)}}},getImageData:function(t,e){e===void 0&&(e=0);var r=vt.document.createElement("canvas"),o=r.getContext("2d");if(!o)throw new Error("failed to create canvas 2d context");return r.width=t.width,r.height=t.height,o.drawImage(t,0,0,t.width,t.height),o.getImageData(-e,-e,t.width+2*e,t.height+2*e)},resolveURL:function(t){return $t||($t=vt.document.createElement("a")),$t.href=t,$t.href},hardwareConcurrency:vt.navigator&&vt.navigator.hardwareConcurrency||4,get devicePixelRatio(){return vt.devicePixelRatio},get prefersReducedMotion(){return!!vt.matchMedia&&(ar==null&&(ar=vt.matchMedia("(prefers-reduced-motion: reduce)")),ar.matches)}},Et={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16,REGISTERED_PROTOCOLS:{}},de={supported:!1,testSupport:function(t){!Ee&&je&&(Fe?ee(t):Sr=t)}},Ee=!1,Fe=!1;function ee(t){var e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,je),t.isContextLost())return;de.supported=!0}catch{}t.deleteTexture(e),Ee=!0}vt.document&&((je=vt.document.createElement("img")).onload=function(){Sr&&ee(Sr),Sr=null,Fe=!0},je.onerror=function(){Ee=!0,Sr=null},je.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var Se="01",Ce=function(t,e){this._transformRequestFn=t,this._customAccessToken=e,this._createSkuToken()};function Rr(t){return t.indexOf("mapbox:")===0}Ce.prototype._createSkuToken=function(){var t=function(){for(var e="",r=0;r<10;r++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Se,e].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=t.token,this._skuTokenExpiresAt=t.tokenExpiresAt},Ce.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},Ce.prototype.transformRequest=function(t,e){return this._transformRequestFn&&this._transformRequestFn(t,e)||{url:t}},Ce.prototype.normalizeStyleURL=function(t,e){if(!Rr(t))return t;var r=gr(t);return r.path="/styles/v1"+r.path,this._makeAPIURL(r,this._customAccessToken||e)},Ce.prototype.normalizeGlyphsURL=function(t,e){if(!Rr(t))return t;var r=gr(t);return r.path="/fonts/v1"+r.path,this._makeAPIURL(r,this._customAccessToken||e)},Ce.prototype.normalizeSourceURL=function(t,e){if(!Rr(t))return t;var r=gr(t);return r.path="/v4/"+r.authority+".json",r.params.push("secure"),this._makeAPIURL(r,this._customAccessToken||e)},Ce.prototype.normalizeSpriteURL=function(t,e,r,o){var u=gr(t);return Rr(t)?(u.path="/styles/v1"+u.path+"/sprite"+e+r,this._makeAPIURL(u,this._customAccessToken||o)):(u.path+=""+e+r,an(u))},Ce.prototype.normalizeTileURL=function(t,e){if(this._isSkuTokenExpired()&&this._createSkuToken(),t&&!Rr(t))return t;var r=gr(t);r.path=r.path.replace(/(\.(png|jpg)\d*)(?=$)/,(_t.devicePixelRatio>=2||e===512?"@2x":"")+(de.supported?".webp":"$1")),r.path=r.path.replace(/^.+\/v4\//,"/"),r.path="/v4"+r.path;var o=this._customAccessToken||function(u){for(var c=0,h=u;c<h.length;c+=1){var m=h[c].match(/^access_token=(.*)$/);if(m)return m[1]}return null}(r.params)||Et.ACCESS_TOKEN;return Et.REQUIRE_ACCESS_TOKEN&&o&&this._skuToken&&r.params.push("sku="+this._skuToken),this._makeAPIURL(r,o)},Ce.prototype.canonicalizeTileURL=function(t,e){var r=gr(t);if(!r.path.match(/(^\/v4\/)/)||!r.path.match(/\.[\w]+$/))return t;var o="mapbox://tiles/";o+=r.path.replace("/v4/","");var u=r.params;return e&&(u=u.filter(function(c){return!c.match(/^access_token=/)})),u.length&&(o+="?"+u.join("&")),o},Ce.prototype.canonicalizeTileset=function(t,e){for(var r=!!e&&Rr(e),o=[],u=0,c=t.tiles||[];u<c.length;u+=1){var h=c[u];Mr(h)?o.push(this.canonicalizeTileURL(h,r)):o.push(h)}return o},Ce.prototype._makeAPIURL=function(t,e){var r="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",o=gr(Et.API_URL);if(t.protocol=o.protocol,t.authority=o.authority,t.protocol==="http"){var u=t.params.indexOf("secure");u>=0&&t.params.splice(u,1)}if(o.path!=="/"&&(t.path=""+o.path+t.path),!Et.REQUIRE_ACCESS_TOKEN)return an(t);if(!(e=e||Et.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+r);if(e[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+r);return t.params=t.params.filter(function(c){return c.indexOf("access_token")===-1}),t.params.push("access_token="+e),an(t)},Ce.prototype.setTransformRequest=function(t){this._transformRequestFn=t};var ai=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function Mr(t){return ai.test(t)}var _i=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function gr(t){var e=t.match(_i);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function an(t){var e=t.params.length?"?"+t.params.join("&"):"";return t.protocol+"://"+t.authority+t.path+e}function Gr(t){if(!t)return null;var e=t.split(".");if(!e||e.length!==3)return null;try{return JSON.parse(decodeURIComponent(vt.atob(e[1]).split("").map(function(r){return"%"+("00"+r.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch{return null}}var ri=function(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};ri.prototype.getStorageKey=function(t){var e,r=Gr(Et.ACCESS_TOKEN);return e=r&&r.u?vt.btoa(encodeURIComponent(r.u).replace(/%([0-9A-F]{2})/g,function(o,u){return String.fromCharCode(Number("0x"+u))})):Et.ACCESS_TOKEN||"",t?"mapbox.eventData."+t+":"+e:"mapbox.eventData:"+e},ri.prototype.fetchEventData=function(){var t=ei("localStorage"),e=this.getStorageKey(),r=this.getStorageKey("uuid");if(t)try{var o=vt.localStorage.getItem(e);o&&(this.eventData=JSON.parse(o));var u=vt.localStorage.getItem(r);u&&(this.anonId=u)}catch{Gt("Unable to read from LocalStorage")}},ri.prototype.saveEventData=function(){var t=ei("localStorage"),e=this.getStorageKey(),r=this.getStorageKey("uuid");if(t)try{vt.localStorage.setItem(r,this.anonId),Object.keys(this.eventData).length>=1&&vt.localStorage.setItem(e,JSON.stringify(this.eventData))}catch{Gt("Unable to write to LocalStorage")}},ri.prototype.processRequests=function(t){},ri.prototype.postEvent=function(t,e,r,o){var u=this;if(Et.EVENTS_URL){var c=gr(Et.EVENTS_URL);c.params.push("access_token="+(o||Et.ACCESS_TOKEN||""));var h={event:this.type,created:new Date(t).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.15.2",skuId:Se,userId:this.anonId},m=e?bt(h,e):h,v={url:an(c),headers:{"Content-Type":"text/plain"},body:JSON.stringify([m])};this.pendingRequest=b(v,function(_){u.pendingRequest=null,r(_),u.saveEventData(),u.processRequests(o)})}},ri.prototype.queueRequest=function(t,e){this.queue.push(t),this.processRequests(e)};var oi,on,tr=function(t){function e(){t.call(this,"map.load"),this.success={},this.skuToken=""}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.postMapLoadEvent=function(r,o,u,c){this.skuToken=u,(Et.EVENTS_URL&&c||Et.ACCESS_TOKEN&&Array.isArray(r)&&r.some(function(h){return Rr(h)||Mr(h)}))&&this.queueRequest({id:o,timestamp:Date.now()},c)},e.prototype.processRequests=function(r){var o=this;if(!this.pendingRequest&&this.queue.length!==0){var u=this.queue.shift(),c=u.id,h=u.timestamp;c&&this.success[c]||(this.anonId||this.fetchEventData(),pr(this.anonId)||(this.anonId=ue()),this.postEvent(h,{skuToken:this.skuToken},function(m){m||c&&(o.success[c]=!0)},r))}},e}(ri),si=new(function(t){function e(r){t.call(this,"appUserTurnstile"),this._customAccessToken=r}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.postTurnstileEvent=function(r,o){Et.EVENTS_URL&&Et.ACCESS_TOKEN&&Array.isArray(r)&&r.some(function(u){return Rr(u)||Mr(u)})&&this.queueRequest(Date.now(),o)},e.prototype.processRequests=function(r){var o=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var u=Gr(Et.ACCESS_TOKEN),c=u?u.u:Et.ACCESS_TOKEN,h=c!==this.eventData.tokenU;pr(this.anonId)||(this.anonId=ue(),h=!0);var m=this.queue.shift();if(this.eventData.lastSuccess){var v=new Date(this.eventData.lastSuccess),_=new Date(m),x=(m-this.eventData.lastSuccess)/864e5;h=h||x>=1||x<-1||v.getDate()!==_.getDate()}else h=!0;if(!h)return this.processRequests();this.postEvent(m,{"enabled.telemetry":!1},function(w){w||(o.eventData.lastSuccess=m,o.eventData.tokenU=c)},r)}},e}(ri)),la=si.postTurnstileEvent.bind(si),Ji=new tr,Qi=Ji.postMapLoadEvent.bind(Ji),zr=500,ua=50;function Ga(){vt.caches&&!oi&&(oi=vt.caches.open("mapbox-tiles"))}function ki(t){var e=t.indexOf("?");return e<0?t:t.slice(0,e)}var Mi,bn=1/0;function li(){return Mi==null&&(Mi=vt.OffscreenCanvas&&new vt.OffscreenCanvas(1,1).getContext("2d")&&typeof vt.createImageBitmap=="function"),Mi}var qi={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(qi);var cn=function(t){function e(r,o,u){o===401&&Mr(u)&&(r+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),t.call(this,r),this.status=o,this.url=u,this.name=this.constructor.name,this.message=r}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},e}(Error),dr=ce()?function(){return self.worker&&self.worker.referrer}:function(){return(vt.location.protocol==="blob:"?vt.parent:vt).location.href};function Bi(t,e){var r,o=new vt.AbortController,u=new vt.Request(t.url,{method:t.method||"GET",body:t.body,credentials:t.credentials,headers:t.headers,referrer:dr(),signal:o.signal}),c=!1,h=!1,m=(r=u.url).indexOf("sku=")>0&&Mr(r);t.type==="json"&&u.headers.set("Accept","application/json");var v=function(x,w,E){if(!h){if(x&&x.message!=="SecurityError"&&Gt(x),w&&E)return _(w);var z=Date.now();vt.fetch(u).then(function(O){if(O.ok){var F=m?O.clone():null;return _(O,F,z)}return e(new cn(O.statusText,O.status,t.url))}).catch(function(O){O.code!==20&&e(new Error(O.message))})}},_=function(x,w,E){(t.type==="arrayBuffer"?x.arrayBuffer():t.type==="json"?x.json():x.text()).then(function(z){h||(w&&E&&function(O,F,J){if(Ga(),oi){var H={status:F.status,statusText:F.statusText,headers:new vt.Headers};F.headers.forEach(function(st,dt){return H.headers.set(dt,st)});var at=fr(F.headers.get("Cache-Control")||"");at["no-store"]||(at["max-age"]&&H.headers.set("Expires",new Date(J+1e3*at["max-age"]).toUTCString()),new Date(H.headers.get("Expires")).getTime()-J<42e4||function(st,dt){if(on===void 0)try{new Response(new ReadableStream),on=!0}catch{on=!1}on?dt(st.body):st.blob().then(dt)}(F,function(st){var dt=new vt.Response(st,H);Ga(),oi&&oi.then(function(mt){return mt.put(ki(O.url),dt)}).catch(function(mt){return Gt(mt.message)})}))}}(u,w,E),c=!0,e(null,z,x.headers.get("Cache-Control"),x.headers.get("Expires")))}).catch(function(z){h||e(new Error(z.message))})};return m?function(x,w){if(Ga(),!oi)return w(null);var E=ki(x.url);oi.then(function(z){z.match(E).then(function(O){var F=function(J){if(!J)return!1;var H=new Date(J.headers.get("Expires")||0),at=fr(J.headers.get("Cache-Control")||"");return H>Date.now()&&!at["no-cache"]}(O);z.delete(E),F&&z.put(E,O.clone()),w(null,O,F)}).catch(w)}).catch(w)}(u,v):v(null,null),{cancel:function(){h=!0,c||o.abort()}}}var zn,Ve,Qr=function(t,e){if(/:\/\//.test(t.url)&&!/^https?:|^file:/.test(t.url)){if(ce()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,e);if(!ce()){var r=t.url.substring(0,t.url.indexOf("://"));return(Et.REGISTERED_PROTOCOLS[r]||Bi)(t,e)}}if(!(/^file:/.test(o=t.url)||/^file:/.test(dr())&&!/^\w+:/.test(o))){if(vt.fetch&&vt.Request&&vt.AbortController&&vt.Request.prototype.hasOwnProperty("signal"))return Bi(t,e);if(ce()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,e,void 0,!0)}var o;return function(u,c){var h=new vt.XMLHttpRequest;for(var m in h.open(u.method||"GET",u.url,!0),u.type==="arrayBuffer"&&(h.responseType="arraybuffer"),u.headers)h.setRequestHeader(m,u.headers[m]);return u.type==="json"&&(h.responseType="text",h.setRequestHeader("Accept","application/json")),h.withCredentials=u.credentials==="include",h.onerror=function(){c(new Error(h.statusText))},h.onload=function(){if((h.status>=200&&h.status<300||h.status===0)&&h.response!==null){var v=h.response;if(u.type==="json")try{v=JSON.parse(h.response)}catch(_){return c(_)}c(null,v,h.getResponseHeader("Cache-Control"),h.getResponseHeader("Expires"))}else c(new cn(h.statusText,h.status,u.url))},h.send(u.body),{cancel:function(){return h.abort()}}}(t,e)},mr=function(t,e){return Qr(bt(t,{type:"arrayBuffer"}),e)},b=function(t,e){return Qr(bt(t,{method:"POST"}),e)},T="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";zn=[],Ve=0;var C=function(t,e){if(de.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),Ve>=Et.MAX_PARALLEL_IMAGE_REQUESTS){var r={requestParameters:t,callback:e,cancelled:!1,cancel:function(){this.cancelled=!0}};return zn.push(r),r}Ve++;var o=!1,u=function(){if(!o)for(o=!0,Ve--;zn.length&&Ve<Et.MAX_PARALLEL_IMAGE_REQUESTS;){var h=zn.shift();h.cancelled||(h.cancel=C(h.requestParameters,h.callback).cancel)}},c=mr(t,function(h,m,v,_){u(),h?e(h):m&&(li()?function(x,w){var E=new vt.Blob([new Uint8Array(x)],{type:"image/png"});vt.createImageBitmap(E).then(function(z){w(null,z)}).catch(function(z){w(new Error("Could not load image because of "+z.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(m,e):function(x,w,E,z){var O=new vt.Image,F=vt.URL;O.onload=function(){w(null,O),F.revokeObjectURL(O.src),O.onload=null,vt.requestAnimationFrame(function(){O.src=T})},O.onerror=function(){return w(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var J=new vt.Blob([new Uint8Array(x)],{type:"image/png"});O.cacheControl=E,O.expires=z,O.src=x.byteLength?F.createObjectURL(J):T}(m,e,v,_))});return{cancel:function(){c.cancel(),u()}}};function k(t,e,r){r[t]&&r[t].indexOf(e)!==-1||(r[t]=r[t]||[],r[t].push(e))}function U(t,e,r){if(r&&r[t]){var o=r[t].indexOf(e);o!==-1&&r[t].splice(o,1)}}var K=function(t,e){e===void 0&&(e={}),bt(this,e),this.type=t},tt=function(t){function e(r,o){o===void 0&&(o={}),t.call(this,"error",bt({error:r},o))}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(K),W=function(){};W.prototype.on=function(t,e){return this._listeners=this._listeners||{},k(t,e,this._listeners),this},W.prototype.off=function(t,e){return U(t,e,this._listeners),U(t,e,this._oneTimeListeners),this},W.prototype.once=function(t,e){return this._oneTimeListeners=this._oneTimeListeners||{},k(t,e,this._oneTimeListeners),this},W.prototype.fire=function(t,e){typeof t=="string"&&(t=new K(t,e||{}));var r=t.type;if(this.listens(r)){t.target=this;for(var o=0,u=this._listeners&&this._listeners[r]?this._listeners[r].slice():[];o<u.length;o+=1)u[o].call(this,t);for(var c=0,h=this._oneTimeListeners&&this._oneTimeListeners[r]?this._oneTimeListeners[r].slice():[];c<h.length;c+=1){var m=h[c];U(r,m,this._oneTimeListeners),m.call(this,t)}var v=this._eventedParent;v&&(bt(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),v.fire(t))}else t instanceof tt&&console.error(t.error);return this},W.prototype.listens=function(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)},W.prototype.setEventedParent=function(t,e){return this._eventedParent=t,this._eventedParentData=e,this};var M={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},j=function(t,e,r,o){this.message=(t?t+": ":"")+r,o&&(this.identifier=o),e!=null&&e.__line__&&(this.line=e.__line__)};function Dt(t){var e=t.value;return e?[new j(t.key,e,"constants have been deprecated as of v8")]:[]}function Ft(t){for(var e=[],r=arguments.length-1;r-- >0;)e[r]=arguments[r+1];for(var o=0,u=e;o<u.length;o+=1){var c=u[o];for(var h in c)t[h]=c[h]}return t}function lt(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function It(t){if(Array.isArray(t))return t.map(It);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){var e={};for(var r in t)e[r]=It(t[r]);return e}return lt(t)}var Xt=function(t){function e(r,o){t.call(this,o),this.message=o,this.key=r}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(Error),Jt=function(t,e){e===void 0&&(e=[]),this.parent=t,this.bindings={};for(var r=0,o=e;r<o.length;r+=1){var u=o[r];this.bindings[u[0]]=u[1]}};Jt.prototype.concat=function(t){return new Jt(this,t)},Jt.prototype.get=function(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(t+" not found in scope.")},Jt.prototype.has=function(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)};var me={kind:"null"},Ct={kind:"number"},qt={kind:"string"},Pt={kind:"boolean"},Ue={kind:"color"},Oe={kind:"object"},ae={kind:"value"},Br={kind:"collator"},Me={kind:"formatted"},Hr={kind:"resolvedImage"};function er(t,e){return{kind:"array",itemType:t,N:e}}function nr(t){if(t.kind==="array"){var e=nr(t.itemType);return typeof t.N=="number"?"array<"+e+", "+t.N+">":t.itemType.kind==="value"?"array":"array<"+e+">"}return t.kind}var Or=[me,Ct,qt,Pt,Ue,Me,Oe,er(ae),Hr];function gi(t,e){if(e.kind==="error")return null;if(t.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!gi(t.itemType,e.itemType))&&(typeof t.N!="number"||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if(t.kind==="value"){for(var r=0,o=Or;r<o.length;r+=1)if(!gi(o[r],e))return null}}return"Expected "+nr(t)+" but found "+nr(e)+" instead."}function Ur(t,e){return e.some(function(r){return r.kind===t.kind})}function Ke(t,e){return e.some(function(r){return r==="null"?t===null:r==="array"?Array.isArray(t):r==="object"?t&&!Array.isArray(t)&&typeof t=="object":r===typeof t})}var Bo=Ut(function(t,e){var r={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function o(m){return(m=Math.round(m))<0?0:m>255?255:m}function u(m){return o(m[m.length-1]==="%"?parseFloat(m)/100*255:parseInt(m))}function c(m){return(v=m[m.length-1]==="%"?parseFloat(m)/100:parseFloat(m))<0?0:v>1?1:v;var v}function h(m,v,_){return _<0?_+=1:_>1&&(_-=1),6*_<1?m+(v-m)*_*6:2*_<1?v:3*_<2?m+(v-m)*(2/3-_)*6:m}try{e.parseCSSColor=function(m){var v,_=m.replace(/ /g,"").toLowerCase();if(_ in r)return r[_].slice();if(_[0]==="#")return _.length===4?(v=parseInt(_.substr(1),16))>=0&&v<=4095?[(3840&v)>>4|(3840&v)>>8,240&v|(240&v)>>4,15&v|(15&v)<<4,1]:null:_.length===7&&(v=parseInt(_.substr(1),16))>=0&&v<=16777215?[(16711680&v)>>16,(65280&v)>>8,255&v,1]:null;var x=_.indexOf("("),w=_.indexOf(")");if(x!==-1&&w+1===_.length){var E=_.substr(0,x),z=_.substr(x+1,w-(x+1)).split(","),O=1;switch(E){case"rgba":if(z.length!==4)return null;O=c(z.pop());case"rgb":return z.length!==3?null:[u(z[0]),u(z[1]),u(z[2]),O];case"hsla":if(z.length!==4)return null;O=c(z.pop());case"hsl":if(z.length!==3)return null;var F=(parseFloat(z[0])%360+360)%360/360,J=c(z[1]),H=c(z[2]),at=H<=.5?H*(J+1):H+J-H*J,st=2*H-at;return[o(255*h(st,at,F+1/3)),o(255*h(st,at,F)),o(255*h(st,at,F-1/3)),O];default:return null}}return null}}catch{}}).parseCSSColor,$e=function(t,e,r,o){o===void 0&&(o=1),this.r=t,this.g=e,this.b=r,this.a=o};$e.parse=function(t){if(t){if(t instanceof $e)return t;if(typeof t=="string"){var e=Bo(t);if(e)return new $e(e[0]/255*e[3],e[1]/255*e[3],e[2]/255*e[3],e[3])}}},$e.prototype.toString=function(){var t=this.toArray(),e=t[1],r=t[2],o=t[3];return"rgba("+Math.round(t[0])+","+Math.round(e)+","+Math.round(r)+","+o+")"},$e.prototype.toArray=function(){var t=this.a;return t===0?[0,0,0,0]:[255*this.r/t,255*this.g/t,255*this.b/t,t]},$e.black=new $e(0,0,0,1),$e.white=new $e(1,1,1,1),$e.transparent=new $e(0,0,0,0),$e.red=new $e(1,0,0,1);var Ha=function(t,e,r){this.sensitivity=t?e?"variant":"case":e?"accent":"base",this.locale=r,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};Ha.prototype.compare=function(t,e){return this.collator.compare(t,e)},Ha.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var go=function(t,e,r,o,u){this.text=t,this.image=e,this.scale=r,this.fontStack=o,this.textColor=u},$i=function(t){this.sections=t};$i.fromString=function(t){return new $i([new go(t,null,null,null,null)])},$i.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(t){return t.text.length!==0||t.image&&t.image.name.length!==0})},$i.factory=function(t){return t instanceof $i?t:$i.fromString(t)},$i.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(t){return t.text}).join("")},$i.prototype.serialize=function(){for(var t=["format"],e=0,r=this.sections;e<r.length;e+=1){var o=r[e];if(o.image)t.push(["image",o.image.name]);else{t.push(o.text);var u={};o.fontStack&&(u["text-font"]=["literal",o.fontStack.split(",")]),o.scale&&(u["font-scale"]=o.scale),o.textColor&&(u["text-color"]=["rgba"].concat(o.textColor.toArray())),t.push(u)}}return t};var Pn=function(t){this.name=t.name,this.available=t.available};function rs(t,e,r,o){return typeof t=="number"&&t>=0&&t<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof r=="number"&&r>=0&&r<=255?o===void 0||typeof o=="number"&&o>=0&&o<=1?null:"Invalid rgba value ["+[t,e,r,o].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof o=="number"?[t,e,r,o]:[t,e,r]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function Oo(t){if(t===null||typeof t=="string"||typeof t=="boolean"||typeof t=="number"||t instanceof $e||t instanceof Ha||t instanceof $i||t instanceof Pn)return!0;if(Array.isArray(t)){for(var e=0,r=t;e<r.length;e+=1)if(!Oo(r[e]))return!1;return!0}if(typeof t=="object"){for(var o in t)if(!Oo(t[o]))return!1;return!0}return!1}function Oi(t){if(t===null)return me;if(typeof t=="string")return qt;if(typeof t=="boolean")return Pt;if(typeof t=="number")return Ct;if(t instanceof $e)return Ue;if(t instanceof Ha)return Br;if(t instanceof $i)return Me;if(t instanceof Pn)return Hr;if(Array.isArray(t)){for(var e,r=t.length,o=0,u=t;o<u.length;o+=1){var c=Oi(u[o]);if(e){if(e===c)continue;e=ae;break}e=c}return er(e||ae,r)}return Oe}function ca(t){var e=typeof t;return t===null?"":e==="string"||e==="number"||e==="boolean"?String(t):t instanceof $e||t instanceof $i||t instanceof Pn?t.toString():JSON.stringify(t)}Pn.prototype.toString=function(){return this.name},Pn.fromString=function(t){return t?new Pn({name:t,available:!1}):null},Pn.prototype.serialize=function(){return["image",this.name]};var Kn=function(t,e){this.type=t,this.value=e};Kn.parse=function(t,e){if(t.length!==2)return e.error("'literal' expression requires exactly one argument, but found "+(t.length-1)+" instead.");if(!Oo(t[1]))return e.error("invalid value");var r=t[1],o=Oi(r),u=e.expectedType;return o.kind!=="array"||o.N!==0||!u||u.kind!=="array"||typeof u.N=="number"&&u.N!==0||(o=u),new Kn(o,r)},Kn.prototype.evaluate=function(){return this.value},Kn.prototype.eachChild=function(){},Kn.prototype.outputDefined=function(){return!0},Kn.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof $e?["rgba"].concat(this.value.toArray()):this.value instanceof $i?this.value.serialize():this.value};var ii=function(t){this.name="ExpressionEvaluationError",this.message=t};ii.prototype.toJSON=function(){return this.message};var wn={string:qt,number:Ct,boolean:Pt,object:Oe},Sn=function(t,e){this.type=t,this.args=e};Sn.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var r,o=1,u=t[0];if(u==="array"){var c,h;if(t.length>2){var m=t[1];if(typeof m!="string"||!(m in wn)||m==="object")return e.error('The item type argument of "array" must be one of string, number, boolean',1);c=wn[m],o++}else c=ae;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return e.error('The length argument to "array" must be a positive integer literal',2);h=t[2],o++}r=er(c,h)}else r=wn[u];for(var v=[];o<t.length;o++){var _=e.parse(t[o],o,ae);if(!_)return null;v.push(_)}return new Sn(r,v)},Sn.prototype.evaluate=function(t){for(var e=0;e<this.args.length;e++){var r=this.args[e].evaluate(t);if(!gi(this.type,Oi(r)))return r;if(e===this.args.length-1)throw new ii("Expected value to be of type "+nr(this.type)+", but found "+nr(Oi(r))+" instead.")}return null},Sn.prototype.eachChild=function(t){this.args.forEach(t)},Sn.prototype.outputDefined=function(){return this.args.every(function(t){return t.outputDefined()})},Sn.prototype.serialize=function(){var t=this.type,e=[t.kind];if(t.kind==="array"){var r=t.itemType;if(r.kind==="string"||r.kind==="number"||r.kind==="boolean"){e.push(r.kind);var o=t.N;(typeof o=="number"||this.args.length>1)&&e.push(o)}}return e.concat(this.args.map(function(u){return u.serialize()}))};var Yn=function(t){this.type=Me,this.sections=t};Yn.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var r=t[1];if(!Array.isArray(r)&&typeof r=="object")return e.error("First argument must be an image or text section.");for(var o=[],u=!1,c=1;c<=t.length-1;++c){var h=t[c];if(u&&typeof h=="object"&&!Array.isArray(h)){u=!1;var m=null;if(h["font-scale"]&&!(m=e.parse(h["font-scale"],1,Ct)))return null;var v=null;if(h["text-font"]&&!(v=e.parse(h["text-font"],1,er(qt))))return null;var _=null;if(h["text-color"]&&!(_=e.parse(h["text-color"],1,Ue)))return null;var x=o[o.length-1];x.scale=m,x.font=v,x.textColor=_}else{var w=e.parse(t[c],1,ae);if(!w)return null;var E=w.type.kind;if(E!=="string"&&E!=="value"&&E!=="null"&&E!=="resolvedImage")return e.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");u=!0,o.push({content:w,scale:null,font:null,textColor:null})}}return new Yn(o)},Yn.prototype.evaluate=function(t){return new $i(this.sections.map(function(e){var r=e.content.evaluate(t);return Oi(r)===Hr?new go("",r,null,null,null):new go(ca(r),null,e.scale?e.scale.evaluate(t):null,e.font?e.font.evaluate(t).join(","):null,e.textColor?e.textColor.evaluate(t):null)}))},Yn.prototype.eachChild=function(t){for(var e=0,r=this.sections;e<r.length;e+=1){var o=r[e];t(o.content),o.scale&&t(o.scale),o.font&&t(o.font),o.textColor&&t(o.textColor)}},Yn.prototype.outputDefined=function(){return!1},Yn.prototype.serialize=function(){for(var t=["format"],e=0,r=this.sections;e<r.length;e+=1){var o=r[e];t.push(o.content.serialize());var u={};o.scale&&(u["font-scale"]=o.scale.serialize()),o.font&&(u["text-font"]=o.font.serialize()),o.textColor&&(u["text-color"]=o.textColor.serialize()),t.push(u)}return t};var ao=function(t){this.type=Hr,this.input=t};ao.parse=function(t,e){if(t.length!==2)return e.error("Expected two arguments.");var r=e.parse(t[1],1,qt);return r?new ao(r):e.error("No image name provided.")},ao.prototype.evaluate=function(t){var e=this.input.evaluate(t),r=Pn.fromString(e);return r&&t.availableImages&&(r.available=t.availableImages.indexOf(e)>-1),r},ao.prototype.eachChild=function(t){t(this.input)},ao.prototype.outputDefined=function(){return!1},ao.prototype.serialize=function(){return["image",this.input.serialize()]};var Fo={"to-boolean":Pt,"to-color":Ue,"to-number":Ct,"to-string":qt},Nn=function(t,e){this.type=t,this.args=e};Nn.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var r=t[0];if((r==="to-boolean"||r==="to-string")&&t.length!==2)return e.error("Expected one argument.");for(var o=Fo[r],u=[],c=1;c<t.length;c++){var h=e.parse(t[c],c,ae);if(!h)return null;u.push(h)}return new Nn(o,u)},Nn.prototype.evaluate=function(t){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(t));if(this.type.kind==="color"){for(var e,r,o=0,u=this.args;o<u.length;o+=1){if(r=null,(e=u[o].evaluate(t))instanceof $e)return e;if(typeof e=="string"){var c=t.parseColor(e);if(c)return c}else if(Array.isArray(e)&&!(r=e.length<3||e.length>4?"Invalid rbga value "+JSON.stringify(e)+": expected an array containing either three or four numeric values.":rs(e[0],e[1],e[2],e[3])))return new $e(e[0]/255,e[1]/255,e[2]/255,e[3])}throw new ii(r||"Could not parse color from value '"+(typeof e=="string"?e:String(JSON.stringify(e)))+"'")}if(this.type.kind==="number"){for(var h=null,m=0,v=this.args;m<v.length;m+=1){if((h=v[m].evaluate(t))===null)return 0;var _=Number(h);if(!isNaN(_))return _}throw new ii("Could not convert "+JSON.stringify(h)+" to number.")}return this.type.kind==="formatted"?$i.fromString(ca(this.args[0].evaluate(t))):this.type.kind==="resolvedImage"?Pn.fromString(ca(this.args[0].evaluate(t))):ca(this.args[0].evaluate(t))},Nn.prototype.eachChild=function(t){this.args.forEach(t)},Nn.prototype.outputDefined=function(){return this.args.every(function(t){return t.outputDefined()})},Nn.prototype.serialize=function(){if(this.type.kind==="formatted")return new Yn([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new ao(this.args[0]).serialize();var t=["to-"+this.type.kind];return this.eachChild(function(e){t.push(e.serialize())}),t};var xl=["Unknown","Point","LineString","Polygon"],wa=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};wa.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},wa.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?xl[this.feature.type]:this.feature.type:null},wa.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},wa.prototype.canonicalID=function(){return this.canonical},wa.prototype.properties=function(){return this.feature&&this.feature.properties||{}},wa.prototype.parseColor=function(t){var e=this._parseColorCache[t];return e||(e=this._parseColorCache[t]=$e.parse(t)),e};var ui=function(t,e,r,o){this.name=t,this.type=e,this._evaluate=r,this.args=o};ui.prototype.evaluate=function(t){return this._evaluate(t,this.args)},ui.prototype.eachChild=function(t){this.args.forEach(t)},ui.prototype.outputDefined=function(){return!1},ui.prototype.serialize=function(){return[this.name].concat(this.args.map(function(t){return t.serialize()}))},ui.parse=function(t,e){var r,o=t[0],u=ui.definitions[o];if(!u)return e.error('Unknown expression "'+o+'". If you wanted a literal array, use ["literal", [...]].',0);for(var c=Array.isArray(u)?u[0]:u.type,h=Array.isArray(u)?[[u[1],u[2]]]:u.overloads,m=h.filter(function(xe){var Qt=xe[0];return!Array.isArray(Qt)||Qt.length===t.length-1}),v=null,_=0,x=m;_<x.length;_+=1){var w=x[_],E=w[0],z=w[1];v=new kn(e.registry,e.path,null,e.scope);for(var O=[],F=!1,J=1;J<t.length;J++){var H=t[J],at=Array.isArray(E)?E[J-1]:E.type,st=v.parse(H,1+O.length,at);if(!st){F=!0;break}O.push(st)}if(!F)if(Array.isArray(E)&&E.length!==O.length)v.error("Expected "+E.length+" arguments, but found "+O.length+" instead.");else{for(var dt=0;dt<O.length;dt++){var mt=Array.isArray(E)?E[dt]:E.type,zt=O[dt];v.concat(dt+1).checkSubtype(mt,zt.type)}if(v.errors.length===0)return new ui(o,c,z,O)}}if(m.length===1)(r=e.errors).push.apply(r,v.errors);else{for(var Ot=(m.length?m:h).map(function(xe){var Qt;return Qt=xe[0],Array.isArray(Qt)?"("+Qt.map(nr).join(", ")+")":"("+nr(Qt.type)+"...)"}).join(" | "),Zt=[],ve=1;ve<t.length;ve++){var Wt=e.parse(t[ve],1+Zt.length);if(!Wt)return null;Zt.push(nr(Wt.type))}e.error("Expected arguments of type "+Ot+", but found ("+Zt.join(", ")+") instead.")}return null},ui.register=function(t,e){for(var r in ui.definitions=e,e)t[r]=ui};var Fi=function(t,e,r){this.type=Br,this.locale=r,this.caseSensitive=t,this.diacriticSensitive=e};function Uo(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}function ws(t,e){return!(t[0]<=e[0]||t[2]>=e[2]||t[1]<=e[1]||t[3]>=e[3])}function jl(t,e){var r=(180+t[0])/360,o=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t[1]*Math.PI/360)))/360,u=Math.pow(2,e.z);return[Math.round(r*u*8192),Math.round(o*u*8192)]}function ql(t,e,r){return e[1]>t[1]!=r[1]>t[1]&&t[0]<(r[0]-e[0])*(t[1]-e[1])/(r[1]-e[1])+e[0]}function Vo(t,e){for(var r,o,u,c,h,m,v,_=!1,x=0,w=e.length;x<w;x++)for(var E=e[x],z=0,O=E.length;z<O-1;z++){if((c=(r=t)[0]-(o=E[z])[0])*(v=r[1]-(u=E[z+1])[1])-(m=r[0]-u[0])*(h=r[1]-o[1])==0&&c*m<=0&&h*v<=0)return!1;ql(t,E[z],E[z+1])&&(_=!_)}return _}function bl(t,e){for(var r=0;r<e.length;r++)if(Vo(t,e[r]))return!0;return!1}function is(t,e,r,o){var u=o[0]-r[0],c=o[1]-r[1],h=(t[0]-r[0])*c-u*(t[1]-r[1]),m=(e[0]-r[0])*c-u*(e[1]-r[1]);return h>0&&m<0||h<0&&m>0}function Zl(t,e,r){for(var o=0,u=r;o<u.length;o+=1)for(var c=u[o],h=0;h<c.length-1;++h)if((w=[(x=c[h+1])[0]-(_=c[h])[0],x[1]-_[1]])[0]*(E=[(v=e)[0]-(m=t)[0],v[1]-m[1]])[1]-w[1]*E[0]!=0&&is(m,v,_,x)&&is(_,x,m,v))return!0;var m,v,_,x,w,E;return!1}function Js(t,e){for(var r=0;r<t.length;++r)if(!Vo(t[r],e))return!1;for(var o=0;o<t.length-1;++o)if(Zl(t[o],t[o+1],e))return!1;return!0}function Ss(t,e){for(var r=0;r<e.length;r++)if(Js(t,e[r]))return!0;return!1}function Qs(t,e,r){for(var o=[],u=0;u<t.length;u++){for(var c=[],h=0;h<t[u].length;h++){var m=jl(t[u][h],r);Uo(e,m),c.push(m)}o.push(c)}return o}function Ts(t,e,r){for(var o=[],u=0;u<t.length;u++){var c=Qs(t[u],e,r);o.push(c)}return o}function xo(t,e,r,o){if(t[0]<r[0]||t[0]>r[2]){var u=.5*o,c=t[0]-r[0]>u?-o:r[0]-t[0]>u?o:0;c===0&&(c=t[0]-r[2]>u?-o:r[2]-t[0]>u?o:0),t[0]+=c}Uo(e,t)}function No(t,e,r,o){for(var u=8192*Math.pow(2,o.z),c=[8192*o.x,8192*o.y],h=[],m=0,v=t;m<v.length;m+=1)for(var _=0,x=v[m];_<x.length;_+=1){var w=x[_],E=[w.x+c[0],w.y+c[1]];xo(E,e,r,u),h.push(E)}return h}function Es(t,e,r,o){for(var u,c=8192*Math.pow(2,o.z),h=[8192*o.x,8192*o.y],m=[],v=0,_=t;v<_.length;v+=1){for(var x=[],w=0,E=_[v];w<E.length;w+=1){var z=E[w],O=[z.x+h[0],z.y+h[1]];Uo(e,O),x.push(O)}m.push(x)}if(e[2]-e[0]<=c/2){(u=e)[0]=u[1]=1/0,u[2]=u[3]=-1/0;for(var F=0,J=m;F<J.length;F+=1)for(var H=0,at=J[F];H<at.length;H+=1)xo(at[H],e,r,c)}return m}Fi.parse=function(t,e){if(t.length!==2)return e.error("Expected one argument.");var r=t[1];if(typeof r!="object"||Array.isArray(r))return e.error("Collator options argument must be an object.");var o=e.parse(r["case-sensitive"]!==void 0&&r["case-sensitive"],1,Pt);if(!o)return null;var u=e.parse(r["diacritic-sensitive"]!==void 0&&r["diacritic-sensitive"],1,Pt);if(!u)return null;var c=null;return r.locale&&!(c=e.parse(r.locale,1,qt))?null:new Fi(o,u,c)},Fi.prototype.evaluate=function(t){return new Ha(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)},Fi.prototype.eachChild=function(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)},Fi.prototype.outputDefined=function(){return!1},Fi.prototype.serialize=function(){var t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]};var Tn=function(t,e){this.type=Pt,this.geojson=t,this.geometries=e};function oo(t){if(t instanceof ui&&(t.name==="get"&&t.args.length===1||t.name==="feature-state"||t.name==="has"&&t.args.length===1||t.name==="properties"||t.name==="geometry-type"||t.name==="id"||/^filter-/.test(t.name))||t instanceof Tn)return!1;var e=!0;return t.eachChild(function(r){e&&!oo(r)&&(e=!1)}),e}function so(t){if(t instanceof ui&&t.name==="feature-state")return!1;var e=!0;return t.eachChild(function(r){e&&!so(r)&&(e=!1)}),e}function bo(t,e){if(t instanceof ui&&e.indexOf(t.name)>=0)return!1;var r=!0;return t.eachChild(function(o){r&&!bo(o,e)&&(r=!1)}),r}Tn.parse=function(t,e){if(t.length!==2)return e.error("'within' expression requires exactly one argument, but found "+(t.length-1)+" instead.");if(Oo(t[1])){var r=t[1];if(r.type==="FeatureCollection")for(var o=0;o<r.features.length;++o){var u=r.features[o].geometry.type;if(u==="Polygon"||u==="MultiPolygon")return new Tn(r,r.features[o].geometry)}else if(r.type==="Feature"){var c=r.geometry.type;if(c==="Polygon"||c==="MultiPolygon")return new Tn(r,r.geometry)}else if(r.type==="Polygon"||r.type==="MultiPolygon")return new Tn(r,r)}return e.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Tn.prototype.evaluate=function(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(e,r){var o=[1/0,1/0,-1/0,-1/0],u=[1/0,1/0,-1/0,-1/0],c=e.canonicalID();if(r.type==="Polygon"){var h=Qs(r.coordinates,u,c),m=No(e.geometry(),o,u,c);if(!ws(o,u))return!1;for(var v=0,_=m;v<_.length;v+=1)if(!Vo(_[v],h))return!1}if(r.type==="MultiPolygon"){var x=Ts(r.coordinates,u,c),w=No(e.geometry(),o,u,c);if(!ws(o,u))return!1;for(var E=0,z=w;E<z.length;E+=1)if(!bl(z[E],x))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(e,r){var o=[1/0,1/0,-1/0,-1/0],u=[1/0,1/0,-1/0,-1/0],c=e.canonicalID();if(r.type==="Polygon"){var h=Qs(r.coordinates,u,c),m=Es(e.geometry(),o,u,c);if(!ws(o,u))return!1;for(var v=0,_=m;v<_.length;v+=1)if(!Js(_[v],h))return!1}if(r.type==="MultiPolygon"){var x=Ts(r.coordinates,u,c),w=Es(e.geometry(),o,u,c);if(!ws(o,u))return!1;for(var E=0,z=w;E<z.length;E+=1)if(!Ss(z[E],x))return!1}return!0}(t,this.geometries)}return!1},Tn.prototype.eachChild=function(){},Tn.prototype.outputDefined=function(){return!0},Tn.prototype.serialize=function(){return["within",this.geojson]};var ci=function(t,e){this.type=e.type,this.name=t,this.boundExpression=e};ci.parse=function(t,e){if(t.length!==2||typeof t[1]!="string")return e.error("'var' expression requires exactly one string literal argument.");var r=t[1];return e.scope.has(r)?new ci(r,e.scope.get(r)):e.error('Unknown variable "'+r+'". Make sure "'+r+'" has been bound in an enclosing "let" expression before using it.',1)},ci.prototype.evaluate=function(t){return this.boundExpression.evaluate(t)},ci.prototype.eachChild=function(){},ci.prototype.outputDefined=function(){return!1},ci.prototype.serialize=function(){return["var",this.name]};var kn=function(t,e,r,o,u){e===void 0&&(e=[]),o===void 0&&(o=new Jt),u===void 0&&(u=[]),this.registry=t,this.path=e,this.key=e.map(function(c){return"["+c+"]"}).join(""),this.scope=o,this.errors=u,this.expectedType=r};function lo(t,e){for(var r,o=t.length-1,u=0,c=o,h=0;u<=c;)if((r=t[h=Math.floor((u+c)/2)])<=e){if(h===o||e<t[h+1])return h;u=h+1}else{if(!(r>e))throw new ii("Input is not a number.");c=h-1}return 0}kn.prototype.parse=function(t,e,r,o,u){return u===void 0&&(u={}),e?this.concat(e,r,o)._parse(t,u):this._parse(t,u)},kn.prototype._parse=function(t,e){function r(_,x,w){return w==="assert"?new Sn(x,[_]):w==="coerce"?new Nn(x,[_]):_}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var o=t[0];if(typeof o!="string")return this.error("Expression name must be a string, but found "+typeof o+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var u=this.registry[o];if(u){var c=u.parse(t,this);if(!c)return null;if(this.expectedType){var h=this.expectedType,m=c.type;if(h.kind!=="string"&&h.kind!=="number"&&h.kind!=="boolean"&&h.kind!=="object"&&h.kind!=="array"||m.kind!=="value")if(h.kind!=="color"&&h.kind!=="formatted"&&h.kind!=="resolvedImage"||m.kind!=="value"&&m.kind!=="string"){if(this.checkSubtype(h,m))return null}else c=r(c,h,e.typeAnnotation||"coerce");else c=r(c,h,e.typeAnnotation||"assert")}if(!(c instanceof Kn)&&c.type.kind!=="resolvedImage"&&function _(x){if(x instanceof ci)return _(x.boundExpression);if(x instanceof ui&&x.name==="error"||x instanceof Fi||x instanceof Tn)return!1;var w=x instanceof Nn||x instanceof Sn,E=!0;return x.eachChild(function(z){E=w?E&&_(z):E&&z instanceof Kn}),!!E&&oo(x)&&bo(x,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(c)){var v=new wa;try{c=new Kn(c.type,c.evaluate(v))}catch(_){return this.error(_.message),null}}return c}return this.error('Unknown expression "'+o+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof t+" instead.")},kn.prototype.concat=function(t,e,r){var o=typeof t=="number"?this.path.concat(t):this.path,u=r?this.scope.concat(r):this.scope;return new kn(this.registry,o,e||null,u,this.errors)},kn.prototype.error=function(t){for(var e=[],r=arguments.length-1;r-- >0;)e[r]=arguments[r+1];var o=""+this.key+e.map(function(u){return"["+u+"]"}).join("");this.errors.push(new Xt(o,t))},kn.prototype.checkSubtype=function(t,e){var r=gi(t,e);return r&&this.error(r),r};var Sa=function(t,e,r){this.type=t,this.input=e,this.labels=[],this.outputs=[];for(var o=0,u=r;o<u.length;o+=1){var c=u[o],h=c[1];this.labels.push(c[0]),this.outputs.push(h)}};function ni(t,e,r){return t*(1-r)+e*r}Sa.parse=function(t,e){if(t.length-1<4)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");var r=e.parse(t[1],1,Ct);if(!r)return null;var o=[],u=null;e.expectedType&&e.expectedType.kind!=="value"&&(u=e.expectedType);for(var c=1;c<t.length;c+=2){var h=c===1?-1/0:t[c],m=t[c+1],v=c,_=c+1;if(typeof h!="number")return e.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',v);if(o.length&&o[o.length-1][0]>=h)return e.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',v);var x=e.parse(m,_,u);if(!x)return null;u=u||x.type,o.push([h,x])}return new Sa(u,r,o)},Sa.prototype.evaluate=function(t){var e=this.labels,r=this.outputs;if(e.length===1)return r[0].evaluate(t);var o=this.input.evaluate(t);if(o<=e[0])return r[0].evaluate(t);var u=e.length;return o>=e[u-1]?r[u-1].evaluate(t):r[lo(e,o)].evaluate(t)},Sa.prototype.eachChild=function(t){t(this.input);for(var e=0,r=this.outputs;e<r.length;e+=1)t(r[e])},Sa.prototype.outputDefined=function(){return this.outputs.every(function(t){return t.outputDefined()})},Sa.prototype.serialize=function(){for(var t=["step",this.input.serialize()],e=0;e<this.labels.length;e++)e>0&&t.push(this.labels[e]),t.push(this.outputs[e].serialize());return t};var Is=Object.freeze({__proto__:null,number:ni,color:function(t,e,r){return new $e(ni(t.r,e.r,r),ni(t.g,e.g,r),ni(t.b,e.b,r),ni(t.a,e.a,r))},array:function(t,e,r){return t.map(function(o,u){return ni(o,e[u],r)})}}),wl=6/29*3*(6/29),Sl=Math.PI/180,As=180/Math.PI;function ns(t){return t>.008856451679035631?Math.pow(t,1/3):t/wl+4/29}function Ta(t){return t>6/29?t*t*t:wl*(t-4/29)}function wo(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function uo(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Tr(t){var e=uo(t.r),r=uo(t.g),o=uo(t.b),u=ns((.4124564*e+.3575761*r+.1804375*o)/.95047),c=ns((.2126729*e+.7151522*r+.072175*o)/1);return{l:116*c-16,a:500*(u-c),b:200*(c-ns((.0193339*e+.119192*r+.9503041*o)/1.08883)),alpha:t.a}}function Ne(t){var e=(t.l+16)/116,r=isNaN(t.a)?e:e+t.a/500,o=isNaN(t.b)?e:e-t.b/200;return e=1*Ta(e),r=.95047*Ta(r),o=1.08883*Ta(o),new $e(wo(3.2404542*r-1.5371385*e-.4985314*o),wo(-.969266*r+1.8760108*e+.041556*o),wo(.0556434*r-.2040259*e+1.0572252*o),t.alpha)}function Da(t,e,r){var o=e-t;return t+r*(o>180||o<-180?o-360*Math.round(o/360):o)}var jn={forward:Tr,reverse:Ne,interpolate:function(t,e,r){return{l:ni(t.l,e.l,r),a:ni(t.a,e.a,r),b:ni(t.b,e.b,r),alpha:ni(t.alpha,e.alpha,r)}}},Mn={forward:function(t){var e=Tr(t),r=e.l,o=e.a,u=e.b,c=Math.atan2(u,o)*As;return{h:c<0?c+360:c,c:Math.sqrt(o*o+u*u),l:r,alpha:t.a}},reverse:function(t){var e=t.h*Sl,r=t.c;return Ne({l:t.l,a:Math.cos(e)*r,b:Math.sin(e)*r,alpha:t.alpha})},interpolate:function(t,e,r){return{h:Da(t.h,e.h,r),c:ni(t.c,e.c,r),l:ni(t.l,e.l,r),alpha:ni(t.alpha,e.alpha,r)}}},lr=Object.freeze({__proto__:null,lab:jn,hcl:Mn}),ur=function(t,e,r,o,u){this.type=t,this.operator=e,this.interpolation=r,this.input=o,this.labels=[],this.outputs=[];for(var c=0,h=u;c<h.length;c+=1){var m=h[c],v=m[1];this.labels.push(m[0]),this.outputs.push(v)}};function La(t,e,r,o){var u=o-r,c=t-r;return u===0?0:e===1?c/u:(Math.pow(e,c)-1)/(Math.pow(e,u)-1)}ur.interpolationFactor=function(t,e,r,o){var u=0;if(t.name==="exponential")u=La(e,t.base,r,o);else if(t.name==="linear")u=La(e,1,r,o);else if(t.name==="cubic-bezier"){var c=t.controlPoints;u=new G(c[0],c[1],c[2],c[3]).solve(La(e,1,r,o))}return u},ur.parse=function(t,e){var r=t[0],o=t[1],u=t[2],c=t.slice(3);if(!Array.isArray(o)||o.length===0)return e.error("Expected an interpolation type expression.",1);if(o[0]==="linear")o={name:"linear"};else if(o[0]==="exponential"){var h=o[1];if(typeof h!="number")return e.error("Exponential interpolation requires a numeric base.",1,1);o={name:"exponential",base:h}}else{if(o[0]!=="cubic-bezier")return e.error("Unknown interpolation type "+String(o[0]),1,0);var m=o.slice(1);if(m.length!==4||m.some(function(J){return typeof J!="number"||J<0||J>1}))return e.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);o={name:"cubic-bezier",controlPoints:m}}if(t.length-1<4)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");if(!(u=e.parse(u,2,Ct)))return null;var v=[],_=null;r==="interpolate-hcl"||r==="interpolate-lab"?_=Ue:e.expectedType&&e.expectedType.kind!=="value"&&(_=e.expectedType);for(var x=0;x<c.length;x+=2){var w=c[x],E=c[x+1],z=x+3,O=x+4;if(typeof w!="number")return e.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',z);if(v.length&&v[v.length-1][0]>=w)return e.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',z);var F=e.parse(E,O,_);if(!F)return null;_=_||F.type,v.push([w,F])}return _.kind==="number"||_.kind==="color"||_.kind==="array"&&_.itemType.kind==="number"&&typeof _.N=="number"?new ur(_,r,o,u,v):e.error("Type "+nr(_)+" is not interpolatable.")},ur.prototype.evaluate=function(t){var e=this.labels,r=this.outputs;if(e.length===1)return r[0].evaluate(t);var o=this.input.evaluate(t);if(o<=e[0])return r[0].evaluate(t);var u=e.length;if(o>=e[u-1])return r[u-1].evaluate(t);var c=lo(e,o),h=ur.interpolationFactor(this.interpolation,o,e[c],e[c+1]),m=r[c].evaluate(t),v=r[c+1].evaluate(t);return this.operator==="interpolate"?Is[this.type.kind.toLowerCase()](m,v,h):this.operator==="interpolate-hcl"?Mn.reverse(Mn.interpolate(Mn.forward(m),Mn.forward(v),h)):jn.reverse(jn.interpolate(jn.forward(m),jn.forward(v),h))},ur.prototype.eachChild=function(t){t(this.input);for(var e=0,r=this.outputs;e<r.length;e+=1)t(r[e])},ur.prototype.outputDefined=function(){return this.outputs.every(function(t){return t.outputDefined()})},ur.prototype.serialize=function(){var t;t=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var e=[this.operator,t,this.input.serialize()],r=0;r<this.labels.length;r++)e.push(this.labels[r],this.outputs[r].serialize());return e};var Di=function(t,e){this.type=t,this.args=e};Di.parse=function(t,e){if(t.length<2)return e.error("Expectected at least one argument.");var r=null,o=e.expectedType;o&&o.kind!=="value"&&(r=o);for(var u=[],c=0,h=t.slice(1);c<h.length;c+=1){var m=e.parse(h[c],1+u.length,r,void 0,{typeAnnotation:"omit"});if(!m)return null;r=r||m.type,u.push(m)}var v=o&&u.some(function(_){return gi(o,_.type)});return new Di(v?ae:r,u)},Di.prototype.evaluate=function(t){for(var e,r=null,o=0,u=0,c=this.args;u<c.length&&(o++,(r=c[u].evaluate(t))&&r instanceof Pn&&!r.available&&(e||(e=r.name),r=null,o===this.args.length&&(r=e)),r===null);u+=1);return r},Di.prototype.eachChild=function(t){this.args.forEach(t)},Di.prototype.outputDefined=function(){return this.args.every(function(t){return t.outputDefined()})},Di.prototype.serialize=function(){var t=["coalesce"];return this.eachChild(function(e){t.push(e.serialize())}),t};var Dn=function(t,e){this.type=e.type,this.bindings=[].concat(t),this.result=e};Dn.prototype.evaluate=function(t){return this.result.evaluate(t)},Dn.prototype.eachChild=function(t){for(var e=0,r=this.bindings;e<r.length;e+=1)t(r[e][1]);t(this.result)},Dn.parse=function(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found "+(t.length-1)+" instead.");for(var r=[],o=1;o<t.length-1;o+=2){var u=t[o];if(typeof u!="string")return e.error("Expected string, but found "+typeof u+" instead.",o);if(/[^a-zA-Z0-9_]/.test(u))return e.error("Variable names must contain only alphanumeric characters or '_'.",o);var c=e.parse(t[o+1],o+1);if(!c)return null;r.push([u,c])}var h=e.parse(t[t.length-1],t.length-1,e.expectedType,r);return h?new Dn(r,h):null},Dn.prototype.outputDefined=function(){return this.result.outputDefined()},Dn.prototype.serialize=function(){for(var t=["let"],e=0,r=this.bindings;e<r.length;e+=1){var o=r[e];t.push(o[0],o[1].serialize())}return t.push(this.result.serialize()),t};var Zi=function(t,e,r){this.type=t,this.index=e,this.input=r};Zi.parse=function(t,e){if(t.length!==3)return e.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var r=e.parse(t[1],1,Ct),o=e.parse(t[2],2,er(e.expectedType||ae));return r&&o?new Zi(o.type.itemType,r,o):null},Zi.prototype.evaluate=function(t){var e=this.index.evaluate(t),r=this.input.evaluate(t);if(e<0)throw new ii("Array index out of bounds: "+e+" < 0.");if(e>=r.length)throw new ii("Array index out of bounds: "+e+" > "+(r.length-1)+".");if(e!==Math.floor(e))throw new ii("Array index must be an integer, but found "+e+" instead.");return r[e]},Zi.prototype.eachChild=function(t){t(this.index),t(this.input)},Zi.prototype.outputDefined=function(){return!1},Zi.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var pa=function(t,e){this.type=Pt,this.needle=t,this.haystack=e};pa.parse=function(t,e){if(t.length!==3)return e.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var r=e.parse(t[1],1,ae),o=e.parse(t[2],2,ae);return r&&o?Ur(r.type,[Pt,qt,Ct,me,ae])?new pa(r,o):e.error("Expected first argument to be of type boolean, string, number or null, but found "+nr(r.type)+" instead"):null},pa.prototype.evaluate=function(t){var e=this.needle.evaluate(t),r=this.haystack.evaluate(t);if(!r)return!1;if(!Ke(e,["boolean","string","number","null"]))throw new ii("Expected first argument to be of type boolean, string, number or null, but found "+nr(Oi(e))+" instead.");if(!Ke(r,["string","array"]))throw new ii("Expected second argument to be of type array or string, but found "+nr(Oi(r))+" instead.");return r.indexOf(e)>=0},pa.prototype.eachChild=function(t){t(this.needle),t(this.haystack)},pa.prototype.outputDefined=function(){return!0},pa.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var Ra=function(t,e,r){this.type=Ct,this.needle=t,this.haystack=e,this.fromIndex=r};Ra.parse=function(t,e){if(t.length<=2||t.length>=5)return e.error("Expected 3 or 4 arguments, but found "+(t.length-1)+" instead.");var r=e.parse(t[1],1,ae),o=e.parse(t[2],2,ae);if(!r||!o)return null;if(!Ur(r.type,[Pt,qt,Ct,me,ae]))return e.error("Expected first argument to be of type boolean, string, number or null, but found "+nr(r.type)+" instead");if(t.length===4){var u=e.parse(t[3],3,Ct);return u?new Ra(r,o,u):null}return new Ra(r,o)},Ra.prototype.evaluate=function(t){var e=this.needle.evaluate(t),r=this.haystack.evaluate(t);if(!Ke(e,["boolean","string","number","null"]))throw new ii("Expected first argument to be of type boolean, string, number or null, but found "+nr(Oi(e))+" instead.");if(!Ke(r,["string","array"]))throw new ii("Expected second argument to be of type array or string, but found "+nr(Oi(r))+" instead.");if(this.fromIndex){var o=this.fromIndex.evaluate(t);return r.indexOf(e,o)}return r.indexOf(e)},Ra.prototype.eachChild=function(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)},Ra.prototype.outputDefined=function(){return!1},Ra.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var Ba=function(t,e,r,o,u,c){this.inputType=t,this.type=e,this.input=r,this.cases=o,this.outputs=u,this.otherwise=c};Ba.parse=function(t,e){if(t.length<5)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if(t.length%2!=1)return e.error("Expected an even number of arguments.");var r,o;e.expectedType&&e.expectedType.kind!=="value"&&(o=e.expectedType);for(var u={},c=[],h=2;h<t.length-1;h+=2){var m=t[h],v=t[h+1];Array.isArray(m)||(m=[m]);var _=e.concat(h);if(m.length===0)return _.error("Expected at least one branch label.");for(var x=0,w=m;x<w.length;x+=1){var E=w[x];if(typeof E!="number"&&typeof E!="string")return _.error("Branch labels must be numbers or strings.");if(typeof E=="number"&&Math.abs(E)>Number.MAX_SAFE_INTEGER)return _.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof E=="number"&&Math.floor(E)!==E)return _.error("Numeric branch labels must be integer values.");if(r){if(_.checkSubtype(r,Oi(E)))return null}else r=Oi(E);if(u[String(E)]!==void 0)return _.error("Branch labels must be unique.");u[String(E)]=c.length}var z=e.parse(v,h,o);if(!z)return null;o=o||z.type,c.push(z)}var O=e.parse(t[1],1,ae);if(!O)return null;var F=e.parse(t[t.length-1],t.length-1,o);return F?O.type.kind!=="value"&&e.concat(1).checkSubtype(r,O.type)?null:new Ba(r,o,O,u,c,F):null},Ba.prototype.evaluate=function(t){var e=this.input.evaluate(t);return(Oi(e)===this.inputType&&this.outputs[this.cases[e]]||this.otherwise).evaluate(t)},Ba.prototype.eachChild=function(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)},Ba.prototype.outputDefined=function(){return this.outputs.every(function(t){return t.outputDefined()})&&this.otherwise.outputDefined()},Ba.prototype.serialize=function(){for(var t=this,e=["match",this.input.serialize()],r=[],o={},u=0,c=Object.keys(this.cases).sort();u<c.length;u+=1){var h=c[u];(w=o[this.cases[h]])===void 0?(o[this.cases[h]]=r.length,r.push([this.cases[h],[h]])):r[w][1].push(h)}for(var m=function(z){return t.inputType.kind==="number"?Number(z):z},v=0,_=r;v<_.length;v+=1){var x=_[v],w=x[0],E=x[1];e.push(E.length===1?m(E[0]):E.map(m)),e.push(this.outputs[outputIndex$1].serialize())}return e.push(this.otherwise.serialize()),e};var ha=function(t,e,r){this.type=t,this.branches=e,this.otherwise=r};ha.parse=function(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found only "+(t.length-1)+".");if(t.length%2!=0)return e.error("Expected an odd number of arguments.");var r;e.expectedType&&e.expectedType.kind!=="value"&&(r=e.expectedType);for(var o=[],u=1;u<t.length-1;u+=2){var c=e.parse(t[u],u,Pt);if(!c)return null;var h=e.parse(t[u+1],u+1,r);if(!h)return null;o.push([c,h]),r=r||h.type}var m=e.parse(t[t.length-1],t.length-1,r);return m?new ha(r,o,m):null},ha.prototype.evaluate=function(t){for(var e=0,r=this.branches;e<r.length;e+=1){var o=r[e],u=o[1];if(o[0].evaluate(t))return u.evaluate(t)}return this.otherwise.evaluate(t)},ha.prototype.eachChild=function(t){for(var e=0,r=this.branches;e<r.length;e+=1){var o=r[e],u=o[1];t(o[0]),t(u)}t(this.otherwise)},ha.prototype.outputDefined=function(){return this.branches.every(function(t){return t[1].outputDefined()})&&this.otherwise.outputDefined()},ha.prototype.serialize=function(){var t=["case"];return this.eachChild(function(e){t.push(e.serialize())}),t};var Oa=function(t,e,r,o){this.type=t,this.input=e,this.beginIndex=r,this.endIndex=o};function as(t,e){return t==="=="||t==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function Vr(t,e,r,o){return o.compare(e,r)===0}function Fa(t,e,r){var o=t!=="=="&&t!=="!=";return function(){function u(c,h,m){this.type=Pt,this.lhs=c,this.rhs=h,this.collator=m,this.hasUntypedArgument=c.type.kind==="value"||h.type.kind==="value"}return u.parse=function(c,h){if(c.length!==3&&c.length!==4)return h.error("Expected two or three arguments.");var m=c[0],v=h.parse(c[1],1,ae);if(!v)return null;if(!as(m,v.type))return h.concat(1).error('"'+m+`" comparisons are not supported for type '`+nr(v.type)+"'.");var _=h.parse(c[2],2,ae);if(!_)return null;if(!as(m,_.type))return h.concat(2).error('"'+m+`" comparisons are not supported for type '`+nr(_.type)+"'.");if(v.type.kind!==_.type.kind&&v.type.kind!=="value"&&_.type.kind!=="value")return h.error("Cannot compare types '"+nr(v.type)+"' and '"+nr(_.type)+"'.");o&&(v.type.kind==="value"&&_.type.kind!=="value"?v=new Sn(_.type,[v]):v.type.kind!=="value"&&_.type.kind==="value"&&(_=new Sn(v.type,[_])));var x=null;if(c.length===4){if(v.type.kind!=="string"&&_.type.kind!=="string"&&v.type.kind!=="value"&&_.type.kind!=="value")return h.error("Cannot use collator to compare non-string types.");if(!(x=h.parse(c[3],3,Br)))return null}return new u(v,_,x)},u.prototype.evaluate=function(c){var h=this.lhs.evaluate(c),m=this.rhs.evaluate(c);if(o&&this.hasUntypedArgument){var v=Oi(h),_=Oi(m);if(v.kind!==_.kind||v.kind!=="string"&&v.kind!=="number")throw new ii('Expected arguments for "'+t+'" to be (string, string) or (number, number), but found ('+v.kind+", "+_.kind+") instead.")}if(this.collator&&!o&&this.hasUntypedArgument){var x=Oi(h),w=Oi(m);if(x.kind!=="string"||w.kind!=="string")return e(c,h,m)}return this.collator?r(c,h,m,this.collator.evaluate(c)):e(c,h,m)},u.prototype.eachChild=function(c){c(this.lhs),c(this.rhs),this.collator&&c(this.collator)},u.prototype.outputDefined=function(){return!0},u.prototype.serialize=function(){var c=[t];return this.eachChild(function(h){c.push(h.serialize())}),c},u}()}Oa.parse=function(t,e){if(t.length<=2||t.length>=5)return e.error("Expected 3 or 4 arguments, but found "+(t.length-1)+" instead.");var r=e.parse(t[1],1,ae),o=e.parse(t[2],2,Ct);if(!r||!o)return null;if(!Ur(r.type,[er(ae),qt,ae]))return e.error("Expected first argument to be of type array or string, but found "+nr(r.type)+" instead");if(t.length===4){var u=e.parse(t[3],3,Ct);return u?new Oa(r.type,r,o,u):null}return new Oa(r.type,r,o)},Oa.prototype.evaluate=function(t){var e=this.input.evaluate(t),r=this.beginIndex.evaluate(t);if(!Ke(e,["string","array"]))throw new ii("Expected first argument to be of type array or string, but found "+nr(Oi(e))+" instead.");if(this.endIndex){var o=this.endIndex.evaluate(t);return e.slice(r,o)}return e.slice(r)},Oa.prototype.eachChild=function(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)},Oa.prototype.outputDefined=function(){return!1},Oa.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var Ua=Fa("==",function(t,e,r){return e===r},Vr),Jn=Fa("!=",function(t,e,r){return e!==r},function(t,e,r,o){return!Vr(0,e,r,o)}),Cs=Fa("<",function(t,e,r){return e<r},function(t,e,r,o){return o.compare(e,r)<0}),zs=Fa(">",function(t,e,r){return e>r},function(t,e,r,o){return o.compare(e,r)>0}),co=Fa("<=",function(t,e,r){return e<=r},function(t,e,r,o){return o.compare(e,r)<=0}),jo=Fa(">=",function(t,e,r){return e>=r},function(t,e,r,o){return o.compare(e,r)>=0}),pn=function(t,e,r,o,u){this.type=qt,this.number=t,this.locale=e,this.currency=r,this.minFractionDigits=o,this.maxFractionDigits=u};pn.parse=function(t,e){if(t.length!==3)return e.error("Expected two arguments.");var r=e.parse(t[1],1,Ct);if(!r)return null;var o=t[2];if(typeof o!="object"||Array.isArray(o))return e.error("NumberFormat options argument must be an object.");var u=null;if(o.locale&&!(u=e.parse(o.locale,1,qt)))return null;var c=null;if(o.currency&&!(c=e.parse(o.currency,1,qt)))return null;var h=null;if(o["min-fraction-digits"]&&!(h=e.parse(o["min-fraction-digits"],1,Ct)))return null;var m=null;return o["max-fraction-digits"]&&!(m=e.parse(o["max-fraction-digits"],1,Ct))?null:new pn(r,u,c,h,m)},pn.prototype.evaluate=function(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))},pn.prototype.eachChild=function(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)},pn.prototype.outputDefined=function(){return!1},pn.prototype.serialize=function(){var t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]};var Ea=function(t){this.type=Ct,this.input=t};Ea.parse=function(t,e){if(t.length!==2)return e.error("Expected 1 argument, but found "+(t.length-1)+" instead.");var r=e.parse(t[1],1);return r?r.type.kind!=="array"&&r.type.kind!=="string"&&r.type.kind!=="value"?e.error("Expected argument of type string or array, but found "+nr(r.type)+" instead."):new Ea(r):null},Ea.prototype.evaluate=function(t){var e=this.input.evaluate(t);if(typeof e=="string"||Array.isArray(e))return e.length;throw new ii("Expected value to be of type string or array, but found "+nr(Oi(e))+" instead.")},Ea.prototype.eachChild=function(t){t(this.input)},Ea.prototype.outputDefined=function(){return!1},Ea.prototype.serialize=function(){var t=["length"];return this.eachChild(function(e){t.push(e.serialize())}),t};var Ia={"==":Ua,"!=":Jn,">":zs,"<":Cs,">=":jo,"<=":co,array:Sn,at:Zi,boolean:Sn,case:ha,coalesce:Di,collator:Fi,format:Yn,image:ao,in:pa,"index-of":Ra,interpolate:ur,"interpolate-hcl":ur,"interpolate-lab":ur,length:Ea,let:Dn,literal:Kn,match:Ba,number:Sn,"number-format":pn,object:Sn,slice:Oa,step:Sa,string:Sn,"to-boolean":Nn,"to-color":Nn,"to-number":Nn,"to-string":Nn,var:ci,within:Tn};function Tl(t,e){var r=e[0],o=e[1],u=e[2],c=e[3];r=r.evaluate(t),o=o.evaluate(t),u=u.evaluate(t);var h=c?c.evaluate(t):1,m=rs(r,o,u,h);if(m)throw new ii(m);return new $e(r/255*h,o/255*h,u/255*h,h)}function Va(t,e){return t in e}function qo(t,e){var r=e[t];return r===void 0?null:r}function hn(t){return{type:t}}function Wa(t){return{result:"success",value:t}}function So(t){return{result:"error",value:t}}function To(t){return t["property-type"]==="data-driven"||t["property-type"]==="cross-faded-data-driven"}function Ps(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}function $s(t){return!!t.expression&&t.expression.interpolated}function Wr(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":t===null?"null":typeof t}function ks(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}function El(t){return t}function Zo(t,e,r){return t!==void 0?t:e!==void 0?e:r!==void 0?r:void 0}function Gl(t,e,r,o,u){return Zo(typeof r===u?o[r]:void 0,t.default,e.default)}function os(t,e,r){if(Wr(r)!=="number")return Zo(t.default,e.default);var o=t.stops.length;if(o===1||r<=t.stops[0][0])return t.stops[0][1];if(r>=t.stops[o-1][0])return t.stops[o-1][1];var u=lo(t.stops.map(function(c){return c[0]}),r);return t.stops[u][1]}function Xa(t,e,r){var o=t.base!==void 0?t.base:1;if(Wr(r)!=="number")return Zo(t.default,e.default);var u=t.stops.length;if(u===1||r<=t.stops[0][0])return t.stops[0][1];if(r>=t.stops[u-1][0])return t.stops[u-1][1];var c=lo(t.stops.map(function(w){return w[0]}),r),h=function(w,E,z,O){var F=O-z,J=w-z;return F===0?0:E===1?J/F:(Math.pow(E,J)-1)/(Math.pow(E,F)-1)}(r,o,t.stops[c][0],t.stops[c+1][0]),m=t.stops[c][1],v=t.stops[c+1][1],_=Is[e.type]||El;if(t.colorSpace&&t.colorSpace!=="rgb"){var x=lr[t.colorSpace];_=function(w,E){return x.reverse(x.interpolate(x.forward(w),x.forward(E),h))}}return typeof m.evaluate=="function"?{evaluate:function(){for(var w=[],E=arguments.length;E--;)w[E]=arguments[E];var z=m.evaluate.apply(void 0,w),O=v.evaluate.apply(void 0,w);if(z!==void 0&&O!==void 0)return _(z,O,h)}}:_(m,v,h)}function tl(t,e,r){return e.type==="color"?r=$e.parse(r):e.type==="formatted"?r=$i.fromString(r.toString()):e.type==="resolvedImage"?r=Pn.fromString(r.toString()):Wr(r)===e.type||e.type==="enum"&&e.values[r]||(r=void 0),Zo(r,t.default,e.default)}ui.register(Ia,{error:[{kind:"error"},[qt],function(t,e){throw new ii(e[0].evaluate(t))}],typeof:[qt,[ae],function(t,e){return nr(Oi(e[0].evaluate(t)))}],"to-rgba":[er(Ct,4),[Ue],function(t,e){return e[0].evaluate(t).toArray()}],rgb:[Ue,[Ct,Ct,Ct],Tl],rgba:[Ue,[Ct,Ct,Ct,Ct],Tl],has:{type:Pt,overloads:[[[qt],function(t,e){return Va(e[0].evaluate(t),t.properties())}],[[qt,Oe],function(t,e){var r=e[1];return Va(e[0].evaluate(t),r.evaluate(t))}]]},get:{type:ae,overloads:[[[qt],function(t,e){return qo(e[0].evaluate(t),t.properties())}],[[qt,Oe],function(t,e){var r=e[1];return qo(e[0].evaluate(t),r.evaluate(t))}]]},"feature-state":[ae,[qt],function(t,e){return qo(e[0].evaluate(t),t.featureState||{})}],properties:[Oe,[],function(t){return t.properties()}],"geometry-type":[qt,[],function(t){return t.geometryType()}],id:[ae,[],function(t){return t.id()}],zoom:[Ct,[],function(t){return t.globals.zoom}],"heatmap-density":[Ct,[],function(t){return t.globals.heatmapDensity||0}],"line-progress":[Ct,[],function(t){return t.globals.lineProgress||0}],accumulated:[ae,[],function(t){return t.globals.accumulated===void 0?null:t.globals.accumulated}],"+":[Ct,hn(Ct),function(t,e){for(var r=0,o=0,u=e;o<u.length;o+=1)r+=u[o].evaluate(t);return r}],"*":[Ct,hn(Ct),function(t,e){for(var r=1,o=0,u=e;o<u.length;o+=1)r*=u[o].evaluate(t);return r}],"-":{type:Ct,overloads:[[[Ct,Ct],function(t,e){var r=e[1];return e[0].evaluate(t)-r.evaluate(t)}],[[Ct],function(t,e){return-e[0].evaluate(t)}]]},"/":[Ct,[Ct,Ct],function(t,e){var r=e[1];return e[0].evaluate(t)/r.evaluate(t)}],"%":[Ct,[Ct,Ct],function(t,e){var r=e[1];return e[0].evaluate(t)%r.evaluate(t)}],ln2:[Ct,[],function(){return Math.LN2}],pi:[Ct,[],function(){return Math.PI}],e:[Ct,[],function(){return Math.E}],"^":[Ct,[Ct,Ct],function(t,e){var r=e[1];return Math.pow(e[0].evaluate(t),r.evaluate(t))}],sqrt:[Ct,[Ct],function(t,e){return Math.sqrt(e[0].evaluate(t))}],log10:[Ct,[Ct],function(t,e){return Math.log(e[0].evaluate(t))/Math.LN10}],ln:[Ct,[Ct],function(t,e){return Math.log(e[0].evaluate(t))}],log2:[Ct,[Ct],function(t,e){return Math.log(e[0].evaluate(t))/Math.LN2}],sin:[Ct,[Ct],function(t,e){return Math.sin(e[0].evaluate(t))}],cos:[Ct,[Ct],function(t,e){return Math.cos(e[0].evaluate(t))}],tan:[Ct,[Ct],function(t,e){return Math.tan(e[0].evaluate(t))}],asin:[Ct,[Ct],function(t,e){return Math.asin(e[0].evaluate(t))}],acos:[Ct,[Ct],function(t,e){return Math.acos(e[0].evaluate(t))}],atan:[Ct,[Ct],function(t,e){return Math.atan(e[0].evaluate(t))}],min:[Ct,hn(Ct),function(t,e){return Math.min.apply(Math,e.map(function(r){return r.evaluate(t)}))}],max:[Ct,hn(Ct),function(t,e){return Math.max.apply(Math,e.map(function(r){return r.evaluate(t)}))}],abs:[Ct,[Ct],function(t,e){return Math.abs(e[0].evaluate(t))}],round:[Ct,[Ct],function(t,e){var r=e[0].evaluate(t);return r<0?-Math.round(-r):Math.round(r)}],floor:[Ct,[Ct],function(t,e){return Math.floor(e[0].evaluate(t))}],ceil:[Ct,[Ct],function(t,e){return Math.ceil(e[0].evaluate(t))}],"filter-==":[Pt,[qt,ae],function(t,e){var r=e[0],o=e[1];return t.properties()[r.value]===o.value}],"filter-id-==":[Pt,[ae],function(t,e){var r=e[0];return t.id()===r.value}],"filter-type-==":[Pt,[qt],function(t,e){var r=e[0];return t.geometryType()===r.value}],"filter-<":[Pt,[qt,ae],function(t,e){var r=e[0],o=e[1],u=t.properties()[r.value],c=o.value;return typeof u==typeof c&&u<c}],"filter-id-<":[Pt,[ae],function(t,e){var r=e[0],o=t.id(),u=r.value;return typeof o==typeof u&&o<u}],"filter->":[Pt,[qt,ae],function(t,e){var r=e[0],o=e[1],u=t.properties()[r.value],c=o.value;return typeof u==typeof c&&u>c}],"filter-id->":[Pt,[ae],function(t,e){var r=e[0],o=t.id(),u=r.value;return typeof o==typeof u&&o>u}],"filter-<=":[Pt,[qt,ae],function(t,e){var r=e[0],o=e[1],u=t.properties()[r.value],c=o.value;return typeof u==typeof c&&u<=c}],"filter-id-<=":[Pt,[ae],function(t,e){var r=e[0],o=t.id(),u=r.value;return typeof o==typeof u&&o<=u}],"filter->=":[Pt,[qt,ae],function(t,e){var r=e[0],o=e[1],u=t.properties()[r.value],c=o.value;return typeof u==typeof c&&u>=c}],"filter-id->=":[Pt,[ae],function(t,e){var r=e[0],o=t.id(),u=r.value;return typeof o==typeof u&&o>=u}],"filter-has":[Pt,[ae],function(t,e){return e[0].value in t.properties()}],"filter-has-id":[Pt,[],function(t){return t.id()!==null&&t.id()!==void 0}],"filter-type-in":[Pt,[er(qt)],function(t,e){return e[0].value.indexOf(t.geometryType())>=0}],"filter-id-in":[Pt,[er(ae)],function(t,e){return e[0].value.indexOf(t.id())>=0}],"filter-in-small":[Pt,[qt,er(ae)],function(t,e){var r=e[0];return e[1].value.indexOf(t.properties()[r.value])>=0}],"filter-in-large":[Pt,[qt,er(ae)],function(t,e){var r=e[0],o=e[1];return function(u,c,h,m){for(;h<=m;){var v=h+m>>1;if(c[v]===u)return!0;c[v]>u?m=v-1:h=v+1}return!1}(t.properties()[r.value],o.value,0,o.value.length-1)}],all:{type:Pt,overloads:[[[Pt,Pt],function(t,e){var r=e[1];return e[0].evaluate(t)&&r.evaluate(t)}],[hn(Pt),function(t,e){for(var r=0,o=e;r<o.length;r+=1)if(!o[r].evaluate(t))return!1;return!0}]]},any:{type:Pt,overloads:[[[Pt,Pt],function(t,e){var r=e[1];return e[0].evaluate(t)||r.evaluate(t)}],[hn(Pt),function(t,e){for(var r=0,o=e;r<o.length;r+=1)if(o[r].evaluate(t))return!0;return!1}]]},"!":[Pt,[Pt],function(t,e){return!e[0].evaluate(t)}],"is-supported-script":[Pt,[qt],function(t,e){var r=t.globals&&t.globals.isSupportedScript;return!r||r(e[0].evaluate(t))}],upcase:[qt,[qt],function(t,e){return e[0].evaluate(t).toUpperCase()}],downcase:[qt,[qt],function(t,e){return e[0].evaluate(t).toLowerCase()}],concat:[qt,hn(ae),function(t,e){return e.map(function(r){return ca(r.evaluate(t))}).join("")}],"resolved-locale":[qt,[Br],function(t,e){return e[0].evaluate(t).resolvedLocale()}]});var Eo=function(t,e){this.expression=t,this._warningHistory={},this._evaluator=new wa,this._defaultValue=e?function(r){return r.type==="color"&&ks(r.default)?new $e(0,0,0,0):r.type==="color"?$e.parse(r.default)||null:r.default===void 0?null:r.default}(e):null,this._enumValues=e&&e.type==="enum"?e.values:null};function Ms(t){return Array.isArray(t)&&t.length>0&&typeof t[0]=="string"&&t[0]in Ia}function Ds(t,e){var r=new kn(Ia,[],e?function(u){var c={color:Ue,string:qt,number:Ct,enum:qt,boolean:Pt,formatted:Me,resolvedImage:Hr};return u.type==="array"?er(c[u.value]||ae,u.length):c[u.type]}(e):void 0),o=r.parse(t,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return o?Wa(new Eo(o,e)):So(r.errors)}Eo.prototype.evaluateWithoutErrorHandling=function(t,e,r,o,u,c){return this._evaluator.globals=t,this._evaluator.feature=e,this._evaluator.featureState=r,this._evaluator.canonical=o,this._evaluator.availableImages=u||null,this._evaluator.formattedSection=c,this.expression.evaluate(this._evaluator)},Eo.prototype.evaluate=function(t,e,r,o,u,c){this._evaluator.globals=t,this._evaluator.feature=e||null,this._evaluator.featureState=r||null,this._evaluator.canonical=o,this._evaluator.availableImages=u||null,this._evaluator.formattedSection=c||null;try{var h=this.expression.evaluate(this._evaluator);if(h==null||typeof h=="number"&&h!=h)return this._defaultValue;if(this._enumValues&&!(h in this._enumValues))throw new ii("Expected value to be one of "+Object.keys(this._enumValues).map(function(m){return JSON.stringify(m)}).join(", ")+", but found "+JSON.stringify(h)+" instead.");return h}catch(m){return this._warningHistory[m.message]||(this._warningHistory[m.message]=!0,typeof console!="undefined"&&console.warn(m.message)),this._defaultValue}};var ss=function(t,e){this.kind=t,this._styleExpression=e,this.isStateDependent=t!=="constant"&&!so(e.expression)};ss.prototype.evaluateWithoutErrorHandling=function(t,e,r,o,u,c){return this._styleExpression.evaluateWithoutErrorHandling(t,e,r,o,u,c)},ss.prototype.evaluate=function(t,e,r,o,u,c){return this._styleExpression.evaluate(t,e,r,o,u,c)};var Go=function(t,e,r,o){this.kind=t,this.zoomStops=r,this._styleExpression=e,this.isStateDependent=t!=="camera"&&!so(e.expression),this.interpolationType=o};function el(t,e){if((t=Ds(t,e)).result==="error")return t;var r=t.value.expression,o=oo(r);if(!o&&!To(e))return So([new Xt("","data expressions not supported")]);var u=bo(r,["zoom"]);if(!u&&!Ps(e))return So([new Xt("","zoom expressions not supported")]);var c=function h(m){var v=null;if(m instanceof Dn)v=h(m.result);else if(m instanceof Di)for(var _=0,x=m.args;_<x.length&&!(v=h(x[_]));_+=1);else(m instanceof Sa||m instanceof ur)&&m.input instanceof ui&&m.input.name==="zoom"&&(v=m);return v instanceof Xt||m.eachChild(function(w){var E=h(w);E instanceof Xt?v=E:!v&&E?v=new Xt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):v&&E&&v!==E&&(v=new Xt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),v}(r);return c||u?c instanceof Xt?So([c]):c instanceof ur&&!$s(e)?So([new Xt("",'"interpolate" expressions cannot be used with this property')]):Wa(c?new Go(o?"camera":"composite",t.value,c.labels,c instanceof ur?c.interpolation:void 0):new ss(o?"constant":"source",t.value)):So([new Xt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}Go.prototype.evaluateWithoutErrorHandling=function(t,e,r,o,u,c){return this._styleExpression.evaluateWithoutErrorHandling(t,e,r,o,u,c)},Go.prototype.evaluate=function(t,e,r,o,u,c){return this._styleExpression.evaluate(t,e,r,o,u,c)},Go.prototype.interpolationFactor=function(t,e,r){return this.interpolationType?ur.interpolationFactor(this.interpolationType,t,e,r):0};var ls=function(t,e){this._parameters=t,this._specification=e,Ft(this,function r(o,u){var c,h,m,v=u.type==="color",_=o.stops&&typeof o.stops[0][0]=="object",x=_||!(_||o.property!==void 0),w=o.type||($s(u)?"exponential":"interval");if(v&&((o=Ft({},o)).stops&&(o.stops=o.stops.map(function(Wt){return[Wt[0],$e.parse(Wt[1])]})),o.default=$e.parse(o.default?o.default:u.default)),o.colorSpace&&o.colorSpace!=="rgb"&&!lr[o.colorSpace])throw new Error("Unknown color space: "+o.colorSpace);if(w==="exponential")c=Xa;else if(w==="interval")c=os;else if(w==="categorical"){c=Gl,h=Object.create(null);for(var E=0,z=o.stops;E<z.length;E+=1){var O=z[E];h[O[0]]=O[1]}m=typeof o.stops[0][0]}else{if(w!=="identity")throw new Error('Unknown function type "'+w+'"');c=tl}if(_){for(var F={},J=[],H=0;H<o.stops.length;H++){var at=o.stops[H],st=at[0].zoom;F[st]===void 0&&(F[st]={zoom:st,type:o.type,property:o.property,default:o.default,stops:[]},J.push(st)),F[st].stops.push([at[0].value,at[1]])}for(var dt=[],mt=0,zt=J;mt<zt.length;mt+=1){var Ot=zt[mt];dt.push([F[Ot].zoom,r(F[Ot],u)])}var Zt={name:"linear"};return{kind:"composite",interpolationType:Zt,interpolationFactor:ur.interpolationFactor.bind(void 0,Zt),zoomStops:dt.map(function(Wt){return Wt[0]}),evaluate:function(Wt,xe){var Qt=Wt.zoom;return Xa({stops:dt,base:o.base},u,Qt).evaluate(Qt,xe)}}}if(x){var ve=w==="exponential"?{name:"exponential",base:o.base!==void 0?o.base:1}:null;return{kind:"camera",interpolationType:ve,interpolationFactor:ur.interpolationFactor.bind(void 0,ve),zoomStops:o.stops.map(function(Wt){return Wt[0]}),evaluate:function(Wt){return c(o,u,Wt.zoom,h,m)}}}return{kind:"source",evaluate:function(Wt,xe){var Qt=xe&&xe.properties?xe.properties[o.property]:void 0;return Qt===void 0?Zo(o.default,u.default):c(o,u,Qt,h,m)}}}(this._parameters,this._specification))};function fa(t){var e=t.key,r=t.value,o=t.valueSpec||{},u=t.objectElementValidators||{},c=t.style,h=t.styleSpec,m=[],v=Wr(r);if(v!=="object")return[new j(e,r,"object expected, "+v+" found")];for(var _ in r){var x=_.split(".")[0],w=o[x]||o["*"],E=void 0;if(u[x])E=u[x];else if(o[x])E=Ye;else if(u["*"])E=u["*"];else{if(!o["*"]){m.push(new j(e,r[_],'unknown property "'+_+'"'));continue}E=Ye}m=m.concat(E({key:(e&&e+".")+_,value:r[_],valueSpec:w,style:c,styleSpec:h,object:r,objectKey:_},r))}for(var z in o)u[z]||o[z].required&&o[z].default===void 0&&r[z]===void 0&&m.push(new j(e,r,'missing required property "'+z+'"'));return m}function Il(t){var e=t.value,r=t.valueSpec,o=t.style,u=t.styleSpec,c=t.key,h=t.arrayElementValidator||Ye;if(Wr(e)!=="array")return[new j(c,e,"array expected, "+Wr(e)+" found")];if(r.length&&e.length!==r.length)return[new j(c,e,"array length "+r.length+" expected, length "+e.length+" found")];if(r["min-length"]&&e.length<r["min-length"])return[new j(c,e,"array length at least "+r["min-length"]+" expected, length "+e.length+" found")];var m={type:r.value,values:r.values};u.$version<7&&(m.function=r.function),Wr(r.value)==="object"&&(m=r.value);for(var v=[],_=0;_<e.length;_++)v=v.concat(h({array:e,arrayIndex:_,value:e[_],valueSpec:m,style:o,styleSpec:u,key:c+"["+_+"]"}));return v}function Ka(t){var e=t.key,r=t.value,o=t.valueSpec,u=Wr(r);return u==="number"&&r!=r&&(u="NaN"),u!=="number"?[new j(e,r,"number expected, "+u+" found")]:"minimum"in o&&r<o.minimum?[new j(e,r,r+" is less than the minimum value "+o.minimum)]:"maximum"in o&&r>o.maximum?[new j(e,r,r+" is greater than the maximum value "+o.maximum)]:[]}function Ho(t){var e,r,o,u=t.valueSpec,c=lt(t.value.type),h={},m=c!=="categorical"&&t.value.property===void 0,v=!m,_=Wr(t.value.stops)==="array"&&Wr(t.value.stops[0])==="array"&&Wr(t.value.stops[0][0])==="object",x=fa({key:t.key,value:t.value,valueSpec:t.styleSpec.function,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(z){if(c==="identity")return[new j(z.key,z.value,'identity function may not have a "stops" property')];var O=[],F=z.value;return O=O.concat(Il({key:z.key,value:F,valueSpec:z.valueSpec,style:z.style,styleSpec:z.styleSpec,arrayElementValidator:w})),Wr(F)==="array"&&F.length===0&&O.push(new j(z.key,F,"array must have at least one stop")),O},default:function(z){return Ye({key:z.key,value:z.value,valueSpec:u,style:z.style,styleSpec:z.styleSpec})}}});return c==="identity"&&m&&x.push(new j(t.key,t.value,'missing required property "property"')),c==="identity"||t.value.stops||x.push(new j(t.key,t.value,'missing required property "stops"')),c==="exponential"&&t.valueSpec.expression&&!$s(t.valueSpec)&&x.push(new j(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(v&&!To(t.valueSpec)?x.push(new j(t.key,t.value,"property functions not supported")):m&&!Ps(t.valueSpec)&&x.push(new j(t.key,t.value,"zoom functions not supported"))),c!=="categorical"&&!_||t.value.property!==void 0||x.push(new j(t.key,t.value,'"property" property is required')),x;function w(z){var O=[],F=z.value,J=z.key;if(Wr(F)!=="array")return[new j(J,F,"array expected, "+Wr(F)+" found")];if(F.length!==2)return[new j(J,F,"array length 2 expected, length "+F.length+" found")];if(_){if(Wr(F[0])!=="object")return[new j(J,F,"object expected, "+Wr(F[0])+" found")];if(F[0].zoom===void 0)return[new j(J,F,"object stop key must have zoom")];if(F[0].value===void 0)return[new j(J,F,"object stop key must have value")];if(o&&o>lt(F[0].zoom))return[new j(J,F[0].zoom,"stop zoom values must appear in ascending order")];lt(F[0].zoom)!==o&&(o=lt(F[0].zoom),r=void 0,h={}),O=O.concat(fa({key:J+"[0]",value:F[0],valueSpec:{zoom:{}},style:z.style,styleSpec:z.styleSpec,objectElementValidators:{zoom:Ka,value:E}}))}else O=O.concat(E({key:J+"[0]",value:F[0],valueSpec:{},style:z.style,styleSpec:z.styleSpec},F));return Ms(It(F[1]))?O.concat([new j(J+"[1]",F[1],"expressions are not allowed in function stops.")]):O.concat(Ye({key:J+"[1]",value:F[1],valueSpec:u,style:z.style,styleSpec:z.styleSpec}))}function E(z,O){var F=Wr(z.value),J=lt(z.value),H=z.value!==null?z.value:O;if(e){if(F!==e)return[new j(z.key,H,F+" stop domain type must match previous stop domain type "+e)]}else e=F;if(F!=="number"&&F!=="string"&&F!=="boolean")return[new j(z.key,H,"stop domain value must be a number, string, or boolean")];if(F!=="number"&&c!=="categorical"){var at="number expected, "+F+" found";return To(u)&&c===void 0&&(at+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new j(z.key,H,at)]}return c!=="categorical"||F!=="number"||isFinite(J)&&Math.floor(J)===J?c!=="categorical"&&F==="number"&&r!==void 0&&J<r?[new j(z.key,H,"stop domain values must appear in ascending order")]:(r=J,c==="categorical"&&J in h?[new j(z.key,H,"stop domain values must be unique")]:(h[J]=!0,[])):[new j(z.key,H,"integer expected, found "+J)]}}function po(t){var e=(t.expressionContext==="property"?el:Ds)(It(t.value),t.valueSpec);if(e.result==="error")return e.value.map(function(o){return new j(""+t.key+o.key,t.value,o.message)});var r=e.value.expression||e.value._styleExpression.expression;if(t.expressionContext==="property"&&t.propertyKey==="text-font"&&!r.outputDefined())return[new j(t.key,t.value,'Invalid data expression for "'+t.propertyKey+'". Output values must be contained as literals within the expression.')];if(t.expressionContext==="property"&&t.propertyType==="layout"&&!so(r))return[new j(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')];if(t.expressionContext==="filter"&&!so(r))return[new j(t.key,t.value,'"feature-state" data expressions are not supported with filters.')];if(t.expressionContext&&t.expressionContext.indexOf("cluster")===0){if(!bo(r,["zoom","feature-state"]))return[new j(t.key,t.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(t.expressionContext==="cluster-initial"&&!oo(r))return[new j(t.key,t.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Io(t){var e=t.key,r=t.value,o=t.valueSpec,u=[];return Array.isArray(o.values)?o.values.indexOf(lt(r))===-1&&u.push(new j(e,r,"expected one of ["+o.values.join(", ")+"], "+JSON.stringify(r)+" found")):Object.keys(o.values).indexOf(lt(r))===-1&&u.push(new j(e,r,"expected one of ["+Object.keys(o.values).join(", ")+"], "+JSON.stringify(r)+" found")),u}function Wo(t){if(t===!0||t===!1)return!0;if(!Array.isArray(t)||t.length===0)return!1;switch(t[0]){case"has":return t.length>=2&&t[1]!=="$id"&&t[1]!=="$type";case"in":return t.length>=3&&(typeof t[1]!="string"||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return t.length!==3||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(var e=0,r=t.slice(1);e<r.length;e+=1){var o=r[e];if(!Wo(o)&&typeof o!="boolean")return!1}return!0;default:return!0}}ls.deserialize=function(t){return new ls(t._parameters,t._specification)},ls.serialize=function(t){return{_parameters:t._parameters,_specification:t._specification}};var Hl={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Ls(t){if(t==null)return{filter:function(){return!0},needGeometry:!1};Wo(t)||(t=Na(t));var e=Ds(t,Hl);if(e.result==="error")throw new Error(e.value.map(function(r){return r.key+": "+r.message}).join(", "));return{filter:function(r,o,u){return e.value.evaluate(r,o,{},u)},needGeometry:function r(o){if(!Array.isArray(o))return!1;if(o[0]==="within")return!0;for(var u=1;u<o.length;u++)if(r(o[u]))return!0;return!1}(t)}}function Wl(t,e){return t<e?-1:t>e?1:0}function Na(t){if(!t)return!0;var e,r=t[0];return t.length<=1?r!=="any":r==="=="?rl(t[1],t[2],"=="):r==="!="?us(rl(t[1],t[2],"==")):r==="<"||r===">"||r==="<="||r===">="?rl(t[1],t[2],r):r==="any"?(e=t.slice(1),["any"].concat(e.map(Na))):r==="all"?["all"].concat(t.slice(1).map(Na)):r==="none"?["all"].concat(t.slice(1).map(Na).map(us)):r==="in"?Rs(t[1],t.slice(2)):r==="!in"?us(Rs(t[1],t.slice(2))):r==="has"?Bs(t[1]):r==="!has"?us(Bs(t[1])):r!=="within"||t}function rl(t,e,r){switch(t){case"$type":return["filter-type-"+r,e];case"$id":return["filter-id-"+r,e];default:return["filter-"+r,t,e]}}function Rs(t,e){if(e.length===0)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(function(r){return typeof r!=typeof e[0]})?["filter-in-large",t,["literal",e.sort(Wl)]]:["filter-in-small",t,["literal",e]]}}function Bs(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function us(t){return["!",t]}function cs(t){return Wo(It(t.value))?po(Ft({},t,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function e(r){var o=r.value,u=r.key;if(Wr(o)!=="array")return[new j(u,o,"array expected, "+Wr(o)+" found")];var c,h=r.styleSpec,m=[];if(o.length<1)return[new j(u,o,"filter array must have at least 1 element")];switch(m=m.concat(Io({key:u+"[0]",value:o[0],valueSpec:h.filter_operator,style:r.style,styleSpec:r.styleSpec})),lt(o[0])){case"<":case"<=":case">":case">=":o.length>=2&&lt(o[1])==="$type"&&m.push(new j(u,o,'"$type" cannot be use with operator "'+o[0]+'"'));case"==":case"!=":o.length!==3&&m.push(new j(u,o,'filter array for operator "'+o[0]+'" must have 3 elements'));case"in":case"!in":o.length>=2&&(c=Wr(o[1]))!=="string"&&m.push(new j(u+"[1]",o[1],"string expected, "+c+" found"));for(var v=2;v<o.length;v++)c=Wr(o[v]),lt(o[1])==="$type"?m=m.concat(Io({key:u+"["+v+"]",value:o[v],valueSpec:h.geometry_type,style:r.style,styleSpec:r.styleSpec})):c!=="string"&&c!=="number"&&c!=="boolean"&&m.push(new j(u+"["+v+"]",o[v],"string, number, or boolean expected, "+c+" found"));break;case"any":case"all":case"none":for(var _=1;_<o.length;_++)m=m.concat(e({key:u+"["+_+"]",value:o[_],style:r.style,styleSpec:r.styleSpec}));break;case"has":case"!has":c=Wr(o[1]),o.length!==2?m.push(new j(u,o,'filter array for "'+o[0]+'" operator must have 2 elements')):c!=="string"&&m.push(new j(u+"[1]",o[1],"string expected, "+c+" found"));break;case"within":c=Wr(o[1]),o.length!==2?m.push(new j(u,o,'filter array for "'+o[0]+'" operator must have 2 elements')):c!=="object"&&m.push(new j(u+"[1]",o[1],"object expected, "+c+" found"))}return m}(t)}function Aa(t,e){var r=t.key,o=t.style,u=t.styleSpec,c=t.value,h=t.objectKey,m=u[e+"_"+t.layerType];if(!m)return[];var v=h.match(/^(.*)-transition$/);if(e==="paint"&&v&&m[v[1]]&&m[v[1]].transition)return Ye({key:r,value:c,valueSpec:u.transition,style:o,styleSpec:u});var _,x=t.valueSpec||m[h];if(!x)return[new j(r,c,'unknown property "'+h+'"')];if(Wr(c)==="string"&&To(x)&&!x.tokens&&(_=/^{([^}]+)}$/.exec(c)))return[new j(r,c,'"'+h+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(_[1])+" }`.")];var w=[];return t.layerType==="symbol"&&(h==="text-field"&&o&&!o.glyphs&&w.push(new j(r,c,'use of "text-field" requires a style "glyphs" property')),h==="text-font"&&ks(It(c))&&lt(c.type)==="identity"&&w.push(new j(r,c,'"text-font" does not support identity functions'))),w.concat(Ye({key:t.key,value:c,valueSpec:x,style:o,styleSpec:u,expressionContext:"property",propertyType:e,propertyKey:h}))}function ps(t){return Aa(t,"paint")}function il(t){return Aa(t,"layout")}function Os(t){var e=[],r=t.value,o=t.key,u=t.style,c=t.styleSpec;r.type||r.ref||e.push(new j(o,r,'either "type" or "ref" is required'));var h,m=lt(r.type),v=lt(r.ref);if(r.id)for(var _=lt(r.id),x=0;x<t.arrayIndex;x++){var w=u.layers[x];lt(w.id)===_&&e.push(new j(o,r.id,'duplicate layer id "'+r.id+'", previously used at line '+w.id.__line__))}if("ref"in r)["type","source","source-layer","filter","layout"].forEach(function(O){O in r&&e.push(new j(o,r[O],'"'+O+'" is prohibited for ref layers'))}),u.layers.forEach(function(O){lt(O.id)===v&&(h=O)}),h?h.ref?e.push(new j(o,r.ref,"ref cannot reference another ref layer")):m=lt(h.type):e.push(new j(o,r.ref,'ref layer "'+v+'" not found'));else if(m!=="background")if(r.source){var E=u.sources&&u.sources[r.source],z=E&&lt(E.type);E?z==="vector"&&m==="raster"?e.push(new j(o,r.source,'layer "'+r.id+'" requires a raster source')):z==="raster"&&m!=="raster"?e.push(new j(o,r.source,'layer "'+r.id+'" requires a vector source')):z!=="vector"||r["source-layer"]?z==="raster-dem"&&m!=="hillshade"?e.push(new j(o,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):m!=="line"||!r.paint||!r.paint["line-gradient"]||z==="geojson"&&E.lineMetrics||e.push(new j(o,r,'layer "'+r.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):e.push(new j(o,r,'layer "'+r.id+'" must specify a "source-layer"')):e.push(new j(o,r.source,'source "'+r.source+'" not found'))}else e.push(new j(o,r,'missing required property "source"'));return e=e.concat(fa({key:o,value:r,valueSpec:c.layer,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return Ye({key:o+".type",value:r.type,valueSpec:c.layer.type,style:t.style,styleSpec:t.styleSpec,object:r,objectKey:"type"})},filter:cs,layout:function(O){return fa({layer:r,key:O.key,value:O.value,style:O.style,styleSpec:O.styleSpec,objectElementValidators:{"*":function(F){return il(Ft({layerType:m},F))}}})},paint:function(O){return fa({layer:r,key:O.key,value:O.value,style:O.style,styleSpec:O.styleSpec,objectElementValidators:{"*":function(F){return ps(Ft({layerType:m},F))}}})}}}))}function Dr(t){var e=t.value,r=t.key,o=Wr(e);return o!=="string"?[new j(r,e,"string expected, "+o+" found")]:[]}var Fs={promoteId:function(t){var e=t.key,r=t.value;if(Wr(r)==="string")return Dr({key:e,value:r});var o=[];for(var u in r)o.push.apply(o,Dr({key:e+"."+u,value:r[u]}));return o}};function Ao(t){var e=t.value,r=t.key,o=t.styleSpec,u=t.style;if(!e.type)return[new j(r,e,'"type" is required')];var c,h=lt(e.type);switch(h){case"vector":case"raster":case"raster-dem":return fa({key:r,value:e,valueSpec:o["source_"+h.replace("-","_")],style:t.style,styleSpec:o,objectElementValidators:Fs});case"geojson":if(c=fa({key:r,value:e,valueSpec:o.source_geojson,style:u,styleSpec:o,objectElementValidators:Fs}),e.cluster)for(var m in e.clusterProperties){var v=e.clusterProperties[m],_=v[0],x=typeof _=="string"?[_,["accumulated"],["get",m]]:_;c.push.apply(c,po({key:r+"."+m+".map",value:v[1],expressionContext:"cluster-map"})),c.push.apply(c,po({key:r+"."+m+".reduce",value:x,expressionContext:"cluster-reduce"}))}return c;case"video":return fa({key:r,value:e,valueSpec:o.source_video,style:u,styleSpec:o});case"image":return fa({key:r,value:e,valueSpec:o.source_image,style:u,styleSpec:o});case"canvas":return[new j(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Io({key:r+".type",value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:u,styleSpec:o})}}function Ya(t){var e=t.value,r=t.styleSpec,o=r.light,u=t.style,c=[],h=Wr(e);if(e===void 0)return c;if(h!=="object")return c.concat([new j("light",e,"object expected, "+h+" found")]);for(var m in e){var v=m.match(/^(.*)-transition$/);c=c.concat(v&&o[v[1]]&&o[v[1]].transition?Ye({key:m,value:e[m],valueSpec:r.transition,style:u,styleSpec:r}):o[m]?Ye({key:m,value:e[m],valueSpec:o[m],style:u,styleSpec:r}):[new j(m,e[m],'unknown property "'+m+'"')])}return c}var Pr={"*":function(){return[]},array:Il,boolean:function(t){var e=t.value,r=t.key,o=Wr(e);return o!=="boolean"?[new j(r,e,"boolean expected, "+o+" found")]:[]},number:Ka,color:function(t){var e=t.key,r=t.value,o=Wr(r);return o!=="string"?[new j(e,r,"color expected, "+o+" found")]:Bo(r)===null?[new j(e,r,'color expected, "'+r+'" found')]:[]},constants:Dt,enum:Io,filter:cs,function:Ho,layer:Os,object:fa,source:Ao,light:Ya,string:Dr,formatted:function(t){return Dr(t).length===0?[]:po(t)},resolvedImage:function(t){return Dr(t).length===0?[]:po(t)}};function Ye(t){var e=t.value,r=t.valueSpec,o=t.styleSpec;return r.expression&&ks(lt(e))?Ho(t):r.expression&&Ms(It(e))?po(t):r.type&&Pr[r.type]?Pr[r.type](t):fa(Ft({},t,{valueSpec:r.type?o[r.type]:r}))}function fn(t){var e=t.value,r=t.key,o=Dr(t);return o.length||(e.indexOf("{fontstack}")===-1&&o.push(new j(r,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&o.push(new j(r,e,'"glyphs" url must include a "{range}" token'))),o}function Ln(t,e){e===void 0&&(e=M);var r=[];return r=r.concat(Ye({key:"",value:t,valueSpec:e.$root,styleSpec:e,style:t,objectElementValidators:{glyphs:fn,"*":function(){return[]}}})),t.constants&&(r=r.concat(Dt({key:"constants",value:t.constants,style:t,styleSpec:e}))),nl(r)}function nl(t){return[].concat(t).sort(function(e,r){return e.line-r.line})}function da(t){return function(){for(var e=[],r=arguments.length;r--;)e[r]=arguments[r];return nl(t.apply(this,e))}}Ln.source=da(Ao),Ln.light=da(Ya),Ln.layer=da(Os),Ln.filter=da(cs),Ln.paintProperty=da(ps),Ln.layoutProperty=da(il);var Co=Ln,al=Co.light,Xo=Co.paintProperty,hs=Co.layoutProperty;function dn(t,e){var r=!1;if(e&&e.length)for(var o=0,u=e;o<u.length;o+=1)t.fire(new tt(new Error(u[o].message))),r=!0;return r}var pi=Rn;function Rn(t,e,r){var o=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var u=new Int32Array(this.arrayBuffer);t=u[0],this.d=(e=u[1])+2*(r=u[2]);for(var c=0;c<this.d*this.d;c++){var h=u[3+c],m=u[3+c+1];o.push(h===m?null:u.subarray(h,m))}var v=u[3+o.length+1];this.keys=u.subarray(u[3+o.length],v),this.bboxes=u.subarray(v),this.insert=this._insertReadonly}else{this.d=e+2*r;for(var _=0;_<this.d*this.d;_++)o.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=t,this.padding=r,this.scale=e/t,this.uid=0;var x=r/e*t;this.min=-x,this.max=t+x}Rn.prototype.insert=function(t,e,r,o,u){this._forEachCell(e,r,o,u,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(r),this.bboxes.push(o),this.bboxes.push(u)},Rn.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Rn.prototype._insertCell=function(t,e,r,o,u,c){this.cells[u].push(c)},Rn.prototype.query=function(t,e,r,o,u){var c=this.min,h=this.max;if(t<=c&&e<=c&&h<=r&&h<=o&&!u)return Array.prototype.slice.call(this.keys);var m=[];return this._forEachCell(t,e,r,o,this._queryCell,m,{},u),m},Rn.prototype._queryCell=function(t,e,r,o,u,c,h,m){var v=this.cells[u];if(v!==null)for(var _=this.keys,x=this.bboxes,w=0;w<v.length;w++){var E=v[w];if(h[E]===void 0){var z=4*E;(m?m(x[z+0],x[z+1],x[z+2],x[z+3]):t<=x[z+2]&&e<=x[z+3]&&r>=x[z+0]&&o>=x[z+1])?(h[E]=!0,c.push(_[E])):h[E]=!1}}},Rn.prototype._forEachCell=function(t,e,r,o,u,c,h,m){for(var v=this._convertToCellCoord(t),_=this._convertToCellCoord(e),x=this._convertToCellCoord(r),w=this._convertToCellCoord(o),E=v;E<=x;E++)for(var z=_;z<=w;z++){var O=this.d*z+E;if((!m||m(this._convertFromCellCoord(E),this._convertFromCellCoord(z),this._convertFromCellCoord(E+1),this._convertFromCellCoord(z+1)))&&u.call(this,t,e,r,o,O,c,h,m))return}},Rn.prototype._convertFromCellCoord=function(t){return(t-this.padding)/this.scale},Rn.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},Rn.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,e=3+this.cells.length+1+1,r=0,o=0;o<this.cells.length;o++)r+=this.cells[o].length;var u=new Int32Array(e+r+this.keys.length+this.bboxes.length);u[0]=this.extent,u[1]=this.n,u[2]=this.padding;for(var c=e,h=0;h<t.length;h++){var m=t[h];u[3+h]=c,u.set(m,c),c+=m.length}return u[3+t.length]=c,u.set(this.keys,c),u[3+t.length+1]=c+=this.keys.length,u.set(this.bboxes,c),c+=this.bboxes.length,u.buffer};var Xl=vt.ImageData,tn=vt.ImageBitmap,Bn={};function re(t,e,r){r===void 0&&(r={}),Object.defineProperty(e,"_classRegistryKey",{value:t,writeable:!1}),Bn[t]={klass:e,omit:r.omit||[],shallow:r.shallow||[]}}for(var fs in re("Object",Object),pi.serialize=function(t,e){var r=t.toArrayBuffer();return e&&e.push(r),{buffer:r}},pi.deserialize=function(t){return new pi(t.buffer)},re("Grid",pi),re("Color",$e),re("Error",Error),re("ResolvedImage",Pn),re("StylePropertyFunction",ls),re("StyleExpression",Eo,{omit:["_evaluator"]}),re("ZoomDependentExpression",Go),re("ZoomConstantExpression",ss),re("CompoundExpression",ui,{omit:["_evaluate"]}),Ia)Ia[fs]._classRegistryKey||re("Expression_"+fs,Ia[fs]);function Ko(t){return t&&typeof ArrayBuffer!="undefined"&&(t instanceof ArrayBuffer||t.constructor&&t.constructor.name==="ArrayBuffer")}function zo(t){return tn&&t instanceof tn}function mn(t,e){if(t==null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp)return t;if(Ko(t)||zo(t))return e&&e.push(t),t;if(ArrayBuffer.isView(t)){var r=t;return e&&e.push(r.buffer),r}if(t instanceof Xl)return e&&e.push(t.data.buffer),t;if(Array.isArray(t)){for(var o=[],u=0,c=t;u<c.length;u+=1)o.push(mn(c[u],e));return o}if(typeof t=="object"){var h=t.constructor,m=h._classRegistryKey;if(!m)throw new Error("can't serialize object of unregistered class");var v=h.serialize?h.serialize(t,e):{};if(!h.serialize){for(var _ in t)if(t.hasOwnProperty(_)&&!(Bn[m].omit.indexOf(_)>=0)){var x=t[_];v[_]=Bn[m].shallow.indexOf(_)>=0?x:mn(x,e)}t instanceof Error&&(v.message=t.message)}if(v.$name)throw new Error("$name property is reserved for worker serialization logic.");return m!=="Object"&&(v.$name=m),v}throw new Error("can't serialize object of type "+typeof t)}function Yo(t){if(t==null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||Ko(t)||zo(t)||ArrayBuffer.isView(t)||t instanceof Xl)return t;if(Array.isArray(t))return t.map(Yo);if(typeof t=="object"){var e=t.$name||"Object",r=Bn[e].klass;if(!r)throw new Error("can't deserialize unregistered class "+e);if(r.deserialize)return r.deserialize(t);for(var o=Object.create(r.prototype),u=0,c=Object.keys(t);u<c.length;u+=1){var h=c[u];if(h!=="$name"){var m=t[h];o[h]=Bn[e].shallow.indexOf(h)>=0?m:Yo(m)}}return o}throw new Error("can't deserialize object of type "+typeof t)}var En=function(){this.first=!0};En.prototype.update=function(t,e){var r=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=r,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=r,!0):(this.lastFloorZoom>r?(this.lastIntegerZoom=r+1,this.lastIntegerZoomTime=e):this.lastFloorZoom<r&&(this.lastIntegerZoom=r,this.lastIntegerZoomTime=e),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=r,!0))};var ie={"Latin-1 Supplement":function(t){return t>=128&&t<=255},Arabic:function(t){return t>=1536&&t<=1791},"Arabic Supplement":function(t){return t>=1872&&t<=1919},"Arabic Extended-A":function(t){return t>=2208&&t<=2303},"Hangul Jamo":function(t){return t>=4352&&t<=4607},"Unified Canadian Aboriginal Syllabics":function(t){return t>=5120&&t<=5759},Khmer:function(t){return t>=6016&&t<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(t){return t>=6320&&t<=6399},"General Punctuation":function(t){return t>=8192&&t<=8303},"Letterlike Symbols":function(t){return t>=8448&&t<=8527},"Number Forms":function(t){return t>=8528&&t<=8591},"Miscellaneous Technical":function(t){return t>=8960&&t<=9215},"Control Pictures":function(t){return t>=9216&&t<=9279},"Optical Character Recognition":function(t){return t>=9280&&t<=9311},"Enclosed Alphanumerics":function(t){return t>=9312&&t<=9471},"Geometric Shapes":function(t){return t>=9632&&t<=9727},"Miscellaneous Symbols":function(t){return t>=9728&&t<=9983},"Miscellaneous Symbols and Arrows":function(t){return t>=11008&&t<=11263},"CJK Radicals Supplement":function(t){return t>=11904&&t<=12031},"Kangxi Radicals":function(t){return t>=12032&&t<=12255},"Ideographic Description Characters":function(t){return t>=12272&&t<=12287},"CJK Symbols and Punctuation":function(t){return t>=12288&&t<=12351},Hiragana:function(t){return t>=12352&&t<=12447},Katakana:function(t){return t>=12448&&t<=12543},Bopomofo:function(t){return t>=12544&&t<=12591},"Hangul Compatibility Jamo":function(t){return t>=12592&&t<=12687},Kanbun:function(t){return t>=12688&&t<=12703},"Bopomofo Extended":function(t){return t>=12704&&t<=12735},"CJK Strokes":function(t){return t>=12736&&t<=12783},"Katakana Phonetic Extensions":function(t){return t>=12784&&t<=12799},"Enclosed CJK Letters and Months":function(t){return t>=12800&&t<=13055},"CJK Compatibility":function(t){return t>=13056&&t<=13311},"CJK Unified Ideographs Extension A":function(t){return t>=13312&&t<=19903},"Yijing Hexagram Symbols":function(t){return t>=19904&&t<=19967},"CJK Unified Ideographs":function(t){return t>=19968&&t<=40959},"Yi Syllables":function(t){return t>=40960&&t<=42127},"Yi Radicals":function(t){return t>=42128&&t<=42191},"Hangul Jamo Extended-A":function(t){return t>=43360&&t<=43391},"Hangul Syllables":function(t){return t>=44032&&t<=55215},"Hangul Jamo Extended-B":function(t){return t>=55216&&t<=55295},"Private Use Area":function(t){return t>=57344&&t<=63743},"CJK Compatibility Ideographs":function(t){return t>=63744&&t<=64255},"Arabic Presentation Forms-A":function(t){return t>=64336&&t<=65023},"Vertical Forms":function(t){return t>=65040&&t<=65055},"CJK Compatibility Forms":function(t){return t>=65072&&t<=65103},"Small Form Variants":function(t){return t>=65104&&t<=65135},"Arabic Presentation Forms-B":function(t){return t>=65136&&t<=65279},"Halfwidth and Fullwidth Forms":function(t){return t>=65280&&t<=65519}};function Us(t){for(var e=0,r=t;e<r.length;e+=1)if(ol(r[e].charCodeAt(0)))return!0;return!1}function ol(t){return!(t!==746&&t!==747&&(t<4352||!(ie["Bopomofo Extended"](t)||ie.Bopomofo(t)||ie["CJK Compatibility Forms"](t)&&!(t>=65097&&t<=65103)||ie["CJK Compatibility Ideographs"](t)||ie["CJK Compatibility"](t)||ie["CJK Radicals Supplement"](t)||ie["CJK Strokes"](t)||!(!ie["CJK Symbols and Punctuation"](t)||t>=12296&&t<=12305||t>=12308&&t<=12319||t===12336)||ie["CJK Unified Ideographs Extension A"](t)||ie["CJK Unified Ideographs"](t)||ie["Enclosed CJK Letters and Months"](t)||ie["Hangul Compatibility Jamo"](t)||ie["Hangul Jamo Extended-A"](t)||ie["Hangul Jamo Extended-B"](t)||ie["Hangul Jamo"](t)||ie["Hangul Syllables"](t)||ie.Hiragana(t)||ie["Ideographic Description Characters"](t)||ie.Kanbun(t)||ie["Kangxi Radicals"](t)||ie["Katakana Phonetic Extensions"](t)||ie.Katakana(t)&&t!==12540||!(!ie["Halfwidth and Fullwidth Forms"](t)||t===65288||t===65289||t===65293||t>=65306&&t<=65310||t===65339||t===65341||t===65343||t>=65371&&t<=65503||t===65507||t>=65512&&t<=65519)||!(!ie["Small Form Variants"](t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||ie["Unified Canadian Aboriginal Syllabics"](t)||ie["Unified Canadian Aboriginal Syllabics Extended"](t)||ie["Vertical Forms"](t)||ie["Yijing Hexagram Symbols"](t)||ie["Yi Syllables"](t)||ie["Yi Radicals"](t))))}function Ca(t){return!(ol(t)||function(e){return!!(ie["Latin-1 Supplement"](e)&&(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247)||ie["General Punctuation"](e)&&(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273)||ie["Letterlike Symbols"](e)||ie["Number Forms"](e)||ie["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215)||ie["Control Pictures"](e)&&e!==9251||ie["Optical Character Recognition"](e)||ie["Enclosed Alphanumerics"](e)||ie["Geometric Shapes"](e)||ie["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||ie["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||ie["CJK Symbols and Punctuation"](e)||ie.Katakana(e)||ie["Private Use Area"](e)||ie["CJK Compatibility Forms"](e)||ie["Small Form Variants"](e)||ie["Halfwidth and Fullwidth Forms"](e)||e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533)}(t))}function qn(t){return t>=1424&&t<=2303||ie["Arabic Presentation Forms-A"](t)||ie["Arabic Presentation Forms-B"](t)}function sl(t,e){return!(!e&&qn(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||ie.Khmer(t))}function ll(t){for(var e=0,r=t;e<r.length;e+=1)if(qn(r[e].charCodeAt(0)))return!0;return!1}var Vs=null,Si="unavailable",ho=null,ds=function(t){t&&typeof t=="string"&&t.indexOf("NetworkError")>-1&&(Si="error"),Vs&&Vs(t)};function Ns(){Al.fire(new K("pluginStateChange",{pluginStatus:Si,pluginURL:ho}))}var Al=new W,ma=function(){return Si},Cl=function(){if(Si!=="deferred"||!ho)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Si="loading",Ns(),ho&&mr({url:ho},function(t){t?ds(t):(Si="loaded",Ns())})},hi={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return Si==="loaded"||hi.applyArabicShaping!=null},isLoading:function(){return Si==="loading"},setState:function(t){Si=t.pluginStatus,ho=t.pluginURL},isParsed:function(){return hi.applyArabicShaping!=null&&hi.processBidirectionalText!=null&&hi.processStyledBidirectionalText!=null},getPluginURL:function(){return ho}},rr=function(t,e){this.zoom=t,e?(this.now=e.now,this.fadeDuration=e.fadeDuration,this.zoomHistory=e.zoomHistory,this.transition=e.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new En,this.transition={})};rr.prototype.isSupportedScript=function(t){return function(e,r){for(var o=0,u=e;o<u.length;o+=1)if(!sl(u[o].charCodeAt(0),r))return!1;return!0}(t,hi.isLoaded())},rr.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},rr.prototype.getCrossfadeParameters=function(){var t=this.zoom,e=t-Math.floor(t),r=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:e+(1-e)*r}:{fromScale:.5,toScale:1,t:1-(1-r)*e}};var Qn=function(t,e){this.property=t,this.value=e,this.expression=function(r,o){if(ks(r))return new ls(r,o);if(Ms(r)){var u=el(r,o);if(u.result==="error")throw new Error(u.value.map(function(h){return h.key+": "+h.message}).join(", "));return u.value}var c=r;return typeof r=="string"&&o.type==="color"&&(c=$e.parse(r)),{kind:"constant",evaluate:function(){return c}}}(e===void 0?t.specification.default:e,t.specification)};Qn.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},Qn.prototype.possiblyEvaluate=function(t,e,r){return this.property.possiblyEvaluate(this,t,e,r)};var zi=function(t){this.property=t,this.value=new Qn(t,void 0)};zi.prototype.transitioned=function(t,e){return new yn(this.property,this.value,e,bt({},t.transition,this.transition),t.now)},zi.prototype.untransitioned=function(){return new yn(this.property,this.value,null,{},0)};var $n=function(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)};$n.prototype.getValue=function(t){return ze(this._values[t].value.value)},$n.prototype.setValue=function(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new zi(this._values[t].property)),this._values[t].value=new Qn(this._values[t].property,e===null?void 0:ze(e))},$n.prototype.getTransition=function(t){return ze(this._values[t].transition)},$n.prototype.setTransition=function(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new zi(this._values[t].property)),this._values[t].transition=ze(e)||void 0},$n.prototype.serialize=function(){for(var t={},e=0,r=Object.keys(this._values);e<r.length;e+=1){var o=r[e],u=this.getValue(o);u!==void 0&&(t[o]=u);var c=this.getTransition(o);c!==void 0&&(t[o+"-transition"]=c)}return t},$n.prototype.transitioned=function(t,e){for(var r=new za(this._properties),o=0,u=Object.keys(this._values);o<u.length;o+=1){var c=u[o];r._values[c]=this._values[c].transitioned(t,e._values[c])}return r},$n.prototype.untransitioned=function(){for(var t=new za(this._properties),e=0,r=Object.keys(this._values);e<r.length;e+=1){var o=r[e];t._values[o]=this._values[o].untransitioned()}return t};var yn=function(t,e,r,o,u){this.property=t,this.value=e,this.begin=u+o.delay||0,this.end=this.begin+o.duration||0,t.specification.transition&&(o.delay||o.duration)&&(this.prior=r)};yn.prototype.possiblyEvaluate=function(t,e,r){var o=t.now||0,u=this.value.possiblyEvaluate(t,e,r),c=this.prior;if(c){if(o>this.end)return this.prior=null,u;if(this.value.isDataDriven())return this.prior=null,u;if(o<this.begin)return c.possiblyEvaluate(t,e,r);var h=(o-this.begin)/(this.end-this.begin);return this.property.interpolate(c.possiblyEvaluate(t,e,r),u,function(m){if(m<=0)return 0;if(m>=1)return 1;var v=m*m,_=v*m;return 4*(m<.5?_:3*(m-v)+_-.75)}(h))}return u};var za=function(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)};za.prototype.possiblyEvaluate=function(t,e,r){for(var o=new ya(this._properties),u=0,c=Object.keys(this._values);u<c.length;u+=1){var h=c[u];o._values[h]=this._values[h].possiblyEvaluate(t,e,r)}return o},za.prototype.hasTransition=function(){for(var t=0,e=Object.keys(this._values);t<e.length;t+=1)if(this._values[e[t]].prior)return!0;return!1};var Po=function(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)};Po.prototype.getValue=function(t){return ze(this._values[t].value)},Po.prototype.setValue=function(t,e){this._values[t]=new Qn(this._values[t].property,e===null?void 0:ze(e))},Po.prototype.serialize=function(){for(var t={},e=0,r=Object.keys(this._values);e<r.length;e+=1){var o=r[e],u=this.getValue(o);u!==void 0&&(t[o]=u)}return t},Po.prototype.possiblyEvaluate=function(t,e,r){for(var o=new ya(this._properties),u=0,c=Object.keys(this._values);u<c.length;u+=1){var h=c[u];o._values[h]=this._values[h].possiblyEvaluate(t,e,r)}return o};var Ti=function(t,e,r){this.property=t,this.value=e,this.parameters=r};Ti.prototype.isConstant=function(){return this.value.kind==="constant"},Ti.prototype.constantOr=function(t){return this.value.kind==="constant"?this.value.value:t},Ti.prototype.evaluate=function(t,e,r,o){return this.property.evaluate(this.value,this.parameters,t,e,r,o)};var ya=function(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)};ya.prototype.get=function(t){return this._values[t]};var Kt=function(t){this.specification=t};Kt.prototype.possiblyEvaluate=function(t,e){return t.expression.evaluate(e)},Kt.prototype.interpolate=function(t,e,r){var o=Is[this.specification.type];return o?o(t,e,r):t};var De=function(t,e){this.specification=t,this.overrides=e};De.prototype.possiblyEvaluate=function(t,e,r,o){return new Ti(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(e,null,{},r,o)}:t.expression,e)},De.prototype.interpolate=function(t,e,r){if(t.value.kind!=="constant"||e.value.kind!=="constant")return t;if(t.value.value===void 0||e.value.value===void 0)return new Ti(this,{kind:"constant",value:void 0},t.parameters);var o=Is[this.specification.type];return o?new Ti(this,{kind:"constant",value:o(t.value.value,e.value.value,r)},t.parameters):t},De.prototype.evaluate=function(t,e,r,o,u,c){return t.kind==="constant"?t.value:t.evaluate(e,r,o,u,c)};var Zn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.possiblyEvaluate=function(r,o,u,c){if(r.value===void 0)return new Ti(this,{kind:"constant",value:void 0},o);if(r.expression.kind==="constant"){var h=r.expression.evaluate(o,null,{},u,c),m=r.property.specification.type==="resolvedImage"&&typeof h!="string"?h.name:h,v=this._calculate(m,m,m,o);return new Ti(this,{kind:"constant",value:v},o)}if(r.expression.kind==="camera"){var _=this._calculate(r.expression.evaluate({zoom:o.zoom-1}),r.expression.evaluate({zoom:o.zoom}),r.expression.evaluate({zoom:o.zoom+1}),o);return new Ti(this,{kind:"constant",value:_},o)}return new Ti(this,r.expression,o)},e.prototype.evaluate=function(r,o,u,c,h,m){if(r.kind==="source"){var v=r.evaluate(o,u,c,h,m);return this._calculate(v,v,v,o)}return r.kind==="composite"?this._calculate(r.evaluate({zoom:Math.floor(o.zoom)-1},u,c),r.evaluate({zoom:Math.floor(o.zoom)},u,c),r.evaluate({zoom:Math.floor(o.zoom)+1},u,c),o):r.value},e.prototype._calculate=function(r,o,u,c){return c.zoom>c.zoomHistory.lastIntegerZoom?{from:r,to:o}:{from:u,to:o}},e.prototype.interpolate=function(r){return r},e}(De),ta=function(t){this.specification=t};ta.prototype.possiblyEvaluate=function(t,e,r,o){if(t.value!==void 0){if(t.expression.kind==="constant"){var u=t.expression.evaluate(e,null,{},r,o);return this._calculate(u,u,u,e)}return this._calculate(t.expression.evaluate(new rr(Math.floor(e.zoom-1),e)),t.expression.evaluate(new rr(Math.floor(e.zoom),e)),t.expression.evaluate(new rr(Math.floor(e.zoom+1),e)),e)}},ta.prototype._calculate=function(t,e,r,o){return o.zoom>o.zoomHistory.lastIntegerZoom?{from:t,to:e}:{from:r,to:e}},ta.prototype.interpolate=function(t){return t};var Ja=function(t){this.specification=t};Ja.prototype.possiblyEvaluate=function(t,e,r,o){return!!t.expression.evaluate(e,null,{},r,o)},Ja.prototype.interpolate=function(){return!1};var ea=function(t){for(var e in this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],t){var r=t[e];r.specification.overridable&&this.overridableProperties.push(e);var o=this.defaultPropertyValues[e]=new Qn(r,void 0),u=this.defaultTransitionablePropertyValues[e]=new zi(r);this.defaultTransitioningPropertyValues[e]=u.untransitioned(),this.defaultPossiblyEvaluatedValues[e]=o.possiblyEvaluate({})}};re("DataDrivenProperty",De),re("DataConstantProperty",Kt),re("CrossFadedDataDrivenProperty",Zn),re("CrossFadedProperty",ta),re("ColorRampProperty",Ja);var Gi=function(t){function e(r,o){if(t.call(this),this.id=r.id,this.type=r.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},r.type!=="custom"&&(this.metadata=(r=r).metadata,this.minzoom=r.minzoom,this.maxzoom=r.maxzoom,r.type!=="background"&&(this.source=r.source,this.sourceLayer=r["source-layer"],this.filter=r.filter),o.layout&&(this._unevaluatedLayout=new Po(o.layout)),o.paint)){for(var u in this._transitionablePaint=new $n(o.paint),r.paint)this.setPaintProperty(u,r.paint[u],{validate:!1});for(var c in r.layout)this.setLayoutProperty(c,r.layout[c],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ya(o.paint)}}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},e.prototype.getLayoutProperty=function(r){return r==="visibility"?this.visibility:this._unevaluatedLayout.getValue(r)},e.prototype.setLayoutProperty=function(r,o,u){u===void 0&&(u={}),o!=null&&this._validate(hs,"layers."+this.id+".layout."+r,r,o,u)||(r!=="visibility"?this._unevaluatedLayout.setValue(r,o):this.visibility=o)},e.prototype.getPaintProperty=function(r){return he(r,"-transition")?this._transitionablePaint.getTransition(r.slice(0,-"-transition".length)):this._transitionablePaint.getValue(r)},e.prototype.setPaintProperty=function(r,o,u){if(u===void 0&&(u={}),o!=null&&this._validate(Xo,"layers."+this.id+".paint."+r,r,o,u))return!1;if(he(r,"-transition"))return this._transitionablePaint.setTransition(r.slice(0,-"-transition".length),o||void 0),!1;var c=this._transitionablePaint._values[r],h=c.property.specification["property-type"]==="cross-faded-data-driven",m=c.value.isDataDriven(),v=c.value;this._transitionablePaint.setValue(r,o),this._handleSpecialPaintPropertyUpdate(r);var _=this._transitionablePaint._values[r].value;return _.isDataDriven()||m||h||this._handleOverridablePaintPropertyUpdate(r,v,_)},e.prototype._handleSpecialPaintPropertyUpdate=function(r){},e.prototype._handleOverridablePaintPropertyUpdate=function(r,o,u){return!1},e.prototype.isHidden=function(r){return!!(this.minzoom&&r<this.minzoom)||!!(this.maxzoom&&r>=this.maxzoom)||this.visibility==="none"},e.prototype.updateTransitions=function(r){this._transitioningPaint=this._transitionablePaint.transitioned(r,this._transitioningPaint)},e.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},e.prototype.recalculate=function(r,o){r.getCrossfadeParameters&&(this._crossfadeParameters=r.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(r,void 0,o)),this.paint=this._transitioningPaint.possiblyEvaluate(r,void 0,o)},e.prototype.serialize=function(){var r={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(r.layout=r.layout||{},r.layout.visibility=this.visibility),_r(r,function(o,u){return!(o===void 0||u==="layout"&&!Object.keys(o).length||u==="paint"&&!Object.keys(o).length)})},e.prototype._validate=function(r,o,u,c,h){return h===void 0&&(h={}),(!h||h.validate!==!1)&&dn(this,r.call(Co,{key:o,layerType:this.type,objectKey:u,value:c,styleSpec:M,style:{glyphs:!0,sprite:!0}}))},e.prototype.is3D=function(){return!1},e.prototype.isTileClipped=function(){return!1},e.prototype.hasOffscreenPass=function(){return!1},e.prototype.resize=function(){},e.prototype.isStateDependent=function(){for(var r in this.paint._values){var o=this.paint.get(r);if(o instanceof Ti&&To(o.property.specification)&&(o.value.kind==="source"||o.value.kind==="composite")&&o.value.isStateDependent)return!0}return!1},e}(W),Tu={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},va=function(t,e){this._structArray=t,this._pos1=e*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},Xr=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function Nr(t,e){e===void 0&&(e=1);var r=0,o=0;return{members:t.map(function(u){var c=Tu[u.type].BYTES_PER_ELEMENT,h=r=ja(r,Math.max(e,c)),m=u.components||1;return o=Math.max(o,c),r+=c*m,{name:u.name,type:u.type,components:m,offset:h}}),size:ja(r,Math.max(o,e)),alignment:e}}function ja(t,e){return Math.ceil(t/e)*e}Xr.serialize=function(t,e){return t._trim(),e&&(t.isTransferred=!0,e.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}},Xr.deserialize=function(t){var e=Object.create(this.prototype);return e.arrayBuffer=t.arrayBuffer,e.length=t.length,e.capacity=t.arrayBuffer.byteLength/e.bytesPerElement,e._refreshViews(),e},Xr.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Xr.prototype.clear=function(){this.length=0},Xr.prototype.resize=function(t){this.reserve(t),this.length=t},Xr.prototype.reserve=function(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var e=this.uint8;this._refreshViews(),e&&this.uint8.set(e)}},Xr.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var Jo=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(r,o){var u=this.length;return this.resize(u+1),this.emplace(u,r,o)},e.prototype.emplace=function(r,o,u){var c=2*r;return this.int16[c+0]=o,this.int16[c+1]=u,r},e}(Xr);Jo.prototype.bytesPerElement=4,re("StructArrayLayout2i4",Jo);var fo=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(r,o,u,c){var h=this.length;return this.resize(h+1),this.emplace(h,r,o,u,c)},e.prototype.emplace=function(r,o,u,c,h){var m=4*r;return this.int16[m+0]=o,this.int16[m+1]=u,this.int16[m+2]=c,this.int16[m+3]=h,r},e}(Xr);fo.prototype.bytesPerElement=8,re("StructArrayLayout4i8",fo);var Gn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(r,o,u,c,h,m){var v=this.length;return this.resize(v+1),this.emplace(v,r,o,u,c,h,m)},e.prototype.emplace=function(r,o,u,c,h,m,v){var _=6*r;return this.int16[_+0]=o,this.int16[_+1]=u,this.int16[_+2]=c,this.int16[_+3]=h,this.int16[_+4]=m,this.int16[_+5]=v,r},e}(Xr);Gn.prototype.bytesPerElement=12,re("StructArrayLayout2i4i12",Gn);var Qa=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(r,o,u,c,h,m){var v=this.length;return this.resize(v+1),this.emplace(v,r,o,u,c,h,m)},e.prototype.emplace=function(r,o,u,c,h,m,v){var _=4*r,x=8*r;return this.int16[_+0]=o,this.int16[_+1]=u,this.uint8[x+4]=c,this.uint8[x+5]=h,this.uint8[x+6]=m,this.uint8[x+7]=v,r},e}(Xr);Qa.prototype.bytesPerElement=8,re("StructArrayLayout2i4ub8",Qa);var Hi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(r,o){var u=this.length;return this.resize(u+1),this.emplace(u,r,o)},e.prototype.emplace=function(r,o,u){var c=2*r;return this.float32[c+0]=o,this.float32[c+1]=u,r},e}(Xr);Hi.prototype.bytesPerElement=8,re("StructArrayLayout2f8",Hi);var $r=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(r,o,u,c,h,m,v,_,x,w){var E=this.length;return this.resize(E+1),this.emplace(E,r,o,u,c,h,m,v,_,x,w)},e.prototype.emplace=function(r,o,u,c,h,m,v,_,x,w,E){var z=10*r;return this.uint16[z+0]=o,this.uint16[z+1]=u,this.uint16[z+2]=c,this.uint16[z+3]=h,this.uint16[z+4]=m,this.uint16[z+5]=v,this.uint16[z+6]=_,this.uint16[z+7]=x,this.uint16[z+8]=w,this.uint16[z+9]=E,r},e}(Xr);$r.prototype.bytesPerElement=20,re("StructArrayLayout10ui20",$r);var Ui=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(r,o,u,c,h,m,v,_,x,w,E,z){var O=this.length;return this.resize(O+1),this.emplace(O,r,o,u,c,h,m,v,_,x,w,E,z)},e.prototype.emplace=function(r,o,u,c,h,m,v,_,x,w,E,z,O){var F=12*r;return this.int16[F+0]=o,this.int16[F+1]=u,this.int16[F+2]=c,this.int16[F+3]=h,this.uint16[F+4]=m,this.uint16[F+5]=v,this.uint16[F+6]=_,this.uint16[F+7]=x,this.int16[F+8]=w,this.int16[F+9]=E,this.int16[F+10]=z,this.int16[F+11]=O,r},e}(Xr);Ui.prototype.bytesPerElement=24,re("StructArrayLayout4i4ui4i24",Ui);var On=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(r,o,u){var c=this.length;return this.resize(c+1),this.emplace(c,r,o,u)},e.prototype.emplace=function(r,o,u,c){var h=3*r;return this.float32[h+0]=o,this.float32[h+1]=u,this.float32[h+2]=c,r},e}(Xr);On.prototype.bytesPerElement=12,re("StructArrayLayout3f12",On);var qa=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(r){var o=this.length;return this.resize(o+1),this.emplace(o,r)},e.prototype.emplace=function(r,o){return this.uint32[1*r+0]=o,r},e}(Xr);qa.prototype.bytesPerElement=4,re("StructArrayLayout1ul4",qa);var $a=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(r,o,u,c,h,m,v,_,x){var w=this.length;return this.resize(w+1),this.emplace(w,r,o,u,c,h,m,v,_,x)},e.prototype.emplace=function(r,o,u,c,h,m,v,_,x,w){var E=10*r,z=5*r;return this.int16[E+0]=o,this.int16[E+1]=u,this.int16[E+2]=c,this.int16[E+3]=h,this.int16[E+4]=m,this.int16[E+5]=v,this.uint32[z+3]=_,this.uint16[E+8]=x,this.uint16[E+9]=w,r},e}(Xr);$a.prototype.bytesPerElement=20,re("StructArrayLayout6i1ul2ui20",$a);var ko=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(r,o,u,c,h,m){var v=this.length;return this.resize(v+1),this.emplace(v,r,o,u,c,h,m)},e.prototype.emplace=function(r,o,u,c,h,m,v){var _=6*r;return this.int16[_+0]=o,this.int16[_+1]=u,this.int16[_+2]=c,this.int16[_+3]=h,this.int16[_+4]=m,this.int16[_+5]=v,r},e}(Xr);ko.prototype.bytesPerElement=12,re("StructArrayLayout2i2i2i12",ko);var V=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(r,o,u,c,h){var m=this.length;return this.resize(m+1),this.emplace(m,r,o,u,c,h)},e.prototype.emplace=function(r,o,u,c,h,m){var v=4*r,_=8*r;return this.float32[v+0]=o,this.float32[v+1]=u,this.float32[v+2]=c,this.int16[_+6]=h,this.int16[_+7]=m,r},e}(Xr);V.prototype.bytesPerElement=16,re("StructArrayLayout2f1f2i16",V);var Q=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(r,o,u,c){var h=this.length;return this.resize(h+1),this.emplace(h,r,o,u,c)},e.prototype.emplace=function(r,o,u,c,h){var m=12*r,v=3*r;return this.uint8[m+0]=o,this.uint8[m+1]=u,this.float32[v+1]=c,this.float32[v+2]=h,r},e}(Xr);Q.prototype.bytesPerElement=12,re("StructArrayLayout2ub2f12",Q);var nt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(r,o,u){var c=this.length;return this.resize(c+1),this.emplace(c,r,o,u)},e.prototype.emplace=function(r,o,u,c){var h=3*r;return this.uint16[h+0]=o,this.uint16[h+1]=u,this.uint16[h+2]=c,r},e}(Xr);nt.prototype.bytesPerElement=6,re("StructArrayLayout3ui6",nt);var pt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(r,o,u,c,h,m,v,_,x,w,E,z,O,F,J,H,at){var st=this.length;return this.resize(st+1),this.emplace(st,r,o,u,c,h,m,v,_,x,w,E,z,O,F,J,H,at)},e.prototype.emplace=function(r,o,u,c,h,m,v,_,x,w,E,z,O,F,J,H,at,st){var dt=24*r,mt=12*r,zt=48*r;return this.int16[dt+0]=o,this.int16[dt+1]=u,this.uint16[dt+2]=c,this.uint16[dt+3]=h,this.uint32[mt+2]=m,this.uint32[mt+3]=v,this.uint32[mt+4]=_,this.uint16[dt+10]=x,this.uint16[dt+11]=w,this.uint16[dt+12]=E,this.float32[mt+7]=z,this.float32[mt+8]=O,this.uint8[zt+36]=F,this.uint8[zt+37]=J,this.uint8[zt+38]=H,this.uint32[mt+10]=at,this.int16[dt+22]=st,r},e}(Xr);pt.prototype.bytesPerElement=48,re("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",pt);var xt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(r,o,u,c,h,m,v,_,x,w,E,z,O,F,J,H,at,st,dt,mt,zt,Ot,Zt,ve,Wt,xe,Qt,Je){var Le=this.length;return this.resize(Le+1),this.emplace(Le,r,o,u,c,h,m,v,_,x,w,E,z,O,F,J,H,at,st,dt,mt,zt,Ot,Zt,ve,Wt,xe,Qt,Je)},e.prototype.emplace=function(r,o,u,c,h,m,v,_,x,w,E,z,O,F,J,H,at,st,dt,mt,zt,Ot,Zt,ve,Wt,xe,Qt,Je,Le){var fe=34*r,ir=17*r;return this.int16[fe+0]=o,this.int16[fe+1]=u,this.int16[fe+2]=c,this.int16[fe+3]=h,this.int16[fe+4]=m,this.int16[fe+5]=v,this.int16[fe+6]=_,this.int16[fe+7]=x,this.uint16[fe+8]=w,this.uint16[fe+9]=E,this.uint16[fe+10]=z,this.uint16[fe+11]=O,this.uint16[fe+12]=F,this.uint16[fe+13]=J,this.uint16[fe+14]=H,this.uint16[fe+15]=at,this.uint16[fe+16]=st,this.uint16[fe+17]=dt,this.uint16[fe+18]=mt,this.uint16[fe+19]=zt,this.uint16[fe+20]=Ot,this.uint16[fe+21]=Zt,this.uint16[fe+22]=ve,this.uint32[ir+12]=Wt,this.float32[ir+13]=xe,this.float32[ir+14]=Qt,this.float32[ir+15]=Je,this.float32[ir+16]=Le,r},e}(Xr);xt.prototype.bytesPerElement=68,re("StructArrayLayout8i15ui1ul4f68",xt);var Tt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(r){var o=this.length;return this.resize(o+1),this.emplace(o,r)},e.prototype.emplace=function(r,o){return this.float32[1*r+0]=o,r},e}(Xr);Tt.prototype.bytesPerElement=4,re("StructArrayLayout1f4",Tt);var Rt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(r,o,u){var c=this.length;return this.resize(c+1),this.emplace(c,r,o,u)},e.prototype.emplace=function(r,o,u,c){var h=3*r;return this.int16[h+0]=o,this.int16[h+1]=u,this.int16[h+2]=c,r},e}(Xr);Rt.prototype.bytesPerElement=6,re("StructArrayLayout3i6",Rt);var te=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(r,o,u){var c=this.length;return this.resize(c+1),this.emplace(c,r,o,u)},e.prototype.emplace=function(r,o,u,c){var h=4*r;return this.uint32[2*r+0]=o,this.uint16[h+2]=u,this.uint16[h+3]=c,r},e}(Xr);te.prototype.bytesPerElement=8,re("StructArrayLayout1ul2ui8",te);var Ht=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(r,o){var u=this.length;return this.resize(u+1),this.emplace(u,r,o)},e.prototype.emplace=function(r,o,u){var c=2*r;return this.uint16[c+0]=o,this.uint16[c+1]=u,r},e}(Xr);Ht.prototype.bytesPerElement=4,re("StructArrayLayout2ui4",Ht);var ne=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(r){var o=this.length;return this.resize(o+1),this.emplace(o,r)},e.prototype.emplace=function(r,o){return this.uint16[1*r+0]=o,r},e}(Xr);ne.prototype.bytesPerElement=2,re("StructArrayLayout1ui2",ne);var i=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(r,o,u,c){var h=this.length;return this.resize(h+1),this.emplace(h,r,o,u,c)},e.prototype.emplace=function(r,o,u,c,h){var m=4*r;return this.float32[m+0]=o,this.float32[m+1]=u,this.float32[m+2]=c,this.float32[m+3]=h,r},e}(Xr);i.prototype.bytesPerElement=16,re("StructArrayLayout4f16",i);var a=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var r={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return r.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},r.x1.get=function(){return this._structArray.int16[this._pos2+2]},r.y1.get=function(){return this._structArray.int16[this._pos2+3]},r.x2.get=function(){return this._structArray.int16[this._pos2+4]},r.y2.get=function(){return this._structArray.int16[this._pos2+5]},r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},r.anchorPoint.get=function(){return new Vt(this.anchorPointX,this.anchorPointY)},Object.defineProperties(e.prototype,r),e}(va);a.prototype.size=20;var n=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.get=function(r){return new a(this,r)},e}($a);re("CollisionBoxArray",n);var s=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var r={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},r.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},r.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},r.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},r.segment.get=function(){return this._structArray.uint16[this._pos2+10]},r.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},r.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},r.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},r.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},r.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},r.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},r.placedOrientation.set=function(o){this._structArray.uint8[this._pos1+37]=o},r.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},r.hidden.set=function(o){this._structArray.uint8[this._pos1+38]=o},r.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},r.crossTileID.set=function(o){this._structArray.uint32[this._pos4+10]=o},r.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(e.prototype,r),e}(va);s.prototype.size=48;var p=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.get=function(r){return new s(this,r)},e}(pt);re("PlacedSymbolArray",p);var f=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var r={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},r.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},r.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},r.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},r.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},r.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},r.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},r.key.get=function(){return this._structArray.uint16[this._pos2+8]},r.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},r.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},r.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},r.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},r.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},r.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},r.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},r.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},r.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},r.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},r.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},r.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},r.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},r.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},r.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},r.crossTileID.set=function(o){this._structArray.uint32[this._pos4+12]=o},r.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},r.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},r.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},r.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(e.prototype,r),e}(va);f.prototype.size=68;var d=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.get=function(r){return new f(this,r)},e}(xt);re("SymbolInstanceArray",d);var y=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getoffsetX=function(r){return this.float32[1*r+0]},e}(Tt);re("GlyphOffsetArray",y);var g=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getx=function(r){return this.int16[3*r+0]},e.prototype.gety=function(r){return this.int16[3*r+1]},e.prototype.gettileUnitDistanceFromAnchor=function(r){return this.int16[3*r+2]},e}(Rt);re("SymbolLineVertexArray",g);var S=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var r={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(e.prototype,r),e}(va);S.prototype.size=8;var I=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.get=function(r){return new S(this,r)},e}(te);re("FeatureIndexArray",I);var P=Nr([{name:"a_pos",components:2,type:"Int16"}],4).members,A=function(t){t===void 0&&(t=[]),this.segments=t};function B(t,e){return 256*(t=Lt(Math.floor(t),0,255))+Lt(Math.floor(e),0,255)}A.prototype.prepareSegment=function(t,e,r,o){var u=this.segments[this.segments.length-1];return t>A.MAX_VERTEX_ARRAY_LENGTH&&Gt("Max vertices per segment is "+A.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+t),(!u||u.vertexLength+t>A.MAX_VERTEX_ARRAY_LENGTH||u.sortKey!==o)&&(u={vertexOffset:e.length,primitiveOffset:r.length,vertexLength:0,primitiveLength:0},o!==void 0&&(u.sortKey=o),this.segments.push(u)),u},A.prototype.get=function(){return this.segments},A.prototype.destroy=function(){for(var t=0,e=this.segments;t<e.length;t+=1){var r=e[t];for(var o in r.vaos)r.vaos[o].destroy()}},A.simpleSegment=function(t,e,r,o){return new A([{vertexOffset:t,primitiveOffset:e,vertexLength:r,primitiveLength:o,vaos:{},sortKey:0}])},A.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,re("SegmentVector",A);var R=Nr([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),N=Ut(function(t){t.exports=function(e,r){var o,u,c,h,m,v,_,x;for(u=e.length-(o=3&e.length),c=r,m=3432918353,v=461845907,x=0;x<u;)_=255&e.charCodeAt(x)|(255&e.charCodeAt(++x))<<8|(255&e.charCodeAt(++x))<<16|(255&e.charCodeAt(++x))<<24,++x,c=27492+(65535&(h=5*(65535&(c=(c^=_=(65535&(_=(_=(65535&_)*m+(((_>>>16)*m&65535)<<16)&4294967295)<<15|_>>>17))*v+(((_>>>16)*v&65535)<<16)&4294967295)<<13|c>>>19))+((5*(c>>>16)&65535)<<16)&4294967295))+((58964+(h>>>16)&65535)<<16);switch(_=0,o){case 3:_^=(255&e.charCodeAt(x+2))<<16;case 2:_^=(255&e.charCodeAt(x+1))<<8;case 1:c^=_=(65535&(_=(_=(65535&(_^=255&e.charCodeAt(x)))*m+(((_>>>16)*m&65535)<<16)&4294967295)<<15|_>>>17))*v+(((_>>>16)*v&65535)<<16)&4294967295}return c^=e.length,c=2246822507*(65535&(c^=c>>>16))+((2246822507*(c>>>16)&65535)<<16)&4294967295,c=3266489909*(65535&(c^=c>>>13))+((3266489909*(c>>>16)&65535)<<16)&4294967295,(c^=c>>>16)>>>0}}),L=Ut(function(t){t.exports=function(e,r){for(var o,u=e.length,c=r^u,h=0;u>=4;)o=1540483477*(65535&(o=255&e.charCodeAt(h)|(255&e.charCodeAt(++h))<<8|(255&e.charCodeAt(++h))<<16|(255&e.charCodeAt(++h))<<24))+((1540483477*(o>>>16)&65535)<<16),c=1540483477*(65535&c)+((1540483477*(c>>>16)&65535)<<16)^(o=1540483477*(65535&(o^=o>>>24))+((1540483477*(o>>>16)&65535)<<16)),u-=4,++h;switch(u){case 3:c^=(255&e.charCodeAt(h+2))<<16;case 2:c^=(255&e.charCodeAt(h+1))<<8;case 1:c=1540483477*(65535&(c^=255&e.charCodeAt(h)))+((1540483477*(c>>>16)&65535)<<16)}return c=1540483477*(65535&(c^=c>>>13))+((1540483477*(c>>>16)&65535)<<16),(c^=c>>>15)>>>0}}),q=N,X=L;q.murmur3=N,q.murmur2=X;var rt=function(){this.ids=[],this.positions=[],this.indexed=!1};rt.prototype.add=function(t,e,r,o){this.ids.push(ot(t)),this.positions.push(e,r,o)},rt.prototype.getPositions=function(t){for(var e=ot(t),r=0,o=this.ids.length-1;r<o;){var u=r+o>>1;this.ids[u]>=e?o=u:r=u+1}for(var c=[];this.ids[r]===e;)c.push({index:this.positions[3*r],start:this.positions[3*r+1],end:this.positions[3*r+2]}),r++;return c},rt.serialize=function(t,e){var r=new Float64Array(t.ids),o=new Uint32Array(t.positions);return function u(c,h,m,v){for(;m<v;){for(var _=c[m+v>>1],x=m-1,w=v+1;;){do x++;while(c[x]<_);do w--;while(c[w]>_);if(x>=w)break;$(c,x,w),$(h,3*x,3*w),$(h,3*x+1,3*w+1),$(h,3*x+2,3*w+2)}w-m<v-w?(u(c,h,m,w),m=w+1):(u(c,h,w+1,v),v=w)}}(r,o,0,r.length-1),e&&e.push(r.buffer,o.buffer),{ids:r,positions:o}},rt.deserialize=function(t){var e=new rt;return e.ids=t.ids,e.positions=t.positions,e.indexed=!0,e};var ct=Math.pow(2,53)-1;function ot(t){var e=+t;return!isNaN(e)&&e<=ct?e:q(String(t))}function $(t,e,r){var o=t[e];t[e]=t[r],t[r]=o}re("FeaturePositionMap",rt);var yt=function(t,e){this.gl=t.gl,this.location=e},kt=function(t){function e(r,o){t.call(this,r,o),this.current=0}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(r){this.current!==r&&(this.current=r,this.gl.uniform1i(this.location,r))},e}(yt),Mt=function(t){function e(r,o){t.call(this,r,o),this.current=0}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(r){this.current!==r&&(this.current=r,this.gl.uniform1f(this.location,r))},e}(yt),Nt=function(t){function e(r,o){t.call(this,r,o),this.current=[0,0]}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]||(this.current=r,this.gl.uniform2f(this.location,r[0],r[1]))},e}(yt),ye=function(t){function e(r,o){t.call(this,r,o),this.current=[0,0,0]}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]||(this.current=r,this.gl.uniform3f(this.location,r[0],r[1],r[2]))},e}(yt),le=function(t){function e(r,o){t.call(this,r,o),this.current=[0,0,0,0]}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]&&r[3]===this.current[3]||(this.current=r,this.gl.uniform4f(this.location,r[0],r[1],r[2],r[3]))},e}(yt),pe=function(t){function e(r,o){t.call(this,r,o),this.current=$e.transparent}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(r){r.r===this.current.r&&r.g===this.current.g&&r.b===this.current.b&&r.a===this.current.a||(this.current=r,this.gl.uniform4f(this.location,r.r,r.g,r.b,r.a))},e}(yt),Ge=new Float32Array(16),jt=function(t){function e(r,o){t.call(this,r,o),this.current=Ge}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(r){if(r[12]!==this.current[12]||r[0]!==this.current[0])return this.current=r,void this.gl.uniformMatrix4fv(this.location,!1,r);for(var o=1;o<16;o++)if(r[o]!==this.current[o]){this.current=r,this.gl.uniformMatrix4fv(this.location,!1,r);break}},e}(yt);function Re(t){return[B(255*t.r,255*t.g),B(255*t.b,255*t.a)]}var Pe=function(t,e,r){this.value=t,this.uniformNames=e.map(function(o){return"u_"+o}),this.type=r};Pe.prototype.setUniform=function(t,e,r){t.set(r.constantOr(this.value))},Pe.prototype.getBinding=function(t,e,r){return this.type==="color"?new pe(t,e):new Mt(t,e)};var _e=function(t,e){this.uniformNames=e.map(function(r){return"u_"+r}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};_e.prototype.setConstantPatternPositions=function(t,e){this.pixelRatioFrom=e.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=e.tlbr,this.patternTo=t.tlbr},_e.prototype.setUniform=function(t,e,r,o){var u=o==="u_pattern_to"?this.patternTo:o==="u_pattern_from"?this.patternFrom:o==="u_pixel_ratio_to"?this.pixelRatioTo:o==="u_pixel_ratio_from"?this.pixelRatioFrom:null;u&&t.set(u)},_e.prototype.getBinding=function(t,e,r){return r.substr(0,9)==="u_pattern"?new le(t,e):new Mt(t,e)};var Ie=function(t,e,r,o){this.expression=t,this.type=r,this.maxValue=0,this.paintVertexAttributes=e.map(function(u){return{name:"a_"+u,type:"Float32",components:r==="color"?2:1,offset:0}}),this.paintVertexArray=new o};Ie.prototype.populatePaintArray=function(t,e,r,o,u){var c=this.paintVertexArray.length,h=this.expression.evaluate(new rr(0),e,{},o,[],u);this.paintVertexArray.resize(t),this._setPaintValue(c,t,h)},Ie.prototype.updatePaintArray=function(t,e,r,o){var u=this.expression.evaluate({zoom:0},r,o);this._setPaintValue(t,e,u)},Ie.prototype._setPaintValue=function(t,e,r){if(this.type==="color")for(var o=Re(r),u=t;u<e;u++)this.paintVertexArray.emplace(u,o[0],o[1]);else{for(var c=t;c<e;c++)this.paintVertexArray.emplace(c,r);this.maxValue=Math.max(this.maxValue,Math.abs(r))}},Ie.prototype.upload=function(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Ie.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var ge=function(t,e,r,o,u,c){this.expression=t,this.uniformNames=e.map(function(h){return"u_"+h+"_t"}),this.type=r,this.useIntegerZoom=o,this.zoom=u,this.maxValue=0,this.paintVertexAttributes=e.map(function(h){return{name:"a_"+h,type:"Float32",components:r==="color"?4:2,offset:0}}),this.paintVertexArray=new c};ge.prototype.populatePaintArray=function(t,e,r,o,u){var c=this.expression.evaluate(new rr(this.zoom),e,{},o,[],u),h=this.expression.evaluate(new rr(this.zoom+1),e,{},o,[],u),m=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(m,t,c,h)},ge.prototype.updatePaintArray=function(t,e,r,o){var u=this.expression.evaluate({zoom:this.zoom},r,o),c=this.expression.evaluate({zoom:this.zoom+1},r,o);this._setPaintValue(t,e,u,c)},ge.prototype._setPaintValue=function(t,e,r,o){if(this.type==="color")for(var u=Re(r),c=Re(o),h=t;h<e;h++)this.paintVertexArray.emplace(h,u[0],u[1],c[0],c[1]);else{for(var m=t;m<e;m++)this.paintVertexArray.emplace(m,r,o);this.maxValue=Math.max(this.maxValue,Math.abs(r),Math.abs(o))}},ge.prototype.upload=function(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},ge.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},ge.prototype.setUniform=function(t,e){var r=this.useIntegerZoom?Math.floor(e.zoom):e.zoom,o=Lt(this.expression.interpolationFactor(r,this.zoom,this.zoom+1),0,1);t.set(o)},ge.prototype.getBinding=function(t,e,r){return new Mt(t,e)};var se=function(t,e,r,o,u,c){this.expression=t,this.type=e,this.useIntegerZoom=r,this.zoom=o,this.layerId=c,this.zoomInPaintVertexArray=new u,this.zoomOutPaintVertexArray=new u};se.prototype.populatePaintArray=function(t,e,r){var o=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(o,t,e.patterns&&e.patterns[this.layerId],r)},se.prototype.updatePaintArray=function(t,e,r,o,u){this._setPaintValues(t,e,r.patterns&&r.patterns[this.layerId],u)},se.prototype._setPaintValues=function(t,e,r,o){if(o&&r){var u=o[r.min],c=o[r.mid],h=o[r.max];if(u&&c&&h)for(var m=t;m<e;m++)this.zoomInPaintVertexArray.emplace(m,c.tl[0],c.tl[1],c.br[0],c.br[1],u.tl[0],u.tl[1],u.br[0],u.br[1],c.pixelRatio,u.pixelRatio),this.zoomOutPaintVertexArray.emplace(m,c.tl[0],c.tl[1],c.br[0],c.br[1],h.tl[0],h.tl[1],h.br[0],h.br[1],c.pixelRatio,h.pixelRatio)}},se.prototype.upload=function(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,R.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,R.members,this.expression.isStateDependent))},se.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var oe=function(t,e,r){this.binders={},this._buffers=[];var o=[];for(var u in t.paint._values)if(r(u)){var c=t.paint.get(u);if(c instanceof Ti&&To(c.property.specification)){var h=Be(u,t.type),m=c.value,v=c.property.specification.type,_=c.property.useIntegerZoom,x=c.property.specification["property-type"],w=x==="cross-faded"||x==="cross-faded-data-driven";if(m.kind==="constant")this.binders[u]=w?new _e(m.value,h):new Pe(m.value,h,v),o.push("/u_"+u);else if(m.kind==="source"||w){var E=fi(u,v,"source");this.binders[u]=w?new se(m,v,_,e,E,t.id):new Ie(m,h,v,E),o.push("/a_"+u)}else{var z=fi(u,v,"composite");this.binders[u]=new ge(m,h,v,_,e,z),o.push("/z_"+u)}}}this.cacheKey=o.sort().join("")};oe.prototype.getMaxValue=function(t){var e=this.binders[t];return e instanceof Ie||e instanceof ge?e.maxValue:0},oe.prototype.populatePaintArrays=function(t,e,r,o,u){for(var c in this.binders){var h=this.binders[c];(h instanceof Ie||h instanceof ge||h instanceof se)&&h.populatePaintArray(t,e,r,o,u)}},oe.prototype.setConstantPatternPositions=function(t,e){for(var r in this.binders){var o=this.binders[r];o instanceof _e&&o.setConstantPatternPositions(t,e)}},oe.prototype.updatePaintArrays=function(t,e,r,o,u){var c=!1;for(var h in t)for(var m=0,v=e.getPositions(h);m<v.length;m+=1){var _=v[m],x=r.feature(_.index);for(var w in this.binders){var E=this.binders[w];if((E instanceof Ie||E instanceof ge||E instanceof se)&&E.expression.isStateDependent===!0){var z=o.paint.get(w);E.expression=z.value,E.updatePaintArray(_.start,_.end,x,t[h],u),c=!0}}}return c},oe.prototype.defines=function(){var t=[];for(var e in this.binders){var r=this.binders[e];(r instanceof Pe||r instanceof _e)&&t.push.apply(t,r.uniformNames.map(function(o){return"#define HAS_UNIFORM_"+o}))}return t},oe.prototype.getBinderAttributes=function(){var t=[];for(var e in this.binders){var r=this.binders[e];if(r instanceof Ie||r instanceof ge)for(var o=0;o<r.paintVertexAttributes.length;o++)t.push(r.paintVertexAttributes[o].name);else if(r instanceof se)for(var u=0;u<R.members.length;u++)t.push(R.members[u].name)}return t},oe.prototype.getBinderUniforms=function(){var t=[];for(var e in this.binders){var r=this.binders[e];if(r instanceof Pe||r instanceof _e||r instanceof ge)for(var o=0,u=r.uniformNames;o<u.length;o+=1)t.push(u[o])}return t},oe.prototype.getPaintVertexBuffers=function(){return this._buffers},oe.prototype.getUniforms=function(t,e){var r=[];for(var o in this.binders){var u=this.binders[o];if(u instanceof Pe||u instanceof _e||u instanceof ge)for(var c=0,h=u.uniformNames;c<h.length;c+=1){var m=h[c];if(e[m]){var v=u.getBinding(t,e[m],m);r.push({name:m,property:o,binding:v})}}}return r},oe.prototype.setUniforms=function(t,e,r,o){for(var u=0,c=e;u<c.length;u+=1){var h=c[u],m=h.name,v=h.property;this.binders[v].setUniform(h.binding,o,r.get(v),m)}},oe.prototype.updatePaintBuffers=function(t){for(var e in this._buffers=[],this.binders){var r=this.binders[e];if(t&&r instanceof se){var o=t.fromScale===2?r.zoomInPaintVertexBuffer:r.zoomOutPaintVertexBuffer;o&&this._buffers.push(o)}else(r instanceof Ie||r instanceof ge)&&r.paintVertexBuffer&&this._buffers.push(r.paintVertexBuffer)}},oe.prototype.upload=function(t){for(var e in this.binders){var r=this.binders[e];(r instanceof Ie||r instanceof ge||r instanceof se)&&r.upload(t)}this.updatePaintBuffers()},oe.prototype.destroy=function(){for(var t in this.binders){var e=this.binders[t];(e instanceof Ie||e instanceof ge||e instanceof se)&&e.destroy()}};var He=function(t,e,r){r===void 0&&(r=function(){return!0}),this.programConfigurations={};for(var o=0,u=t;o<u.length;o+=1){var c=u[o];this.programConfigurations[c.id]=new oe(c,e,r)}this.needsUpload=!1,this._featureMap=new rt,this._bufferOffset=0};function Be(t,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[t]||[t.replace(e+"-","").replace(/-/g,"_")]}function fi(t,e,r){var o={color:{source:Hi,composite:i},number:{source:Tt,composite:Hi}},u=function(c){return{"line-pattern":{source:$r,composite:$r},"fill-pattern":{source:$r,composite:$r},"fill-extrusion-pattern":{source:$r,composite:$r}}[c]}(t);return u&&u[r]||o[e][r]}He.prototype.populatePaintArrays=function(t,e,r,o,u,c){for(var h in this.programConfigurations)this.programConfigurations[h].populatePaintArrays(t,e,o,u,c);e.id!==void 0&&this._featureMap.add(e.id,r,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0},He.prototype.updatePaintArrays=function(t,e,r,o){for(var u=0,c=r;u<c.length;u+=1){var h=c[u];this.needsUpload=this.programConfigurations[h.id].updatePaintArrays(t,this._featureMap,e,h,o)||this.needsUpload}},He.prototype.get=function(t){return this.programConfigurations[t]},He.prototype.upload=function(t){if(this.needsUpload){for(var e in this.programConfigurations)this.programConfigurations[e].upload(t);this.needsUpload=!1}},He.prototype.destroy=function(){for(var t in this.programConfigurations)this.programConfigurations[t].destroy()},re("ConstantBinder",Pe),re("CrossFadedConstantBinder",_e),re("SourceExpressionBinder",Ie),re("CrossFadedCompositeBinder",se),re("CompositeExpressionBinder",ge),re("ProgramConfiguration",oe,{omit:["_buffers"]}),re("ProgramConfigurationSet",He);var di=Math.pow(2,14)-1,xi=-di-1;function jr(t){for(var e=8192/t.extent,r=t.loadGeometry(),o=0;o<r.length;o++)for(var u=r[o],c=0;c<u.length;c++){var h=u[c],m=Math.round(h.x*e),v=Math.round(h.y*e);h.x=Lt(m,xi,di),h.y=Lt(v,xi,di),(m<h.x||m>h.x+1||v<h.y||v>h.y+1)&&Gt("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return r}function bi(t,e){return{type:t.type,id:t.id,properties:t.properties,geometry:e?jr(t):[]}}function Qe(t,e,r,o,u){t.emplaceBack(2*e+(o+1)/2,2*r+(u+1)/2)}var Lr=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(e){return e.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Jo,this.indexArray=new nt,this.segments=new A,this.programConfigurations=new He(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(function(e){return e.isStateDependent()}).map(function(e){return e.id})};function Pi(t,e){for(var r=0;r<t.length;r++)if(be(e,t[r]))return!0;for(var o=0;o<e.length;o++)if(be(t,e[o]))return!0;return!!Pa(t,e)}function Ir(t,e,r){return!!be(t,e)||!!vn(e,t,r)}function Kr(t,e){if(t.length===1)return Ae(e,t[0]);for(var r=0;r<e.length;r++)for(var o=e[r],u=0;u<o.length;u++)if(be(t,o[u]))return!0;for(var c=0;c<t.length;c++)if(Ae(e,t[c]))return!0;for(var h=0;h<e.length;h++)if(Pa(t,e[h]))return!0;return!1}function ra(t,e,r){if(t.length>1){if(Pa(t,e))return!0;for(var o=0;o<e.length;o++)if(vn(e[o],t,r))return!0}for(var u=0;u<t.length;u++)if(vn(t[u],e,r))return!0;return!1}function Pa(t,e){if(t.length===0||e.length===0)return!1;for(var r=0;r<t.length-1;r++)for(var o=t[r],u=t[r+1],c=0;c<e.length-1;c++)if(mo(o,u,e[c],e[c+1]))return!0;return!1}function mo(t,e,r,o){return ke(t,r,o)!==ke(e,r,o)&&ke(t,e,r)!==ke(t,e,o)}function vn(t,e,r){var o=r*r;if(e.length===1)return t.distSqr(e[0])<o;for(var u=1;u<e.length;u++)if(ia(t,e[u-1],e[u])<o)return!0;return!1}function ia(t,e,r){var o=e.distSqr(r);if(o===0)return t.distSqr(e);var u=((t.x-e.x)*(r.x-e.x)+(t.y-e.y)*(r.y-e.y))/o;return t.distSqr(u<0?e:u>1?r:r.sub(e)._mult(u)._add(e))}function Ae(t,e){for(var r,o,u,c=!1,h=0;h<t.length;h++)for(var m=0,v=(r=t[h]).length-1;m<r.length;v=m++)(o=r[m]).y>e.y!=(u=r[v]).y>e.y&&e.x<(u.x-o.x)*(e.y-o.y)/(u.y-o.y)+o.x&&(c=!c);return c}function be(t,e){for(var r=!1,o=0,u=t.length-1;o<t.length;u=o++){var c=t[o],h=t[u];c.y>e.y!=h.y>e.y&&e.x<(h.x-c.x)*(e.y-c.y)/(h.y-c.y)+c.x&&(r=!r)}return r}function mi(t,e,r){var o=r[0],u=r[2];if(t.x<o.x&&e.x<o.x||t.x>u.x&&e.x>u.x||t.y<o.y&&e.y<o.y||t.y>u.y&&e.y>u.y)return!1;var c=ke(t,e,r[0]);return c!==ke(t,e,r[1])||c!==ke(t,e,r[2])||c!==ke(t,e,r[3])}function Er(t,e,r){var o=e.paint.get(t).value;return o.kind==="constant"?o.value:r.programConfigurations.get(e.id).getMaxValue(t)}function yr(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function Vi(t,e,r,o,u){if(!e[0]&&!e[1])return t;var c=Vt.convert(e)._mult(u);r==="viewport"&&c._rotate(-o);for(var h=[],m=0;m<t.length;m++)h.push(t[m].sub(c));return h}Lr.prototype.populate=function(t,e,r){var o=this.layers[0],u=[],c=null,h=!1;o.type==="circle"&&(h=!(c=o.layout.get("circle-sort-key")).isConstant());for(var m=0,v=t;m<v.length;m+=1){var _=v[m],x=_.feature,w=_.id,E=_.index,z=_.sourceLayerIndex,O=this.layers[0]._featureFilter.needGeometry,F=bi(x,O);if(this.layers[0]._featureFilter.filter(new rr(this.zoom),F,r)){var J=h?c.evaluate(F,{},r):void 0,H={id:w,properties:x.properties,type:x.type,sourceLayerIndex:z,index:E,geometry:O?F.geometry:jr(x),patterns:{},sortKey:J};u.push(H)}}h&&u.sort(function(ve,Wt){return ve.sortKey-Wt.sortKey});for(var at=0,st=u;at<st.length;at+=1){var dt=st[at],mt=dt.geometry,zt=dt.index,Ot=dt.sourceLayerIndex,Zt=t[zt].feature;this.addFeature(dt,mt,zt,r),e.featureIndex.insert(Zt,mt,zt,Ot,this.index)}},Lr.prototype.update=function(t,e,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,r)},Lr.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Lr.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Lr.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,P),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},Lr.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Lr.prototype.addFeature=function(t,e,r,o){for(var u=0,c=e;u<c.length;u+=1)for(var h=0,m=c[u];h<m.length;h+=1){var v=m[h],_=v.x,x=v.y;if(!(_<0||_>=8192||x<0||x>=8192)){var w=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),E=w.vertexLength;Qe(this.layoutVertexArray,_,x,-1,-1),Qe(this.layoutVertexArray,_,x,1,-1),Qe(this.layoutVertexArray,_,x,1,1),Qe(this.layoutVertexArray,_,x,-1,1),this.indexArray.emplaceBack(E,E+1,E+2),this.indexArray.emplaceBack(E,E+3,E+2),w.vertexLength+=4,w.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,r,{},o)},re("CircleBucket",Lr,{omit:["layers"]});var yi=new ea({"circle-sort-key":new De(M.layout_circle["circle-sort-key"])}),xr={paint:new ea({"circle-radius":new De(M.paint_circle["circle-radius"]),"circle-color":new De(M.paint_circle["circle-color"]),"circle-blur":new De(M.paint_circle["circle-blur"]),"circle-opacity":new De(M.paint_circle["circle-opacity"]),"circle-translate":new Kt(M.paint_circle["circle-translate"]),"circle-translate-anchor":new Kt(M.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Kt(M.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Kt(M.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new De(M.paint_circle["circle-stroke-width"]),"circle-stroke-color":new De(M.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new De(M.paint_circle["circle-stroke-opacity"])}),layout:yi},qr=typeof Float32Array!="undefined"?Float32Array:Array;function cr(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Fn(t,e,r){var o=e[0],u=e[1],c=e[2],h=e[3],m=e[4],v=e[5],_=e[6],x=e[7],w=e[8],E=e[9],z=e[10],O=e[11],F=e[12],J=e[13],H=e[14],at=e[15],st=r[0],dt=r[1],mt=r[2],zt=r[3];return t[0]=st*o+dt*m+mt*w+zt*F,t[1]=st*u+dt*v+mt*E+zt*J,t[2]=st*c+dt*_+mt*z+zt*H,t[3]=st*h+dt*x+mt*O+zt*at,t[4]=(st=r[4])*o+(dt=r[5])*m+(mt=r[6])*w+(zt=r[7])*F,t[5]=st*u+dt*v+mt*E+zt*J,t[6]=st*c+dt*_+mt*z+zt*H,t[7]=st*h+dt*x+mt*O+zt*at,t[8]=(st=r[8])*o+(dt=r[9])*m+(mt=r[10])*w+(zt=r[11])*F,t[9]=st*u+dt*v+mt*E+zt*J,t[10]=st*c+dt*_+mt*z+zt*H,t[11]=st*h+dt*x+mt*O+zt*at,t[12]=(st=r[12])*o+(dt=r[13])*m+(mt=r[14])*w+(zt=r[15])*F,t[13]=st*u+dt*v+mt*E+zt*J,t[14]=st*c+dt*_+mt*z+zt*H,t[15]=st*h+dt*x+mt*O+zt*at,t}Math.hypot||(Math.hypot=function(){for(var t=arguments,e=0,r=arguments.length;r--;)e+=t[r]*t[r];return Math.sqrt(e)});var _a,sn=Fn;function ka(t,e,r){var o=e[0],u=e[1],c=e[2],h=e[3];return t[0]=r[0]*o+r[4]*u+r[8]*c+r[12]*h,t[1]=r[1]*o+r[5]*u+r[9]*c+r[13]*h,t[2]=r[2]*o+r[6]*u+r[10]*c+r[14]*h,t[3]=r[3]*o+r[7]*u+r[11]*c+r[15]*h,t}_a=new qr(3),qr!=Float32Array&&(_a[0]=0,_a[1]=0,_a[2]=0),function(){var t=new qr(4);qr!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0)}();var ga=(function(){var t=new qr(2);qr!=Float32Array&&(t[0]=0,t[1]=0)}(),function(t){function e(r){t.call(this,r,xr)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.createBucket=function(r){return new Lr(r)},e.prototype.queryRadius=function(r){var o=r;return Er("circle-radius",this,o)+Er("circle-stroke-width",this,o)+yr(this.paint.get("circle-translate"))},e.prototype.queryIntersectsFeature=function(r,o,u,c,h,m,v,_){for(var x=Vi(r,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),m.angle,v),w=this.paint.get("circle-radius").evaluate(o,u)+this.paint.get("circle-stroke-width").evaluate(o,u),E=this.paint.get("circle-pitch-alignment")==="map",z=E?x:function(Ot,Zt){return Ot.map(function(ve){return yo(ve,Zt)})}(x,_),O=E?w*v:w,F=0,J=c;F<J.length;F+=1)for(var H=0,at=J[F];H<at.length;H+=1){var st=at[H],dt=E?st:yo(st,_),mt=O,zt=ka([],[st.x,st.y,0,1],_);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?mt*=zt[3]/m.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(mt*=m.cameraToCenterDistance/zt[3]),Ir(z,dt,mt))return!0}return!1},e}(Gi));function yo(t,e){var r=ka([],[t.x,t.y,0,1],e);return new Vt(r[0]/r[3],r[1]/r[3])}var Un=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(Lr);function na(t,e,r,o){var u=e.width,c=e.height;if(o){if(o instanceof Uint8ClampedArray)o=new Uint8Array(o.buffer);else if(o.length!==u*c*r)throw new RangeError("mismatched image size")}else o=new Uint8Array(u*c*r);return t.width=u,t.height=c,t.data=o,t}function Kl(t,e,r){var o=e.width,u=e.height;if(o!==t.width||u!==t.height){var c=na({},{width:o,height:u},r);Eu(t,c,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,o),height:Math.min(t.height,u)},r),t.width=o,t.height=u,t.data=c.data}}function Eu(t,e,r,o,u,c){if(u.width===0||u.height===0)return e;if(u.width>t.width||u.height>t.height||r.x>t.width-u.width||r.y>t.height-u.height)throw new RangeError("out of range source coordinates for image copy");if(u.width>e.width||u.height>e.height||o.x>e.width-u.width||o.y>e.height-u.height)throw new RangeError("out of range destination coordinates for image copy");for(var h=t.data,m=e.data,v=0;v<u.height;v++)for(var _=((r.y+v)*t.width+r.x)*c,x=((o.y+v)*e.width+o.x)*c,w=0;w<u.width*c;w++)m[x+w]=h[_+w];return e}re("HeatmapBucket",Un,{omit:["layers"]});var Ma=function(t,e){na(this,t,1,e)};Ma.prototype.resize=function(t){Kl(this,t,1)},Ma.prototype.clone=function(){return new Ma({width:this.width,height:this.height},new Uint8Array(this.data))},Ma.copy=function(t,e,r,o,u){Eu(t,e,r,o,u,1)};var _n=function(t,e){na(this,t,4,e)};_n.prototype.resize=function(t){Kl(this,t,4)},_n.prototype.replace=function(t,e){e?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t},_n.prototype.clone=function(){return new _n({width:this.width,height:this.height},new Uint8Array(this.data))},_n.copy=function(t,e,r,o,u){Eu(t,e,r,o,u,4)},re("AlphaImage",Ma),re("RGBAImage",_n);var lc={paint:new ea({"heatmap-radius":new De(M.paint_heatmap["heatmap-radius"]),"heatmap-weight":new De(M.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Kt(M.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Ja(M.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Kt(M.paint_heatmap["heatmap-opacity"])})};function ul(t){var e={},r=t.resolution||256,o=t.clips?t.clips.length:1,u=t.image||new _n({width:r,height:o}),c=function(O,F,J){e[t.evaluationKey]=J;var H=t.expression.evaluate(e);u.data[O+F+0]=Math.floor(255*H.r/H.a),u.data[O+F+1]=Math.floor(255*H.g/H.a),u.data[O+F+2]=Math.floor(255*H.b/H.a),u.data[O+F+3]=Math.floor(255*H.a)};if(t.clips)for(var h=0,m=0;h<o;++h,m+=4*r)for(var v=0,_=0;v<r;v++,_+=4){var x=v/(r-1),w=t.clips[h];c(m,_,w.start*(1-x)+w.end*x)}else for(var E=0,z=0;E<r;E++,z+=4)c(0,z,E/(r-1));return u}var Iu=function(t){function e(r){t.call(this,r,lc),this._updateColorRamp()}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.createBucket=function(r){return new Un(r)},e.prototype._handleSpecialPaintPropertyUpdate=function(r){r==="heatmap-color"&&this._updateColorRamp()},e.prototype._updateColorRamp=function(){this.colorRamp=ul({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},e.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},e.prototype.queryRadius=function(){return 0},e.prototype.queryIntersectsFeature=function(){return!1},e.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},e}(Gi),cl={paint:new ea({"hillshade-illumination-direction":new Kt(M.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Kt(M.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Kt(M.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Kt(M.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Kt(M.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Kt(M.paint_hillshade["hillshade-accent-color"])})},uc=function(t){function e(r){t.call(this,r,cl)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},e}(Gi),cc=Nr([{name:"a_pos",components:2,type:"Int16"}],4).members,Mo=js,Au=js;function js(t,e,r){r=r||2;var o,u,c,h,m,v,_,x=e&&e.length,w=x?e[0]*r:t.length,E=qs(t,0,w,r,!0),z=[];if(!E||E.next===E.prev)return z;if(x&&(E=function(F,J,H,at){var st,dt,mt,zt=[];for(st=0,dt=J.length;st<dt;st++)(mt=qs(F,J[st]*at,st<dt-1?J[st+1]*at:F.length,at,!1))===mt.next&&(mt.steiner=!0),zt.push(Qo(mt));for(zt.sort(pc),st=0;st<zt.length;st++)hc(zt[st],H),H=to(H,H.next);return H}(t,e,E,r)),t.length>80*r){o=c=t[0],u=h=t[1];for(var O=r;O<w;O+=r)(m=t[O])<o&&(o=m),(v=t[O+1])<u&&(u=v),m>c&&(c=m),v>h&&(h=v);_=(_=Math.max(c-o,h-u))!==0?1/_:0}return pl(E,z,r,o,u,_),z}function qs(t,e,r,o,u){var c,h;if(u===ku(t,e,r,o)>0)for(c=e;c<r;c+=o)h=zu(c,t[c],t[c+1],h);else for(c=r-o;c>=e;c-=o)h=zu(c,t[c],t[c+1],h);return h&&hl(h,h.next)&&(fl(h),h=h.next),h}function to(t,e){if(!t)return t;e||(e=t);var r,o=t;do if(r=!1,o.steiner||!hl(o,o.next)&&hr(o.prev,o,o.next)!==0)o=o.next;else{if(fl(o),(o=e=o.prev)===o.next)break;r=!0}while(r||o!==e);return e}function pl(t,e,r,o,u,c,h){if(t){!h&&c&&function(x,w,E,z){var O=x;do O.z===null&&(O.z=Pl(O.x,O.y,w,E,z)),O.prevZ=O.prev,O.nextZ=O.next,O=O.next;while(O!==x);O.prevZ.nextZ=null,O.prevZ=null,function(F){var J,H,at,st,dt,mt,zt,Ot,Zt=1;do{for(H=F,F=null,dt=null,mt=0;H;){for(mt++,at=H,zt=0,J=0;J<Zt&&(zt++,at=at.nextZ);J++);for(Ot=Zt;zt>0||Ot>0&&at;)zt!==0&&(Ot===0||!at||H.z<=at.z)?(st=H,H=H.nextZ,zt--):(st=at,at=at.nextZ,Ot--),dt?dt.nextZ=st:F=st,st.prevZ=dt,dt=st;H=at}dt.nextZ=null,Zt*=2}while(mt>1)}(O)}(t,o,u,c);for(var m,v,_=t;t.prev!==t.next;)if(m=t.prev,v=t.next,c?Li(t,o,u,c):Do(t))e.push(m.i/r),e.push(t.i/r),e.push(v.i/r),fl(t),t=v.next,_=v.next;else if((t=v)===_){h?h===1?pl(t=Ei(to(t),e,r),e,r,o,u,c,2):h===2&&zl(t,e,r,o,u,c):pl(to(t),e,r,o,u,c,1);break}}}function Do(t){var e=t.prev,r=t,o=t.next;if(hr(e,r,o)>=0)return!1;for(var u=t.next.next;u!==t.prev;){if($o(e.x,e.y,r.x,r.y,o.x,o.y,u.x,u.y)&&hr(u.prev,u,u.next)>=0)return!1;u=u.next}return!0}function Li(t,e,r,o){var u=t.prev,c=t,h=t.next;if(hr(u,c,h)>=0)return!1;for(var m=u.x>c.x?u.x>h.x?u.x:h.x:c.x>h.x?c.x:h.x,v=u.y>c.y?u.y>h.y?u.y:h.y:c.y>h.y?c.y:h.y,_=Pl(u.x<c.x?u.x<h.x?u.x:h.x:c.x<h.x?c.x:h.x,u.y<c.y?u.y<h.y?u.y:h.y:c.y<h.y?c.y:h.y,e,r,o),x=Pl(m,v,e,r,o),w=t.prevZ,E=t.nextZ;w&&w.z>=_&&E&&E.z<=x;){if(w!==t.prev&&w!==t.next&&$o(u.x,u.y,c.x,c.y,h.x,h.y,w.x,w.y)&&hr(w.prev,w,w.next)>=0||(w=w.prevZ,E!==t.prev&&E!==t.next&&$o(u.x,u.y,c.x,c.y,h.x,h.y,E.x,E.y)&&hr(E.prev,E,E.next)>=0))return!1;E=E.nextZ}for(;w&&w.z>=_;){if(w!==t.prev&&w!==t.next&&$o(u.x,u.y,c.x,c.y,h.x,h.y,w.x,w.y)&&hr(w.prev,w,w.next)>=0)return!1;w=w.prevZ}for(;E&&E.z<=x;){if(E!==t.prev&&E!==t.next&&$o(u.x,u.y,c.x,c.y,h.x,h.y,E.x,E.y)&&hr(E.prev,E,E.next)>=0)return!1;E=E.nextZ}return!0}function Ei(t,e,r){var o=t;do{var u=o.prev,c=o.next.next;!hl(u,c)&&kl(u,o,o.next,c)&&Dl(u,c)&&Dl(c,u)&&(e.push(u.i/r),e.push(o.i/r),e.push(c.i/r),fl(o),fl(o.next),o=t=c),o=o.next}while(o!==t);return to(o)}function zl(t,e,r,o,u,c){var h=t;do{for(var m=h.next.next;m!==h.prev;){if(h.i!==m.i&&Cu(h,m)){var v=vo(h,m);return h=to(h,h.next),v=to(v,v.next),pl(h,e,r,o,u,c),void pl(v,e,r,o,u,c)}m=m.next}h=h.next}while(h!==t)}function pc(t,e){return t.x-e.x}function hc(t,e){if(e=function(o,u){var c,h=u,m=o.x,v=o.y,_=-1/0;do{if(v<=h.y&&v>=h.next.y&&h.next.y!==h.y){var x=h.x+(v-h.y)*(h.next.x-h.x)/(h.next.y-h.y);if(x<=m&&x>_){if(_=x,x===m){if(v===h.y)return h;if(v===h.next.y)return h.next}c=h.x<h.next.x?h:h.next}}h=h.next}while(h!==u);if(!c)return null;if(m===_)return c;var w,E=c,z=c.x,O=c.y,F=1/0;h=c;do m>=h.x&&h.x>=z&&m!==h.x&&$o(v<O?m:_,v,z,O,v<O?_:m,v,h.x,h.y)&&(w=Math.abs(v-h.y)/(m-h.x),Dl(h,o)&&(w<F||w===F&&(h.x>c.x||h.x===c.x&&Qc(c,h)))&&(c=h,F=w)),h=h.next;while(h!==E);return c}(t,e)){var r=vo(e,t);to(e,e.next),to(r,r.next)}}function Qc(t,e){return hr(t.prev,t,e.prev)<0&&hr(e.next,t,t.next)<0}function Pl(t,e,r,o,u){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*u)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-o)*u)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Qo(t){var e=t,r=t;do(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next;while(e!==t);return r}function $o(t,e,r,o,u,c,h,m){return(u-h)*(e-m)-(t-h)*(c-m)>=0&&(t-h)*(o-m)-(r-h)*(e-m)>=0&&(r-h)*(c-m)-(u-h)*(o-m)>=0}function Cu(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(r,o){var u=r;do{if(u.i!==r.i&&u.next.i!==r.i&&u.i!==o.i&&u.next.i!==o.i&&kl(u,u.next,r,o))return!0;u=u.next}while(u!==r);return!1}(t,e)&&(Dl(t,e)&&Dl(e,t)&&function(r,o){var u=r,c=!1,h=(r.x+o.x)/2,m=(r.y+o.y)/2;do u.y>m!=u.next.y>m&&u.next.y!==u.y&&h<(u.next.x-u.x)*(m-u.y)/(u.next.y-u.y)+u.x&&(c=!c),u=u.next;while(u!==r);return c}(t,e)&&(hr(t.prev,t,e.prev)||hr(t,e.prev,e))||hl(t,e)&&hr(t.prev,t,t.next)>0&&hr(e.prev,e,e.next)>0)}function hr(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function hl(t,e){return t.x===e.x&&t.y===e.y}function kl(t,e,r,o){var u=Ml(hr(t,e,r)),c=Ml(hr(t,e,o)),h=Ml(hr(r,o,t)),m=Ml(hr(r,o,e));return u!==c&&h!==m||!(u!==0||!Yl(t,r,e))||!(c!==0||!Yl(t,o,e))||!(h!==0||!Yl(r,t,o))||!(m!==0||!Yl(r,e,o))}function Yl(t,e,r){return e.x<=Math.max(t.x,r.x)&&e.x>=Math.min(t.x,r.x)&&e.y<=Math.max(t.y,r.y)&&e.y>=Math.min(t.y,r.y)}function Ml(t){return t>0?1:t<0?-1:0}function Dl(t,e){return hr(t.prev,t,t.next)<0?hr(t,e,t.next)>=0&&hr(t,t.prev,e)>=0:hr(t,e,t.prev)<0||hr(t,t.next,e)<0}function vo(t,e){var r=new Pu(t.i,t.x,t.y),o=new Pu(e.i,e.x,e.y),u=t.next,c=e.prev;return t.next=e,e.prev=t,r.next=u,u.prev=r,o.next=r,r.prev=o,c.next=o,o.prev=c,o}function zu(t,e,r,o){var u=new Pu(t,e,r);return o?(u.next=o.next,u.prev=o,o.next.prev=u,o.next=u):(u.prev=u,u.next=u),u}function fl(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Pu(t,e,r){this.i=t,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function ku(t,e,r,o){for(var u=0,c=e,h=r-o;c<r;c+=o)u+=(t[h]-t[c])*(t[c+1]+t[h+1]),h=c;return u}function $c(t,e,r,o,u){(function c(h,m,v,_,x){for(;_>v;){if(_-v>600){var w=_-v+1,E=m-v+1,z=Math.log(w),O=.5*Math.exp(2*z/3),F=.5*Math.sqrt(z*O*(w-O)/w)*(E-w/2<0?-1:1);c(h,m,Math.max(v,Math.floor(m-E*O/w+F)),Math.min(_,Math.floor(m+(w-E)*O/w+F)),x)}var J=h[m],H=v,at=_;for(Ll(h,v,m),x(h[_],J)>0&&Ll(h,v,_);H<at;){for(Ll(h,H,at),H++,at--;x(h[H],J)<0;)H++;for(;x(h[at],J)>0;)at--}x(h[v],J)===0?Ll(h,v,at):Ll(h,++at,_),at<=m&&(v=at+1),m<=at&&(_=at-1)}})(t,e,r||0,o||t.length-1,u||tp)}function Ll(t,e,r){var o=t[e];t[e]=t[r],t[r]=o}function tp(t,e){return t<e?-1:t>e?1:0}function Mu(t,e){var r=t.length;if(r<=1)return[t];for(var o,u,c=[],h=0;h<r;h++){var m=Xe(t[h]);m!==0&&(t[h].area=Math.abs(m),u===void 0&&(u=m<0),u===m<0?(o&&c.push(o),o=[t[h]]):o.push(t[h]))}if(o&&c.push(o),e>1)for(var v=0;v<c.length;v++)c[v].length<=e||($c(c[v],e,1,c[v].length-1,fc),c[v]=c[v].slice(0,e));return c}function fc(t,e){return e.area-t.area}function dl(t,e,r){for(var o=r.patternDependencies,u=!1,c=0,h=e;c<h.length;c+=1){var m=h[c].paint.get(t+"-pattern");m.isConstant()||(u=!0);var v=m.constantOr(null);v&&(u=!0,o[v.to]=!0,o[v.from]=!0)}return u}function Du(t,e,r,o,u){for(var c=u.patternDependencies,h=0,m=e;h<m.length;h+=1){var v=m[h],_=v.paint.get(t+"-pattern").value;if(_.kind!=="constant"){var x=_.evaluate({zoom:o-1},r,{},u.availableImages),w=_.evaluate({zoom:o},r,{},u.availableImages),E=_.evaluate({zoom:o+1},r,{},u.availableImages);w=w&&w.name?w.name:w,E=E&&E.name?E.name:E,c[x=x&&x.name?x.name:x]=!0,c[w]=!0,c[E]=!0,r.patterns[v.id]={min:x,mid:w,max:E}}}return r}js.deviation=function(t,e,r,o){var u=e&&e.length,c=Math.abs(ku(t,0,u?e[0]*r:t.length,r));if(u)for(var h=0,m=e.length;h<m;h++)c-=Math.abs(ku(t,e[h]*r,h<m-1?e[h+1]*r:t.length,r));var v=0;for(h=0;h<o.length;h+=3){var _=o[h]*r,x=o[h+1]*r,w=o[h+2]*r;v+=Math.abs((t[_]-t[w])*(t[x+1]-t[_+1])-(t[_]-t[x])*(t[w+1]-t[_+1]))}return c===0&&v===0?0:Math.abs((v-c)/c)},js.flatten=function(t){for(var e=t[0][0].length,r={vertices:[],holes:[],dimensions:e},o=0,u=0;u<t.length;u++){for(var c=0;c<t[u].length;c++)for(var h=0;h<e;h++)r.vertices.push(t[u][c][h]);u>0&&r.holes.push(o+=t[u-1].length)}return r},Mo.default=Au;var _o=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(e){return e.id}),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Jo,this.indexArray=new nt,this.indexArray2=new Ht,this.programConfigurations=new He(t.layers,t.zoom),this.segments=new A,this.segments2=new A,this.stateDependentLayerIds=this.layers.filter(function(e){return e.isStateDependent()}).map(function(e){return e.id})};_o.prototype.populate=function(t,e,r){this.hasPattern=dl("fill",this.layers,e);for(var o=this.layers[0].layout.get("fill-sort-key"),u=!o.isConstant(),c=[],h=0,m=t;h<m.length;h+=1){var v=m[h],_=v.feature,x=v.id,w=v.index,E=v.sourceLayerIndex,z=this.layers[0]._featureFilter.needGeometry,O=bi(_,z);if(this.layers[0]._featureFilter.filter(new rr(this.zoom),O,r)){var F=u?o.evaluate(O,{},r,e.availableImages):void 0,J={id:x,properties:_.properties,type:_.type,sourceLayerIndex:E,index:w,geometry:z?O.geometry:jr(_),patterns:{},sortKey:F};c.push(J)}}u&&c.sort(function(Zt,ve){return Zt.sortKey-ve.sortKey});for(var H=0,at=c;H<at.length;H+=1){var st=at[H],dt=st.geometry,mt=st.index,zt=st.sourceLayerIndex;if(this.hasPattern){var Ot=Du("fill",this.layers,st,this.zoom,e);this.patternFeatures.push(Ot)}else this.addFeature(st,dt,mt,r,{});e.featureIndex.insert(t[mt].feature,dt,mt,zt,this.index)}},_o.prototype.update=function(t,e,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,r)},_o.prototype.addFeatures=function(t,e,r){for(var o=0,u=this.patternFeatures;o<u.length;o+=1){var c=u[o];this.addFeature(c,c.geometry,c.index,e,r)}},_o.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},_o.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},_o.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,cc),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0},_o.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},_o.prototype.addFeature=function(t,e,r,o,u){for(var c=0,h=Mu(e,500);c<h.length;c+=1){for(var m=h[c],v=0,_=0,x=m;_<x.length;_+=1)v+=x[_].length;for(var w=this.segments.prepareSegment(v,this.layoutVertexArray,this.indexArray),E=w.vertexLength,z=[],O=[],F=0,J=m;F<J.length;F+=1){var H=J[F];if(H.length!==0){H!==m[0]&&O.push(z.length/2);var at=this.segments2.prepareSegment(H.length,this.layoutVertexArray,this.indexArray2),st=at.vertexLength;this.layoutVertexArray.emplaceBack(H[0].x,H[0].y),this.indexArray2.emplaceBack(st+H.length-1,st),z.push(H[0].x),z.push(H[0].y);for(var dt=1;dt<H.length;dt++)this.layoutVertexArray.emplaceBack(H[dt].x,H[dt].y),this.indexArray2.emplaceBack(st+dt-1,st+dt),z.push(H[dt].x),z.push(H[dt].y);at.vertexLength+=H.length,at.primitiveLength+=H.length}}for(var mt=Mo(z,O),zt=0;zt<mt.length;zt+=3)this.indexArray.emplaceBack(E+mt[zt],E+mt[zt+1],E+mt[zt+2]);w.vertexLength+=v,w.primitiveLength+=mt.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,r,u,o)},re("FillBucket",_o,{omit:["layers","patternFeatures"]});var ep=new ea({"fill-sort-key":new De(M.layout_fill["fill-sort-key"])}),Jl={paint:new ea({"fill-antialias":new Kt(M.paint_fill["fill-antialias"]),"fill-opacity":new De(M.paint_fill["fill-opacity"]),"fill-color":new De(M.paint_fill["fill-color"]),"fill-outline-color":new De(M.paint_fill["fill-outline-color"]),"fill-translate":new Kt(M.paint_fill["fill-translate"]),"fill-translate-anchor":new Kt(M.paint_fill["fill-translate-anchor"]),"fill-pattern":new Zn(M.paint_fill["fill-pattern"])}),layout:ep},Zs=function(t){function e(r){t.call(this,r,Jl)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.recalculate=function(r,o){t.prototype.recalculate.call(this,r,o);var u=this.paint._values["fill-outline-color"];u.value.kind==="constant"&&u.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},e.prototype.createBucket=function(r){return new _o(r)},e.prototype.queryRadius=function(){return yr(this.paint.get("fill-translate"))},e.prototype.queryIntersectsFeature=function(r,o,u,c,h,m,v){return Kr(Vi(r,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),m.angle,v),c)},e.prototype.isTileClipped=function(){return!0},e}(Gi),en=Nr([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,Vn=Hn;function Hn(t,e,r,o,u){this.properties={},this.extent=r,this.type=0,this._pbf=t,this._geometry=-1,this._keys=o,this._values=u,t.readFields(Wi,this,e)}function Wi(t,e,r){t==1?e.id=r.readVarint():t==2?function(o,u){for(var c=o.readVarint()+o.pos;o.pos<c;){var h=u._keys[o.readVarint()],m=u._values[o.readVarint()];u.properties[h]=m}}(r,e):t==3?e.type=r.readVarint():t==4&&(e._geometry=r.pos)}function Fr(t){for(var e,r,o=0,u=0,c=t.length,h=c-1;u<c;h=u++)o+=((r=t[h]).x-(e=t[u]).x)*(e.y+r.y);return o}Hn.types=["Unknown","Point","LineString","Polygon"],Hn.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,r=t.readVarint()+t.pos,o=1,u=0,c=0,h=0,m=[];t.pos<r;){if(u<=0){var v=t.readVarint();o=7&v,u=v>>3}if(u--,o===1||o===2)c+=t.readSVarint(),h+=t.readSVarint(),o===1&&(e&&m.push(e),e=[]),e.push(new Vt(c,h));else{if(o!==7)throw new Error("unknown command "+o);e&&e.push(e[0].clone())}}return e&&m.push(e),m},Hn.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,r=1,o=0,u=0,c=0,h=1/0,m=-1/0,v=1/0,_=-1/0;t.pos<e;){if(o<=0){var x=t.readVarint();r=7&x,o=x>>3}if(o--,r===1||r===2)(u+=t.readSVarint())<h&&(h=u),u>m&&(m=u),(c+=t.readSVarint())<v&&(v=c),c>_&&(_=c);else if(r!==7)throw new Error("unknown command "+r)}return[h,v,m,_]},Hn.prototype.toGeoJSON=function(t,e,r){var o,u,c=this.extent*Math.pow(2,r),h=this.extent*t,m=this.extent*e,v=this.loadGeometry(),_=Hn.types[this.type];function x(z){for(var O=0;O<z.length;O++){var F=z[O];z[O]=[360*(F.x+h)/c-180,360/Math.PI*Math.atan(Math.exp((180-360*(F.y+m)/c)*Math.PI/180))-90]}}switch(this.type){case 1:var w=[];for(o=0;o<v.length;o++)w[o]=v[o][0];x(v=w);break;case 2:for(o=0;o<v.length;o++)x(v[o]);break;case 3:for(v=function(z){var O=z.length;if(O<=1)return[z];for(var F,J,H=[],at=0;at<O;at++){var st=Fr(z[at]);st!==0&&(J===void 0&&(J=st<0),J===st<0?(F&&H.push(F),F=[z[at]]):F.push(z[at]))}return F&&H.push(F),H}(v),o=0;o<v.length;o++)for(u=0;u<v[o].length;u++)x(v[o][u])}v.length===1?v=v[0]:_="Multi"+_;var E={type:"Feature",geometry:{type:_,coordinates:v},properties:this.properties};return"id"in this&&(E.id=this.id),E};var eo=ms;function ms(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(Lu,this,e),this.length=this._features.length}function Lu(t,e,r){t===15?e.version=r.readVarint():t===1?e.name=r.readString():t===5?e.extent=r.readVarint():t===2?e._features.push(r.pos):t===3?e._keys.push(r.readString()):t===4&&e._values.push(function(o){for(var u=null,c=o.readVarint()+o.pos;o.pos<c;){var h=o.readVarint()>>3;u=h===1?o.readString():h===2?o.readFloat():h===3?o.readDouble():h===4?o.readVarint64():h===5?o.readVarint():h===6?o.readSVarint():h===7?o.readBoolean():null}return u}(r))}function Ql(t,e,r){if(t===3){var o=new eo(r,r.readVarint()+r.pos);o.length&&(e[o.name]=o)}}ms.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new Vn(this._pbf,e,this.extent,this._keys,this._values)};var ml={VectorTile:function(t,e){this.layers=t.readFields(Ql,{},e)},VectorTileFeature:Vn,VectorTileLayer:eo},df=ml.VectorTileFeature.types,rp=Math.pow(2,13);function Ru(t,e,r,o,u,c,h,m){t.emplaceBack(e,r,2*Math.floor(o*rp)+h,u*rp*2,c*rp*2,Math.round(m))}var ts=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(e){return e.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Gn,this.indexArray=new nt,this.programConfigurations=new He(t.layers,t.zoom),this.segments=new A,this.stateDependentLayerIds=this.layers.filter(function(e){return e.isStateDependent()}).map(function(e){return e.id})};function mf(t,e){return t.x===e.x&&(t.x<0||t.x>8192)||t.y===e.y&&(t.y<0||t.y>8192)}ts.prototype.populate=function(t,e,r){this.features=[],this.hasPattern=dl("fill-extrusion",this.layers,e);for(var o=0,u=t;o<u.length;o+=1){var c=u[o],h=c.feature,m=c.id,v=c.index,_=c.sourceLayerIndex,x=this.layers[0]._featureFilter.needGeometry,w=bi(h,x);if(this.layers[0]._featureFilter.filter(new rr(this.zoom),w,r)){var E={id:m,sourceLayerIndex:_,index:v,geometry:x?w.geometry:jr(h),properties:h.properties,type:h.type,patterns:{}};this.hasPattern?this.features.push(Du("fill-extrusion",this.layers,E,this.zoom,e)):this.addFeature(E,E.geometry,v,r,{}),e.featureIndex.insert(h,E.geometry,v,_,this.index,!0)}}},ts.prototype.addFeatures=function(t,e,r){for(var o=0,u=this.features;o<u.length;o+=1){var c=u[o];this.addFeature(c,c.geometry,c.index,e,r)}},ts.prototype.update=function(t,e,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,r)},ts.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},ts.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},ts.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,en),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},ts.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},ts.prototype.addFeature=function(t,e,r,o,u){for(var c=0,h=Mu(e,500);c<h.length;c+=1){for(var m=h[c],v=0,_=0,x=m;_<x.length;_+=1)v+=x[_].length;for(var w=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),E=0,z=m;E<z.length;E+=1){var O=z[E];if(O.length!==0&&!((ir=O).every(function(qe){return qe.x<0})||ir.every(function(qe){return qe.x>8192})||ir.every(function(qe){return qe.y<0})||ir.every(function(qe){return qe.y>8192})))for(var F=0,J=0;J<O.length;J++){var H=O[J];if(J>=1){var at=O[J-1];if(!mf(H,at)){w.vertexLength+4>A.MAX_VERTEX_ARRAY_LENGTH&&(w=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var st=H.sub(at)._perp()._unit(),dt=at.dist(H);F+dt>32768&&(F=0),Ru(this.layoutVertexArray,H.x,H.y,st.x,st.y,0,0,F),Ru(this.layoutVertexArray,H.x,H.y,st.x,st.y,0,1,F),Ru(this.layoutVertexArray,at.x,at.y,st.x,st.y,0,0,F+=dt),Ru(this.layoutVertexArray,at.x,at.y,st.x,st.y,0,1,F);var mt=w.vertexLength;this.indexArray.emplaceBack(mt,mt+2,mt+1),this.indexArray.emplaceBack(mt+1,mt+2,mt+3),w.vertexLength+=4,w.primitiveLength+=2}}}}if(w.vertexLength+v>A.MAX_VERTEX_ARRAY_LENGTH&&(w=this.segments.prepareSegment(v,this.layoutVertexArray,this.indexArray)),df[t.type]==="Polygon"){for(var zt=[],Ot=[],Zt=w.vertexLength,ve=0,Wt=m;ve<Wt.length;ve+=1){var xe=Wt[ve];if(xe.length!==0){xe!==m[0]&&Ot.push(zt.length/2);for(var Qt=0;Qt<xe.length;Qt++){var Je=xe[Qt];Ru(this.layoutVertexArray,Je.x,Je.y,0,0,1,1,0),zt.push(Je.x),zt.push(Je.y)}}}for(var Le=Mo(zt,Ot),fe=0;fe<Le.length;fe+=3)this.indexArray.emplaceBack(Zt+Le[fe],Zt+Le[fe+2],Zt+Le[fe+1]);w.primitiveLength+=Le.length/3,w.vertexLength+=v}}var ir;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,r,u,o)},re("FillExtrusionBucket",ts,{omit:["layers","features"]});var yf={paint:new ea({"fill-extrusion-opacity":new Kt(M["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new De(M["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Kt(M["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Kt(M["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Zn(M["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new De(M["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new De(M["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Kt(M["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},vf=function(t){function e(r){t.call(this,r,yf)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.createBucket=function(r){return new ts(r)},e.prototype.queryRadius=function(){return yr(this.paint.get("fill-extrusion-translate"))},e.prototype.is3D=function(){return!0},e.prototype.queryIntersectsFeature=function(r,o,u,c,h,m,v,_){var x=Vi(r,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),m.angle,v),w=this.paint.get("fill-extrusion-height").evaluate(o,u),E=this.paint.get("fill-extrusion-base").evaluate(o,u),z=function(F,J,H,at){for(var st=[],dt=0,mt=F;dt<mt.length;dt+=1){var zt=mt[dt],Ot=[zt.x,zt.y,0,1];ka(Ot,Ot,J),st.push(new Vt(Ot[0]/Ot[3],Ot[1]/Ot[3]))}return st}(x,_),O=function(F,J,H,at){for(var st=[],dt=[],mt=at[8]*J,zt=at[9]*J,Ot=at[10]*J,Zt=at[11]*J,ve=at[8]*H,Wt=at[9]*H,xe=at[10]*H,Qt=at[11]*H,Je=0,Le=F;Je<Le.length;Je+=1){for(var fe=[],ir=[],qe=0,vr=Le[Je];qe<vr.length;qe+=1){var we=vr[qe],Ar=we.x,Ai=we.y,Ni=at[0]*Ar+at[4]*Ai+at[12],Ri=at[1]*Ar+at[5]*Ai+at[13],Ci=at[2]*Ar+at[6]*Ai+at[14],ji=at[3]*Ar+at[7]*Ai+at[15],gn=Ci+Ot,xn=ji+Zt,oa=Ni+ve,An=Ri+Wt,sa=Ci+xe,Xi=ji+Qt,Cn=new Vt((Ni+mt)/xn,(Ri+zt)/xn);Cn.z=gn/xn,fe.push(Cn);var or=new Vt(oa/Xi,An/Xi);or.z=sa/Xi,ir.push(or)}st.push(fe),dt.push(ir)}return[st,dt]}(c,E,w,_);return function(F,J,H){var at=1/0;Kr(H,J)&&(at=Dp(H,J[0]));for(var st=0;st<J.length;st++)for(var dt=J[st],mt=F[st],zt=0;zt<dt.length-1;zt++){var Ot=dt[zt],Zt=[Ot,dt[zt+1],mt[zt+1],mt[zt],Ot];Pi(H,Zt)&&(at=Math.min(at,Dp(H,Zt)))}return at!==1/0&&at}(O[0],O[1],z)},e}(Gi);function Bu(t,e){return t.x*e.x+t.y*e.y}function Dp(t,e){if(t.length===1){for(var r,o=0,u=e[o++];!r||u.equals(r);)if(!(r=e[o++]))return 1/0;for(;o<e.length;o++){var c=e[o],h=t[0],m=r.sub(u),v=c.sub(u),_=h.sub(u),x=Bu(m,m),w=Bu(m,v),E=Bu(v,v),z=Bu(_,m),O=Bu(_,v),F=x*E-w*w,J=(E*z-w*O)/F,H=(x*O-w*z)/F,at=u.z*(1-J-H)+r.z*J+c.z*H;if(isFinite(at))return at}return 1/0}for(var st=1/0,dt=0,mt=e;dt<mt.length;dt+=1)st=Math.min(st,mt[dt].z);return st}var _f=Nr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,gf=Nr([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,xf=ml.VectorTileFeature.types,bf=Math.cos(Math.PI/180*37.5),Lp=Math.pow(2,14)/.5,xa=function(t){var e=this;this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(r){e.gradients[r.id]={}}),this.layoutVertexArray=new Qa,this.layoutVertexArray2=new Hi,this.indexArray=new nt,this.programConfigurations=new He(t.layers,t.zoom),this.segments=new A,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};xa.prototype.populate=function(t,e,r){this.hasPattern=dl("line",this.layers,e);for(var o=this.layers[0].layout.get("line-sort-key"),u=!o.isConstant(),c=[],h=0,m=t;h<m.length;h+=1){var v=m[h],_=v.feature,x=v.id,w=v.index,E=v.sourceLayerIndex,z=this.layers[0]._featureFilter.needGeometry,O=bi(_,z);if(this.layers[0]._featureFilter.filter(new rr(this.zoom),O,r)){var F=u?o.evaluate(O,{},r):void 0,J={id:x,properties:_.properties,type:_.type,sourceLayerIndex:E,index:w,geometry:z?O.geometry:jr(_),patterns:{},sortKey:F};c.push(J)}}u&&c.sort(function(Zt,ve){return Zt.sortKey-ve.sortKey});for(var H=0,at=c;H<at.length;H+=1){var st=at[H],dt=st.geometry,mt=st.index,zt=st.sourceLayerIndex;if(this.hasPattern){var Ot=Du("line",this.layers,st,this.zoom,e);this.patternFeatures.push(Ot)}else this.addFeature(st,dt,mt,r,{});e.featureIndex.insert(t[mt].feature,dt,mt,zt,this.index)}},xa.prototype.update=function(t,e,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,r)},xa.prototype.addFeatures=function(t,e,r){for(var o=0,u=this.patternFeatures;o<u.length;o+=1){var c=u[o];this.addFeature(c,c.geometry,c.index,e,r)}},xa.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},xa.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},xa.prototype.upload=function(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,gf)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,_f),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},xa.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},xa.prototype.lineFeatureClips=function(t){if(t.properties&&t.properties.hasOwnProperty("mapbox_clip_start")&&t.properties.hasOwnProperty("mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}},xa.prototype.addFeature=function(t,e,r,o,u){var c=this.layers[0].layout,h=c.get("line-join").evaluate(t,{}),m=c.get("line-cap"),v=c.get("line-miter-limit"),_=c.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(var x=0,w=e;x<w.length;x+=1)this.addLine(w[x],t,h,m,v,_);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,r,u,o)},xa.prototype.addLine=function(t,e,r,o,u,c){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var h=0;h<t.length-1;h++)this.totalDistance+=t[h].dist(t[h+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var m=xf[e.type]==="Polygon",v=t.length;v>=2&&t[v-1].equals(t[v-2]);)v--;for(var _=0;_<v-1&&t[_].equals(t[_+1]);)_++;if(!(v<(m?3:2))){r==="bevel"&&(u=1.05);var x,w=this.overscaling<=16?122880/(512*this.overscaling):0,E=this.segments.prepareSegment(10*v,this.layoutVertexArray,this.indexArray),z=void 0,O=void 0,F=void 0,J=void 0;this.e1=this.e2=-1,m&&(J=t[_].sub(x=t[v-2])._unit()._perp());for(var H=_;H<v;H++)if(!(O=H===v-1?m?t[_+1]:void 0:t[H+1])||!t[H].equals(O)){J&&(F=J),x&&(z=x),x=t[H],J=O?O.sub(x)._unit()._perp():F;var at=(F=F||J).add(J);at.x===0&&at.y===0||at._unit();var st=F.x*J.x+F.y*J.y,dt=at.x*J.x+at.y*J.y,mt=dt!==0?1/dt:1/0,zt=2*Math.sqrt(2-2*dt),Ot=dt<bf&&z&&O,Zt=F.x*J.y-F.y*J.x>0;if(Ot&&H>_){var ve=x.dist(z);if(ve>2*w){var Wt=x.sub(x.sub(z)._mult(w/ve)._round());this.updateDistance(z,Wt),this.addCurrentVertex(Wt,F,0,0,E),z=Wt}}var xe=z&&O,Qt=xe?r:m?"butt":o;if(xe&&Qt==="round"&&(mt<c?Qt="miter":mt<=2&&(Qt="fakeround")),Qt==="miter"&&mt>u&&(Qt="bevel"),Qt==="bevel"&&(mt>2&&(Qt="flipbevel"),mt<u&&(Qt="miter")),z&&this.updateDistance(z,x),Qt==="miter")at._mult(mt),this.addCurrentVertex(x,at,0,0,E);else if(Qt==="flipbevel"){if(mt>100)at=J.mult(-1);else{var Je=mt*F.add(J).mag()/F.sub(J).mag();at._perp()._mult(Je*(Zt?-1:1))}this.addCurrentVertex(x,at,0,0,E),this.addCurrentVertex(x,at.mult(-1),0,0,E)}else if(Qt==="bevel"||Qt==="fakeround"){var Le=-Math.sqrt(mt*mt-1),fe=Zt?Le:0,ir=Zt?0:Le;if(z&&this.addCurrentVertex(x,F,fe,ir,E),Qt==="fakeround")for(var qe=Math.round(180*zt/Math.PI/20),vr=1;vr<qe;vr++){var we=vr/qe;if(we!==.5){var Ar=we-.5;we+=we*Ar*(we-1)*((1.0904+st*(st*(3.55645-1.43519*st)-3.2452))*Ar*Ar+(.848013+st*(.215638*st-1.06021)))}var Ai=J.sub(F)._mult(we)._add(F)._unit()._mult(Zt?-1:1);this.addHalfVertex(x,Ai.x,Ai.y,!1,Zt,0,E)}O&&this.addCurrentVertex(x,J,-fe,-ir,E)}else if(Qt==="butt")this.addCurrentVertex(x,at,0,0,E);else if(Qt==="square"){var Ni=z?1:-1;this.addCurrentVertex(x,at,Ni,Ni,E)}else Qt==="round"&&(z&&(this.addCurrentVertex(x,F,0,0,E),this.addCurrentVertex(x,F,1,1,E,!0)),O&&(this.addCurrentVertex(x,J,-1,-1,E,!0),this.addCurrentVertex(x,J,0,0,E)));if(Ot&&H<v-1){var Ri=x.dist(O);if(Ri>2*w){var Ci=x.add(O.sub(x)._mult(w/Ri)._round());this.updateDistance(x,Ci),this.addCurrentVertex(Ci,J,0,0,E),x=Ci}}}}},xa.prototype.addCurrentVertex=function(t,e,r,o,u,c){c===void 0&&(c=!1);var h=e.y*o-e.x,m=-e.y-e.x*o;this.addHalfVertex(t,e.x+e.y*r,e.y-e.x*r,c,!1,r,u),this.addHalfVertex(t,h,m,c,!0,-o,u),this.distance>Lp/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(t,e,r,o,u,c))},xa.prototype.addHalfVertex=function(t,e,r,o,u,c,h){var m=.5*(this.lineClips?this.scaledDistance*(Lp-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t.x<<1)+(o?1:0),(t.y<<1)+(u?1:0),Math.round(63*e)+128,Math.round(63*r)+128,1+(c===0?0:c<0?-1:1)|(63&m)<<2,m>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var v=h.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,v),h.primitiveLength++),u?this.e2=v:this.e1=v},xa.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},xa.prototype.updateDistance=function(t,e){this.distance+=t.dist(e),this.updateScaledDistance()},re("LineBucket",xa,{omit:["layers","patternFeatures"]});var wf=new ea({"line-cap":new Kt(M.layout_line["line-cap"]),"line-join":new De(M.layout_line["line-join"]),"line-miter-limit":new Kt(M.layout_line["line-miter-limit"]),"line-round-limit":new Kt(M.layout_line["line-round-limit"]),"line-sort-key":new De(M.layout_line["line-sort-key"])}),Rp={paint:new ea({"line-opacity":new De(M.paint_line["line-opacity"]),"line-color":new De(M.paint_line["line-color"]),"line-translate":new Kt(M.paint_line["line-translate"]),"line-translate-anchor":new Kt(M.paint_line["line-translate-anchor"]),"line-width":new De(M.paint_line["line-width"]),"line-gap-width":new De(M.paint_line["line-gap-width"]),"line-offset":new De(M.paint_line["line-offset"]),"line-blur":new De(M.paint_line["line-blur"]),"line-dasharray":new ta(M.paint_line["line-dasharray"]),"line-pattern":new Zn(M.paint_line["line-pattern"]),"line-gradient":new Ja(M.paint_line["line-gradient"])}),layout:wf},Bp=new(function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.possiblyEvaluate=function(r,o){return o=new rr(Math.floor(o.zoom),{now:o.now,fadeDuration:o.fadeDuration,zoomHistory:o.zoomHistory,transition:o.transition}),t.prototype.possiblyEvaluate.call(this,r,o)},e.prototype.evaluate=function(r,o,u,c){return o=bt({},o,{zoom:Math.floor(o.zoom)}),t.prototype.evaluate.call(this,r,o,u,c)},e}(De))(Rp.paint.properties["line-width"].specification);Bp.useIntegerZoom=!0;var Sf=function(t){function e(r){t.call(this,r,Rp),this.gradientVersion=0}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._handleSpecialPaintPropertyUpdate=function(r){r==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Sa,this.gradientVersion=(this.gradientVersion+1)%wr)},e.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},e.prototype.recalculate=function(r,o){t.prototype.recalculate.call(this,r,o),this.paint._values["line-floorwidth"]=Bp.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,r)},e.prototype.createBucket=function(r){return new xa(r)},e.prototype.queryRadius=function(r){var o=r,u=Op(Er("line-width",this,o),Er("line-gap-width",this,o)),c=Er("line-offset",this,o);return u/2+Math.abs(c)+yr(this.paint.get("line-translate"))},e.prototype.queryIntersectsFeature=function(r,o,u,c,h,m,v){var _=Vi(r,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),m.angle,v),x=v/2*Op(this.paint.get("line-width").evaluate(o,u),this.paint.get("line-gap-width").evaluate(o,u)),w=this.paint.get("line-offset").evaluate(o,u);return w&&(c=function(E,z){for(var O=[],F=new Vt(0,0),J=0;J<E.length;J++){for(var H=E[J],at=[],st=0;st<H.length;st++){var dt=H[st],mt=H[st+1],zt=st===0?F:dt.sub(H[st-1])._unit()._perp(),Ot=st===H.length-1?F:mt.sub(dt)._unit()._perp(),Zt=zt._add(Ot)._unit();Zt._mult(1/(Zt.x*Ot.x+Zt.y*Ot.y)),at.push(Zt._mult(z)._add(dt))}O.push(at)}return O}(c,w*v)),function(E,z,O){for(var F=0;F<z.length;F++){var J=z[F];if(E.length>=3){for(var H=0;H<J.length;H++)if(be(E,J[H]))return!0}if(ra(E,J,O))return!0}return!1}(_,c,x)},e.prototype.isTileClipped=function(){return!0},e}(Gi);function Op(t,e){return e>0?e+2*t:t}var Tf=Nr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Ef=Nr([{name:"a_projected_pos",components:3,type:"Float32"}],4),If=(Nr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),Nr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),Fp=(Nr([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),Nr([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),Af=Nr([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Cf(t,e,r){return t.sections.forEach(function(o){o.text=function(u,c,h){var m=c.layout.get("text-transform").evaluate(h,{});return m==="uppercase"?u=u.toLocaleUpperCase():m==="lowercase"&&(u=u.toLocaleLowerCase()),hi.applyArabicShaping&&(u=hi.applyArabicShaping(u)),u}(o.text,e,r)}),t}Nr([{name:"triangle",components:3,type:"Uint16"}]),Nr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Nr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Nr([{type:"Float32",name:"offsetX"}]),Nr([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var Ou={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"},Up=function(t,e,r,o,u){var c,h,m=8*u-o-1,v=(1<<m)-1,_=v>>1,x=-7,w=r?u-1:0,E=r?-1:1,z=t[e+w];for(w+=E,c=z&(1<<-x)-1,z>>=-x,x+=m;x>0;c=256*c+t[e+w],w+=E,x-=8);for(h=c&(1<<-x)-1,c>>=-x,x+=o;x>0;h=256*h+t[e+w],w+=E,x-=8);if(c===0)c=1-_;else{if(c===v)return h?NaN:1/0*(z?-1:1);h+=Math.pow(2,o),c-=_}return(z?-1:1)*h*Math.pow(2,c-o)},Vp=function(t,e,r,o,u,c){var h,m,v,_=8*c-u-1,x=(1<<_)-1,w=x>>1,E=u===23?Math.pow(2,-24)-Math.pow(2,-77):0,z=o?0:c-1,O=o?1:-1,F=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(m=isNaN(e)?1:0,h=x):(h=Math.floor(Math.log(e)/Math.LN2),e*(v=Math.pow(2,-h))<1&&(h--,v*=2),(e+=h+w>=1?E/v:E*Math.pow(2,1-w))*v>=2&&(h++,v/=2),h+w>=x?(m=0,h=x):h+w>=1?(m=(e*v-1)*Math.pow(2,u),h+=w):(m=e*Math.pow(2,w-1)*Math.pow(2,u),h=0));u>=8;t[r+z]=255&m,z+=O,m/=256,u-=8);for(h=h<<u|m,_+=u;_>0;t[r+z]=255&h,z+=O,h/=256,_-=8);t[r+z-O]|=128*F},dc=vi;function vi(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}vi.Varint=0,vi.Fixed64=1,vi.Bytes=2,vi.Fixed32=5;var Np=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");function Gs(t){return t.type===vi.Bytes?t.readVarint()+t.pos:t.pos+1}function $l(t,e,r){return r?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function jp(t,e,r){var o=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));r.realloc(o);for(var u=r.pos-1;u>=t;u--)r.buf[u+o]=r.buf[u]}function zf(t,e){for(var r=0;r<t.length;r++)e.writeVarint(t[r])}function Pf(t,e){for(var r=0;r<t.length;r++)e.writeSVarint(t[r])}function kf(t,e){for(var r=0;r<t.length;r++)e.writeFloat(t[r])}function Mf(t,e){for(var r=0;r<t.length;r++)e.writeDouble(t[r])}function Df(t,e){for(var r=0;r<t.length;r++)e.writeBoolean(t[r])}function Lf(t,e){for(var r=0;r<t.length;r++)e.writeFixed32(t[r])}function Rf(t,e){for(var r=0;r<t.length;r++)e.writeSFixed32(t[r])}function Bf(t,e){for(var r=0;r<t.length;r++)e.writeFixed64(t[r])}function Of(t,e){for(var r=0;r<t.length;r++)e.writeSFixed64(t[r])}function mc(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function tu(t,e,r){t[r]=e,t[r+1]=e>>>8,t[r+2]=e>>>16,t[r+3]=e>>>24}function qp(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}function Ff(t,e,r){t===1&&r.readMessage(Uf,e)}function Uf(t,e,r){if(t===3){var o=r.readMessage(Vf,{}),u=o.width,c=o.height,h=o.left,m=o.top,v=o.advance;e.push({id:o.id,bitmap:new Ma({width:u+6,height:c+6},o.bitmap),metrics:{width:u,height:c,left:h,top:m,advance:v}})}}function Vf(t,e,r){t===1?e.id=r.readVarint():t===2?e.bitmap=r.readBytes():t===3?e.width=r.readVarint():t===4?e.height=r.readVarint():t===5?e.left=r.readSVarint():t===6?e.top=r.readSVarint():t===7&&(e.advance=r.readVarint())}function Zp(t){for(var e=0,r=0,o=0,u=t;o<u.length;o+=1){var c=u[o];e+=c.w*c.h,r=Math.max(r,c.w)}t.sort(function(F,J){return J.h-F.h});for(var h=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),r),h:1/0}],m=0,v=0,_=0,x=t;_<x.length;_+=1)for(var w=x[_],E=h.length-1;E>=0;E--){var z=h[E];if(!(w.w>z.w||w.h>z.h)){if(w.x=z.x,w.y=z.y,v=Math.max(v,w.y+w.h),m=Math.max(m,w.x+w.w),w.w===z.w&&w.h===z.h){var O=h.pop();E<h.length&&(h[E]=O)}else w.h===z.h?(z.x+=w.w,z.w-=w.w):w.w===z.w?(z.y+=w.h,z.h-=w.h):(h.push({x:z.x+w.w,y:z.y,w:z.w-w.w,h:w.h}),z.y+=w.h,z.h-=w.h);break}}return{w:m,h:v,fill:e/(m*v)||0}}vi.prototype={destroy:function(){this.buf=null},readFields:function(t,e,r){for(r=r||this.length;this.pos<r;){var o=this.readVarint(),u=o>>3,c=this.pos;this.type=7&o,t(u,e,this),this.pos===c&&this.skip(o)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=mc(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=qp(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=mc(this.buf,this.pos)+4294967296*mc(this.buf,this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=mc(this.buf,this.pos)+4294967296*qp(this.buf,this.pos+4);return this.pos+=8,t},readFloat:function(){var t=Up(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=Up(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,r,o=this.buf;return e=127&(r=o[this.pos++]),r<128?e:(e|=(127&(r=o[this.pos++]))<<7,r<128?e:(e|=(127&(r=o[this.pos++]))<<14,r<128?e:(e|=(127&(r=o[this.pos++]))<<21,r<128?e:function(u,c,h){var m,v,_=h.buf;if(m=(112&(v=_[h.pos++]))>>4,v<128||(m|=(127&(v=_[h.pos++]))<<3,v<128)||(m|=(127&(v=_[h.pos++]))<<10,v<128)||(m|=(127&(v=_[h.pos++]))<<17,v<128)||(m|=(127&(v=_[h.pos++]))<<24,v<128)||(m|=(1&(v=_[h.pos++]))<<31,v<128))return $l(u,m,c);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(r=o[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&Np?function(r,o,u){return Np.decode(r.subarray(o,u))}(this.buf,e,t):function(r,o,u){for(var c="",h=o;h<u;){var m,v,_,x=r[h],w=null,E=x>239?4:x>223?3:x>191?2:1;if(h+E>u)break;E===1?x<128&&(w=x):E===2?(192&(m=r[h+1]))==128&&(w=(31&x)<<6|63&m)<=127&&(w=null):E===3?(v=r[h+2],(192&(m=r[h+1]))==128&&(192&v)==128&&((w=(15&x)<<12|(63&m)<<6|63&v)<=2047||w>=55296&&w<=57343)&&(w=null)):E===4&&(v=r[h+2],_=r[h+3],(192&(m=r[h+1]))==128&&(192&v)==128&&(192&_)==128&&((w=(15&x)<<18|(63&m)<<12|(63&v)<<6|63&_)<=65535||w>=1114112)&&(w=null)),w===null?(w=65533,E=1):w>65535&&(w-=65536,c+=String.fromCharCode(w>>>10&1023|55296),w=56320|1023&w),c+=String.fromCharCode(w),h+=E}return c}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==vi.Bytes)return t.push(this.readVarint(e));var r=Gs(this);for(t=t||[];this.pos<r;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==vi.Bytes)return t.push(this.readSVarint());var e=Gs(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==vi.Bytes)return t.push(this.readBoolean());var e=Gs(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==vi.Bytes)return t.push(this.readFloat());var e=Gs(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==vi.Bytes)return t.push(this.readDouble());var e=Gs(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==vi.Bytes)return t.push(this.readFixed32());var e=Gs(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==vi.Bytes)return t.push(this.readSFixed32());var e=Gs(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==vi.Bytes)return t.push(this.readFixed64());var e=Gs(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==vi.Bytes)return t.push(this.readSFixed64());var e=Gs(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===vi.Varint)for(;this.buf[this.pos++]>127;);else if(e===vi.Bytes)this.pos=this.readVarint()+this.pos;else if(e===vi.Fixed32)this.pos+=4;else{if(e!==vi.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var r=new Uint8Array(e);r.set(this.buf),this.buf=r,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),tu(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),tu(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),tu(this.buf,-1&t,this.pos),tu(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),tu(this.buf,-1&t,this.pos),tu(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(e,r){var o,u;if(e>=0?(o=e%4294967296|0,u=e/4294967296|0):(u=~(-e/4294967296),4294967295^(o=~(-e%4294967296))?o=o+1|0:(o=0,u=u+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");r.realloc(10),function(c,h,m){m.buf[m.pos++]=127&c|128,c>>>=7,m.buf[m.pos++]=127&c|128,c>>>=7,m.buf[m.pos++]=127&c|128,c>>>=7,m.buf[m.pos++]=127&c|128,m.buf[m.pos]=127&(c>>>=7)}(o,0,r),function(c,h){var m=(7&c)<<4;h.buf[h.pos++]|=m|((c>>>=3)?128:0),c&&(h.buf[h.pos++]=127&c|((c>>>=7)?128:0),c&&(h.buf[h.pos++]=127&c|((c>>>=7)?128:0),c&&(h.buf[h.pos++]=127&c|((c>>>=7)?128:0),c&&(h.buf[h.pos++]=127&c|((c>>>=7)?128:0),c&&(h.buf[h.pos++]=127&c)))))}(u,r)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(o,u,c){for(var h,m,v=0;v<u.length;v++){if((h=u.charCodeAt(v))>55295&&h<57344){if(!m){h>56319||v+1===u.length?(o[c++]=239,o[c++]=191,o[c++]=189):m=h;continue}if(h<56320){o[c++]=239,o[c++]=191,o[c++]=189,m=h;continue}h=m-55296<<10|h-56320|65536,m=null}else m&&(o[c++]=239,o[c++]=191,o[c++]=189,m=null);h<128?o[c++]=h:(h<2048?o[c++]=h>>6|192:(h<65536?o[c++]=h>>12|224:(o[c++]=h>>18|240,o[c++]=h>>12&63|128),o[c++]=h>>6&63|128),o[c++]=63&h|128)}return c}(this.buf,t,this.pos);var r=this.pos-e;r>=128&&jp(e,r,this),this.pos=e-1,this.writeVarint(r),this.pos+=r},writeFloat:function(t){this.realloc(4),Vp(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),Vp(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var r=0;r<e;r++)this.buf[this.pos++]=t[r]},writeRawMessage:function(t,e){this.pos++;var r=this.pos;t(e,this);var o=this.pos-r;o>=128&&jp(r,o,this),this.pos=r-1,this.writeVarint(o),this.pos+=o},writeMessage:function(t,e,r){this.writeTag(t,vi.Bytes),this.writeRawMessage(e,r)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,zf,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,Pf,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,Df,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,kf,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,Mf,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,Lf,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,Rf,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,Bf,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,Of,e)},writeBytesField:function(t,e){this.writeTag(t,vi.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,vi.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,vi.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,vi.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,vi.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,vi.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,vi.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,vi.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,vi.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,vi.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}};var yc=function(t,e){var r=e.pixelRatio,o=e.version,u=e.stretchX,c=e.stretchY,h=e.content;this.paddedRect=t,this.pixelRatio=r,this.stretchX=u,this.stretchY=c,this.content=h,this.version=o},Fu={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};Fu.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},Fu.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},Fu.tlbr.get=function(){return this.tl.concat(this.br)},Fu.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(yc.prototype,Fu);var Uu=function(t,e){var r={},o={};this.haveRenderCallbacks=[];var u=[];this.addImages(t,r,u),this.addImages(e,o,u);var c=Zp(u),h=new _n({width:c.w||1,height:c.h||1});for(var m in t){var v=t[m],_=r[m].paddedRect;_n.copy(v.data,h,{x:0,y:0},{x:_.x+1,y:_.y+1},v.data)}for(var x in e){var w=e[x],E=o[x].paddedRect,z=E.x+1,O=E.y+1,F=w.data.width,J=w.data.height;_n.copy(w.data,h,{x:0,y:0},{x:z,y:O},w.data),_n.copy(w.data,h,{x:0,y:J-1},{x:z,y:O-1},{width:F,height:1}),_n.copy(w.data,h,{x:0,y:0},{x:z,y:O+J},{width:F,height:1}),_n.copy(w.data,h,{x:F-1,y:0},{x:z-1,y:O},{width:1,height:J}),_n.copy(w.data,h,{x:0,y:0},{x:z+F,y:O},{width:1,height:J})}this.image=h,this.iconPositions=r,this.patternPositions=o};Uu.prototype.addImages=function(t,e,r){for(var o in t){var u=t[o],c={x:0,y:0,w:u.data.width+2,h:u.data.height+2};r.push(c),e[o]=new yc(c,u),u.hasRenderCallback&&this.haveRenderCallbacks.push(o)}},Uu.prototype.patchUpdatedImages=function(t,e){for(var r in t.dispatchRenderCallbacks(this.haveRenderCallbacks),t.updatedImages)this.patchUpdatedImage(this.iconPositions[r],t.getImage(r),e),this.patchUpdatedImage(this.patternPositions[r],t.getImage(r),e)},Uu.prototype.patchUpdatedImage=function(t,e,r){if(t&&e&&t.version!==e.version){t.version=e.version;var o=t.tl;r.update(e.data,void 0,{x:o[0],y:o[1]})}},re("ImagePosition",yc),re("ImageAtlas",Uu);var ro={horizontal:1,vertical:2,horizontalOnly:3},eu=function(){this.scale=1,this.fontStack="",this.imageName=null};eu.forText=function(t,e){var r=new eu;return r.scale=t||1,r.fontStack=e,r},eu.forImage=function(t){var e=new eu;return e.imageName=t,e};var aa=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function vc(t,e,r,o,u,c,h,m,v,_,x,w,E,z,O,F){var J,H=aa.fromFeature(t,u);w===ro.vertical&&H.verticalizePunctuation();var at=hi.processBidirectionalText,st=hi.processStyledBidirectionalText;if(at&&H.sections.length===1){J=[];for(var dt=0,mt=at(H.toString(),ip(H,_,c,e,o,z,O));dt<mt.length;dt+=1){var zt=mt[dt],Ot=new aa;Ot.text=zt,Ot.sections=H.sections;for(var Zt=0;Zt<zt.length;Zt++)Ot.sectionIndex.push(0);J.push(Ot)}}else if(st){J=[];for(var ve=0,Wt=st(H.text,H.sectionIndex,ip(H,_,c,e,o,z,O));ve<Wt.length;ve+=1){var xe=Wt[ve],Qt=new aa;Qt.text=xe[0],Qt.sectionIndex=xe[1],Qt.sections=H.sections,J.push(Qt)}}else J=function(fe,ir){for(var qe=[],vr=fe.text,we=0,Ar=0,Ai=ir;Ar<Ai.length;Ar+=1){var Ni=Ai[Ar];qe.push(fe.substring(we,Ni)),we=Ni}return we<vr.length&&qe.push(fe.substring(we,vr.length)),qe}(H,ip(H,_,c,e,o,z,O));var Je=[],Le={positionedLines:Je,text:H.toString(),top:x[1],bottom:x[1],left:x[0],right:x[0],writingMode:w,iconsInText:!1,verticalizable:!1};return function(fe,ir,qe,vr,we,Ar,Ai,Ni,Ri,Ci,ji,gn){for(var xn=0,oa=-17,An=0,sa=0,Xi=Ni==="right"?1:Ni==="left"?0:.5,Cn=0,or=0,ti=we;or<ti.length;or+=1){var Zr=ti[or];Zr.trim();var br=Zr.getMaxScale(),ba=24*(br-1),Wn={positionedGlyphs:[],lineOffset:0};fe.positionedLines[Cn]=Wn;var wi=Wn.positionedGlyphs,rn=0;if(Zr.length()){for(var Xn=0;Xn<Zr.length();Xn++){var Cr=Zr.getSection(Xn),ys=Zr.getSectionIndex(Xn),io=Zr.getCharCode(Xn),vs=0,Ki=null,_s=null,Lo=null,uu=24,Fl=!(Ri===ro.horizontal||!ji&&!ol(io)||ji&&(_c[io]||(Ks=io,ie.Arabic(Ks)||ie["Arabic Supplement"](Ks)||ie["Arabic Extended-A"](Ks)||ie["Arabic Presentation Forms-A"](Ks)||ie["Arabic Presentation Forms-B"](Ks))));if(Cr.imageName){var cu=vr[Cr.imageName];if(!cu)continue;Lo=Cr.imageName,fe.iconsInText=fe.iconsInText||!0,_s=cu.paddedRect;var Xs=cu.displaySize;Cr.scale=24*Cr.scale/gn,vs=ba+(24-Xs[1]*Cr.scale),uu=(Ki={width:Xs[0],height:Xs[1],left:1,top:-3,advance:Fl?Xs[1]:Xs[0]}).advance;var pu=Fl?Xs[0]*Cr.scale-24*br:Xs[1]*Cr.scale-24*br;pu>0&&pu>rn&&(rn=pu)}else{var Ac=qe[Cr.fontStack],hu=Ac&&Ac[io];if(hu&&hu.rect)_s=hu.rect,Ki=hu.metrics;else{var ju=ir[Cr.fontStack],Cc=ju&&ju[io];if(!Cc)continue;Ki=Cc.metrics}vs=24*(br-Cr.scale)}Fl?(fe.verticalizable=!0,wi.push({glyph:io,imageName:Lo,x:xn,y:oa+vs,vertical:Fl,scale:Cr.scale,fontStack:Cr.fontStack,sectionIndex:ys,metrics:Ki,rect:_s}),xn+=uu*Cr.scale+Ci):(wi.push({glyph:io,imageName:Lo,x:xn,y:oa+vs,vertical:Fl,scale:Cr.scale,fontStack:Cr.fontStack,sectionIndex:ys,metrics:Ki,rect:_s}),xn+=Ki.advance*Cr.scale+Ci)}wi.length!==0&&(An=Math.max(xn-Ci,An),jf(wi,0,wi.length-1,Xi,rn)),xn=0;var zc=Ar*br+rn;Wn.lineOffset=Math.max(rn,ba),oa+=zc,sa=Math.max(zc,sa),++Cn}else oa+=Ar,++Cn}var Ks,qu=oa- -17,fu=np(Ai),vl=fu.horizontalAlign,du=fu.verticalAlign;(function(Pc,kc,Zu,Gu,Mc,Hu,Wu,Xu,Dc){var mu,Lc=(kc-Zu)*Mc;mu=Hu!==Wu?-Xu*Gu- -17:(-Gu*Dc+.5)*Wu;for(var yu=0,Ku=Pc;yu<Ku.length;yu+=1)for(var Ul=0,Yu=Ku[yu].positionedGlyphs;Ul<Yu.length;Ul+=1){var vu=Yu[Ul];vu.x+=Lc,vu.y+=mu}})(fe.positionedLines,Xi,vl,du,An,sa,Ar,qu,we.length),fe.top+=-du*qu,fe.bottom=fe.top+qu,fe.left+=-vl*An,fe.right=fe.left+An}(Le,e,r,o,J,h,m,v,w,_,E,F),!function(fe){for(var ir=0,qe=fe;ir<qe.length;ir+=1)if(qe[ir].positionedGlyphs.length!==0)return!1;return!0}(Je)&&Le}aa.fromFeature=function(t,e){for(var r=new aa,o=0;o<t.sections.length;o++){var u=t.sections[o];u.image?r.addImageSection(u):r.addTextSection(u,e)}return r},aa.prototype.length=function(){return this.text.length},aa.prototype.getSection=function(t){return this.sections[this.sectionIndex[t]]},aa.prototype.getSectionIndex=function(t){return this.sectionIndex[t]},aa.prototype.getCharCode=function(t){return this.text.charCodeAt(t)},aa.prototype.verticalizePunctuation=function(){this.text=function(t){for(var e="",r=0;r<t.length;r++){var o=t.charCodeAt(r+1)||null,u=t.charCodeAt(r-1)||null;e+=o&&Ca(o)&&!Ou[t[r+1]]||u&&Ca(u)&&!Ou[t[r-1]]||!Ou[t[r]]?t[r]:Ou[t[r]]}return e}(this.text)},aa.prototype.trim=function(){for(var t=0,e=0;e<this.text.length&&_c[this.text.charCodeAt(e)];e++)t++;for(var r=this.text.length,o=this.text.length-1;o>=0&&o>=t&&_c[this.text.charCodeAt(o)];o--)r--;this.text=this.text.substring(t,r),this.sectionIndex=this.sectionIndex.slice(t,r)},aa.prototype.substring=function(t,e){var r=new aa;return r.text=this.text.substring(t,e),r.sectionIndex=this.sectionIndex.slice(t,e),r.sections=this.sections,r},aa.prototype.toString=function(){return this.text},aa.prototype.getMaxScale=function(){var t=this;return this.sectionIndex.reduce(function(e,r){return Math.max(e,t.sections[r].scale)},0)},aa.prototype.addTextSection=function(t,e){this.text+=t.text,this.sections.push(eu.forText(t.scale,t.fontStack||e));for(var r=this.sections.length-1,o=0;o<t.text.length;++o)this.sectionIndex.push(r)},aa.prototype.addImageSection=function(t){var e=t.image?t.image.name:"";if(e.length!==0){var r=this.getNextImageSectionCharCode();r?(this.text+=String.fromCharCode(r),this.sections.push(eu.forImage(e)),this.sectionIndex.push(this.sections.length-1)):Gt("Reached maximum number of images 6401")}else Gt("Can't add FormattedSection with an empty image.")},aa.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var _c={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Za={};function Gp(t,e,r,o,u,c){if(e.imageName){var h=o[e.imageName];return h?h.displaySize[0]*e.scale*24/c+u:0}var m=r[e.fontStack],v=m&&m[t];return v?v.metrics.advance*e.scale+u:0}function Hp(t,e,r,o){var u=Math.pow(t-e,2);return o?t<e?u/2:2*u:u+Math.abs(r)*r}function Nf(t,e,r){var o=0;return t===10&&(o-=1e4),r&&(o+=150),t!==40&&t!==65288||(o+=50),e!==41&&e!==65289||(o+=50),o}function Wp(t,e,r,o,u,c){for(var h=null,m=Hp(e,r,u,c),v=0,_=o;v<_.length;v+=1){var x=_[v],w=Hp(e-x.x,r,u,c)+x.badness;w<=m&&(h=x,m=w)}return{index:t,x:e,priorBreak:h,badness:m}}function ip(t,e,r,o,u,c,h){if(c!=="point")return[];if(!t)return[];for(var m,v=[],_=function(J,H,at,st,dt,mt){for(var zt=0,Ot=0;Ot<J.length();Ot++){var Zt=J.getSection(Ot);zt+=Gp(J.getCharCode(Ot),Zt,st,dt,H,mt)}return zt/Math.max(1,Math.ceil(zt/at))}(t,e,r,o,u,h),x=t.text.indexOf("\u200B")>=0,w=0,E=0;E<t.length();E++){var z=t.getSection(E),O=t.getCharCode(E);if(_c[O]||(w+=Gp(O,z,o,u,e,h)),E<t.length()-1){var F=!((m=O)<11904||!(ie["Bopomofo Extended"](m)||ie.Bopomofo(m)||ie["CJK Compatibility Forms"](m)||ie["CJK Compatibility Ideographs"](m)||ie["CJK Compatibility"](m)||ie["CJK Radicals Supplement"](m)||ie["CJK Strokes"](m)||ie["CJK Symbols and Punctuation"](m)||ie["CJK Unified Ideographs Extension A"](m)||ie["CJK Unified Ideographs"](m)||ie["Enclosed CJK Letters and Months"](m)||ie["Halfwidth and Fullwidth Forms"](m)||ie.Hiragana(m)||ie["Ideographic Description Characters"](m)||ie["Kangxi Radicals"](m)||ie["Katakana Phonetic Extensions"](m)||ie.Katakana(m)||ie["Vertical Forms"](m)||ie["Yi Radicals"](m)||ie["Yi Syllables"](m)));(Za[O]||F||z.imageName)&&v.push(Wp(E+1,w,_,v,Nf(O,t.getCharCode(E+1),F&&x),!1))}}return function J(H){return H?J(H.priorBreak).concat(H.index):[]}(Wp(t.length(),w,_,v,0,!0))}function np(t){var e=.5,r=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:e,verticalAlign:r}}function jf(t,e,r,o,u){if(o||u)for(var c=t[r],h=(t[r].x+c.metrics.advance*c.scale)*o,m=e;m<=r;m++)t[m].x-=h,t[m].y+=u}function Xp(t,e,r,o,u,c){var h,m=t.image;if(m.content){var v=m.content,_=m.pixelRatio||1;h=[v[0]/_,v[1]/_,m.displaySize[0]-v[2]/_,m.displaySize[1]-v[3]/_]}var x,w,E,z,O=e.left*c,F=e.right*c;r==="width"||r==="both"?(z=u[0]+O-o[3],w=u[0]+F+o[1]):w=(z=u[0]+(O+F-m.displaySize[0])/2)+m.displaySize[0];var J=e.top*c,H=e.bottom*c;return r==="height"||r==="both"?(x=u[1]+J-o[0],E=u[1]+H+o[2]):E=(x=u[1]+(J+H-m.displaySize[1])/2)+m.displaySize[1],{image:m,top:x,right:w,bottom:E,left:z,collisionPadding:h}}Za[10]=!0,Za[32]=!0,Za[38]=!0,Za[40]=!0,Za[41]=!0,Za[43]=!0,Za[45]=!0,Za[47]=!0,Za[173]=!0,Za[183]=!0,Za[8203]=!0,Za[8208]=!0,Za[8211]=!0,Za[8231]=!0;var ru=function(t){function e(r,o,u,c){t.call(this,r,o),this.angle=u,c!==void 0&&(this.segment=c)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.clone=function(){return new e(this.x,this.y,this.angle,this.segment)},e}(Vt);function ap(t,e){var r=e.expression;if(r.kind==="constant")return{kind:"constant",layoutSize:r.evaluate(new rr(t+1))};if(r.kind==="source")return{kind:"source"};for(var o=r.zoomStops,u=r.interpolationType,c=0;c<o.length&&o[c]<=t;)c++;for(var h=c=Math.max(0,c-1);h<o.length&&o[h]<t+1;)h++;h=Math.min(o.length-1,h);var m=o[c],v=o[h];return r.kind==="composite"?{kind:"composite",minZoom:m,maxZoom:v,interpolationType:u}:{kind:"camera",minZoom:m,maxZoom:v,minSize:r.evaluate(new rr(m)),maxSize:r.evaluate(new rr(v)),interpolationType:u}}function Kp(t,e,r){var o=e.uSize,u=r.lowerSize;return t.kind==="source"?u/128:t.kind==="composite"?ni(u/128,r.upperSize/128,e.uSizeT):o}function Yp(t,e){var r=0,o=0;if(t.kind==="constant")o=t.layoutSize;else if(t.kind!=="source"){var u=t.interpolationType,c=u?Lt(ur.interpolationFactor(u,e,t.minZoom,t.maxZoom),0,1):0;t.kind==="camera"?o=ni(t.minSize,t.maxSize,c):r=c}return{uSizeT:r,uSize:o}}re("Anchor",ru);var qf=Object.freeze({__proto__:null,getSizeData:ap,evaluateSizeForFeature:Kp,evaluateSizeForZoom:Yp,SIZE_PACK_FACTOR:128});function Jp(t,e,r,o,u){if(e.segment===void 0)return!0;for(var c=e,h=e.segment+1,m=0;m>-r/2;){if(--h<0)return!1;m-=t[h].dist(c),c=t[h]}m+=t[h].dist(t[h+1]),h++;for(var v=[],_=0;m<r/2;){var x=t[h],w=t[h+1];if(!w)return!1;var E=t[h-1].angleTo(x)-x.angleTo(w);for(E=Math.abs((E+3*Math.PI)%(2*Math.PI)-Math.PI),v.push({distance:m,angleDelta:E}),_+=E;m-v[0].distance>o;)_-=v.shift().angleDelta;if(_>u)return!1;h++,m+=x.dist(w)}return!0}function Qp(t){for(var e=0,r=0;r<t.length-1;r++)e+=t[r].dist(t[r+1]);return e}function $p(t,e,r){return t?.6*e*r:0}function th(t,e){return Math.max(t?t.right-t.left:0,e?e.right-e.left:0)}function Zf(t,e,r,o,u,c){for(var h=$p(r,u,c),m=th(r,o)*c,v=0,_=Qp(t)/2,x=0;x<t.length-1;x++){var w=t[x],E=t[x+1],z=w.dist(E);if(v+z>_){var O=(_-v)/z,F=ni(w.x,E.x,O),J=ni(w.y,E.y,O),H=new ru(F,J,E.angleTo(w),x);return H._round(),!h||Jp(t,H,m,h,e)?H:void 0}v+=z}}function Gf(t,e,r,o,u,c,h,m,v){var _=$p(o,c,h),x=th(o,u),w=x*h,E=t[0].x===0||t[0].x===v||t[0].y===0||t[0].y===v;return e-w<e/4&&(e=w+e/4),function z(O,F,J,H,at,st,dt,mt,zt){for(var Ot=st/2,Zt=Qp(O),ve=0,Wt=F-J,xe=[],Qt=0;Qt<O.length-1;Qt++){for(var Je=O[Qt],Le=O[Qt+1],fe=Je.dist(Le),ir=Le.angleTo(Je);Wt+J<ve+fe;){var qe=((Wt+=J)-ve)/fe,vr=ni(Je.x,Le.x,qe),we=ni(Je.y,Le.y,qe);if(vr>=0&&vr<zt&&we>=0&&we<zt&&Wt-Ot>=0&&Wt+Ot<=Zt){var Ar=new ru(vr,we,ir,Qt);Ar._round(),H&&!Jp(O,Ar,st,H,at)||xe.push(Ar)}}ve+=fe}return mt||xe.length||dt||(xe=z(O,ve/2,J,H,at,st,dt,!0,zt)),xe}(t,E?e/2*m%e:(x/2+2*c)*h*m%e,e,_,r,w,E,!1,v)}function eh(t,e,r,o,u){for(var c=[],h=0;h<t.length;h++)for(var m=t[h],v=void 0,_=0;_<m.length-1;_++){var x=m[_],w=m[_+1];x.x<e&&w.x<e||(x.x<e?x=new Vt(e,x.y+(e-x.x)/(w.x-x.x)*(w.y-x.y))._round():w.x<e&&(w=new Vt(e,x.y+(e-x.x)/(w.x-x.x)*(w.y-x.y))._round()),x.y<r&&w.y<r||(x.y<r?x=new Vt(x.x+(r-x.y)/(w.y-x.y)*(w.x-x.x),r)._round():w.y<r&&(w=new Vt(x.x+(r-x.y)/(w.y-x.y)*(w.x-x.x),r)._round()),x.x>=o&&w.x>=o||(x.x>=o?x=new Vt(o,x.y+(o-x.x)/(w.x-x.x)*(w.y-x.y))._round():w.x>=o&&(w=new Vt(o,x.y+(o-x.x)/(w.x-x.x)*(w.y-x.y))._round()),x.y>=u&&w.y>=u||(x.y>=u?x=new Vt(x.x+(u-x.y)/(w.y-x.y)*(w.x-x.x),u)._round():w.y>=u&&(w=new Vt(x.x+(u-x.y)/(w.y-x.y)*(w.x-x.x),u)._round()),v&&x.equals(v[v.length-1])||c.push(v=[x]),v.push(w)))))}return c}function rh(t,e,r,o){var u=[],c=t.image,h=c.pixelRatio,m=c.paddedRect.w-2,v=c.paddedRect.h-2,_=t.right-t.left,x=t.bottom-t.top,w=c.stretchX||[[0,m]],E=c.stretchY||[[0,v]],z=function(vr,we){return vr+we[1]-we[0]},O=w.reduce(z,0),F=E.reduce(z,0),J=m-O,H=v-F,at=0,st=O,dt=0,mt=F,zt=0,Ot=J,Zt=0,ve=H;if(c.content&&o){var Wt=c.content;at=gc(w,0,Wt[0]),dt=gc(E,0,Wt[1]),st=gc(w,Wt[0],Wt[2]),mt=gc(E,Wt[1],Wt[3]),zt=Wt[0]-at,Zt=Wt[1]-dt,Ot=Wt[2]-Wt[0]-st,ve=Wt[3]-Wt[1]-mt}var xe=function(vr,we,Ar,Ai){var Ni=xc(vr.stretch-at,st,_,t.left),Ri=bc(vr.fixed-zt,Ot,vr.stretch,O),Ci=xc(we.stretch-dt,mt,x,t.top),ji=bc(we.fixed-Zt,ve,we.stretch,F),gn=xc(Ar.stretch-at,st,_,t.left),xn=bc(Ar.fixed-zt,Ot,Ar.stretch,O),oa=xc(Ai.stretch-dt,mt,x,t.top),An=bc(Ai.fixed-Zt,ve,Ai.stretch,F),sa=new Vt(Ni,Ci),Xi=new Vt(gn,Ci),Cn=new Vt(gn,oa),or=new Vt(Ni,oa),ti=new Vt(Ri/h,ji/h),Zr=new Vt(xn/h,An/h),br=e*Math.PI/180;if(br){var ba=Math.sin(br),Wn=Math.cos(br),wi=[Wn,-ba,ba,Wn];sa._matMult(wi),Xi._matMult(wi),or._matMult(wi),Cn._matMult(wi)}var rn=vr.stretch+vr.fixed,Xn=we.stretch+we.fixed;return{tl:sa,tr:Xi,bl:or,br:Cn,tex:{x:c.paddedRect.x+1+rn,y:c.paddedRect.y+1+Xn,w:Ar.stretch+Ar.fixed-rn,h:Ai.stretch+Ai.fixed-Xn},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:ti,pixelOffsetBR:Zr,minFontScaleX:Ot/h/_,minFontScaleY:ve/h/x,isSDF:r}};if(o&&(c.stretchX||c.stretchY))for(var Qt=ih(w,J,O),Je=ih(E,H,F),Le=0;Le<Qt.length-1;Le++)for(var fe=Qt[Le],ir=Qt[Le+1],qe=0;qe<Je.length-1;qe++)u.push(xe(fe,Je[qe],ir,Je[qe+1]));else u.push(xe({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:m+1},{fixed:0,stretch:v+1}));return u}function gc(t,e,r){for(var o=0,u=0,c=t;u<c.length;u+=1){var h=c[u];o+=Math.max(e,Math.min(r,h[1]))-Math.max(e,Math.min(r,h[0]))}return o}function ih(t,e,r){for(var o=[{fixed:-1,stretch:0}],u=0,c=t;u<c.length;u+=1){var h=c[u],m=h[0],v=h[1],_=o[o.length-1];o.push({fixed:m-_.stretch,stretch:_.stretch}),o.push({fixed:m-_.stretch,stretch:_.stretch+(v-m)})}return o.push({fixed:e+1,stretch:r}),o}function xc(t,e,r,o){return t/e*r+o}function bc(t,e,r,o){return t-e*r/o}var wc=function(t,e,r,o,u,c,h,m,v,_){if(this.boxStartIndex=t.length,v){var x=c.top,w=c.bottom,E=c.collisionPadding;E&&(x-=E[1],w+=E[3]);var z=w-x;z>0&&(z=Math.max(10,z),this.circleDiameter=z)}else{var O=c.top*h-m,F=c.bottom*h+m,J=c.left*h-m,H=c.right*h+m,at=c.collisionPadding;if(at&&(J-=at[0]*h,O-=at[1]*h,H+=at[2]*h,F+=at[3]*h),_){var st=new Vt(J,O),dt=new Vt(H,O),mt=new Vt(J,F),zt=new Vt(H,F),Ot=_*Math.PI/180;st._rotate(Ot),dt._rotate(Ot),mt._rotate(Ot),zt._rotate(Ot),J=Math.min(st.x,dt.x,mt.x,zt.x),H=Math.max(st.x,dt.x,mt.x,zt.x),O=Math.min(st.y,dt.y,mt.y,zt.y),F=Math.max(st.y,dt.y,mt.y,zt.y)}t.emplaceBack(e.x,e.y,J,O,H,F,r,o,u)}this.boxEndIndex=t.length},iu=function(t,e){if(t===void 0&&(t=[]),e===void 0&&(e=Hf),this.data=t,this.length=this.data.length,this.compare=e,this.length>0)for(var r=(this.length>>1)-1;r>=0;r--)this._down(r)};function Hf(t,e){return t<e?-1:t>e?1:0}function Wf(t,e,r){e===void 0&&(e=1),r===void 0&&(r=!1);for(var o=1/0,u=1/0,c=-1/0,h=-1/0,m=t[0],v=0;v<m.length;v++){var _=m[v];(!v||_.x<o)&&(o=_.x),(!v||_.y<u)&&(u=_.y),(!v||_.x>c)&&(c=_.x),(!v||_.y>h)&&(h=_.y)}var x=Math.min(c-o,h-u),w=x/2,E=new iu([],Xf);if(x===0)return new Vt(o,u);for(var z=o;z<c;z+=x)for(var O=u;O<h;O+=x)E.push(new nu(z+w,O+w,w,t));for(var F=function(at){for(var st=0,dt=0,mt=0,zt=at[0],Ot=0,Zt=zt.length,ve=Zt-1;Ot<Zt;ve=Ot++){var Wt=zt[Ot],xe=zt[ve],Qt=Wt.x*xe.y-xe.x*Wt.y;dt+=(Wt.x+xe.x)*Qt,mt+=(Wt.y+xe.y)*Qt,st+=3*Qt}return new nu(dt/st,mt/st,0,at)}(t),J=E.length;E.length;){var H=E.pop();(H.d>F.d||!F.d)&&(F=H,r&&console.log("found best %d after %d probes",Math.round(1e4*H.d)/1e4,J)),H.max-F.d<=e||(E.push(new nu(H.p.x-(w=H.h/2),H.p.y-w,w,t)),E.push(new nu(H.p.x+w,H.p.y-w,w,t)),E.push(new nu(H.p.x-w,H.p.y+w,w,t)),E.push(new nu(H.p.x+w,H.p.y+w,w,t)),J+=4)}return r&&(console.log("num probes: "+J),console.log("best distance: "+F.d)),F.p}function Xf(t,e){return e.max-t.max}function nu(t,e,r,o){this.p=new Vt(t,e),this.h=r,this.d=function(u,c){for(var h=!1,m=1/0,v=0;v<c.length;v++)for(var _=c[v],x=0,w=_.length,E=w-1;x<w;E=x++){var z=_[x],O=_[E];z.y>u.y!=O.y>u.y&&u.x<(O.x-z.x)*(u.y-z.y)/(O.y-z.y)+z.x&&(h=!h),m=Math.min(m,ia(u,z,O))}return(h?1:-1)*Math.sqrt(m)}(this.p,o),this.max=this.d+this.h*Math.SQRT2}iu.prototype.push=function(t){this.data.push(t),this.length++,this._up(this.length-1)},iu.prototype.pop=function(){if(this.length!==0){var t=this.data[0],e=this.data.pop();return this.length--,this.length>0&&(this.data[0]=e,this._down(0)),t}},iu.prototype.peek=function(){return this.data[0]},iu.prototype._up=function(t){for(var e=this.data,r=this.compare,o=e[t];t>0;){var u=t-1>>1,c=e[u];if(r(o,c)>=0)break;e[t]=c,t=u}e[t]=o},iu.prototype._down=function(t){for(var e=this.data,r=this.compare,o=this.length>>1,u=e[t];t<o;){var c=1+(t<<1),h=e[c],m=c+1;if(m<this.length&&r(e[m],h)<0&&(c=m,h=e[m]),r(h,u)>=0)break;e[t]=h,t=c}e[t]=u};var op=Number.POSITIVE_INFINITY;function nh(t,e){return e[1]!==op?function(r,o,u){var c=0,h=0;switch(o=Math.abs(o),u=Math.abs(u),r){case"top-right":case"top-left":case"top":h=u-7;break;case"bottom-right":case"bottom-left":case"bottom":h=7-u}switch(r){case"top-right":case"bottom-right":case"right":c=-o;break;case"top-left":case"bottom-left":case"left":c=o}return[c,h]}(t,e[0],e[1]):function(r,o){var u=0,c=0;o<0&&(o=0);var h=o/Math.sqrt(2);switch(r){case"top-right":case"top-left":c=h-7;break;case"bottom-right":case"bottom-left":c=7-h;break;case"bottom":c=7-o;break;case"top":c=o-7}switch(r){case"top-right":case"bottom-right":u=-h;break;case"top-left":case"bottom-left":u=h;break;case"left":u=o;break;case"right":u=-o}return[u,c]}(t,e[0])}function sp(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function ah(t,e,r,o,u,c,h,m,v,_,x,w,E,z,O){var F=function(dt,mt,zt,Ot,Zt,ve,Wt,xe){for(var Qt=Ot.layout.get("text-rotate").evaluate(ve,{})*Math.PI/180,Je=[],Le=0,fe=mt.positionedLines;Le<fe.length;Le+=1)for(var ir=fe[Le],qe=0,vr=ir.positionedGlyphs;qe<vr.length;qe+=1){var we=vr[qe];if(we.rect){var Ar=we.rect||{},Ai=4,Ni=!0,Ri=1,Ci=0,ji=(Zt||xe)&&we.vertical,gn=we.metrics.advance*we.scale/2;if(xe&&mt.verticalizable&&(Ci=ir.lineOffset/2-(we.imageName?-(24-we.metrics.width*we.scale)/2:24*(we.scale-1))),we.imageName){var xn=Wt[we.imageName];Ni=xn.sdf,Ai=1/(Ri=xn.pixelRatio)}var oa=Zt?[we.x+gn,we.y]:[0,0],An=Zt?[0,0]:[we.x+gn+zt[0],we.y+zt[1]-Ci],sa=[0,0];ji&&(sa=An,An=[0,0]);var Xi=(we.metrics.left-Ai)*we.scale-gn+An[0],Cn=(-we.metrics.top-Ai)*we.scale+An[1],or=Xi+Ar.w*we.scale/Ri,ti=Cn+Ar.h*we.scale/Ri,Zr=new Vt(Xi,Cn),br=new Vt(or,Cn),ba=new Vt(Xi,ti),Wn=new Vt(or,ti);if(ji){var wi=new Vt(-gn,gn- -17),rn=-Math.PI/2,Xn=12-gn,Cr=new Vt(22-Xn,-(we.imageName?Xn:0)),ys=new(Function.prototype.bind.apply(Vt,[null].concat(sa)));Zr._rotateAround(rn,wi)._add(Cr)._add(ys),br._rotateAround(rn,wi)._add(Cr)._add(ys),ba._rotateAround(rn,wi)._add(Cr)._add(ys),Wn._rotateAround(rn,wi)._add(Cr)._add(ys)}if(Qt){var io=Math.sin(Qt),vs=Math.cos(Qt),Ki=[vs,-io,io,vs];Zr._matMult(Ki),br._matMult(Ki),ba._matMult(Ki),Wn._matMult(Ki)}var _s=new Vt(0,0),Lo=new Vt(0,0);Je.push({tl:Zr,tr:br,bl:ba,br:Wn,tex:Ar,writingMode:mt.writingMode,glyphOffset:oa,sectionIndex:we.sectionIndex,isSDF:Ni,pixelOffsetTL:_s,pixelOffsetBR:Lo,minFontScaleX:0,minFontScaleY:0})}}return Je}(0,r,m,u,c,h,o,t.allowVerticalPlacement),J=t.textSizeData,H=null;J.kind==="source"?(H=[128*u.layout.get("text-size").evaluate(h,{})])[0]>32640&&Gt(t.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):J.kind==="composite"&&((H=[128*z.compositeTextSizes[0].evaluate(h,{},O),128*z.compositeTextSizes[1].evaluate(h,{},O)])[0]>32640||H[1]>32640)&&Gt(t.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),t.addSymbols(t.text,F,H,m,c,h,_,e,v.lineStartIndex,v.lineLength,E,O);for(var at=0,st=x;at<st.length;at+=1)w[st[at]]=t.text.placedSymbolArray.length-1;return 4*F.length}function oh(t){for(var e in t)return t[e];return null}function Kf(t,e,r,o){var u=t.compareText;if(e in u){for(var c=u[e],h=c.length-1;h>=0;h--)if(o.dist(c[h])<r)return!0}else u[e]=[];return u[e].push(o),!1}var Yf=ml.VectorTileFeature.types,Jf=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Sc(t,e,r,o,u,c,h,m,v,_,x,w,E){var z=m?Math.min(32640,Math.round(m[0])):0,O=m?Math.min(32640,Math.round(m[1])):0;t.emplaceBack(e,r,Math.round(32*o),Math.round(32*u),c,h,(z<<1)+(v?1:0),O,16*_,16*x,256*w,256*E)}function lp(t,e,r){t.emplaceBack(e.x,e.y,r),t.emplaceBack(e.x,e.y,r),t.emplaceBack(e.x,e.y,r),t.emplaceBack(e.x,e.y,r)}function Qf(t){for(var e=0,r=t.sections;e<r.length;e+=1)if(ll(r[e].text))return!0;return!1}var au=function(t){this.layoutVertexArray=new Ui,this.indexArray=new nt,this.programConfigurations=t,this.segments=new A,this.dynamicLayoutVertexArray=new On,this.opacityVertexArray=new qa,this.placedSymbolArray=new p};au.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},au.prototype.upload=function(t,e,r,o){this.isEmpty()||(r&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Tf.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,e),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,Ef.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,Jf,!0),this.opacityVertexBuffer.itemSize=1),(r||o)&&this.programConfigurations.upload(t))},au.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},re("SymbolBuffers",au);var Vu=function(t,e,r){this.layoutVertexArray=new t,this.layoutAttributes=e,this.indexArray=new r,this.segments=new A,this.collisionVertexArray=new Q};Vu.prototype.upload=function(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,If.members,!0)},Vu.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},re("CollisionBuffers",Vu);var Yr=function(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(c){return c.id}),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=cr([]),this.placementViewportMatrix=cr([]);var e=this.layers[0]._unevaluatedLayout._values;this.textSizeData=ap(this.zoom,e["text-size"]),this.iconSizeData=ap(this.zoom,e["icon-size"]);var r=this.layers[0].layout,o=r.get("symbol-sort-key"),u=r.get("symbol-z-order");this.canOverlap=r.get("text-allow-overlap")||r.get("icon-allow-overlap")||r.get("text-ignore-placement")||r.get("icon-ignore-placement"),this.sortFeaturesByKey=u!=="viewport-y"&&!o.isConstant(),this.sortFeaturesByY=(u==="viewport-y"||u==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,r.get("symbol-placement")==="point"&&(this.writingModes=r.get("text-writing-mode").map(function(c){return ro[c]})),this.stateDependentLayerIds=this.layers.filter(function(c){return c.isStateDependent()}).map(function(c){return c.id}),this.sourceID=t.sourceID};Yr.prototype.createArrays=function(){this.text=new au(new He(this.layers,this.zoom,function(t){return/^text/.test(t)})),this.icon=new au(new He(this.layers,this.zoom,function(t){return/^icon/.test(t)})),this.glyphOffsetArray=new y,this.lineVertexArray=new g,this.symbolInstances=new d},Yr.prototype.calculateGlyphDependencies=function(t,e,r,o,u){for(var c=0;c<t.length;c++)if(e[t.charCodeAt(c)]=!0,(r||o)&&u){var h=Ou[t.charAt(c)];h&&(e[h.charCodeAt(0)]=!0)}},Yr.prototype.populate=function(t,e,r){var o=this.layers[0],u=o.layout,c=u.get("text-font"),h=u.get("text-field"),m=u.get("icon-image"),v=(h.value.kind!=="constant"||h.value.value instanceof $i&&!h.value.value.isEmpty()||h.value.value.toString().length>0)&&(c.value.kind!=="constant"||c.value.value.length>0),_=m.value.kind!=="constant"||!!m.value.value||Object.keys(m.parameters).length>0,x=u.get("symbol-sort-key");if(this.features=[],v||_){for(var w=e.iconDependencies,E=e.glyphDependencies,z=e.availableImages,O=new rr(this.zoom),F=0,J=t;F<J.length;F+=1){var H=J[F],at=H.feature,st=H.id,dt=H.index,mt=H.sourceLayerIndex,zt=o._featureFilter.needGeometry,Ot=bi(at,zt);if(o._featureFilter.filter(O,Ot,r)){zt||(Ot.geometry=jr(at));var Zt=void 0;if(v){var ve=o.getValueAndResolveTokens("text-field",Ot,r,z),Wt=$i.factory(ve);Qf(Wt)&&(this.hasRTLText=!0),(!this.hasRTLText||ma()==="unavailable"||this.hasRTLText&&hi.isParsed())&&(Zt=Cf(Wt,o,Ot))}var xe=void 0;if(_){var Qt=o.getValueAndResolveTokens("icon-image",Ot,r,z);xe=Qt instanceof Pn?Qt:Pn.fromString(Qt)}if(Zt||xe){var Je=this.sortFeaturesByKey?x.evaluate(Ot,{},r):void 0;if(this.features.push({id:st,text:Zt,icon:xe,index:dt,sourceLayerIndex:mt,geometry:Ot.geometry,properties:at.properties,type:Yf[at.type],sortKey:Je}),xe&&(w[xe.name]=!0),Zt){var Le=c.evaluate(Ot,{},r).join(","),fe=u.get("text-rotation-alignment")==="map"&&u.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(ro.vertical)>=0;for(var ir=0,qe=Zt.sections;ir<qe.length;ir+=1){var vr=qe[ir];if(vr.image)w[vr.image.name]=!0;else{var we=Us(Zt.toString()),Ar=vr.fontStack||Le,Ai=E[Ar]=E[Ar]||{};this.calculateGlyphDependencies(vr.text,Ai,fe,this.allowVerticalPlacement,we)}}}}}}u.get("symbol-placement")==="line"&&(this.features=function(Ni){var Ri={},Ci={},ji=[],gn=0;function xn(wi){ji.push(Ni[wi]),gn++}function oa(wi,rn,Xn){var Cr=Ci[wi];return delete Ci[wi],Ci[rn]=Cr,ji[Cr].geometry[0].pop(),ji[Cr].geometry[0]=ji[Cr].geometry[0].concat(Xn[0]),Cr}function An(wi,rn,Xn){var Cr=Ri[rn];return delete Ri[rn],Ri[wi]=Cr,ji[Cr].geometry[0].shift(),ji[Cr].geometry[0]=Xn[0].concat(ji[Cr].geometry[0]),Cr}function sa(wi,rn,Xn){var Cr=Xn?rn[0][rn[0].length-1]:rn[0][0];return wi+":"+Cr.x+":"+Cr.y}for(var Xi=0;Xi<Ni.length;Xi++){var Cn=Ni[Xi],or=Cn.geometry,ti=Cn.text?Cn.text.toString():null;if(ti){var Zr=sa(ti,or),br=sa(ti,or,!0);if(Zr in Ci&&br in Ri&&Ci[Zr]!==Ri[br]){var ba=An(Zr,br,or),Wn=oa(Zr,br,ji[ba].geometry);delete Ri[Zr],delete Ci[br],Ci[sa(ti,ji[Wn].geometry,!0)]=Wn,ji[ba].geometry=null}else Zr in Ci?oa(Zr,br,or):br in Ri?An(Zr,br,or):(xn(Xi),Ri[Zr]=gn-1,Ci[br]=gn-1)}else xn(Xi)}return ji.filter(function(wi){return wi.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(Ni,Ri){return Ni.sortKey-Ri.sortKey})}},Yr.prototype.update=function(t,e,r){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,e,this.layers,r),this.icon.programConfigurations.updatePaintArrays(t,e,this.layers,r))},Yr.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},Yr.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},Yr.prototype.upload=function(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},Yr.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},Yr.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},Yr.prototype.addToLineVertexArray=function(t,e){var r=this.lineVertexArray.length;if(t.segment!==void 0){for(var o=t.dist(e[t.segment+1]),u=t.dist(e[t.segment]),c={},h=t.segment+1;h<e.length;h++)c[h]={x:e[h].x,y:e[h].y,tileUnitDistanceFromAnchor:o},h<e.length-1&&(o+=e[h+1].dist(e[h]));for(var m=t.segment||0;m>=0;m--)c[m]={x:e[m].x,y:e[m].y,tileUnitDistanceFromAnchor:u},m>0&&(u+=e[m-1].dist(e[m]));for(var v=0;v<e.length;v++){var _=c[v];this.lineVertexArray.emplaceBack(_.x,_.y,_.tileUnitDistanceFromAnchor)}}return{lineStartIndex:r,lineLength:this.lineVertexArray.length-r}},Yr.prototype.addSymbols=function(t,e,r,o,u,c,h,m,v,_,x,w){for(var E=t.indexArray,z=t.layoutVertexArray,O=t.segments.prepareSegment(4*e.length,z,E,this.canOverlap?c.sortKey:void 0),F=this.glyphOffsetArray.length,J=O.vertexLength,H=this.allowVerticalPlacement&&h===ro.vertical?Math.PI/2:0,at=c.text&&c.text.sections,st=0;st<e.length;st++){var dt=e[st],mt=dt.tl,zt=dt.tr,Ot=dt.bl,Zt=dt.br,ve=dt.tex,Wt=dt.pixelOffsetTL,xe=dt.pixelOffsetBR,Qt=dt.minFontScaleX,Je=dt.minFontScaleY,Le=dt.glyphOffset,fe=dt.isSDF,ir=dt.sectionIndex,qe=O.vertexLength,vr=Le[1];Sc(z,m.x,m.y,mt.x,vr+mt.y,ve.x,ve.y,r,fe,Wt.x,Wt.y,Qt,Je),Sc(z,m.x,m.y,zt.x,vr+zt.y,ve.x+ve.w,ve.y,r,fe,xe.x,Wt.y,Qt,Je),Sc(z,m.x,m.y,Ot.x,vr+Ot.y,ve.x,ve.y+ve.h,r,fe,Wt.x,xe.y,Qt,Je),Sc(z,m.x,m.y,Zt.x,vr+Zt.y,ve.x+ve.w,ve.y+ve.h,r,fe,xe.x,xe.y,Qt,Je),lp(t.dynamicLayoutVertexArray,m,H),E.emplaceBack(qe,qe+1,qe+2),E.emplaceBack(qe+1,qe+2,qe+3),O.vertexLength+=4,O.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Le[0]),st!==e.length-1&&ir===e[st+1].sectionIndex||t.programConfigurations.populatePaintArrays(z.length,c,c.index,{},w,at&&at[ir])}t.placedSymbolArray.emplaceBack(m.x,m.y,F,this.glyphOffsetArray.length-F,J,v,_,m.segment,r?r[0]:0,r?r[1]:0,o[0],o[1],h,0,!1,0,x)},Yr.prototype._addCollisionDebugVertex=function(t,e,r,o,u,c){return e.emplaceBack(0,0),t.emplaceBack(r.x,r.y,o,u,Math.round(c.x),Math.round(c.y))},Yr.prototype.addCollisionDebugVertices=function(t,e,r,o,u,c,h){var m=u.segments.prepareSegment(4,u.layoutVertexArray,u.indexArray),v=m.vertexLength,_=u.layoutVertexArray,x=u.collisionVertexArray,w=h.anchorX,E=h.anchorY;this._addCollisionDebugVertex(_,x,c,w,E,new Vt(t,e)),this._addCollisionDebugVertex(_,x,c,w,E,new Vt(r,e)),this._addCollisionDebugVertex(_,x,c,w,E,new Vt(r,o)),this._addCollisionDebugVertex(_,x,c,w,E,new Vt(t,o)),m.vertexLength+=4;var z=u.indexArray;z.emplaceBack(v,v+1),z.emplaceBack(v+1,v+2),z.emplaceBack(v+2,v+3),z.emplaceBack(v+3,v),m.primitiveLength+=4},Yr.prototype.addDebugCollisionBoxes=function(t,e,r,o){for(var u=t;u<e;u++){var c=this.collisionBoxArray.get(u);this.addCollisionDebugVertices(c.x1,c.y1,c.x2,c.y2,o?this.textCollisionBox:this.iconCollisionBox,c.anchorPoint,r)}},Yr.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Vu(ko,Fp.members,Ht),this.iconCollisionBox=new Vu(ko,Fp.members,Ht);for(var t=0;t<this.symbolInstances.length;t++){var e=this.symbolInstances.get(t);this.addDebugCollisionBoxes(e.textBoxStartIndex,e.textBoxEndIndex,e,!0),this.addDebugCollisionBoxes(e.verticalTextBoxStartIndex,e.verticalTextBoxEndIndex,e,!0),this.addDebugCollisionBoxes(e.iconBoxStartIndex,e.iconBoxEndIndex,e,!1),this.addDebugCollisionBoxes(e.verticalIconBoxStartIndex,e.verticalIconBoxEndIndex,e,!1)}},Yr.prototype._deserializeCollisionBoxesForSymbol=function(t,e,r,o,u,c,h,m,v){for(var _={},x=e;x<r;x++){var w=t.get(x);_.textBox={x1:w.x1,y1:w.y1,x2:w.x2,y2:w.y2,anchorPointX:w.anchorPointX,anchorPointY:w.anchorPointY},_.textFeatureIndex=w.featureIndex;break}for(var E=o;E<u;E++){var z=t.get(E);_.verticalTextBox={x1:z.x1,y1:z.y1,x2:z.x2,y2:z.y2,anchorPointX:z.anchorPointX,anchorPointY:z.anchorPointY},_.verticalTextFeatureIndex=z.featureIndex;break}for(var O=c;O<h;O++){var F=t.get(O);_.iconBox={x1:F.x1,y1:F.y1,x2:F.x2,y2:F.y2,anchorPointX:F.anchorPointX,anchorPointY:F.anchorPointY},_.iconFeatureIndex=F.featureIndex;break}for(var J=m;J<v;J++){var H=t.get(J);_.verticalIconBox={x1:H.x1,y1:H.y1,x2:H.x2,y2:H.y2,anchorPointX:H.anchorPointX,anchorPointY:H.anchorPointY},_.verticalIconFeatureIndex=H.featureIndex;break}return _},Yr.prototype.deserializeCollisionBoxes=function(t){this.collisionArrays=[];for(var e=0;e<this.symbolInstances.length;e++){var r=this.symbolInstances.get(e);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,r.textBoxStartIndex,r.textBoxEndIndex,r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r.iconBoxStartIndex,r.iconBoxEndIndex,r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex))}},Yr.prototype.hasTextData=function(){return this.text.segments.get().length>0},Yr.prototype.hasIconData=function(){return this.icon.segments.get().length>0},Yr.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},Yr.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},Yr.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},Yr.prototype.addIndicesForPlacedSymbol=function(t,e){for(var r=t.placedSymbolArray.get(e),o=r.vertexStartIndex+4*r.numGlyphs,u=r.vertexStartIndex;u<o;u+=4)t.indexArray.emplaceBack(u,u+1,u+2),t.indexArray.emplaceBack(u+1,u+2,u+3)},Yr.prototype.getSortedSymbolIndexes=function(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var e=Math.sin(t),r=Math.cos(t),o=[],u=[],c=[],h=0;h<this.symbolInstances.length;++h){c.push(h);var m=this.symbolInstances.get(h);o.push(0|Math.round(e*m.anchorX+r*m.anchorY)),u.push(m.featureIndex)}return c.sort(function(v,_){return o[v]-o[_]||u[_]-u[v]}),c},Yr.prototype.addToSortKeyRanges=function(t,e){var r=this.sortKeyRanges[this.sortKeyRanges.length-1];r&&r.sortKey===e?r.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:e,symbolInstanceStart:t,symbolInstanceEnd:t+1})},Yr.prototype.sortFeatures=function(t){var e=this;if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var r=0,o=this.symbolInstanceIndexes;r<o.length;r+=1){var u=this.symbolInstances.get(o[r]);this.featureSortOrder.push(u.featureIndex),[u.rightJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.leftJustifiedTextSymbolIndex].forEach(function(c,h,m){c>=0&&m.indexOf(c)===h&&e.addIndicesForPlacedSymbol(e.text,c)}),u.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,u.verticalPlacedTextSymbolIndex),u.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,u.placedIconSymbolIndex),u.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,u.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},re("SymbolBucket",Yr,{omit:["layers","collisionBoxArray","features","compareText"]}),Yr.MAX_GLYPHS=65535,Yr.addDynamicAttributes=lp;var $f=new ea({"symbol-placement":new Kt(M.layout_symbol["symbol-placement"]),"symbol-spacing":new Kt(M.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Kt(M.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new De(M.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Kt(M.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Kt(M.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Kt(M.layout_symbol["icon-ignore-placement"]),"icon-optional":new Kt(M.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Kt(M.layout_symbol["icon-rotation-alignment"]),"icon-size":new De(M.layout_symbol["icon-size"]),"icon-text-fit":new Kt(M.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Kt(M.layout_symbol["icon-text-fit-padding"]),"icon-image":new De(M.layout_symbol["icon-image"]),"icon-rotate":new De(M.layout_symbol["icon-rotate"]),"icon-padding":new Kt(M.layout_symbol["icon-padding"]),"icon-keep-upright":new Kt(M.layout_symbol["icon-keep-upright"]),"icon-offset":new De(M.layout_symbol["icon-offset"]),"icon-anchor":new De(M.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Kt(M.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Kt(M.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Kt(M.layout_symbol["text-rotation-alignment"]),"text-field":new De(M.layout_symbol["text-field"]),"text-font":new De(M.layout_symbol["text-font"]),"text-size":new De(M.layout_symbol["text-size"]),"text-max-width":new De(M.layout_symbol["text-max-width"]),"text-line-height":new Kt(M.layout_symbol["text-line-height"]),"text-letter-spacing":new De(M.layout_symbol["text-letter-spacing"]),"text-justify":new De(M.layout_symbol["text-justify"]),"text-radial-offset":new De(M.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Kt(M.layout_symbol["text-variable-anchor"]),"text-anchor":new De(M.layout_symbol["text-anchor"]),"text-max-angle":new Kt(M.layout_symbol["text-max-angle"]),"text-writing-mode":new Kt(M.layout_symbol["text-writing-mode"]),"text-rotate":new De(M.layout_symbol["text-rotate"]),"text-padding":new Kt(M.layout_symbol["text-padding"]),"text-keep-upright":new Kt(M.layout_symbol["text-keep-upright"]),"text-transform":new De(M.layout_symbol["text-transform"]),"text-offset":new De(M.layout_symbol["text-offset"]),"text-allow-overlap":new Kt(M.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Kt(M.layout_symbol["text-ignore-placement"]),"text-optional":new Kt(M.layout_symbol["text-optional"])}),up={paint:new ea({"icon-opacity":new De(M.paint_symbol["icon-opacity"]),"icon-color":new De(M.paint_symbol["icon-color"]),"icon-halo-color":new De(M.paint_symbol["icon-halo-color"]),"icon-halo-width":new De(M.paint_symbol["icon-halo-width"]),"icon-halo-blur":new De(M.paint_symbol["icon-halo-blur"]),"icon-translate":new Kt(M.paint_symbol["icon-translate"]),"icon-translate-anchor":new Kt(M.paint_symbol["icon-translate-anchor"]),"text-opacity":new De(M.paint_symbol["text-opacity"]),"text-color":new De(M.paint_symbol["text-color"],{runtimeType:Ue,getOverride:function(t){return t.textColor},hasOverride:function(t){return!!t.textColor}}),"text-halo-color":new De(M.paint_symbol["text-halo-color"]),"text-halo-width":new De(M.paint_symbol["text-halo-width"]),"text-halo-blur":new De(M.paint_symbol["text-halo-blur"]),"text-translate":new Kt(M.paint_symbol["text-translate"]),"text-translate-anchor":new Kt(M.paint_symbol["text-translate-anchor"])}),layout:$f},ou=function(t){this.type=t.property.overrides?t.property.overrides.runtimeType:me,this.defaultValue=t};ou.prototype.evaluate=function(t){if(t.formattedSection){var e=this.defaultValue.property.overrides;if(e&&e.hasOverride(t.formattedSection))return e.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default},ou.prototype.eachChild=function(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)},ou.prototype.outputDefined=function(){return!1},ou.prototype.serialize=function(){return null},re("FormatSectionOverride",ou,{omit:["defaultValue"]});var td=function(t){function e(r){t.call(this,r,up)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.recalculate=function(r,o){if(t.prototype.recalculate.call(this,r,o),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var u=this.layout.get("text-writing-mode");if(u){for(var c=[],h=0,m=u;h<m.length;h+=1){var v=m[h];c.indexOf(v)<0&&c.push(v)}this.layout._values["text-writing-mode"]=c}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},e.prototype.getValueAndResolveTokens=function(r,o,u,c){var h=this.layout.get(r).evaluate(o,{},u,c),m=this._unevaluatedLayout._values[r];return m.isDataDriven()||Ms(m.value)||!h?h:function(v,_){return _.replace(/{([^{}]+)}/g,function(x,w){return w in v?String(v[w]):""})}(o.properties,h)},e.prototype.createBucket=function(r){return new Yr(r)},e.prototype.queryRadius=function(){return 0},e.prototype.queryIntersectsFeature=function(){return!1},e.prototype._setPaintOverrides=function(){for(var r=0,o=up.paint.overridableProperties;r<o.length;r+=1){var u=o[r];if(e.hasPaintOverride(this.layout,u)){var c,h=this.paint.get(u),m=new ou(h),v=new Eo(m,h.property.specification);c=h.value.kind==="constant"||h.value.kind==="source"?new ss("source",v):new Go("composite",v,h.value.zoomStops,h.value._interpolationType),this.paint._values[u]=new Ti(h.property,c,h.parameters)}}},e.prototype._handleOverridablePaintPropertyUpdate=function(r,o,u){return!(!this.layout||o.isDataDriven()||u.isDataDriven())&&e.hasPaintOverride(this.layout,r)},e.hasPaintOverride=function(r,o){var u=r.get("text-field"),c=up.paint.properties[o],h=!1,m=function(x){for(var w=0,E=x;w<E.length;w+=1)if(c.overrides&&c.overrides.hasOverride(E[w]))return void(h=!0)};if(u.value.kind==="constant"&&u.value.value instanceof $i)m(u.value.value.sections);else if(u.value.kind==="source"){var v=function(x){h||(x instanceof Kn&&Oi(x.value)===Me?m(x.value.sections):x instanceof Yn?m(x.sections):x.eachChild(v))},_=u.value;_._styleExpression&&v(_._styleExpression.expression)}return h},e}(Gi),ed={paint:new ea({"background-color":new Kt(M.paint_background["background-color"]),"background-pattern":new ta(M.paint_background["background-pattern"]),"background-opacity":new Kt(M.paint_background["background-opacity"])})},rd=function(t){function e(r){t.call(this,r,ed)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(Gi),id={paint:new ea({"raster-opacity":new Kt(M.paint_raster["raster-opacity"]),"raster-hue-rotate":new Kt(M.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Kt(M.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Kt(M.paint_raster["raster-brightness-max"]),"raster-saturation":new Kt(M.paint_raster["raster-saturation"]),"raster-contrast":new Kt(M.paint_raster["raster-contrast"]),"raster-resampling":new Kt(M.paint_raster["raster-resampling"]),"raster-fade-duration":new Kt(M.paint_raster["raster-fade-duration"])})},nd=function(t){function e(r){t.call(this,r,id)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(Gi),ad=function(t){function e(r){t.call(this,r,{}),this.implementation=r}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},e.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},e.prototype.recalculate=function(){},e.prototype.updateTransitions=function(){},e.prototype.hasTransition=function(){},e.prototype.serialize=function(){},e.prototype.onAdd=function(r){this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)},e.prototype.onRemove=function(r){this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)},e}(Gi),od={circle:ga,heatmap:Iu,hillshade:uc,fill:Zs,"fill-extrusion":vf,line:Sf,symbol:td,background:rd,raster:nd},sh=vt.HTMLImageElement,lh=vt.HTMLCanvasElement,uh=vt.HTMLVideoElement,ch=vt.ImageData,Tc=vt.ImageBitmap,Rl=function(t,e,r,o){this.context=t,this.format=r,this.texture=t.gl.createTexture(),this.update(e,o)};Rl.prototype.update=function(t,e,r){var o=t.width,u=t.height,c=!(this.size&&this.size[0]===o&&this.size[1]===u||r),h=this.context,m=h.gl;if(this.useMipmap=Boolean(e&&e.useMipmap),m.bindTexture(m.TEXTURE_2D,this.texture),h.pixelStoreUnpackFlipY.set(!1),h.pixelStoreUnpack.set(1),h.pixelStoreUnpackPremultiplyAlpha.set(this.format===m.RGBA&&(!e||e.premultiply!==!1)),c)this.size=[o,u],t instanceof sh||t instanceof lh||t instanceof uh||t instanceof ch||Tc&&t instanceof Tc?m.texImage2D(m.TEXTURE_2D,0,this.format,this.format,m.UNSIGNED_BYTE,t):m.texImage2D(m.TEXTURE_2D,0,this.format,o,u,0,this.format,m.UNSIGNED_BYTE,t.data);else{var v=r||{x:0,y:0},_=v.x,x=v.y;t instanceof sh||t instanceof lh||t instanceof uh||t instanceof ch||Tc&&t instanceof Tc?m.texSubImage2D(m.TEXTURE_2D,0,_,x,m.RGBA,m.UNSIGNED_BYTE,t):m.texSubImage2D(m.TEXTURE_2D,0,_,x,o,u,m.RGBA,m.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&m.generateMipmap(m.TEXTURE_2D)},Rl.prototype.bind=function(t,e,r){var o=this.context.gl;o.bindTexture(o.TEXTURE_2D,this.texture),r!==o.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(r=o.LINEAR),t!==this.filter&&(o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,t),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,r||t),this.filter=t),e!==this.wrap&&(o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,e),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,e),this.wrap=e)},Rl.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},Rl.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var cp=function(t){var e=this;this._callback=t,this._triggered=!1,typeof MessageChannel!="undefined"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){e._triggered=!1,e._callback()})};cp.prototype.trigger=function(){var t=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){t._triggered=!1,t._callback()},0))},cp.prototype.remove=function(){delete this._channel,this._callback=function(){}};var su=function(t,e,r){this.target=t,this.parent=e,this.mapId=r,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},sr(["receive","process"],this),this.invoker=new cp(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=ce()?t:vt};function ph(t,e,r){var o=2*Math.PI*6378137/256/Math.pow(2,r);return[t*o-2*Math.PI*6378137/2,e*o-2*Math.PI*6378137/2]}su.prototype.send=function(t,e,r,o,u){var c=this;u===void 0&&(u=!1);var h=Math.round(1e18*Math.random()).toString(36).substring(0,10);r&&(this.callbacks[h]=r);var m=Ze(this.globalScope)?void 0:[];return this.target.postMessage({id:h,type:t,hasCallback:!!r,targetMapId:o,mustQueue:u,sourceMapId:this.mapId,data:mn(e,m)},m),{cancel:function(){r&&delete c.callbacks[h],c.target.postMessage({id:h,type:"<cancel>",targetMapId:o,sourceMapId:c.mapId})}}},su.prototype.receive=function(t){var e=t.data,r=e.id;if(r&&(!e.targetMapId||this.mapId===e.targetMapId))if(e.type==="<cancel>"){delete this.tasks[r];var o=this.cancelCallbacks[r];delete this.cancelCallbacks[r],o&&o()}else ce()||e.mustQueue?(this.tasks[r]=e,this.taskQueue.push(r),this.invoker.trigger()):this.processTask(r,e)},su.prototype.process=function(){if(this.taskQueue.length){var t=this.taskQueue.shift(),e=this.tasks[t];delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),e&&this.processTask(t,e)}},su.prototype.processTask=function(t,e){var r=this;if(e.type==="<response>"){var o=this.callbacks[t];delete this.callbacks[t],o&&(e.error?o(Yo(e.error)):o(null,Yo(e.data)))}else{var u=!1,c=Ze(this.globalScope)?void 0:[],h=e.hasCallback?function(x,w){u=!0,delete r.cancelCallbacks[t],r.target.postMessage({id:t,type:"<response>",sourceMapId:r.mapId,error:x?mn(x):null,data:mn(w,c)},c)}:function(x){u=!0},m=null,v=Yo(e.data);if(this.parent[e.type])m=this.parent[e.type](e.sourceMapId,v,h);else if(this.parent.getWorkerSource){var _=e.type.split(".");m=this.parent.getWorkerSource(e.sourceMapId,_[0],v.source)[_[1]](v,h)}else h(new Error("Could not find function "+e.type));!u&&m&&m.cancel&&(this.cancelCallbacks[t]=m.cancel)}},su.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var ln=function(t,e){t&&(e?this.setSouthWest(t).setNorthEast(e):t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))};ln.prototype.setNorthEast=function(t){return this._ne=t instanceof Ii?new Ii(t.lng,t.lat):Ii.convert(t),this},ln.prototype.setSouthWest=function(t){return this._sw=t instanceof Ii?new Ii(t.lng,t.lat):Ii.convert(t),this},ln.prototype.extend=function(t){var e,r,o=this._sw,u=this._ne;if(t instanceof Ii)e=t,r=t;else{if(!(t instanceof ln))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(ln.convert(t)):this.extend(Ii.convert(t)):this;if(r=t._ne,!(e=t._sw)||!r)return this}return o||u?(o.lng=Math.min(e.lng,o.lng),o.lat=Math.min(e.lat,o.lat),u.lng=Math.max(r.lng,u.lng),u.lat=Math.max(r.lat,u.lat)):(this._sw=new Ii(e.lng,e.lat),this._ne=new Ii(r.lng,r.lat)),this},ln.prototype.getCenter=function(){return new Ii((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},ln.prototype.getSouthWest=function(){return this._sw},ln.prototype.getNorthEast=function(){return this._ne},ln.prototype.getNorthWest=function(){return new Ii(this.getWest(),this.getNorth())},ln.prototype.getSouthEast=function(){return new Ii(this.getEast(),this.getSouth())},ln.prototype.getWest=function(){return this._sw.lng},ln.prototype.getSouth=function(){return this._sw.lat},ln.prototype.getEast=function(){return this._ne.lng},ln.prototype.getNorth=function(){return this._ne.lat},ln.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},ln.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},ln.prototype.isEmpty=function(){return!(this._sw&&this._ne)},ln.prototype.contains=function(t){var e=Ii.convert(t),r=e.lng,o=e.lat,u=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(u=this._sw.lng>=r&&r>=this._ne.lng),this._sw.lat<=o&&o<=this._ne.lat&&u},ln.convert=function(t){return!t||t instanceof ln?t:new ln(t)};var Ii=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid LngLat object: ("+t+", "+e+")");if(this.lng=+t,this.lat=+e,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Ii.prototype.wrap=function(){return new Ii(Z(this.lng,-180,180),this.lat)},Ii.prototype.toArray=function(){return[this.lng,this.lat]},Ii.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Ii.prototype.distanceTo=function(t){var e=Math.PI/180,r=this.lat*e,o=t.lat*e,u=Math.sin(r)*Math.sin(o)+Math.cos(r)*Math.cos(o)*Math.cos((t.lng-this.lng)*e);return 63710088e-1*Math.acos(Math.min(u,1))},Ii.prototype.toBounds=function(t){t===void 0&&(t=0);var e=360*t/40075017,r=e/Math.cos(Math.PI/180*this.lat);return new ln(new Ii(this.lng-r,this.lat-e),new Ii(this.lng+r,this.lat+e))},Ii.convert=function(t){if(t instanceof Ii)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new Ii(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new Ii(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var hh=2*Math.PI*63710088e-1;function fh(t){return hh*Math.cos(t*Math.PI/180)}function dh(t){return(180+t)/360}function mh(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function yh(t,e){return t/fh(e)}function pp(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}var Bl=function(t,e,r){r===void 0&&(r=0),this.x=+t,this.y=+e,this.z=+r};Bl.fromLngLat=function(t,e){e===void 0&&(e=0);var r=Ii.convert(t);return new Bl(dh(r.lng),mh(r.lat),yh(e,r.lat))},Bl.prototype.toLngLat=function(){return new Ii(360*this.x-180,pp(this.y))},Bl.prototype.toAltitude=function(){return this.z*fh(pp(this.y))},Bl.prototype.meterInMercatorCoordinateUnits=function(){return 1/hh*(t=pp(this.y),1/Math.cos(t*Math.PI/180));var t};var Ol=function(t,e,r){this.z=t,this.x=e,this.y=r,this.key=Nu(0,t,t,e,r)};Ol.prototype.equals=function(t){return this.z===t.z&&this.x===t.x&&this.y===t.y},Ol.prototype.url=function(t,e){var r,o,u,c,h,m=(o=this.y,u=this.z,c=ph(256*(r=this.x),256*(o=Math.pow(2,u)-o-1),u),h=ph(256*(r+1),256*(o+1),u),c[0]+","+c[1]+","+h[0]+","+h[1]),v=function(_,x,w){for(var E,z="",O=_;O>0;O--)z+=(x&(E=1<<O-1)?1:0)+(w&E?2:0);return z}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(e==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",v).replace("{bbox-epsg-3857}",m)},Ol.prototype.getTilePoint=function(t){var e=Math.pow(2,this.z);return new Vt(8192*(t.x*e-this.x),8192*(t.y*e-this.y))},Ol.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var vh=function(t,e){this.wrap=t,this.canonical=e,this.key=Nu(t,e.z,e.z,e.x,e.y)},un=function(t,e,r,o,u){this.overscaledZ=t,this.wrap=e,this.canonical=new Ol(r,+o,+u),this.key=Nu(e,t,r,o,u)};function Nu(t,e,r,o,u){(t*=2)<0&&(t=-1*t-1);var c=1<<r;return(c*c*t+c*u+o).toString(36)+r.toString(36)+e.toString(36)}un.prototype.equals=function(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)},un.prototype.scaledTo=function(t){var e=this.canonical.z-t;return t>this.canonical.z?new un(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new un(t,this.wrap,t,this.canonical.x>>e,this.canonical.y>>e)},un.prototype.calculateScaledKey=function(t,e){var r=this.canonical.z-t;return t>this.canonical.z?Nu(this.wrap*+e,t,this.canonical.z,this.canonical.x,this.canonical.y):Nu(this.wrap*+e,t,t,this.canonical.x>>r,this.canonical.y>>r)},un.prototype.isChildOf=function(t){if(t.wrap!==this.wrap)return!1;var e=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>e&&t.canonical.y===this.canonical.y>>e},un.prototype.children=function(t){if(this.overscaledZ>=t)return[new un(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var e=this.canonical.z+1,r=2*this.canonical.x,o=2*this.canonical.y;return[new un(e,this.wrap,e,r,o),new un(e,this.wrap,e,r+1,o),new un(e,this.wrap,e,r,o+1),new un(e,this.wrap,e,r+1,o+1)]},un.prototype.isLessThan=function(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))},un.prototype.wrapped=function(){return new un(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},un.prototype.unwrapTo=function(t){return new un(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)},un.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},un.prototype.toUnwrapped=function(){return new vh(this.wrap,this.canonical)},un.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},un.prototype.getTilePoint=function(t){return this.canonical.getTilePoint(new Bl(t.x-this.wrap,t.y))},re("CanonicalTileID",Ol),re("OverscaledTileID",un,{omit:["posMatrix"]});var Hs=function(t,e,r){if(this.uid=t,e.height!==e.width)throw new RangeError("DEM tiles must be square");if(r&&r!=="mapbox"&&r!=="terrarium")return Gt('"'+r+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=e.height;var o=this.dim=e.height-2;this.data=new Uint32Array(e.data.buffer),this.encoding=r||"mapbox";for(var u=0;u<o;u++)this.data[this._idx(-1,u)]=this.data[this._idx(0,u)],this.data[this._idx(o,u)]=this.data[this._idx(o-1,u)],this.data[this._idx(u,-1)]=this.data[this._idx(u,0)],this.data[this._idx(u,o)]=this.data[this._idx(u,o-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(o,-1)]=this.data[this._idx(o-1,0)],this.data[this._idx(-1,o)]=this.data[this._idx(0,o-1)],this.data[this._idx(o,o)]=this.data[this._idx(o-1,o-1)]};Hs.prototype.get=function(t,e){var r=new Uint8Array(this.data.buffer),o=4*this._idx(t,e);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(r[o],r[o+1],r[o+2])},Hs.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Hs.prototype._idx=function(t,e){if(t<-1||t>=this.dim+1||e<-1||e>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(e+1)*this.stride+(t+1)},Hs.prototype._unpackMapbox=function(t,e,r){return(256*t*256+256*e+r)/10-1e4},Hs.prototype._unpackTerrarium=function(t,e,r){return 256*t+e+r/256-32768},Hs.prototype.getPixels=function(){return new _n({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Hs.prototype.backfillBorder=function(t,e,r){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");var o=e*this.dim,u=e*this.dim+this.dim,c=r*this.dim,h=r*this.dim+this.dim;switch(e){case-1:o=u-1;break;case 1:u=o+1}switch(r){case-1:c=h-1;break;case 1:h=c+1}for(var m=-e*this.dim,v=-r*this.dim,_=c;_<h;_++)for(var x=o;x<u;x++)this.data[this._idx(x,_)]=t.data[this._idx(x+m,_+v)]},re("DEMData",Hs);var Ec=function(t){this._stringToNumber={},this._numberToString=[];for(var e=0;e<t.length;e++){var r=t[e];this._stringToNumber[r]=e,this._numberToString[e]=r}};Ec.prototype.encode=function(t){return this._stringToNumber[t]},Ec.prototype.decode=function(t){return this._numberToString[t]};var Ic=function(t,e,r,o,u){this.type="Feature",this._vectorTileFeature=t,t._z=e,t._x=r,t._y=o,this.properties=t.properties,this.id=u},hp={geometry:{configurable:!0}};hp.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},hp.geometry.set=function(t){this._geometry=t},Ic.prototype.toJSON=function(){var t={geometry:this.geometry};for(var e in this)e!=="_geometry"&&e!=="_vectorTileFeature"&&(t[e]=this[e]);return t},Object.defineProperties(Ic.prototype,hp);var lu=function(){this.state={},this.stateChanges={},this.deletedStates={}};lu.prototype.updateState=function(t,e,r){var o=String(e);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][o]=this.stateChanges[t][o]||{},bt(this.stateChanges[t][o],r),this.deletedStates[t]===null)for(var u in this.deletedStates[t]={},this.state[t])u!==o&&(this.deletedStates[t][u]=null);else if(this.deletedStates[t]&&this.deletedStates[t][o]===null)for(var c in this.deletedStates[t][o]={},this.state[t][o])r[c]||(this.deletedStates[t][o][c]=null);else for(var h in r)this.deletedStates[t]&&this.deletedStates[t][o]&&this.deletedStates[t][o][h]===null&&delete this.deletedStates[t][o][h]},lu.prototype.removeFeatureState=function(t,e,r){if(this.deletedStates[t]!==null){var o=String(e);if(this.deletedStates[t]=this.deletedStates[t]||{},r&&e!==void 0)this.deletedStates[t][o]!==null&&(this.deletedStates[t][o]=this.deletedStates[t][o]||{},this.deletedStates[t][o][r]=null);else if(e!==void 0)if(this.stateChanges[t]&&this.stateChanges[t][o])for(r in this.deletedStates[t][o]={},this.stateChanges[t][o])this.deletedStates[t][o][r]=null;else this.deletedStates[t][o]=null;else this.deletedStates[t]=null}},lu.prototype.getState=function(t,e){var r=String(e),o=bt({},(this.state[t]||{})[r],(this.stateChanges[t]||{})[r]);if(this.deletedStates[t]===null)return{};if(this.deletedStates[t]){var u=this.deletedStates[t][e];if(u===null)return{};for(var c in u)delete o[c]}return o},lu.prototype.initializeTileState=function(t,e){t.setFeatureState(this.state,e)},lu.prototype.coalesceChanges=function(t,e){var r={};for(var o in this.stateChanges){this.state[o]=this.state[o]||{};var u={};for(var c in this.stateChanges[o])this.state[o][c]||(this.state[o][c]={}),bt(this.state[o][c],this.stateChanges[o][c]),u[c]=this.state[o][c];r[o]=u}for(var h in this.deletedStates){this.state[h]=this.state[h]||{};var m={};if(this.deletedStates[h]===null)for(var v in this.state[h])m[v]={},this.state[h][v]={};else for(var _ in this.deletedStates[h]){if(this.deletedStates[h][_]===null)this.state[h][_]={};else for(var x=0,w=Object.keys(this.deletedStates[h][_]);x<w.length;x+=1)delete this.state[h][_][w[x]];m[_]=this.state[h][_]}r[h]=r[h]||{},bt(r[h],m)}if(this.stateChanges={},this.deletedStates={},Object.keys(r).length!==0)for(var E in t)t[E].setFeatureState(r,e)};var Ws=function(t,e){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new pi(8192,16,0),this.grid3D=new pi(8192,16,0),this.featureIndexArray=new I,this.promoteId=e};function _h(t,e,r,o,u){return Te(t,function(c,h){var m=e instanceof ya?e.get(h):null;return m&&m.evaluate?m.evaluate(r,o,u):m})}function gh(t){for(var e=1/0,r=1/0,o=-1/0,u=-1/0,c=0,h=t;c<h.length;c+=1){var m=h[c];e=Math.min(e,m.x),r=Math.min(r,m.y),o=Math.max(o,m.x),u=Math.max(u,m.y)}return{minX:e,minY:r,maxX:o,maxY:u}}function sd(t,e){return e-t}Ws.prototype.insert=function(t,e,r,o,u,c){var h=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(r,o,u);for(var m=c?this.grid3D:this.grid,v=0;v<e.length;v++){for(var _=e[v],x=[1/0,1/0,-1/0,-1/0],w=0;w<_.length;w++){var E=_[w];x[0]=Math.min(x[0],E.x),x[1]=Math.min(x[1],E.y),x[2]=Math.max(x[2],E.x),x[3]=Math.max(x[3],E.y)}x[0]<8192&&x[1]<8192&&x[2]>=0&&x[3]>=0&&m.insert(h,x[0],x[1],x[2],x[3])}},Ws.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new ml.VectorTile(new dc(this.rawTileData)).layers,this.sourceLayerCoder=new Ec(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Ws.prototype.query=function(t,e,r,o){var u=this;this.loadVTLayers();for(var c=t.params||{},h=8192/t.tileSize/t.scale,m=Ls(c.filter),v=t.queryGeometry,_=t.queryPadding*h,x=gh(v),w=this.grid.query(x.minX-_,x.minY-_,x.maxX+_,x.maxY+_),E=gh(t.cameraQueryGeometry),z=this.grid3D.query(E.minX-_,E.minY-_,E.maxX+_,E.maxY+_,function(dt,mt,zt,Ot){return function(Zt,ve,Wt,xe,Qt){for(var Je=0,Le=Zt;Je<Le.length;Je+=1){var fe=Le[Je];if(ve<=fe.x&&Wt<=fe.y&&xe>=fe.x&&Qt>=fe.y)return!0}var ir=[new Vt(ve,Wt),new Vt(ve,Qt),new Vt(xe,Qt),new Vt(xe,Wt)];if(Zt.length>2){for(var qe=0,vr=ir;qe<vr.length;qe+=1)if(be(Zt,vr[qe]))return!0}for(var we=0;we<Zt.length-1;we++)if(mi(Zt[we],Zt[we+1],ir))return!0;return!1}(t.cameraQueryGeometry,dt-_,mt-_,zt+_,Ot+_)}),O=0,F=z;O<F.length;O+=1)w.push(F[O]);w.sort(sd);for(var J,H={},at=function(dt){var mt=w[dt];if(mt!==J){J=mt;var zt=u.featureIndexArray.get(mt),Ot=null;u.loadMatchingFeature(H,zt.bucketIndex,zt.sourceLayerIndex,zt.featureIndex,m,c.layers,c.availableImages,e,r,o,function(Zt,ve,Wt){return Ot||(Ot=jr(Zt)),ve.queryIntersectsFeature(v,Zt,Wt,Ot,u.z,t.transform,h,t.pixelPosMatrix)})}},st=0;st<w.length;st++)at(st);return H},Ws.prototype.loadMatchingFeature=function(t,e,r,o,u,c,h,m,v,_,x){var w=this.bucketLayerIDs[e];if(!c||function(Zt,ve){for(var Wt=0;Wt<Zt.length;Wt++)if(ve.indexOf(Zt[Wt])>=0)return!0;return!1}(c,w)){var E=this.sourceLayerCoder.decode(r),z=this.vtLayers[E].feature(o);if(u.needGeometry){var O=bi(z,!0);if(!u.filter(new rr(this.tileID.overscaledZ),O,this.tileID.canonical))return}else if(!u.filter(new rr(this.tileID.overscaledZ),z))return;for(var F=this.getId(z,E),J=0;J<w.length;J++){var H=w[J];if(!(c&&c.indexOf(H)<0)){var at=m[H];if(at){var st={};F!==void 0&&_&&(st=_.getState(at.sourceLayer||"_geojsonTileLayer",F));var dt=bt({},v[H]);dt.paint=_h(dt.paint,at.paint,z,st,h),dt.layout=_h(dt.layout,at.layout,z,st,h);var mt=!x||x(z,at,st);if(mt){var zt=new Ic(z,this.z,this.x,this.y,F);zt.layer=dt;var Ot=t[H];Ot===void 0&&(Ot=t[H]=[]),Ot.push({featureIndex:o,feature:zt,intersectionZ:mt})}}}}}},Ws.prototype.lookupSymbolFeatures=function(t,e,r,o,u,c,h,m){var v={};this.loadVTLayers();for(var _=Ls(u),x=0,w=t;x<w.length;x+=1)this.loadMatchingFeature(v,r,o,w[x],_,c,h,m,e);return v},Ws.prototype.hasLayer=function(t){for(var e=0,r=this.bucketLayerIDs;e<r.length;e+=1)for(var o=0,u=r[e];o<u.length;o+=1)if(t===u[o])return!0;return!1},Ws.prototype.getId=function(t,e){var r=t.id;return this.promoteId&&typeof(r=t.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[e]])=="boolean"&&(r=Number(r)),r},re("FeatureIndex",Ws,{omit:["rawTileData","sourceLayerCoder"]});var In=function(t,e){this.tileID=t,this.uid=At(),this.uses=0,this.tileSize=e,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};In.prototype.registerFadeDuration=function(t){var e=t+this.timeAdded;e<_t.now()||this.fadeEndTime&&e<this.fadeEndTime||(this.fadeEndTime=e)},In.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},In.prototype.loadVectorData=function(t,e,r){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){for(var o in t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(_,x){var w={};if(!x)return w;for(var E=function(){var F=O[z],J=F.layerIds.map(function(st){return x.getLayer(st)}).filter(Boolean);if(J.length!==0){F.layers=J,F.stateDependentLayerIds&&(F.stateDependentLayers=F.stateDependentLayerIds.map(function(st){return J.filter(function(dt){return dt.id===st})[0]}));for(var H=0,at=J;H<at.length;H+=1)w[at[H].id]=F}},z=0,O=_;z<O.length;z+=1)E();return w}(t.buckets,e.style),this.hasSymbolBuckets=!1,this.buckets){var u=this.buckets[o];if(u instanceof Yr){if(this.hasSymbolBuckets=!0,!r)break;u.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var c in this.buckets){var h=this.buckets[c];if(h instanceof Yr&&h.hasRTLText){this.hasRTLText=!0,hi.isLoading()||hi.isLoaded()||ma()!=="deferred"||Cl();break}}for(var m in this.queryPadding=0,this.buckets){var v=this.buckets[m];this.queryPadding=Math.max(this.queryPadding,e.style.getLayer(m).queryRadius(v))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new n},In.prototype.unloadVectorData=function(){for(var t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},In.prototype.getBucket=function(t){return this.buckets[t.id]},In.prototype.upload=function(t){for(var e in this.buckets){var r=this.buckets[e];r.uploadPending()&&r.upload(t)}var o=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Rl(t,this.imageAtlas.image,o.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Rl(t,this.glyphAtlasImage,o.ALPHA),this.glyphAtlasImage=null)},In.prototype.prepare=function(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)},In.prototype.queryRenderedFeatures=function(t,e,r,o,u,c,h,m,v,_){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:o,cameraQueryGeometry:u,scale:c,tileSize:this.tileSize,pixelPosMatrix:_,transform:m,params:h,queryPadding:this.queryPadding*v},t,e,r):{}},In.prototype.querySourceFeatures=function(t,e){var r=this.latestFeatureIndex;if(r&&r.rawTileData){var o=r.loadVTLayers(),u=e?e.sourceLayer:"",c=o._geojsonTileLayer||o[u];if(c)for(var h=Ls(e&&e.filter),m=this.tileID.canonical,v=m.z,_=m.x,x=m.y,w={z:v,x:_,y:x},E=0;E<c.length;E++){var z=c.feature(E);if(h.needGeometry){var O=bi(z,!0);if(!h.filter(new rr(this.tileID.overscaledZ),O,this.tileID.canonical))continue}else if(!h.filter(new rr(this.tileID.overscaledZ),z))continue;var F=r.getId(z,u),J=new Ic(z,v,_,x,F);J.tile=w,t.push(J)}}},In.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},In.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},In.prototype.setExpiryData=function(t){var e=this.expirationTime;if(t.cacheControl){var r=fr(t.cacheControl);r["max-age"]&&(this.expirationTime=Date.now()+1e3*r["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){var o=Date.now(),u=!1;if(this.expirationTime>o)u=!1;else if(e)if(this.expirationTime<e)u=!0;else{var c=this.expirationTime-e;c?this.expirationTime=o+Math.max(c,3e4):u=!0}else u=!0;u?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},In.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},In.prototype.setFeatureState=function(t,e){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(t).length!==0){var r=this.latestFeatureIndex.loadVTLayers();for(var o in this.buckets)if(e.style.hasLayer(o)){var u=this.buckets[o],c=u.layers[0].sourceLayer||"_geojsonTileLayer",h=r[c],m=t[c];if(h&&m&&Object.keys(m).length!==0){u.update(m,h,this.imageAtlas&&this.imageAtlas.patternPositions||{});var v=e&&e.style&&e.style.getLayer(o);v&&(this.queryPadding=Math.max(this.queryPadding,v.queryRadius(u)))}}}},In.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},In.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<_t.now()},In.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},In.prototype.setHoldDuration=function(t){this.symbolFadeHoldUntil=_t.now()+t},In.prototype.setDependencies=function(t,e){for(var r={},o=0,u=e;o<u.length;o+=1)r[u[o]]=!0;this.dependencies[t]=r},In.prototype.hasDependency=function(t,e){for(var r=0,o=t;r<o.length;r+=1){var u=this.dependencies[o[r]];if(u){for(var c=0,h=e;c<h.length;c+=1)if(u[h[c]])return!0}}return!1};var yl=vt.performance,xh=function(t){this._marks={start:[t.url,"start"].join("#"),end:[t.url,"end"].join("#"),measure:t.url.toString()},yl.mark(this._marks.start)};xh.prototype.finish=function(){yl.mark(this._marks.end);var t=yl.getEntriesByName(this._marks.measure);return t.length===0&&(yl.measure(this._marks.measure,this._marks.start,this._marks.end),t=yl.getEntriesByName(this._marks.measure),yl.clearMarks(this._marks.start),yl.clearMarks(this._marks.end),yl.clearMeasures(this._marks.measure)),t},l.Actor=su,l.AlphaImage=Ma,l.CanonicalTileID=Ol,l.CollisionBoxArray=n,l.Color=$e,l.DEMData=Hs,l.DataConstantProperty=Kt,l.DictionaryCoder=Ec,l.EXTENT=8192,l.ErrorEvent=tt,l.EvaluationParameters=rr,l.Event=K,l.Evented=W,l.FeatureIndex=Ws,l.FillBucket=_o,l.FillExtrusionBucket=ts,l.ImageAtlas=Uu,l.ImagePosition=yc,l.LineBucket=xa,l.LngLat=Ii,l.LngLatBounds=ln,l.MercatorCoordinate=Bl,l.ONE_EM=24,l.OverscaledTileID=un,l.Point=Vt,l.Point$1=Vt,l.Properties=ea,l.Protobuf=dc,l.RGBAImage=_n,l.RequestManager=Ce,l.RequestPerformance=xh,l.ResourceType=qi,l.SegmentVector=A,l.SourceFeatureState=lu,l.StructArrayLayout1ui2=ne,l.StructArrayLayout2f1f2i16=V,l.StructArrayLayout2i4=Jo,l.StructArrayLayout3ui6=nt,l.StructArrayLayout4i8=fo,l.SymbolBucket=Yr,l.Texture=Rl,l.Tile=In,l.Transitionable=$n,l.Uniform1f=Mt,l.Uniform1i=kt,l.Uniform2f=Nt,l.Uniform3f=ye,l.Uniform4f=le,l.UniformColor=pe,l.UniformMatrix4f=jt,l.UnwrappedTileID=vh,l.ValidationError=j,l.WritingMode=ro,l.ZoomHistory=En,l.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t},l.addDynamicAttributes=lp,l.asyncAll=function(t,e,r){if(!t.length)return r(null,[]);var o=t.length,u=new Array(t.length),c=null;t.forEach(function(h,m){e(h,function(v,_){v&&(c=v),u[m]=_,--o==0&&r(c,u)})})},l.bezier=kr,l.bindAll=sr,l.browser=_t,l.cacheEntryPossiblyAdded=function(t){++bn>ua&&(t.getActor().send("enforceCacheSizeLimit",zr),bn=0)},l.clamp=Lt,l.clearTileCache=function(t){var e=vt.caches.delete("mapbox-tiles");t&&e.catch(t).then(function(){return t()})},l.clipLine=eh,l.clone=function(t){var e=new qr(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},l.clone$1=ze,l.clone$2=function(t){var e=new qr(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},l.collisionCircleLayout=Af,l.config=Et,l.create=function(){var t=new qr(16);return qr!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},l.create$1=function(){var t=new qr(9);return qr!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t},l.create$2=function(){var t=new qr(4);return qr!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t},l.createCommonjsModule=Ut,l.createExpression=Ds,l.createLayout=Nr,l.createStyleLayer=function(t){return t.type==="custom"?new ad(t):new od[t.type](t)},l.cross=function(t,e,r){var o=e[0],u=e[1],c=e[2],h=r[0],m=r[1],v=r[2];return t[0]=u*v-c*m,t[1]=c*h-o*v,t[2]=o*m-u*h,t},l.deepEqual=function t(e,r){if(Array.isArray(e)){if(!Array.isArray(r)||e.length!==r.length)return!1;for(var o=0;o<e.length;o++)if(!t(e[o],r[o]))return!1;return!0}if(typeof e=="object"&&e!==null&&r!==null){if(typeof r!="object"||Object.keys(e).length!==Object.keys(r).length)return!1;for(var u in e)if(!t(e[u],r[u]))return!1;return!0}return e===r},l.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},l.dot$1=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},l.ease=Bt,l.emitValidationErrors=dn,l.endsWith=he,l.enforceCacheSizeLimit=function(t){Ga(),oi&&oi.then(function(e){e.keys().then(function(r){for(var o=0;o<r.length-t;o++)e.delete(r[o])})})},l.evaluateSizeForFeature=Kp,l.evaluateSizeForZoom=Yp,l.evaluateVariableOffset=nh,l.evented=Al,l.extend=bt,l.featureFilter=Ls,l.filterObject=_r,l.fromRotation=function(t,e){var r=Math.sin(e),o=Math.cos(e);return t[0]=o,t[1]=r,t[2]=0,t[3]=-r,t[4]=o,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},l.getAnchorAlignment=np,l.getAnchorJustification=sp,l.getArrayBuffer=mr,l.getImage=C,l.getJSON=function(t,e){return Qr(bt(t,{type:"json"}),e)},l.getRTLTextPluginStatus=ma,l.getReferrer=dr,l.getVideo=function(t,e){var r,o,u=vt.document.createElement("video");u.muted=!0,u.onloadstart=function(){e(null,u)};for(var c=0;c<t.length;c++){var h=vt.document.createElement("source");r=t[c],o=void 0,(o=vt.document.createElement("a")).href=r,(o.protocol!==vt.document.location.protocol||o.host!==vt.document.location.host)&&(u.crossOrigin="Anonymous"),h.src=t[c],u.appendChild(h)}return{cancel:function(){}}},l.identity=cr,l.invert=function(t,e){var r=e[0],o=e[1],u=e[2],c=e[3],h=e[4],m=e[5],v=e[6],_=e[7],x=e[8],w=e[9],E=e[10],z=e[11],O=e[12],F=e[13],J=e[14],H=e[15],at=r*m-o*h,st=r*v-u*h,dt=r*_-c*h,mt=o*v-u*m,zt=o*_-c*m,Ot=u*_-c*v,Zt=x*F-w*O,ve=x*J-E*O,Wt=x*H-z*O,xe=w*J-E*F,Qt=w*H-z*F,Je=E*H-z*J,Le=at*Je-st*Qt+dt*xe+mt*Wt-zt*ve+Ot*Zt;return Le?(t[0]=(m*Je-v*Qt+_*xe)*(Le=1/Le),t[1]=(u*Qt-o*Je-c*xe)*Le,t[2]=(F*Ot-J*zt+H*mt)*Le,t[3]=(E*zt-w*Ot-z*mt)*Le,t[4]=(v*Wt-h*Je-_*ve)*Le,t[5]=(r*Je-u*Wt+c*ve)*Le,t[6]=(J*dt-O*Ot-H*st)*Le,t[7]=(x*Ot-E*dt+z*st)*Le,t[8]=(h*Qt-m*Wt+_*Zt)*Le,t[9]=(o*Wt-r*Qt-c*Zt)*Le,t[10]=(O*zt-F*dt+H*at)*Le,t[11]=(w*dt-x*zt-z*at)*Le,t[12]=(m*ve-h*xe-v*Zt)*Le,t[13]=(r*xe-o*ve+u*Zt)*Le,t[14]=(F*st-O*mt-J*at)*Le,t[15]=(x*mt-w*st+E*at)*Le,t):null},l.isChar=ie,l.isMapboxURL=Rr,l.keysDifference=function(t,e){var r=[];for(var o in t)o in e||r.push(o);return r},l.makeRequest=Qr,l.mapObject=Te,l.mercatorXfromLng=dh,l.mercatorYfromLat=mh,l.mercatorZfromAltitude=yh,l.mul=sn,l.multiply=Fn,l.mvt=ml,l.nextPowerOfTwo=function(t){return t<=1?1:Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},l.normalize=function(t,e){var r=e[0],o=e[1],u=e[2],c=r*r+o*o+u*u;return c>0&&(c=1/Math.sqrt(c)),t[0]=e[0]*c,t[1]=e[1]*c,t[2]=e[2]*c,t},l.number=ni,l.offscreenCanvasSupported=li,l.ortho=function(t,e,r,o,u,c,h){var m=1/(e-r),v=1/(o-u),_=1/(c-h);return t[0]=-2*m,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*v,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*_,t[11]=0,t[12]=(e+r)*m,t[13]=(u+o)*v,t[14]=(h+c)*_,t[15]=1,t},l.parseGlyphPBF=function(t){return new dc(t).readFields(Ff,[])},l.pbf=dc,l.performSymbolLayout=function(t,e,r,o,u,c,h){t.createArrays(),t.tilePixelRatio=8192/(512*t.overscaling),t.compareText={},t.iconsNeedLinear=!1;var m=t.layers[0].layout,v=t.layers[0]._unevaluatedLayout._values,_={};if(t.textSizeData.kind==="composite"){var x=t.textSizeData,w=x.maxZoom;_.compositeTextSizes=[v["text-size"].possiblyEvaluate(new rr(x.minZoom),h),v["text-size"].possiblyEvaluate(new rr(w),h)]}if(t.iconSizeData.kind==="composite"){var E=t.iconSizeData,z=E.maxZoom;_.compositeIconSizes=[v["icon-size"].possiblyEvaluate(new rr(E.minZoom),h),v["icon-size"].possiblyEvaluate(new rr(z),h)]}_.layoutTextSize=v["text-size"].possiblyEvaluate(new rr(t.zoom+1),h),_.layoutIconSize=v["icon-size"].possiblyEvaluate(new rr(t.zoom+1),h),_.textMaxSize=v["text-size"].possiblyEvaluate(new rr(18));for(var O=24*m.get("text-line-height"),F=m.get("text-rotation-alignment")==="map"&&m.get("symbol-placement")!=="point",J=m.get("text-keep-upright"),H=m.get("text-size"),at=function(){var mt=dt[st],zt=m.get("text-font").evaluate(mt,{},h).join(","),Ot=H.evaluate(mt,{},h),Zt=_.layoutTextSize.evaluate(mt,{},h),ve=_.layoutIconSize.evaluate(mt,{},h),Wt={horizontal:{},vertical:void 0},xe=mt.text,Qt=[0,0];if(xe){var Je=xe.toString(),Le=24*m.get("text-letter-spacing").evaluate(mt,{},h),fe=function(or){for(var ti=0,Zr=or;ti<Zr.length;ti+=1)if(br=Zr[ti].charCodeAt(0),ie.Arabic(br)||ie["Arabic Supplement"](br)||ie["Arabic Extended-A"](br)||ie["Arabic Presentation Forms-A"](br)||ie["Arabic Presentation Forms-B"](br))return!1;var br;return!0}(Je)?Le:0,ir=m.get("text-anchor").evaluate(mt,{},h),qe=m.get("text-variable-anchor");if(!qe){var vr=m.get("text-radial-offset").evaluate(mt,{},h);Qt=vr?nh(ir,[24*vr,op]):m.get("text-offset").evaluate(mt,{},h).map(function(or){return 24*or})}var we=F?"center":m.get("text-justify").evaluate(mt,{},h),Ar=m.get("symbol-placement"),Ai=Ar==="point"?24*m.get("text-max-width").evaluate(mt,{},h):0,Ni=function(){t.allowVerticalPlacement&&Us(Je)&&(Wt.vertical=vc(xe,e,r,u,zt,Ai,O,ir,"left",fe,Qt,ro.vertical,!0,Ar,Zt,Ot))};if(!F&&qe){for(var Ri=we==="auto"?qe.map(function(or){return sp(or)}):[we],Ci=!1,ji=0;ji<Ri.length;ji++){var gn=Ri[ji];if(!Wt.horizontal[gn])if(Ci)Wt.horizontal[gn]=Wt.horizontal[0];else{var xn=vc(xe,e,r,u,zt,Ai,O,"center",gn,fe,Qt,ro.horizontal,!1,Ar,Zt,Ot);xn&&(Wt.horizontal[gn]=xn,Ci=xn.positionedLines.length===1)}}Ni()}else{we==="auto"&&(we=sp(ir));var oa=vc(xe,e,r,u,zt,Ai,O,ir,we,fe,Qt,ro.horizontal,!1,Ar,Zt,Ot);oa&&(Wt.horizontal[we]=oa),Ni(),Us(Je)&&F&&J&&(Wt.vertical=vc(xe,e,r,u,zt,Ai,O,ir,we,fe,Qt,ro.vertical,!1,Ar,Zt,Ot))}}var An=void 0,sa=!1;if(mt.icon&&mt.icon.name){var Xi=o[mt.icon.name];Xi&&(An=function(or,ti,Zr){var br=np(Zr),ba=ti[0]-or.displaySize[0]*br.horizontalAlign,Wn=ti[1]-or.displaySize[1]*br.verticalAlign;return{image:or,top:Wn,bottom:Wn+or.displaySize[1],left:ba,right:ba+or.displaySize[0]}}(u[mt.icon.name],m.get("icon-offset").evaluate(mt,{},h),m.get("icon-anchor").evaluate(mt,{},h)),sa=Xi.sdf,t.sdfIcons===void 0?t.sdfIcons=Xi.sdf:t.sdfIcons!==Xi.sdf&&Gt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Xi.pixelRatio!==t.pixelRatio||m.get("icon-rotate").constantOr(1)!==0)&&(t.iconsNeedLinear=!0))}var Cn=oh(Wt.horizontal)||Wt.vertical;t.iconsInText=!!Cn&&Cn.iconsInText,(Cn||An)&&function(or,ti,Zr,br,ba,Wn,wi,rn,Xn,Cr,ys){var io=Wn.textMaxSize.evaluate(ti,{});io===void 0&&(io=wi);var vs,Ki=or.layers[0].layout,_s=Ki.get("icon-offset").evaluate(ti,{},ys),Lo=oh(Zr.horizontal),uu=wi/24,Fl=or.tilePixelRatio*uu,cu=or.tilePixelRatio*io/24,Xs=or.tilePixelRatio*rn,pu=or.tilePixelRatio*Ki.get("symbol-spacing"),Ac=Ki.get("text-padding")*or.tilePixelRatio,hu=Ki.get("icon-padding")*or.tilePixelRatio,ju=Ki.get("text-max-angle")/180*Math.PI,Cc=Ki.get("text-rotation-alignment")==="map"&&Ki.get("symbol-placement")!=="point",zc=Ki.get("icon-rotation-alignment")==="map"&&Ki.get("symbol-placement")!=="point",Ks=Ki.get("symbol-placement"),qu=pu/2,fu=Ki.get("icon-text-fit");br&&fu!=="none"&&(or.allowVerticalPlacement&&Zr.vertical&&(vs=Xp(br,Zr.vertical,fu,Ki.get("icon-text-fit-padding"),_s,uu)),Lo&&(br=Xp(br,Lo,fu,Ki.get("icon-text-fit-padding"),_s,uu)));var vl=function(ld,Ju){Ju.x<0||Ju.x>=8192||Ju.y<0||Ju.y>=8192||function(Yi,es,ud,_l,yp,Sh,Rc,gs,Bc,Qu,Oc,Fc,vp,Th,$u,Eh,Ih,Ah,Ch,zh,no,Uc,Ph,xs,cd){var kh,Vl,_u,gu,xu,bu=Yi.addToLineVertexArray(es,ud),Mh=0,Dh=0,Lh=0,Rh=0,_p=-1,gp=-1,Ys={},Bh=q(""),xp=0,bp=0;if(gs._unevaluatedLayout.getValue("text-radial-offset")===void 0?(xp=(kh=gs.layout.get("text-offset").evaluate(no,{},xs).map(function(ec){return 24*ec}))[0],bp=kh[1]):(xp=24*gs.layout.get("text-radial-offset").evaluate(no,{},xs),bp=op),Yi.allowVerticalPlacement&&_l.vertical){var Oh=gs.layout.get("text-rotate").evaluate(no,{},xs)+90;gu=new wc(Bc,es,Qu,Oc,Fc,_l.vertical,vp,Th,$u,Oh),Rc&&(xu=new wc(Bc,es,Qu,Oc,Fc,Rc,Ih,Ah,$u,Oh))}if(yp){var wp=gs.layout.get("icon-rotate").evaluate(no,{}),Fh=gs.layout.get("icon-text-fit")!=="none",Uh=rh(yp,wp,Ph,Fh),Sp=Rc?rh(Rc,wp,Ph,Fh):void 0;_u=new wc(Bc,es,Qu,Oc,Fc,yp,Ih,Ah,!1,wp),Mh=4*Uh.length;var Vh=Yi.iconSizeData,tc=null;Vh.kind==="source"?(tc=[128*gs.layout.get("icon-size").evaluate(no,{})])[0]>32640&&Gt(Yi.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):Vh.kind==="composite"&&((tc=[128*Uc.compositeIconSizes[0].evaluate(no,{},xs),128*Uc.compositeIconSizes[1].evaluate(no,{},xs)])[0]>32640||tc[1]>32640)&&Gt(Yi.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),Yi.addSymbols(Yi.icon,Uh,tc,zh,Ch,no,!1,es,bu.lineStartIndex,bu.lineLength,-1,xs),_p=Yi.icon.placedSymbolArray.length-1,Sp&&(Dh=4*Sp.length,Yi.addSymbols(Yi.icon,Sp,tc,zh,Ch,no,ro.vertical,es,bu.lineStartIndex,bu.lineLength,-1,xs),gp=Yi.icon.placedSymbolArray.length-1)}for(var Nh in _l.horizontal){var Vc=_l.horizontal[Nh];if(!Vl){Bh=q(Vc.text);var pd=gs.layout.get("text-rotate").evaluate(no,{},xs);Vl=new wc(Bc,es,Qu,Oc,Fc,Vc,vp,Th,$u,pd)}var jh=Vc.positionedLines.length===1;if(Lh+=ah(Yi,es,Vc,Sh,gs,$u,no,Eh,bu,_l.vertical?ro.horizontal:ro.horizontalOnly,jh?Object.keys(_l.horizontal):[Nh],Ys,_p,Uc,xs),jh)break}_l.vertical&&(Rh+=ah(Yi,es,_l.vertical,Sh,gs,$u,no,Eh,bu,ro.vertical,["vertical"],Ys,gp,Uc,xs));var hd=Vl?Vl.boxStartIndex:Yi.collisionBoxArray.length,fd=Vl?Vl.boxEndIndex:Yi.collisionBoxArray.length,dd=gu?gu.boxStartIndex:Yi.collisionBoxArray.length,md=gu?gu.boxEndIndex:Yi.collisionBoxArray.length,yd=_u?_u.boxStartIndex:Yi.collisionBoxArray.length,vd=_u?_u.boxEndIndex:Yi.collisionBoxArray.length,_d=xu?xu.boxStartIndex:Yi.collisionBoxArray.length,gd=xu?xu.boxEndIndex:Yi.collisionBoxArray.length,bs=-1,Nc=function(ec,Zh){return ec&&ec.circleDiameter?Math.max(ec.circleDiameter,Zh):Zh};bs=Nc(Vl,bs),bs=Nc(gu,bs),bs=Nc(_u,bs);var qh=(bs=Nc(xu,bs))>-1?1:0;qh&&(bs*=cd/24),Yi.glyphOffsetArray.length>=Yr.MAX_GLYPHS&&Gt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),no.sortKey!==void 0&&Yi.addToSortKeyRanges(Yi.symbolInstances.length,no.sortKey),Yi.symbolInstances.emplaceBack(es.x,es.y,Ys.right>=0?Ys.right:-1,Ys.center>=0?Ys.center:-1,Ys.left>=0?Ys.left:-1,Ys.vertical||-1,_p,gp,Bh,hd,fd,dd,md,yd,vd,_d,gd,Qu,Lh,Rh,Mh,Dh,qh,0,vp,xp,bp,bs)}(or,Ju,ld,Zr,br,ba,vs,or.layers[0],or.collisionBoxArray,ti.index,ti.sourceLayerIndex,or.index,Fl,Ac,Cc,Xn,Xs,hu,zc,_s,ti,Wn,Cr,ys,wi)};if(Ks==="line")for(var du=0,Pc=eh(ti.geometry,0,0,8192,8192);du<Pc.length;du+=1)for(var kc=Pc[du],Zu=0,Gu=Gf(kc,pu,ju,Zr.vertical||Lo,br,24,cu,or.overscaling,8192);Zu<Gu.length;Zu+=1){var Mc=Gu[Zu];Lo&&Kf(or,Lo.text,qu,Mc)||vl(kc,Mc)}else if(Ks==="line-center")for(var Hu=0,Wu=ti.geometry;Hu<Wu.length;Hu+=1){var Xu=Wu[Hu];if(Xu.length>1){var Dc=Zf(Xu,ju,Zr.vertical||Lo,br,24,cu);Dc&&vl(Xu,Dc)}}else if(ti.type==="Polygon")for(var mu=0,Lc=Mu(ti.geometry,0);mu<Lc.length;mu+=1){var yu=Lc[mu],Ku=Wf(yu,16);vl(yu[0],new ru(Ku.x,Ku.y,0))}else if(ti.type==="LineString")for(var Ul=0,Yu=ti.geometry;Ul<Yu.length;Ul+=1){var vu=Yu[Ul];vl(vu,new ru(vu[0].x,vu[0].y,0))}else if(ti.type==="Point")for(var fp=0,bh=ti.geometry;fp<bh.length;fp+=1)for(var dp=0,wh=bh[fp];dp<wh.length;dp+=1){var mp=wh[dp];vl([mp],new ru(mp.x,mp.y,0))}}(t,mt,Wt,An,o,_,Zt,ve,Qt,sa,h)},st=0,dt=t.features;st<dt.length;st+=1)at();c&&t.generateCollisionDebugBuffers()},l.perspective=function(t,e,r,o,u){var c,h=1/Math.tan(e/2);return t[0]=h/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=h,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,u!=null&&u!==1/0?(t[10]=(u+o)*(c=1/(o-u)),t[14]=2*u*o*c):(t[10]=-1,t[14]=-2*o),t},l.pick=function(t,e){for(var r={},o=0;o<e.length;o++){var u=e[o];u in t&&(r[u]=t[u])}return r},l.plugin=hi,l.polygonIntersectsPolygon=Pi,l.postMapLoadEvent=Qi,l.postTurnstileEvent=la,l.potpack=Zp,l.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],l.register=re,l.registerForPluginStateChange=function(t){return t({pluginStatus:Si,pluginURL:ho}),Al.on("pluginStateChange",t),t},l.renderColorRamp=ul,l.rotate=function(t,e,r){var o=e[0],u=e[1],c=e[2],h=e[3],m=Math.sin(r),v=Math.cos(r);return t[0]=o*v+c*m,t[1]=u*v+h*m,t[2]=o*-m+c*v,t[3]=u*-m+h*v,t},l.rotateX=function(t,e,r){var o=Math.sin(r),u=Math.cos(r),c=e[4],h=e[5],m=e[6],v=e[7],_=e[8],x=e[9],w=e[10],E=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=c*u+_*o,t[5]=h*u+x*o,t[6]=m*u+w*o,t[7]=v*u+E*o,t[8]=_*u-c*o,t[9]=x*u-h*o,t[10]=w*u-m*o,t[11]=E*u-v*o,t},l.rotateZ=function(t,e,r){var o=Math.sin(r),u=Math.cos(r),c=e[0],h=e[1],m=e[2],v=e[3],_=e[4],x=e[5],w=e[6],E=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=c*u+_*o,t[1]=h*u+x*o,t[2]=m*u+w*o,t[3]=v*u+E*o,t[4]=_*u-c*o,t[5]=x*u-h*o,t[6]=w*u-m*o,t[7]=E*u-v*o,t},l.scale=function(t,e,r){var o=r[0],u=r[1],c=r[2];return t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t[3]=e[3]*o,t[4]=e[4]*u,t[5]=e[5]*u,t[6]=e[6]*u,t[7]=e[7]*u,t[8]=e[8]*c,t[9]=e[9]*c,t[10]=e[10]*c,t[11]=e[11]*c,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},l.scale$1=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t},l.scale$2=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t},l.setCacheLimits=function(t,e){zr=t,ua=e},l.setRTLTextPlugin=function(t,e,r){if(r===void 0&&(r=!1),Si==="deferred"||Si==="loading"||Si==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");ho=_t.resolveURL(t),Si="deferred",Vs=e,Ns(),r||Cl()},l.sphericalToCartesian=function(t){var e=t[0],r=t[1],o=t[2];return r+=90,r*=Math.PI/180,o*=Math.PI/180,{x:e*Math.cos(r)*Math.sin(o),y:e*Math.sin(r)*Math.sin(o),z:e*Math.cos(o)}},l.sqrLen=function(t){var e=t[0],r=t[1];return e*e+r*r},l.styleSpec=M,l.sub=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t},l.symbolSize=qf,l.transformMat3=function(t,e,r){var o=e[0],u=e[1],c=e[2];return t[0]=o*r[0]+u*r[3]+c*r[6],t[1]=o*r[1]+u*r[4]+c*r[7],t[2]=o*r[2]+u*r[5]+c*r[8],t},l.transformMat4=ka,l.translate=function(t,e,r){var o,u,c,h,m,v,_,x,w,E,z,O,F=r[0],J=r[1],H=r[2];return e===t?(t[12]=e[0]*F+e[4]*J+e[8]*H+e[12],t[13]=e[1]*F+e[5]*J+e[9]*H+e[13],t[14]=e[2]*F+e[6]*J+e[10]*H+e[14],t[15]=e[3]*F+e[7]*J+e[11]*H+e[15]):(u=e[1],c=e[2],h=e[3],m=e[4],v=e[5],_=e[6],x=e[7],w=e[8],E=e[9],z=e[10],O=e[11],t[0]=o=e[0],t[1]=u,t[2]=c,t[3]=h,t[4]=m,t[5]=v,t[6]=_,t[7]=x,t[8]=w,t[9]=E,t[10]=z,t[11]=O,t[12]=o*F+m*J+w*H+e[12],t[13]=u*F+v*J+E*H+e[13],t[14]=c*F+_*J+z*H+e[14],t[15]=h*F+x*J+O*H+e[15]),t},l.triggerPluginCompletionEvent=ds,l.uniqueId=At,l.validateCustomStyleLayer=function(t){var e=[],r=t.id;return r===void 0&&e.push({message:"layers."+r+': missing required property "id"'}),t.render===void 0&&e.push({message:"layers."+r+': missing required method "render"'}),t.renderingMode&&t.renderingMode!=="2d"&&t.renderingMode!=="3d"&&e.push({message:"layers."+r+': property "renderingMode" must be either "2d" or "3d"'}),e},l.validateLight=al,l.validateStyle=Co,l.values=function(t){var e=[];for(var r in t)e.push(t[r]);return e},l.vectorTile=ml,l.version="1.15.2",l.warnOnce=Gt,l.webpSupported=de,l.window=vt,l.wrap=Z}),ht(["./shared"],function(l){function Ut(b){var T=typeof b;if(T==="number"||T==="boolean"||T==="string"||b==null)return JSON.stringify(b);if(Array.isArray(b)){for(var C="[",k=0,U=b;k<U.length;k+=1)C+=Ut(U[k])+",";return C+"]"}for(var K=Object.keys(b).sort(),tt="{",W=0;W<K.length;W++)tt+=JSON.stringify(K[W])+":"+Ut(b[K[W]])+",";return tt+"}"}function G(b){for(var T="",C=0,k=l.refProperties;C<k.length;C+=1)T+="/"+Ut(b[k[C]]);return T}var St=function(b){this.keyCache={},b&&this.replace(b)};St.prototype.replace=function(b){this._layerConfigs={},this._layers={},this.update(b,[])},St.prototype.update=function(b,T){for(var C=this,k=0,U=b;k<U.length;k+=1){var K=U[k];this._layerConfigs[K.id]=K;var tt=this._layers[K.id]=l.createStyleLayer(K);tt._featureFilter=l.featureFilter(tt.filter),this.keyCache[K.id]&&delete this.keyCache[K.id]}for(var W=0,M=T;W<M.length;W+=1){var j=M[W];delete this.keyCache[j],delete this._layerConfigs[j],delete this._layers[j]}this.familiesBySource={};for(var Dt=0,Ft=function(qt,Pt){for(var Ue={},Oe=0;Oe<qt.length;Oe++){var ae=Pt&&Pt[qt[Oe].id]||G(qt[Oe]);Pt&&(Pt[qt[Oe].id]=ae);var Br=Ue[ae];Br||(Br=Ue[ae]=[]),Br.push(qt[Oe])}var Me=[];for(var Hr in Ue)Me.push(Ue[Hr]);return Me}(l.values(this._layerConfigs),this.keyCache);Dt<Ft.length;Dt+=1){var lt=Ft[Dt].map(function(qt){return C._layers[qt.id]}),It=lt[0];if(It.visibility!=="none"){var Xt=It.source||"",Jt=this.familiesBySource[Xt];Jt||(Jt=this.familiesBySource[Xt]={});var me=It.sourceLayer||"_geojsonTileLayer",Ct=Jt[me];Ct||(Ct=Jt[me]=[]),Ct.push(lt)}}};var Vt=function(b){var T={},C=[];for(var k in b){var U=b[k],K=T[k]={};for(var tt in U){var W=U[+tt];if(W&&W.bitmap.width!==0&&W.bitmap.height!==0){var M={x:0,y:0,w:W.bitmap.width+2,h:W.bitmap.height+2};C.push(M),K[tt]={rect:M,metrics:W.metrics}}}}var j=l.potpack(C),Dt=new l.AlphaImage({width:j.w||1,height:j.h||1});for(var Ft in b){var lt=b[Ft];for(var It in lt){var Xt=lt[+It];if(Xt&&Xt.bitmap.width!==0&&Xt.bitmap.height!==0){var Jt=T[Ft][It].rect;l.AlphaImage.copy(Xt.bitmap,Dt,{x:0,y:0},{x:Jt.x+1,y:Jt.y+1},Xt.bitmap)}}}this.image=Dt,this.positions=T};l.register("GlyphAtlas",Vt);var We=function(b){this.tileID=new l.OverscaledTileID(b.tileID.overscaledZ,b.tileID.wrap,b.tileID.canonical.z,b.tileID.canonical.x,b.tileID.canonical.y),this.uid=b.uid,this.zoom=b.zoom,this.pixelRatio=b.pixelRatio,this.tileSize=b.tileSize,this.source=b.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=b.showCollisionBoxes,this.collectResourceTiming=!!b.collectResourceTiming,this.returnDependencies=!!b.returnDependencies,this.promoteId=b.promoteId};function vt(b,T,C){for(var k=new l.EvaluationParameters(T),U=0,K=b;U<K.length;U+=1)K[U].recalculate(k,C)}function wr(b,T){var C=l.getArrayBuffer(b.request,function(k,U,K,tt){k?T(k):U&&T(null,{vectorTile:new l.vectorTile.VectorTile(new l.pbf(U)),rawData:U,cacheControl:K,expires:tt})});return function(){C.cancel(),T()}}We.prototype.parse=function(b,T,C,k,U){var K=this;this.status="parsing",this.data=b,this.collisionBoxArray=new l.CollisionBoxArray;var tt=new l.DictionaryCoder(Object.keys(b.layers).sort()),W=new l.FeatureIndex(this.tileID,this.promoteId);W.bucketLayerIDs=[];var M,j,Dt,Ft,lt={},It={featureIndex:W,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:C},Xt=T.familiesBySource[this.source];for(var Jt in Xt){var me=b.layers[Jt];if(me){me.version===1&&l.warnOnce('Vector tile source "'+this.source+'" layer "'+Jt+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var Ct=tt.encode(Jt),qt=[],Pt=0;Pt<me.length;Pt++){var Ue=me.feature(Pt),Oe=W.getId(Ue,Jt);qt.push({feature:Ue,id:Oe,index:Pt,sourceLayerIndex:Ct})}for(var ae=0,Br=Xt[Jt];ae<Br.length;ae+=1){var Me=Br[ae],Hr=Me[0];Hr.minzoom&&this.zoom<Math.floor(Hr.minzoom)||Hr.maxzoom&&this.zoom>=Hr.maxzoom||Hr.visibility!=="none"&&(vt(Me,this.zoom,C),(lt[Hr.id]=Hr.createBucket({index:W.bucketLayerIDs.length,layers:Me,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Ct,sourceID:this.source})).populate(qt,It,this.tileID.canonical),W.bucketLayerIDs.push(Me.map(function(Ur){return Ur.id})))}}}var er=l.mapObject(It.glyphDependencies,function(Ur){return Object.keys(Ur).map(Number)});Object.keys(er).length?k.send("getGlyphs",{uid:this.uid,stacks:er},function(Ur,Ke){M||(M=Ur,j=Ke,gi.call(K))}):j={};var nr=Object.keys(It.iconDependencies);nr.length?k.send("getImages",{icons:nr,source:this.source,tileID:this.tileID,type:"icons"},function(Ur,Ke){M||(M=Ur,Dt=Ke,gi.call(K))}):Dt={};var Or=Object.keys(It.patternDependencies);function gi(){if(M)return U(M);if(j&&Dt&&Ft){var Ur=new Vt(j),Ke=new l.ImageAtlas(Dt,Ft);for(var Bo in lt){var $e=lt[Bo];$e instanceof l.SymbolBucket?(vt($e.layers,this.zoom,C),l.performSymbolLayout($e,j,Ur.positions,Dt,Ke.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):$e.hasPattern&&($e instanceof l.LineBucket||$e instanceof l.FillBucket||$e instanceof l.FillExtrusionBucket)&&(vt($e.layers,this.zoom,C),$e.addFeatures(It,this.tileID.canonical,Ke.patternPositions))}this.status="done",U(null,{buckets:l.values(lt).filter(function(Ha){return!Ha.isEmpty()}),featureIndex:W,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Ur.image,imageAtlas:Ke,glyphMap:this.returnDependencies?j:null,iconMap:this.returnDependencies?Dt:null,glyphPositions:this.returnDependencies?Ur.positions:null})}}Or.length?k.send("getImages",{icons:Or,source:this.source,tileID:this.tileID,type:"patterns"},function(Ur,Ke){M||(M=Ur,Ft=Ke,gi.call(K))}):Ft={},gi.call(this)};var kr=function(b,T,C,k){this.actor=b,this.layerIndex=T,this.availableImages=C,this.loadVectorData=k||wr,this.loading={},this.loaded={}};kr.prototype.loadTile=function(b,T){var C=this,k=b.uid;this.loading||(this.loading={});var U=!!(b&&b.request&&b.request.collectResourceTiming)&&new l.RequestPerformance(b.request),K=this.loading[k]=new We(b);K.abort=this.loadVectorData(b,function(tt,W){if(delete C.loading[k],tt||!W)return K.status="done",C.loaded[k]=K,T(tt);var M=W.rawData,j={};W.expires&&(j.expires=W.expires),W.cacheControl&&(j.cacheControl=W.cacheControl);var Dt={};if(U){var Ft=U.finish();Ft&&(Dt.resourceTiming=JSON.parse(JSON.stringify(Ft)))}K.vectorTile=W.vectorTile,K.parse(W.vectorTile,C.layerIndex,C.availableImages,C.actor,function(lt,It){if(lt||!It)return T(lt);T(null,l.extend({rawTileData:M.slice(0)},It,j,Dt))}),C.loaded=C.loaded||{},C.loaded[k]=K})},kr.prototype.reloadTile=function(b,T){var C=this,k=this.loaded,U=b.uid,K=this;if(k&&k[U]){var tt=k[U];tt.showCollisionBoxes=b.showCollisionBoxes;var W=function(M,j){var Dt=tt.reloadCallback;Dt&&(delete tt.reloadCallback,tt.parse(tt.vectorTile,K.layerIndex,C.availableImages,K.actor,Dt)),T(M,j)};tt.status==="parsing"?tt.reloadCallback=W:tt.status==="done"&&(tt.vectorTile?tt.parse(tt.vectorTile,this.layerIndex,this.availableImages,this.actor,W):W())}},kr.prototype.abortTile=function(b,T){var C=this.loading,k=b.uid;C&&C[k]&&C[k].abort&&(C[k].abort(),delete C[k]),T()},kr.prototype.removeTile=function(b,T){var C=this.loaded,k=b.uid;C&&C[k]&&delete C[k],T()};var Bt=l.window.ImageBitmap,Lt=function(){this.loaded={}};function Z(b,T){if(b.length!==0){bt(b[0],T);for(var C=1;C<b.length;C++)bt(b[C],!T)}}function bt(b,T){for(var C=0,k=0,U=b.length,K=U-1;k<U;K=k++)C+=(b[k][0]-b[K][0])*(b[K][1]+b[k][1]);C>=0!=!!T&&b.reverse()}Lt.prototype.loadTile=function(b,T){var C=b.uid,k=b.encoding,U=b.rawImageData,K=Bt&&U instanceof Bt?this.getImageData(U):U,tt=new l.DEMData(C,K,k);this.loaded=this.loaded||{},this.loaded[C]=tt,T(null,tt)},Lt.prototype.getImageData=function(b){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(b.width,b.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=b.width,this.offscreenCanvas.height=b.height,this.offscreenCanvasContext.drawImage(b,0,0,b.width,b.height);var T=this.offscreenCanvasContext.getImageData(-1,-1,b.width+2,b.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new l.RGBAImage({width:T.width,height:T.height},T.data)},Lt.prototype.removeTile=function(b){var T=this.loaded,C=b.uid;T&&T[C]&&delete T[C]};var wt=l.vectorTile.VectorTileFeature.prototype.toGeoJSON,At=function(b){this._feature=b,this.extent=l.EXTENT,this.type=b.type,this.properties=b.tags,"id"in b&&!isNaN(b.id)&&(this.id=parseInt(b.id,10))};At.prototype.loadGeometry=function(){if(this._feature.type===1){for(var b=[],T=0,C=this._feature.geometry;T<C.length;T+=1){var k=C[T];b.push([new l.Point$1(k[0],k[1])])}return b}for(var U=[],K=0,tt=this._feature.geometry;K<tt.length;K+=1){for(var W=[],M=0,j=tt[K];M<j.length;M+=1){var Dt=j[M];W.push(new l.Point$1(Dt[0],Dt[1]))}U.push(W)}return U},At.prototype.toGeoJSON=function(b,T,C){return wt.call(this,b,T,C)};var ue=function(b){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=l.EXTENT,this.length=b.length,this._features=b};ue.prototype.feature=function(b){return new At(this._features[b])};var pr=l.vectorTile.VectorTileFeature,sr=he;function he(b,T){this.options=T||{},this.features=b,this.length=b.length}function Te(b,T){this.id=typeof b.id=="number"?b.id:void 0,this.type=b.type,this.rawGeometry=b.type===1?[b.geometry]:b.geometry,this.properties=b.tags,this.extent=T||4096}he.prototype.feature=function(b){return new Te(this.features[b],this.options.extent)},Te.prototype.loadGeometry=function(){var b=this.rawGeometry;this.geometry=[];for(var T=0;T<b.length;T++){for(var C=b[T],k=[],U=0;U<C.length;U++)k.push(new l.Point$1(C[U][0],C[U][1]));this.geometry.push(k)}return this.geometry},Te.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var b=this.geometry,T=1/0,C=-1/0,k=1/0,U=-1/0,K=0;K<b.length;K++)for(var tt=b[K],W=0;W<tt.length;W++){var M=tt[W];T=Math.min(T,M.x),C=Math.max(C,M.x),k=Math.min(k,M.y),U=Math.max(U,M.y)}return[T,k,C,U]},Te.prototype.toGeoJSON=pr.prototype.toGeoJSON;var _r=Jr,ze=sr;function Jr(b){var T=new l.pbf;return function(C,k){for(var U in C.layers)k.writeMessage(3,Gt,C.layers[U])}(b,T),T.finish()}function Gt(b,T){var C;T.writeVarintField(15,b.version||1),T.writeStringField(1,b.name||""),T.writeVarintField(5,b.extent||4096);var k={keys:[],values:[],keycache:{},valuecache:{}};for(C=0;C<b.length;C++)k.feature=b.feature(C),T.writeMessage(2,ke,k);var U=k.keys;for(C=0;C<U.length;C++)T.writeStringField(3,U[C]);var K=k.values;for(C=0;C<K.length;C++)T.writeMessage(4,Ze,K[C])}function ke(b,T){var C=b.feature;C.id!==void 0&&T.writeVarintField(1,C.id),T.writeMessage(2,Xe,b),T.writeVarintField(3,C.type),T.writeMessage(4,nn,C)}function Xe(b,T){var C=b.feature,k=b.keys,U=b.values,K=b.keycache,tt=b.valuecache;for(var W in C.properties){var M=K[W];M===void 0&&(k.push(W),K[W]=M=k.length-1),T.writeVarint(M);var j=C.properties[W],Dt=typeof j;Dt!=="string"&&Dt!=="boolean"&&Dt!=="number"&&(j=JSON.stringify(j));var Ft=Dt+":"+j,lt=tt[Ft];lt===void 0&&(U.push(j),tt[Ft]=lt=U.length-1),T.writeVarint(lt)}}function ce(b,T){return(T<<3)+(7&b)}function fr(b){return b<<1^b>>31}function nn(b,T){for(var C=b.loadGeometry(),k=b.type,U=0,K=0,tt=C.length,W=0;W<tt;W++){var M=C[W],j=1;k===1&&(j=M.length),T.writeVarint(ce(1,j));for(var Dt=k===3?M.length-1:M.length,Ft=0;Ft<Dt;Ft++){Ft===1&&k!==1&&T.writeVarint(ce(2,Dt-1));var lt=M[Ft].x-U,It=M[Ft].y-K;T.writeVarint(fr(lt)),T.writeVarint(fr(It)),U+=lt,K+=It}k===3&&T.writeVarint(ce(7,1))}}function Ze(b,T){var C=typeof b;C==="string"?T.writeStringField(1,b):C==="boolean"?T.writeBooleanField(7,b):C==="number"&&(b%1!=0?T.writeDoubleField(3,b):b<0?T.writeSVarintField(6,b):T.writeVarintField(5,b))}function ei(b,T,C,k){$t(b,C,k),$t(T,2*C,2*k),$t(T,2*C+1,2*k+1)}function $t(b,T,C){var k=b[T];b[T]=b[C],b[C]=k}function ar(b,T,C,k){var U=b-C,K=T-k;return U*U+K*K}_r.fromVectorTileJs=Jr,_r.fromGeojsonVt=function(b,T){T=T||{};var C={};for(var k in b)C[k]=new sr(b[k].features,T),C[k].name=k,C[k].version=T.version,C[k].extent=T.extent;return Jr({layers:C})},_r.GeoJSONWrapper=ze;var Sr=function(b){return b[0]},je=function(b){return b[1]},et=function(b,T,C,k,U){T===void 0&&(T=Sr),C===void 0&&(C=je),k===void 0&&(k=64),U===void 0&&(U=Float64Array),this.nodeSize=k,this.points=b;for(var K=b.length<65536?Uint16Array:Uint32Array,tt=this.ids=new K(b.length),W=this.coords=new U(2*b.length),M=0;M<b.length;M++)tt[M]=M,W[2*M]=T(b[M]),W[2*M+1]=C(b[M]);(function j(Dt,Ft,lt,It,Xt,Jt){if(!(Xt-It<=lt)){var me=It+Xt>>1;(function Ct(qt,Pt,Ue,Oe,ae,Br){for(;ae>Oe;){if(ae-Oe>600){var Me=ae-Oe+1,Hr=Ue-Oe+1,er=Math.log(Me),nr=.5*Math.exp(2*er/3),Or=.5*Math.sqrt(er*nr*(Me-nr)/Me)*(Hr-Me/2<0?-1:1);Ct(qt,Pt,Ue,Math.max(Oe,Math.floor(Ue-Hr*nr/Me+Or)),Math.min(ae,Math.floor(Ue+(Me-Hr)*nr/Me+Or)),Br)}var gi=Pt[2*Ue+Br],Ur=Oe,Ke=ae;for(ei(qt,Pt,Oe,Ue),Pt[2*ae+Br]>gi&&ei(qt,Pt,Oe,ae);Ur<Ke;){for(ei(qt,Pt,Ur,Ke),Ur++,Ke--;Pt[2*Ur+Br]<gi;)Ur++;for(;Pt[2*Ke+Br]>gi;)Ke--}Pt[2*Oe+Br]===gi?ei(qt,Pt,Oe,Ke):ei(qt,Pt,++Ke,ae),Ke<=Ue&&(Oe=Ke+1),Ue<=Ke&&(ae=Ke-1)}})(Dt,Ft,me,It,Xt,Jt%2),j(Dt,Ft,lt,It,me-1,Jt+1),j(Dt,Ft,lt,me+1,Xt,Jt+1)}})(tt,W,k,0,tt.length-1,0)};et.prototype.range=function(b,T,C,k){return function(U,K,tt,W,M,j,Dt){for(var Ft,lt,It=[0,U.length-1,0],Xt=[];It.length;){var Jt=It.pop(),me=It.pop(),Ct=It.pop();if(me-Ct<=Dt)for(var qt=Ct;qt<=me;qt++)lt=K[2*qt+1],(Ft=K[2*qt])>=tt&&Ft<=M&&lt>=W&&lt<=j&&Xt.push(U[qt]);else{var Pt=Math.floor((Ct+me)/2);lt=K[2*Pt+1],(Ft=K[2*Pt])>=tt&&Ft<=M&&lt>=W&&lt<=j&&Xt.push(U[Pt]);var Ue=(Jt+1)%2;(Jt===0?tt<=Ft:W<=lt)&&(It.push(Ct),It.push(Pt-1),It.push(Ue)),(Jt===0?M>=Ft:j>=lt)&&(It.push(Pt+1),It.push(me),It.push(Ue))}}return Xt}(this.ids,this.coords,b,T,C,k,this.nodeSize)},et.prototype.within=function(b,T,C){return function(k,U,K,tt,W,M){for(var j=[0,k.length-1,0],Dt=[],Ft=W*W;j.length;){var lt=j.pop(),It=j.pop(),Xt=j.pop();if(It-Xt<=M)for(var Jt=Xt;Jt<=It;Jt++)ar(U[2*Jt],U[2*Jt+1],K,tt)<=Ft&&Dt.push(k[Jt]);else{var me=Math.floor((Xt+It)/2),Ct=U[2*me],qt=U[2*me+1];ar(Ct,qt,K,tt)<=Ft&&Dt.push(k[me]);var Pt=(lt+1)%2;(lt===0?K-W<=Ct:tt-W<=qt)&&(j.push(Xt),j.push(me-1),j.push(Pt)),(lt===0?K+W>=Ct:tt+W>=qt)&&(j.push(me+1),j.push(It),j.push(Pt))}}return Dt}(this.ids,this.coords,b,T,C,this.nodeSize)};var ft={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(b){return b}},it=function(b){this.options=Se(Object.create(ft),b),this.trees=new Array(this.options.maxZoom+1)};function _t(b,T,C,k,U){return{x:b,y:T,zoom:1/0,id:C,parentId:-1,numPoints:k,properties:U}}function Et(b,T){var C=b.geometry.coordinates,k=C[1];return{x:Fe(C[0]),y:ee(k),zoom:1/0,index:T,parentId:-1}}function de(b){return{type:"Feature",id:b.id,properties:Ee(b),geometry:{type:"Point",coordinates:[(k=b.x,360*(k-.5)),(T=b.y,C=(180-360*T)*Math.PI/180,360*Math.atan(Math.exp(C))/Math.PI-90)]}};var T,C,k}function Ee(b){var T=b.numPoints,C=T>=1e4?Math.round(T/1e3)+"k":T>=1e3?Math.round(T/100)/10+"k":T;return Se(Se({},b.properties),{cluster:!0,cluster_id:b.id,point_count:T,point_count_abbreviated:C})}function Fe(b){return b/360+.5}function ee(b){var T=Math.sin(b*Math.PI/180),C=.5-.25*Math.log((1+T)/(1-T))/Math.PI;return C<0?0:C>1?1:C}function Se(b,T){for(var C in T)b[C]=T[C];return b}function Ce(b){return b.x}function Rr(b){return b.y}function ai(b,T,C,k,U,K){var tt=U-C,W=K-k;if(tt!==0||W!==0){var M=((b-C)*tt+(T-k)*W)/(tt*tt+W*W);M>1?(C=U,k=K):M>0&&(C+=tt*M,k+=W*M)}return(tt=b-C)*tt+(W=T-k)*W}function Mr(b,T,C,k){var U={id:b===void 0?null:b,type:T,geometry:C,tags:k,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(K){var tt=K.geometry,W=K.type;if(W==="Point"||W==="MultiPoint"||W==="LineString")_i(K,tt);else if(W==="Polygon"||W==="MultiLineString")for(var M=0;M<tt.length;M++)_i(K,tt[M]);else if(W==="MultiPolygon")for(M=0;M<tt.length;M++)for(var j=0;j<tt[M].length;j++)_i(K,tt[M][j])}(U),U}function _i(b,T){for(var C=0;C<T.length;C+=3)b.minX=Math.min(b.minX,T[C]),b.minY=Math.min(b.minY,T[C+1]),b.maxX=Math.max(b.maxX,T[C]),b.maxY=Math.max(b.maxY,T[C+1])}function gr(b,T,C,k){if(T.geometry){var U=T.geometry.coordinates,K=T.geometry.type,tt=Math.pow(C.tolerance/((1<<C.maxZoom)*C.extent),2),W=[],M=T.id;if(C.promoteId?M=T.properties[C.promoteId]:C.generateId&&(M=k||0),K==="Point")an(U,W);else if(K==="MultiPoint")for(var j=0;j<U.length;j++)an(U[j],W);else if(K==="LineString")Gr(U,W,tt,!1);else if(K==="MultiLineString"){if(C.lineMetrics){for(j=0;j<U.length;j++)Gr(U[j],W=[],tt,!1),b.push(Mr(M,"LineString",W,T.properties));return}ri(U,W,tt,!1)}else if(K==="Polygon")ri(U,W,tt,!0);else{if(K!=="MultiPolygon"){if(K==="GeometryCollection"){for(j=0;j<T.geometry.geometries.length;j++)gr(b,{id:M,geometry:T.geometry.geometries[j],properties:T.properties},C,k);return}throw new Error("Input data is not a valid GeoJSON object.")}for(j=0;j<U.length;j++){var Dt=[];ri(U[j],Dt,tt,!0),W.push(Dt)}}b.push(Mr(M,K,W,T.properties))}}function an(b,T){T.push(oi(b[0])),T.push(on(b[1])),T.push(0)}function Gr(b,T,C,k){for(var U,K,tt=0,W=0;W<b.length;W++){var M=oi(b[W][0]),j=on(b[W][1]);T.push(M),T.push(j),T.push(0),W>0&&(tt+=k?(U*j-M*K)/2:Math.sqrt(Math.pow(M-U,2)+Math.pow(j-K,2))),U=M,K=j}var Dt=T.length-3;T[2]=1,function Ft(lt,It,Xt,Jt){for(var me,Ct=Jt,qt=Xt-It>>1,Pt=Xt-It,Ue=lt[It],Oe=lt[It+1],ae=lt[Xt],Br=lt[Xt+1],Me=It+3;Me<Xt;Me+=3){var Hr=ai(lt[Me],lt[Me+1],Ue,Oe,ae,Br);if(Hr>Ct)me=Me,Ct=Hr;else if(Hr===Ct){var er=Math.abs(Me-qt);er<Pt&&(me=Me,Pt=er)}}Ct>Jt&&(me-It>3&&Ft(lt,It,me,Jt),lt[me+2]=Ct,Xt-me>3&&Ft(lt,me,Xt,Jt))}(T,0,Dt,C),T[Dt+2]=1,T.size=Math.abs(tt),T.start=0,T.end=T.size}function ri(b,T,C,k){for(var U=0;U<b.length;U++){var K=[];Gr(b[U],K,C,k),T.push(K)}}function oi(b){return b/360+.5}function on(b){var T=Math.sin(b*Math.PI/180),C=.5-.25*Math.log((1+T)/(1-T))/Math.PI;return C<0?0:C>1?1:C}function tr(b,T,C,k,U,K,tt,W){if(k/=T,K>=(C/=T)&&tt<k)return b;if(tt<C||K>=k)return null;for(var M=[],j=0;j<b.length;j++){var Dt=b[j],Ft=Dt.geometry,lt=Dt.type,It=U===0?Dt.minX:Dt.minY,Xt=U===0?Dt.maxX:Dt.maxY;if(It>=C&&Xt<k)M.push(Dt);else if(!(Xt<C||It>=k)){var Jt=[];if(lt==="Point"||lt==="MultiPoint")si(Ft,Jt,C,k,U);else if(lt==="LineString")la(Ft,Jt,C,k,U,!1,W.lineMetrics);else if(lt==="MultiLineString")Qi(Ft,Jt,C,k,U,!1);else if(lt==="Polygon")Qi(Ft,Jt,C,k,U,!0);else if(lt==="MultiPolygon")for(var me=0;me<Ft.length;me++){var Ct=[];Qi(Ft[me],Ct,C,k,U,!0),Ct.length&&Jt.push(Ct)}if(Jt.length){if(W.lineMetrics&&lt==="LineString"){for(me=0;me<Jt.length;me++)M.push(Mr(Dt.id,lt,Jt[me],Dt.tags));continue}lt!=="LineString"&&lt!=="MultiLineString"||(Jt.length===1?(lt="LineString",Jt=Jt[0]):lt="MultiLineString"),lt!=="Point"&&lt!=="MultiPoint"||(lt=Jt.length===3?"Point":"MultiPoint"),M.push(Mr(Dt.id,lt,Jt,Dt.tags))}}}return M.length?M:null}function si(b,T,C,k,U){for(var K=0;K<b.length;K+=3){var tt=b[K+U];tt>=C&&tt<=k&&(T.push(b[K]),T.push(b[K+1]),T.push(b[K+2]))}}function la(b,T,C,k,U,K,tt){for(var W,M,j=Ji(b),Dt=U===0?ua:Ga,Ft=b.start,lt=0;lt<b.length-3;lt+=3){var It=b[lt],Xt=b[lt+1],Jt=b[lt+2],me=b[lt+3],Ct=b[lt+4],qt=U===0?It:Xt,Pt=U===0?me:Ct,Ue=!1;tt&&(W=Math.sqrt(Math.pow(It-me,2)+Math.pow(Xt-Ct,2))),qt<C?Pt>C&&(M=Dt(j,It,Xt,me,Ct,C),tt&&(j.start=Ft+W*M)):qt>k?Pt<k&&(M=Dt(j,It,Xt,me,Ct,k),tt&&(j.start=Ft+W*M)):zr(j,It,Xt,Jt),Pt<C&&qt>=C&&(M=Dt(j,It,Xt,me,Ct,C),Ue=!0),Pt>k&&qt<=k&&(M=Dt(j,It,Xt,me,Ct,k),Ue=!0),!K&&Ue&&(tt&&(j.end=Ft+W*M),T.push(j),j=Ji(b)),tt&&(Ft+=W)}var Oe=b.length-3;It=b[Oe],Xt=b[Oe+1],Jt=b[Oe+2],(qt=U===0?It:Xt)>=C&&qt<=k&&zr(j,It,Xt,Jt),Oe=j.length-3,K&&Oe>=3&&(j[Oe]!==j[0]||j[Oe+1]!==j[1])&&zr(j,j[0],j[1],j[2]),j.length&&T.push(j)}function Ji(b){var T=[];return T.size=b.size,T.start=b.start,T.end=b.end,T}function Qi(b,T,C,k,U,K){for(var tt=0;tt<b.length;tt++)la(b[tt],T,C,k,U,K,!1)}function zr(b,T,C,k){b.push(T),b.push(C),b.push(k)}function ua(b,T,C,k,U,K){var tt=(K-T)/(k-T);return b.push(K),b.push(C+(U-C)*tt),b.push(1),tt}function Ga(b,T,C,k,U,K){var tt=(K-C)/(U-C);return b.push(T+(k-T)*tt),b.push(K),b.push(1),tt}function ki(b,T){for(var C=[],k=0;k<b.length;k++){var U,K=b[k],tt=K.type;if(tt==="Point"||tt==="MultiPoint"||tt==="LineString")U=Mi(K.geometry,T);else if(tt==="MultiLineString"||tt==="Polygon"){U=[];for(var W=0;W<K.geometry.length;W++)U.push(Mi(K.geometry[W],T))}else if(tt==="MultiPolygon")for(U=[],W=0;W<K.geometry.length;W++){for(var M=[],j=0;j<K.geometry[W].length;j++)M.push(Mi(K.geometry[W][j],T));U.push(M)}C.push(Mr(K.id,tt,U,K.tags))}return C}function Mi(b,T){var C=[];C.size=b.size,b.start!==void 0&&(C.start=b.start,C.end=b.end);for(var k=0;k<b.length;k+=3)C.push(b[k]+T,b[k+1],b[k+2]);return C}function bn(b,T){if(b.transformed)return b;var C,k,U,K=1<<b.z,tt=b.x,W=b.y;for(C=0;C<b.features.length;C++){var M=b.features[C],j=M.geometry,Dt=M.type;if(M.geometry=[],Dt===1)for(k=0;k<j.length;k+=2)M.geometry.push(li(j[k],j[k+1],T,K,tt,W));else for(k=0;k<j.length;k++){var Ft=[];for(U=0;U<j[k].length;U+=2)Ft.push(li(j[k][U],j[k][U+1],T,K,tt,W));M.geometry.push(Ft)}}return b.transformed=!0,b}function li(b,T,C,k,U,K){return[Math.round(C*(b*k-U)),Math.round(C*(T*k-K))]}function qi(b,T,C,k,U){for(var K=T===U.maxZoom?0:U.tolerance/((1<<T)*U.extent),tt={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:C,y:k,z:T,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},W=0;W<b.length;W++){tt.numFeatures++,cn(tt,b[W],K,U);var M=b[W].minX,j=b[W].minY,Dt=b[W].maxX,Ft=b[W].maxY;M<tt.minX&&(tt.minX=M),j<tt.minY&&(tt.minY=j),Dt>tt.maxX&&(tt.maxX=Dt),Ft>tt.maxY&&(tt.maxY=Ft)}return tt}function cn(b,T,C,k){var U=T.geometry,K=T.type,tt=[];if(K==="Point"||K==="MultiPoint")for(var W=0;W<U.length;W+=3)tt.push(U[W]),tt.push(U[W+1]),b.numPoints++,b.numSimplified++;else if(K==="LineString")dr(tt,U,b,C,!1,!1);else if(K==="MultiLineString"||K==="Polygon")for(W=0;W<U.length;W++)dr(tt,U[W],b,C,K==="Polygon",W===0);else if(K==="MultiPolygon")for(var M=0;M<U.length;M++){var j=U[M];for(W=0;W<j.length;W++)dr(tt,j[W],b,C,!0,W===0)}if(tt.length){var Dt=T.tags||null;if(K==="LineString"&&k.lineMetrics){for(var Ft in Dt={},T.tags)Dt[Ft]=T.tags[Ft];Dt.mapbox_clip_start=U.start/U.size,Dt.mapbox_clip_end=U.end/U.size}var lt={geometry:tt,type:K==="Polygon"||K==="MultiPolygon"?3:K==="LineString"||K==="MultiLineString"?2:1,tags:Dt};T.id!==null&&(lt.id=T.id),b.features.push(lt)}}function dr(b,T,C,k,U,K){var tt=k*k;if(k>0&&T.size<(U?tt:k))C.numPoints+=T.length/3;else{for(var W=[],M=0;M<T.length;M+=3)(k===0||T[M+2]>tt)&&(C.numSimplified++,W.push(T[M]),W.push(T[M+1])),C.numPoints++;U&&function(j,Dt){for(var Ft=0,lt=0,It=j.length,Xt=It-2;lt<It;Xt=lt,lt+=2)Ft+=(j[lt]-j[Xt])*(j[lt+1]+j[Xt+1]);if(Ft>0===Dt)for(lt=0,It=j.length;lt<It/2;lt+=2){var Jt=j[lt],me=j[lt+1];j[lt]=j[It-2-lt],j[lt+1]=j[It-1-lt],j[It-2-lt]=Jt,j[It-1-lt]=me}}(W,K),b.push(W)}}function Bi(b,T){var C=(T=this.options=function(U,K){for(var tt in K)U[tt]=K[tt];return U}(Object.create(this.options),T)).debug;if(C&&console.time("preprocess data"),T.maxZoom<0||T.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(T.promoteId&&T.generateId)throw new Error("promoteId and generateId cannot be used together.");var k=function(U,K){var tt=[];if(U.type==="FeatureCollection")for(var W=0;W<U.features.length;W++)gr(tt,U.features[W],K,W);else gr(tt,U.type==="Feature"?U:{geometry:U},K);return tt}(b,T);this.tiles={},this.tileCoords=[],C&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",T.indexMaxZoom,T.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(k=function(U,K){var tt=K.buffer/K.extent,W=U,M=tr(U,1,-1-tt,tt,0,-1,2,K),j=tr(U,1,1-tt,2+tt,0,-1,2,K);return(M||j)&&(W=tr(U,1,-tt,1+tt,0,-1,2,K)||[],M&&(W=ki(M,1).concat(W)),j&&(W=W.concat(ki(j,-1)))),W}(k,T)).length&&this.splitTile(k,0,0,0),C&&(k.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function zn(b,T,C){return 32*((1<<b)*C+T)+b}function Ve(b,T){var C=b.tileID.canonical;if(!this._geoJSONIndex)return T(null,null);var k=this._geoJSONIndex.getTile(C.z,C.x,C.y);if(!k)return T(null,null);var U=new ue(k.features),K=_r(U);K.byteOffset===0&&K.byteLength===K.buffer.byteLength||(K=new Uint8Array(K)),T(null,{vectorTile:U,rawData:K.buffer})}it.prototype.load=function(b){var T=this.options,C=T.log,k=T.minZoom,U=T.maxZoom,K=T.nodeSize;C&&console.time("total time");var tt="prepare "+b.length+" points";C&&console.time(tt),this.points=b;for(var W=[],M=0;M<b.length;M++)b[M].geometry&&W.push(Et(b[M],M));this.trees[U+1]=new et(W,Ce,Rr,K,Float32Array),C&&console.timeEnd(tt);for(var j=U;j>=k;j--){var Dt=+Date.now();W=this._cluster(W,j),this.trees[j]=new et(W,Ce,Rr,K,Float32Array),C&&console.log("z%d: %d clusters in %dms",j,W.length,+Date.now()-Dt)}return C&&console.timeEnd("total time"),this},it.prototype.getClusters=function(b,T){var C=((b[0]+180)%360+360)%360-180,k=Math.max(-90,Math.min(90,b[1])),U=b[2]===180?180:((b[2]+180)%360+360)%360-180,K=Math.max(-90,Math.min(90,b[3]));if(b[2]-b[0]>=360)C=-180,U=180;else if(C>U){var tt=this.getClusters([C,k,180,K],T),W=this.getClusters([-180,k,U,K],T);return tt.concat(W)}for(var M=this.trees[this._limitZoom(T)],j=[],Dt=0,Ft=M.range(Fe(C),ee(K),Fe(U),ee(k));Dt<Ft.length;Dt+=1){var lt=M.points[Ft[Dt]];j.push(lt.numPoints?de(lt):this.points[lt.index])}return j},it.prototype.getChildren=function(b){var T=this._getOriginId(b),C=this._getOriginZoom(b),k="No cluster with the specified id.",U=this.trees[C];if(!U)throw new Error(k);var K=U.points[T];if(!K)throw new Error(k);for(var tt=this.options.radius/(this.options.extent*Math.pow(2,C-1)),W=[],M=0,j=U.within(K.x,K.y,tt);M<j.length;M+=1){var Dt=U.points[j[M]];Dt.parentId===b&&W.push(Dt.numPoints?de(Dt):this.points[Dt.index])}if(W.length===0)throw new Error(k);return W},it.prototype.getLeaves=function(b,T,C){var k=[];return this._appendLeaves(k,b,T=T||10,C=C||0,0),k},it.prototype.getTile=function(b,T,C){var k=this.trees[this._limitZoom(b)],U=Math.pow(2,b),K=this.options,tt=K.radius/K.extent,W=(C-tt)/U,M=(C+1+tt)/U,j={features:[]};return this._addTileFeatures(k.range((T-tt)/U,W,(T+1+tt)/U,M),k.points,T,C,U,j),T===0&&this._addTileFeatures(k.range(1-tt/U,W,1,M),k.points,U,C,U,j),T===U-1&&this._addTileFeatures(k.range(0,W,tt/U,M),k.points,-1,C,U,j),j.features.length?j:null},it.prototype.getClusterExpansionZoom=function(b){for(var T=this._getOriginZoom(b)-1;T<=this.options.maxZoom;){var C=this.getChildren(b);if(T++,C.length!==1)break;b=C[0].properties.cluster_id}return T},it.prototype._appendLeaves=function(b,T,C,k,U){for(var K=0,tt=this.getChildren(T);K<tt.length;K+=1){var W=tt[K],M=W.properties;if(M&&M.cluster?U+M.point_count<=k?U+=M.point_count:U=this._appendLeaves(b,M.cluster_id,C,k,U):U<k?U++:b.push(W),b.length===C)break}return U},it.prototype._addTileFeatures=function(b,T,C,k,U,K){for(var tt=0,W=b;tt<W.length;tt+=1){var M=T[W[tt]],j=M.numPoints,Dt={type:1,geometry:[[Math.round(this.options.extent*(M.x*U-C)),Math.round(this.options.extent*(M.y*U-k))]],tags:j?Ee(M):this.points[M.index].properties},Ft=void 0;j?Ft=M.id:this.options.generateId?Ft=M.index:this.points[M.index].id&&(Ft=this.points[M.index].id),Ft!==void 0&&(Dt.id=Ft),K.features.push(Dt)}},it.prototype._limitZoom=function(b){return Math.max(this.options.minZoom,Math.min(+b,this.options.maxZoom+1))},it.prototype._cluster=function(b,T){for(var C=[],k=this.options,U=k.reduce,K=k.minPoints,tt=k.radius/(k.extent*Math.pow(2,T)),W=0;W<b.length;W++){var M=b[W];if(!(M.zoom<=T)){M.zoom=T;for(var j=this.trees[T+1],Dt=j.within(M.x,M.y,tt),Ft=M.numPoints||1,lt=Ft,It=0,Xt=Dt;It<Xt.length;It+=1){var Jt=j.points[Xt[It]];Jt.zoom>T&&(lt+=Jt.numPoints||1)}if(lt>=K){for(var me=M.x*Ft,Ct=M.y*Ft,qt=U&&Ft>1?this._map(M,!0):null,Pt=(W<<5)+(T+1)+this.points.length,Ue=0,Oe=Dt;Ue<Oe.length;Ue+=1){var ae=j.points[Oe[Ue]];if(!(ae.zoom<=T)){ae.zoom=T;var Br=ae.numPoints||1;me+=ae.x*Br,Ct+=ae.y*Br,ae.parentId=Pt,U&&(qt||(qt=this._map(M,!0)),U(qt,this._map(ae)))}}M.parentId=Pt,C.push(_t(me/lt,Ct/lt,Pt,lt,qt))}else if(C.push(M),lt>1)for(var Me=0,Hr=Dt;Me<Hr.length;Me+=1){var er=j.points[Hr[Me]];er.zoom<=T||(er.zoom=T,C.push(er))}}}return C},it.prototype._getOriginId=function(b){return b-this.points.length>>5},it.prototype._getOriginZoom=function(b){return(b-this.points.length)%32},it.prototype._map=function(b,T){if(b.numPoints)return T?Se({},b.properties):b.properties;var C=this.points[b.index].properties,k=this.options.map(C);return T&&k===C?Se({},k):k},Bi.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Bi.prototype.splitTile=function(b,T,C,k,U,K,tt){for(var W=[b,T,C,k],M=this.options,j=M.debug;W.length;){k=W.pop(),C=W.pop(),T=W.pop(),b=W.pop();var Dt=1<<T,Ft=zn(T,C,k),lt=this.tiles[Ft];if(!lt&&(j>1&&console.time("creation"),lt=this.tiles[Ft]=qi(b,T,C,k,M),this.tileCoords.push({z:T,x:C,y:k}),j)){j>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",T,C,k,lt.numFeatures,lt.numPoints,lt.numSimplified),console.timeEnd("creation"));var It="z"+T;this.stats[It]=(this.stats[It]||0)+1,this.total++}if(lt.source=b,U){if(T===M.maxZoom||T===U)continue;var Xt=1<<U-T;if(C!==Math.floor(K/Xt)||k!==Math.floor(tt/Xt))continue}else if(T===M.indexMaxZoom||lt.numPoints<=M.indexMaxPoints)continue;if(lt.source=null,b.length!==0){j>1&&console.time("clipping");var Jt,me,Ct,qt,Pt,Ue,Oe=.5*M.buffer/M.extent,ae=.5-Oe,Br=.5+Oe,Me=1+Oe;Jt=me=Ct=qt=null,Pt=tr(b,Dt,C-Oe,C+Br,0,lt.minX,lt.maxX,M),Ue=tr(b,Dt,C+ae,C+Me,0,lt.minX,lt.maxX,M),b=null,Pt&&(Jt=tr(Pt,Dt,k-Oe,k+Br,1,lt.minY,lt.maxY,M),me=tr(Pt,Dt,k+ae,k+Me,1,lt.minY,lt.maxY,M),Pt=null),Ue&&(Ct=tr(Ue,Dt,k-Oe,k+Br,1,lt.minY,lt.maxY,M),qt=tr(Ue,Dt,k+ae,k+Me,1,lt.minY,lt.maxY,M),Ue=null),j>1&&console.timeEnd("clipping"),W.push(Jt||[],T+1,2*C,2*k),W.push(me||[],T+1,2*C,2*k+1),W.push(Ct||[],T+1,2*C+1,2*k),W.push(qt||[],T+1,2*C+1,2*k+1)}}},Bi.prototype.getTile=function(b,T,C){var k=this.options,U=k.extent,K=k.debug;if(b<0||b>24)return null;var tt=1<<b,W=zn(b,T=(T%tt+tt)%tt,C);if(this.tiles[W])return bn(this.tiles[W],U);K>1&&console.log("drilling down to z%d-%d-%d",b,T,C);for(var M,j=b,Dt=T,Ft=C;!M&&j>0;)j--,Dt=Math.floor(Dt/2),Ft=Math.floor(Ft/2),M=this.tiles[zn(j,Dt,Ft)];return M&&M.source?(K>1&&console.log("found parent tile z%d-%d-%d",j,Dt,Ft),K>1&&console.time("drilling down"),this.splitTile(M.source,j,Dt,Ft,b,T,C),K>1&&console.timeEnd("drilling down"),this.tiles[W]?bn(this.tiles[W],U):null):null};var Qr=function(b){function T(C,k,U,K){b.call(this,C,k,U,Ve),K&&(this.loadGeoJSON=K)}return b&&(T.__proto__=b),(T.prototype=Object.create(b&&b.prototype)).constructor=T,T.prototype.loadData=function(C,k){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=k,this._pendingLoadDataParams=C,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},T.prototype._loadData=function(){var C=this;if(this._pendingCallback&&this._pendingLoadDataParams){var k=this._pendingCallback,U=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var K=!!(U&&U.request&&U.request.collectResourceTiming)&&new l.RequestPerformance(U.request);this.loadGeoJSON(U,function(tt,W){if(tt||!W)return k(tt);if(typeof W!="object")return k(new Error("Input data given to '"+U.source+"' is not a valid GeoJSON object."));(function lt(It,Xt){var Jt,me=It&&It.type;if(me==="FeatureCollection")for(Jt=0;Jt<It.features.length;Jt++)lt(It.features[Jt],Xt);else if(me==="GeometryCollection")for(Jt=0;Jt<It.geometries.length;Jt++)lt(It.geometries[Jt],Xt);else if(me==="Feature")lt(It.geometry,Xt);else if(me==="Polygon")Z(It.coordinates,Xt);else if(me==="MultiPolygon")for(Jt=0;Jt<It.coordinates.length;Jt++)Z(It.coordinates[Jt],Xt);return It})(W,!0);try{if(U.filter){var M=l.createExpression(U.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(M.result==="error")throw new Error(M.value.map(function(lt){return lt.key+": "+lt.message}).join(", "));var j=W.features.filter(function(lt){return M.value.evaluate({zoom:0},lt)});W={type:"FeatureCollection",features:j}}C._geoJSONIndex=U.cluster?new it(function(lt){var It=lt.superclusterOptions,Xt=lt.clusterProperties;if(!Xt||!It)return It;for(var Jt={},me={},Ct={accumulated:null,zoom:0},qt={properties:null},Pt=Object.keys(Xt),Ue=0,Oe=Pt;Ue<Oe.length;Ue+=1){var ae=Oe[Ue],Br=Xt[ae],Me=Br[0],Hr=l.createExpression(Br[1]),er=l.createExpression(typeof Me=="string"?[Me,["accumulated"],["get",ae]]:Me);Jt[ae]=Hr.value,me[ae]=er.value}return It.map=function(nr){qt.properties=nr;for(var Or={},gi=0,Ur=Pt;gi<Ur.length;gi+=1){var Ke=Ur[gi];Or[Ke]=Jt[Ke].evaluate(Ct,qt)}return Or},It.reduce=function(nr,Or){qt.properties=Or;for(var gi=0,Ur=Pt;gi<Ur.length;gi+=1){var Ke=Ur[gi];Ct.accumulated=nr[Ke],nr[Ke]=me[Ke].evaluate(Ct,qt)}},It}(U)).load(W.features):function(lt,It){return new Bi(lt,It)}(W,U.geojsonVtOptions)}catch(lt){return k(lt)}C.loaded={};var Dt={};if(K){var Ft=K.finish();Ft&&(Dt.resourceTiming={},Dt.resourceTiming[U.source]=JSON.parse(JSON.stringify(Ft)))}k(null,Dt)})}},T.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},T.prototype.reloadTile=function(C,k){var U=this.loaded;return U&&U[C.uid]?b.prototype.reloadTile.call(this,C,k):this.loadTile(C,k)},T.prototype.loadGeoJSON=function(C,k){if(C.request)l.getJSON(C.request,k);else{if(typeof C.data!="string")return k(new Error("Input data given to '"+C.source+"' is not a valid GeoJSON object."));try{return k(null,JSON.parse(C.data))}catch{return k(new Error("Input data given to '"+C.source+"' is not a valid GeoJSON object."))}}},T.prototype.removeSource=function(C,k){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),k()},T.prototype.getClusterExpansionZoom=function(C,k){try{k(null,this._geoJSONIndex.getClusterExpansionZoom(C.clusterId))}catch(U){k(U)}},T.prototype.getClusterChildren=function(C,k){try{k(null,this._geoJSONIndex.getChildren(C.clusterId))}catch(U){k(U)}},T.prototype.getClusterLeaves=function(C,k){try{k(null,this._geoJSONIndex.getLeaves(C.clusterId,C.limit,C.offset))}catch(U){k(U)}},T}(kr),mr=function(b){var T=this;this.self=b,this.actor=new l.Actor(b,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:kr,geojson:Qr},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(C,k){if(T.workerSourceTypes[C])throw new Error('Worker source with name "'+C+'" already registered.');T.workerSourceTypes[C]=k},this.self.registerRTLTextPlugin=function(C){if(l.plugin.isParsed())throw new Error("RTL text plugin already registered.");l.plugin.applyArabicShaping=C.applyArabicShaping,l.plugin.processBidirectionalText=C.processBidirectionalText,l.plugin.processStyledBidirectionalText=C.processStyledBidirectionalText}};return mr.prototype.setReferrer=function(b,T){this.referrer=T},mr.prototype.setImages=function(b,T,C){for(var k in this.availableImages[b]=T,this.workerSources[b]){var U=this.workerSources[b][k];for(var K in U)U[K].availableImages=T}C()},mr.prototype.setLayers=function(b,T,C){this.getLayerIndex(b).replace(T),C()},mr.prototype.updateLayers=function(b,T,C){this.getLayerIndex(b).update(T.layers,T.removedIds),C()},mr.prototype.loadTile=function(b,T,C){this.getWorkerSource(b,T.type,T.source).loadTile(T,C)},mr.prototype.loadDEMTile=function(b,T,C){this.getDEMWorkerSource(b,T.source).loadTile(T,C)},mr.prototype.reloadTile=function(b,T,C){this.getWorkerSource(b,T.type,T.source).reloadTile(T,C)},mr.prototype.abortTile=function(b,T,C){this.getWorkerSource(b,T.type,T.source).abortTile(T,C)},mr.prototype.removeTile=function(b,T,C){this.getWorkerSource(b,T.type,T.source).removeTile(T,C)},mr.prototype.removeDEMTile=function(b,T){this.getDEMWorkerSource(b,T.source).removeTile(T)},mr.prototype.removeSource=function(b,T,C){if(this.workerSources[b]&&this.workerSources[b][T.type]&&this.workerSources[b][T.type][T.source]){var k=this.workerSources[b][T.type][T.source];delete this.workerSources[b][T.type][T.source],k.removeSource!==void 0?k.removeSource(T,C):C()}},mr.prototype.loadWorkerSource=function(b,T,C){try{this.self.importScripts(T.url),C()}catch(k){C(k.toString())}},mr.prototype.syncRTLPluginState=function(b,T,C){try{l.plugin.setState(T);var k=l.plugin.getPluginURL();if(l.plugin.isLoaded()&&!l.plugin.isParsed()&&k!=null){this.self.importScripts(k);var U=l.plugin.isParsed();C(U?void 0:new Error("RTL Text Plugin failed to import scripts from "+k),U)}}catch(K){C(K.toString())}},mr.prototype.getAvailableImages=function(b){var T=this.availableImages[b];return T||(T=[]),T},mr.prototype.getLayerIndex=function(b){var T=this.layerIndexes[b];return T||(T=this.layerIndexes[b]=new St),T},mr.prototype.getWorkerSource=function(b,T,C){var k=this;return this.workerSources[b]||(this.workerSources[b]={}),this.workerSources[b][T]||(this.workerSources[b][T]={}),this.workerSources[b][T][C]||(this.workerSources[b][T][C]=new this.workerSourceTypes[T]({send:function(U,K,tt){k.actor.send(U,K,tt,b)}},this.getLayerIndex(b),this.getAvailableImages(b))),this.workerSources[b][T][C]},mr.prototype.getDEMWorkerSource=function(b,T){return this.demWorkerSources[b]||(this.demWorkerSources[b]={}),this.demWorkerSources[b][T]||(this.demWorkerSources[b][T]=new Lt),this.demWorkerSources[b][T]},mr.prototype.enforceCacheSizeLimit=function(b,T){l.enforceCacheSizeLimit(T)},typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope&&(self.worker=new mr(self)),mr}),ht(["./shared"],function(l){var Ut=l.createCommonjsModule(function(i){function a(p){return!n(p)}function n(p){return typeof window=="undefined"||typeof document=="undefined"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var d,y,g=new Blob([""],{type:"text/javascript"}),S=URL.createObjectURL(g);try{y=new Worker(S),d=!0}catch{d=!1}return y&&y.terminate(),URL.revokeObjectURL(S),d}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var d=document.createElement("canvas");d.width=d.height=1;var y=d.getContext("2d");if(!y)return!1;var g=y.getImageData(0,0,1,1);return g&&g.width===d.width}()?(s[f=p&&p.failIfMajorPerformanceCaveat]===void 0&&(s[f]=function(d){var y=function(S){var I=document.createElement("canvas"),P=Object.create(a.webGLContextAttributes);return P.failIfMajorPerformanceCaveat=S,I.probablySupportsContext?I.probablySupportsContext("webgl",P)||I.probablySupportsContext("experimental-webgl",P):I.supportsContext?I.supportsContext("webgl",P)||I.supportsContext("experimental-webgl",P):I.getContext("webgl",P)||I.getContext("experimental-webgl",P)}(d);if(!y)return!1;var g=y.createShader(y.VERTEX_SHADER);return!(!g||y.isContextLost())&&(y.shaderSource(g,"void main() {}"),y.compileShader(g),y.getShaderParameter(g,y.COMPILE_STATUS)===!0)}(f)),s[f]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var f}i.exports?i.exports=a:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=a,window.mapboxgl.notSupportedReason=n);var s={};a.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),G={create:function(i,a,n){var s=l.window.document.createElement(i);return a!==void 0&&(s.className=a),n&&n.appendChild(s),s},createNS:function(i,a){return l.window.document.createElementNS(i,a)}},St=l.window.document&&l.window.document.documentElement.style;function Vt(i){if(!St)return i[0];for(var a=0;a<i.length;a++)if(i[a]in St)return i[a];return i[0]}var We,vt=Vt(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);G.disableDrag=function(){St&&vt&&(We=St[vt],St[vt]="none")},G.enableDrag=function(){St&&vt&&(St[vt]=We)};var wr=Vt(["transform","WebkitTransform"]);G.setTransform=function(i,a){i.style[wr]=a};var kr=!1;try{var Bt=Object.defineProperty({},"passive",{get:function(){kr=!0}});l.window.addEventListener("test",Bt,Bt),l.window.removeEventListener("test",Bt,Bt)}catch{kr=!1}G.addEventListener=function(i,a,n,s){s===void 0&&(s={}),i.addEventListener(a,n,"passive"in s&&kr?s:s.capture)},G.removeEventListener=function(i,a,n,s){s===void 0&&(s={}),i.removeEventListener(a,n,"passive"in s&&kr?s:s.capture)};var Lt=function(i){i.preventDefault(),i.stopPropagation(),l.window.removeEventListener("click",Lt,!0)};function Z(i){var a=i.userImage;return!!(a&&a.render&&a.render())&&(i.data.replace(new Uint8Array(a.data.buffer)),!0)}G.suppressClick=function(){l.window.addEventListener("click",Lt,!0),l.window.setTimeout(function(){l.window.removeEventListener("click",Lt,!0)},0)},G.mousePos=function(i,a){var n=i.getBoundingClientRect();return new l.Point(a.clientX-n.left-i.clientLeft,a.clientY-n.top-i.clientTop)},G.touchPos=function(i,a){for(var n=i.getBoundingClientRect(),s=[],p=0;p<a.length;p++)s.push(new l.Point(a[p].clientX-n.left-i.clientLeft,a[p].clientY-n.top-i.clientTop));return s},G.mouseButton=function(i){return l.window.InstallTrigger!==void 0&&i.button===2&&i.ctrlKey&&l.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:i.button},G.remove=function(i){i.parentNode&&i.parentNode.removeChild(i)};var bt=function(i){function a(){i.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new l.RGBAImage({width:1,height:1}),this.dirty=!0}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.isLoaded=function(){return this.loaded},a.prototype.setLoaded=function(n){if(this.loaded!==n&&(this.loaded=n,n)){for(var s=0,p=this.requestors;s<p.length;s+=1){var f=p[s];this._notify(f.ids,f.callback)}this.requestors=[]}},a.prototype.getImage=function(n){return this.images[n]},a.prototype.addImage=function(n,s){this._validate(n,s)&&(this.images[n]=s)},a.prototype._validate=function(n,s){var p=!0;return this._validateStretch(s.stretchX,s.data&&s.data.width)||(this.fire(new l.ErrorEvent(new Error('Image "'+n+'" has invalid "stretchX" value'))),p=!1),this._validateStretch(s.stretchY,s.data&&s.data.height)||(this.fire(new l.ErrorEvent(new Error('Image "'+n+'" has invalid "stretchY" value'))),p=!1),this._validateContent(s.content,s)||(this.fire(new l.ErrorEvent(new Error('Image "'+n+'" has invalid "content" value'))),p=!1),p},a.prototype._validateStretch=function(n,s){if(!n)return!0;for(var p=0,f=0,d=n;f<d.length;f+=1){var y=d[f];if(y[0]<p||y[1]<y[0]||s<y[1])return!1;p=y[1]}return!0},a.prototype._validateContent=function(n,s){return!(n&&(n.length!==4||n[0]<0||s.data.width<n[0]||n[1]<0||s.data.height<n[1]||n[2]<0||s.data.width<n[2]||n[3]<0||s.data.height<n[3]||n[2]<n[0]||n[3]<n[1]))},a.prototype.updateImage=function(n,s){s.version=this.images[n].version+1,this.images[n]=s,this.updatedImages[n]=!0},a.prototype.removeImage=function(n){var s=this.images[n];delete this.images[n],delete this.patterns[n],s.userImage&&s.userImage.onRemove&&s.userImage.onRemove()},a.prototype.listImages=function(){return Object.keys(this.images)},a.prototype.getImages=function(n,s){var p=!0;if(!this.isLoaded())for(var f=0,d=n;f<d.length;f+=1)this.images[d[f]]||(p=!1);this.isLoaded()||p?this._notify(n,s):this.requestors.push({ids:n,callback:s})},a.prototype._notify=function(n,s){for(var p={},f=0,d=n;f<d.length;f+=1){var y=d[f];this.images[y]||this.fire(new l.Event("styleimagemissing",{id:y}));var g=this.images[y];g?p[y]={data:g.data.clone(),pixelRatio:g.pixelRatio,sdf:g.sdf,version:g.version,stretchX:g.stretchX,stretchY:g.stretchY,content:g.content,hasRenderCallback:Boolean(g.userImage&&g.userImage.render)}:l.warnOnce('Image "'+y+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}s(null,p)},a.prototype.getPixelSize=function(){var n=this.atlasImage;return{width:n.width,height:n.height}},a.prototype.getPattern=function(n){var s=this.patterns[n],p=this.getImage(n);if(!p)return null;if(s&&s.position.version===p.version)return s.position;if(s)s.position.version=p.version;else{var f={w:p.data.width+2,h:p.data.height+2,x:0,y:0},d=new l.ImagePosition(f,p);this.patterns[n]={bin:f,position:d}}return this._updatePatternAtlas(),this.patterns[n].position},a.prototype.bind=function(n){var s=n.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new l.Texture(n,this.atlasImage,s.RGBA),this.atlasTexture.bind(s.LINEAR,s.CLAMP_TO_EDGE)},a.prototype._updatePatternAtlas=function(){var n=[];for(var s in this.patterns)n.push(this.patterns[s].bin);var p=l.potpack(n),f=p.w,d=p.h,y=this.atlasImage;for(var g in y.resize({width:f||1,height:d||1}),this.patterns){var S=this.patterns[g].bin,I=S.x+1,P=S.y+1,A=this.images[g].data,B=A.width,R=A.height;l.RGBAImage.copy(A,y,{x:0,y:0},{x:I,y:P},{width:B,height:R}),l.RGBAImage.copy(A,y,{x:0,y:R-1},{x:I,y:P-1},{width:B,height:1}),l.RGBAImage.copy(A,y,{x:0,y:0},{x:I,y:P+R},{width:B,height:1}),l.RGBAImage.copy(A,y,{x:B-1,y:0},{x:I-1,y:P},{width:1,height:R}),l.RGBAImage.copy(A,y,{x:0,y:0},{x:I+B,y:P},{width:1,height:R})}this.dirty=!0},a.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},a.prototype.dispatchRenderCallbacks=function(n){for(var s=0,p=n;s<p.length;s+=1){var f=p[s];if(!this.callbackDispatchedThisFrame[f]){this.callbackDispatchedThisFrame[f]=!0;var d=this.images[f];Z(d)&&this.updateImage(f,d)}}},a}(l.Evented),wt=pr,At=pr,ue=1e20;function pr(i,a,n,s,p,f){this.fontSize=i||24,this.buffer=a===void 0?3:a,this.cutoff=s||.25,this.fontFamily=p||"sans-serif",this.fontWeight=f||"normal",this.radius=n||8;var d=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=d,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(d*d),this.gridInner=new Float64Array(d*d),this.f=new Float64Array(d),this.d=new Float64Array(d),this.z=new Float64Array(d+1),this.v=new Int16Array(d),this.middle=Math.round(d/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function sr(i,a,n,s,p,f,d){for(var y=0;y<a;y++){for(var g=0;g<n;g++)s[g]=i[g*a+y];for(he(s,p,f,d,n),g=0;g<n;g++)i[g*a+y]=p[g]}for(g=0;g<n;g++){for(y=0;y<a;y++)s[y]=i[g*a+y];for(he(s,p,f,d,a),y=0;y<a;y++)i[g*a+y]=Math.sqrt(p[y])}}function he(i,a,n,s,p){n[0]=0,s[0]=-ue,s[1]=+ue;for(var f=1,d=0;f<p;f++){for(var y=(i[f]+f*f-(i[n[d]]+n[d]*n[d]))/(2*f-2*n[d]);y<=s[d];)d--,y=(i[f]+f*f-(i[n[d]]+n[d]*n[d]))/(2*f-2*n[d]);n[++d]=f,s[d]=y,s[d+1]=+ue}for(f=0,d=0;f<p;f++){for(;s[d+1]<f;)d++;a[f]=(f-n[d])*(f-n[d])+i[n[d]]}}pr.prototype.draw=function(i){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(i,this.buffer,this.middle);for(var a=this.ctx.getImageData(0,0,this.size,this.size),n=new Uint8ClampedArray(this.size*this.size),s=0;s<this.size*this.size;s++){var p=a.data[4*s+3]/255;this.gridOuter[s]=p===1?0:p===0?ue:Math.pow(Math.max(0,.5-p),2),this.gridInner[s]=p===1?ue:p===0?0:Math.pow(Math.max(0,p-.5),2)}for(sr(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),sr(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),s=0;s<this.size*this.size;s++)n[s]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[s]-this.gridInner[s])/this.radius+this.cutoff))));return n},wt.default=At;var Te=function(i,a){this.requestManager=i,this.localIdeographFontFamily=a,this.entries={}};Te.prototype.setURL=function(i){this.url=i},Te.prototype.getGlyphs=function(i,a){var n=this,s=[];for(var p in i)for(var f=0,d=i[p];f<d.length;f+=1)s.push({stack:p,id:d[f]});l.asyncAll(s,function(y,g){var S=y.stack,I=y.id,P=n.entries[S];P||(P=n.entries[S]={glyphs:{},requests:{},ranges:{}});var A=P.glyphs[I];if(A===void 0){if(A=n._tinySDF(P,S,I))return P.glyphs[I]=A,void g(null,{stack:S,id:I,glyph:A});var B=Math.floor(I/256);if(256*B>65535)g(new Error("glyphs > 65535 not supported"));else if(P.ranges[B])g(null,{stack:S,id:I,glyph:A});else{var R=P.requests[B];R||(R=P.requests[B]=[],Te.loadGlyphRange(S,B,n.url,n.requestManager,function(N,L){if(L){for(var q in L)n._doesCharSupportLocalGlyph(+q)||(P.glyphs[+q]=L[+q]);P.ranges[B]=!0}for(var X=0,rt=R;X<rt.length;X+=1)(0,rt[X])(N,L);delete P.requests[B]})),R.push(function(N,L){N?g(N):L&&g(null,{stack:S,id:I,glyph:L[I]||null})})}}else g(null,{stack:S,id:I,glyph:A})},function(y,g){if(y)a(y);else if(g){for(var S={},I=0,P=g;I<P.length;I+=1){var A=P[I],B=A.stack,R=A.id,N=A.glyph;(S[B]||(S[B]={}))[R]=N&&{id:N.id,bitmap:N.bitmap.clone(),metrics:N.metrics}}a(null,S)}})},Te.prototype._doesCharSupportLocalGlyph=function(i){return!!this.localIdeographFontFamily&&(l.isChar["CJK Unified Ideographs"](i)||l.isChar["Hangul Syllables"](i)||l.isChar.Hiragana(i)||l.isChar.Katakana(i))},Te.prototype._tinySDF=function(i,a,n){var s=this.localIdeographFontFamily;if(s&&this._doesCharSupportLocalGlyph(n)){var p=i.tinySDF;if(!p){var f="400";/bold/i.test(a)?f="900":/medium/i.test(a)?f="500":/light/i.test(a)&&(f="200"),p=i.tinySDF=new Te.TinySDF(24,3,8,.25,s,f)}return{id:n,bitmap:new l.AlphaImage({width:30,height:30},p.draw(String.fromCharCode(n))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},Te.loadGlyphRange=function(i,a,n,s,p){var f=256*a,d=f+255,y=s.transformRequest(s.normalizeGlyphsURL(n).replace("{fontstack}",i).replace("{range}",f+"-"+d),l.ResourceType.Glyphs);l.getArrayBuffer(y,function(g,S){if(g)p(g);else if(S){for(var I={},P=0,A=l.parseGlyphPBF(S);P<A.length;P+=1){var B=A[P];I[B.id]=B}p(null,I)}})},Te.TinySDF=wt;var _r=function(){this.specification=l.styleSpec.light.position};_r.prototype.possiblyEvaluate=function(i,a){return l.sphericalToCartesian(i.expression.evaluate(a))},_r.prototype.interpolate=function(i,a,n){return{x:l.number(i.x,a.x,n),y:l.number(i.y,a.y,n),z:l.number(i.z,a.z,n)}};var ze=new l.Properties({anchor:new l.DataConstantProperty(l.styleSpec.light.anchor),position:new _r,color:new l.DataConstantProperty(l.styleSpec.light.color),intensity:new l.DataConstantProperty(l.styleSpec.light.intensity)}),Jr=function(i){function a(n){i.call(this),this._transitionable=new l.Transitionable(ze),this.setLight(n),this._transitioning=this._transitionable.untransitioned()}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.getLight=function(){return this._transitionable.serialize()},a.prototype.setLight=function(n,s){if(s===void 0&&(s={}),!this._validate(l.validateLight,n,s))for(var p in n){var f=n[p];l.endsWith(p,"-transition")?this._transitionable.setTransition(p.slice(0,-"-transition".length),f):this._transitionable.setValue(p,f)}},a.prototype.updateTransitions=function(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)},a.prototype.hasTransition=function(){return this._transitioning.hasTransition()},a.prototype.recalculate=function(n){this.properties=this._transitioning.possiblyEvaluate(n)},a.prototype._validate=function(n,s,p){return(!p||p.validate!==!1)&&l.emitValidationErrors(this,n.call(l.validateStyle,l.extend({value:s,style:{glyphs:!0,sprite:!0},styleSpec:l.styleSpec})))},a}(l.Evented),Gt=function(i,a){this.width=i,this.height=a,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};Gt.prototype.getDash=function(i,a){var n=i.join(",")+String(a);return this.dashEntry[n]||(this.dashEntry[n]=this.addDash(i,a)),this.dashEntry[n]},Gt.prototype.getDashRanges=function(i,a,n){var s=[],p=i.length%2==1?-i[i.length-1]*n:0,f=i[0]*n,d=!0;s.push({left:p,right:f,isDash:d,zeroLength:i[0]===0});for(var y=i[0],g=1;g<i.length;g++){var S=i[g];s.push({left:p=y*n,right:f=(y+=S)*n,isDash:d=!d,zeroLength:S===0})}return s},Gt.prototype.addRoundDash=function(i,a,n){for(var s=a/2,p=-n;p<=n;p++)for(var f=this.width*(this.nextRow+n+p),d=0,y=i[d],g=0;g<this.width;g++){g/y.right>1&&(y=i[++d]);var S=Math.abs(g-y.left),I=Math.abs(g-y.right),P=Math.min(S,I),A=void 0,B=p/n*(s+1);if(y.isDash){var R=s-Math.abs(B);A=Math.sqrt(P*P+R*R)}else A=s-Math.sqrt(P*P+B*B);this.data[f+g]=Math.max(0,Math.min(255,A+128))}},Gt.prototype.addRegularDash=function(i){for(var a=i.length-1;a>=0;--a){var n=i[a],s=i[a+1];n.zeroLength?i.splice(a,1):s&&s.isDash===n.isDash&&(s.left=n.left,i.splice(a,1))}var p=i[0],f=i[i.length-1];p.isDash===f.isDash&&(p.left=f.left-this.width,f.right=p.right+this.width);for(var d=this.width*this.nextRow,y=0,g=i[y],S=0;S<this.width;S++){S/g.right>1&&(g=i[++y]);var I=Math.abs(S-g.left),P=Math.abs(S-g.right),A=Math.min(I,P);this.data[d+S]=Math.max(0,Math.min(255,(g.isDash?A:-A)+128))}},Gt.prototype.addDash=function(i,a){var n=a?7:0,s=2*n+1;if(this.nextRow+s>this.height)return l.warnOnce("LineAtlas out of space"),null;for(var p=0,f=0;f<i.length;f++)p+=i[f];if(p!==0){var d=this.width/p,y=this.getDashRanges(i,this.width,d);a?this.addRoundDash(y,d,n):this.addRegularDash(y)}var g={y:(this.nextRow+n+.5)/this.height,height:2*n/this.height,width:p};return this.nextRow+=s,this.dirty=!0,g},Gt.prototype.bind=function(i){var a=i.gl;this.texture?(a.bindTexture(a.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,a.texSubImage2D(a.TEXTURE_2D,0,0,0,this.width,this.height,a.ALPHA,a.UNSIGNED_BYTE,this.data))):(this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texImage2D(a.TEXTURE_2D,0,a.ALPHA,this.width,this.height,0,a.ALPHA,a.UNSIGNED_BYTE,this.data))};var ke=function i(a,n){this.workerPool=a,this.actors=[],this.currentActor=0,this.id=l.uniqueId();for(var s=this.workerPool.acquire(this.id),p=0;p<s.length;p++){var f=new i.Actor(s[p],n,this.id);f.name="Worker "+p,this.actors.push(f)}};function Xe(i,a,n){var s=function(p,f){if(p)return n(p);if(f){var d=l.pick(l.extend(f,i),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);f.vector_layers&&(d.vectorLayers=f.vector_layers,d.vectorLayerIds=d.vectorLayers.map(function(y){return y.id})),d.tiles=a.canonicalizeTileset(d,i.url),n(null,d)}};return i.url?l.getJSON(a.transformRequest(a.normalizeSourceURL(i.url),l.ResourceType.Source),s):l.browser.frame(function(){return s(null,i)})}ke.prototype.broadcast=function(i,a,n){l.asyncAll(this.actors,function(s,p){s.send(i,a,p)},n=n||function(){})},ke.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},ke.prototype.remove=function(){this.actors.forEach(function(i){i.remove()}),this.actors=[],this.workerPool.release(this.id)},ke.Actor=l.Actor;var ce=function(i,a,n){this.bounds=l.LngLatBounds.convert(this.validateBounds(i)),this.minzoom=a||0,this.maxzoom=n||24};ce.prototype.validateBounds=function(i){return Array.isArray(i)&&i.length===4?[Math.max(-180,i[0]),Math.max(-90,i[1]),Math.min(180,i[2]),Math.min(90,i[3])]:[-180,-90,180,90]},ce.prototype.contains=function(i){var a=Math.pow(2,i.z),n=Math.floor(l.mercatorXfromLng(this.bounds.getWest())*a),s=Math.floor(l.mercatorYfromLat(this.bounds.getNorth())*a),p=Math.ceil(l.mercatorXfromLng(this.bounds.getEast())*a),f=Math.ceil(l.mercatorYfromLat(this.bounds.getSouth())*a);return i.x>=n&&i.x<p&&i.y>=s&&i.y<f};var fr=function(i){function a(n,s,p,f){if(i.call(this),this.id=n,this.dispatcher=p,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,l.extend(this,l.pick(s,["url","scheme","tileSize","promoteId"])),this._options=l.extend({type:"vector"},s),this._collectResourceTiming=s.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(f)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.load=function(){var n=this;this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Xe(this._options,this.map._requestManager,function(s,p){n._tileJSONRequest=null,n._loaded=!0,s?n.fire(new l.ErrorEvent(s)):p&&(l.extend(n,p),p.bounds&&(n.tileBounds=new ce(p.bounds,n.minzoom,n.maxzoom)),l.postTurnstileEvent(p.tiles,n.map._requestManager._customAccessToken),l.postMapLoadEvent(p.tiles,n.map._getMapId(),n.map._requestManager._skuToken,n.map._requestManager._customAccessToken),n.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})),n.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"})))})},a.prototype.loaded=function(){return this._loaded},a.prototype.hasTile=function(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)},a.prototype.onAdd=function(n){this.map=n,this.load()},a.prototype.setSourceProperty=function(n){this._tileJSONRequest&&this._tileJSONRequest.cancel(),n(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},a.prototype.setTiles=function(n){var s=this;return this.setSourceProperty(function(){s._options.tiles=n}),this},a.prototype.setUrl=function(n){var s=this;return this.setSourceProperty(function(){s.url=n,s._options.url=n}),this},a.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},a.prototype.serialize=function(){return l.extend({},this._options)},a.prototype.loadTile=function(n,s){var p=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme)),f={request:this.map._requestManager.transformRequest(p,l.ResourceType.Tile),uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,tileSize:this.tileSize*n.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:l.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function d(y,g){return delete n.request,n.aborted?s(null):y&&y.status!==404?s(y):(g&&g.resourceTiming&&(n.resourceTiming=g.resourceTiming),this.map._refreshExpiredTiles&&g&&n.setExpiryData(g),n.loadVectorData(g,this.map.painter),l.cacheEntryPossiblyAdded(this.dispatcher),s(null),void(n.reloadCallback&&(this.loadTile(n,n.reloadCallback),n.reloadCallback=null)))}f.request.collectResourceTiming=this._collectResourceTiming,n.actor&&n.state!=="expired"?n.state==="loading"?n.reloadCallback=s:n.request=n.actor.send("reloadTile",f,d.bind(this)):(n.actor=this.dispatcher.getActor(),n.request=n.actor.send("loadTile",f,d.bind(this)))},a.prototype.abortTile=function(n){n.request&&(n.request.cancel(),delete n.request),n.actor&&n.actor.send("abortTile",{uid:n.uid,type:this.type,source:this.id},void 0)},a.prototype.unloadTile=function(n){n.unloadVectorData(),n.actor&&n.actor.send("removeTile",{uid:n.uid,type:this.type,source:this.id},void 0)},a.prototype.hasTransition=function(){return!1},a}(l.Evented),nn=function(i){function a(n,s,p,f){i.call(this),this.id=n,this.dispatcher=p,this.setEventedParent(f),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=l.extend({type:"raster"},s),l.extend(this,l.pick(s,["url","scheme","tileSize"]))}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.load=function(){var n=this;this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Xe(this._options,this.map._requestManager,function(s,p){n._tileJSONRequest=null,n._loaded=!0,s?n.fire(new l.ErrorEvent(s)):p&&(l.extend(n,p),p.bounds&&(n.tileBounds=new ce(p.bounds,n.minzoom,n.maxzoom)),l.postTurnstileEvent(p.tiles),l.postMapLoadEvent(p.tiles,n.map._getMapId(),n.map._requestManager._skuToken),n.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})),n.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"})))})},a.prototype.loaded=function(){return this._loaded},a.prototype.onAdd=function(n){this.map=n,this.load()},a.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},a.prototype.serialize=function(){return l.extend({},this._options)},a.prototype.hasTile=function(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)},a.prototype.loadTile=function(n,s){var p=this,f=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);n.request=l.getImage(this.map._requestManager.transformRequest(f,l.ResourceType.Tile),function(d,y){if(delete n.request,n.aborted)n.state="unloaded",s(null);else if(d)n.state="errored",s(d);else if(y){p.map._refreshExpiredTiles&&n.setExpiryData(y),delete y.cacheControl,delete y.expires;var g=p.map.painter.context,S=g.gl;n.texture=p.map.painter.getTileTexture(y.width),n.texture?n.texture.update(y,{useMipmap:!0}):(n.texture=new l.Texture(g,y,S.RGBA,{useMipmap:!0}),n.texture.bind(S.LINEAR,S.CLAMP_TO_EDGE,S.LINEAR_MIPMAP_NEAREST),g.extTextureFilterAnisotropic&&S.texParameterf(S.TEXTURE_2D,g.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,g.extTextureFilterAnisotropicMax)),n.state="loaded",l.cacheEntryPossiblyAdded(p.dispatcher),s(null)}})},a.prototype.abortTile=function(n,s){n.request&&(n.request.cancel(),delete n.request),s()},a.prototype.unloadTile=function(n,s){n.texture&&this.map.painter.saveTileTexture(n.texture),s()},a.prototype.hasTransition=function(){return!1},a}(l.Evented),Ze=function(i){function a(n,s,p,f){i.call(this,n,s,p,f),this.type="raster-dem",this.maxzoom=22,this._options=l.extend({type:"raster-dem"},s),this.encoding=s.encoding||"mapbox"}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},a.prototype.loadTile=function(n,s){var p=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function f(d,y){d&&(n.state="errored",s(d)),y&&(n.dem=y,n.needsHillshadePrepare=!0,n.state="loaded",s(null))}n.request=l.getImage(this.map._requestManager.transformRequest(p,l.ResourceType.Tile),function(d,y){if(delete n.request,n.aborted)n.state="unloaded",s(null);else if(d)n.state="errored",s(d);else if(y){this.map._refreshExpiredTiles&&n.setExpiryData(y),delete y.cacheControl,delete y.expires;var g=l.window.ImageBitmap&&y instanceof l.window.ImageBitmap&&l.offscreenCanvasSupported()?y:l.browser.getImageData(y,1),S={uid:n.uid,coord:n.tileID,source:this.id,rawImageData:g,encoding:this.encoding};n.actor&&n.state!=="expired"||(n.actor=this.dispatcher.getActor(),n.actor.send("loadDEMTile",S,f.bind(this)))}}.bind(this)),n.neighboringTiles=this._getNeighboringTiles(n.tileID)},a.prototype._getNeighboringTiles=function(n){var s=n.canonical,p=Math.pow(2,s.z),f=(s.x-1+p)%p,d=s.x===0?n.wrap-1:n.wrap,y=(s.x+1+p)%p,g=s.x+1===p?n.wrap+1:n.wrap,S={};return S[new l.OverscaledTileID(n.overscaledZ,d,s.z,f,s.y).key]={backfilled:!1},S[new l.OverscaledTileID(n.overscaledZ,g,s.z,y,s.y).key]={backfilled:!1},s.y>0&&(S[new l.OverscaledTileID(n.overscaledZ,d,s.z,f,s.y-1).key]={backfilled:!1},S[new l.OverscaledTileID(n.overscaledZ,n.wrap,s.z,s.x,s.y-1).key]={backfilled:!1},S[new l.OverscaledTileID(n.overscaledZ,g,s.z,y,s.y-1).key]={backfilled:!1}),s.y+1<p&&(S[new l.OverscaledTileID(n.overscaledZ,d,s.z,f,s.y+1).key]={backfilled:!1},S[new l.OverscaledTileID(n.overscaledZ,n.wrap,s.z,s.x,s.y+1).key]={backfilled:!1},S[new l.OverscaledTileID(n.overscaledZ,g,s.z,y,s.y+1).key]={backfilled:!1}),S},a.prototype.unloadTile=function(n){n.demTexture&&this.map.painter.saveTileTexture(n.demTexture),n.fbo&&(n.fbo.destroy(),delete n.fbo),n.dem&&delete n.dem,delete n.neighboringTiles,n.state="unloaded",n.actor&&n.actor.send("removeDEMTile",{uid:n.uid,source:this.id})},a}(nn),ei=function(i){function a(n,s,p,f){i.call(this),this.id=n,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=p.getActor(),this.setEventedParent(f),this._data=s.data,this._options=l.extend({},s),this._collectResourceTiming=s.collectResourceTiming,this._resourceTiming=[],s.maxzoom!==void 0&&(this.maxzoom=s.maxzoom),s.type&&(this.type=s.type),s.attribution&&(this.attribution=s.attribution),this.promoteId=s.promoteId;var d=l.EXTENT/this.tileSize;this.workerOptions=l.extend({source:this.id,cluster:s.cluster||!1,geojsonVtOptions:{buffer:(s.buffer!==void 0?s.buffer:128)*d,tolerance:(s.tolerance!==void 0?s.tolerance:.375)*d,extent:l.EXTENT,maxZoom:this.maxzoom,lineMetrics:s.lineMetrics||!1,generateId:s.generateId||!1},superclusterOptions:{maxZoom:s.clusterMaxZoom!==void 0?Math.min(s.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,s.clusterMinPoints||2),extent:l.EXTENT,radius:(s.clusterRadius||50)*d,log:!1,generateId:s.generateId||!1},clusterProperties:s.clusterProperties,filter:s.filter},s.workerOptions)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.load=function(){var n=this;this.fire(new l.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(s){if(s)n.fire(new l.ErrorEvent(s));else{var p={dataType:"source",sourceDataType:"metadata"};n._collectResourceTiming&&n._resourceTiming&&n._resourceTiming.length>0&&(p.resourceTiming=n._resourceTiming,n._resourceTiming=[]),n.fire(new l.Event("data",p))}})},a.prototype.onAdd=function(n){this.map=n,this.load()},a.prototype.setData=function(n){var s=this;return this._data=n,this.fire(new l.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(p){if(p)s.fire(new l.ErrorEvent(p));else{var f={dataType:"source",sourceDataType:"content"};s._collectResourceTiming&&s._resourceTiming&&s._resourceTiming.length>0&&(f.resourceTiming=s._resourceTiming,s._resourceTiming=[]),s.fire(new l.Event("data",f))}}),this},a.prototype.getClusterExpansionZoom=function(n,s){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:n,source:this.id},s),this},a.prototype.getClusterChildren=function(n,s){return this.actor.send("geojson.getClusterChildren",{clusterId:n,source:this.id},s),this},a.prototype.getClusterLeaves=function(n,s,p,f){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:n,limit:s,offset:p},f),this},a.prototype._updateWorkerData=function(n){var s=this;this._loaded=!1;var p=l.extend({},this.workerOptions),f=this._data;typeof f=="string"?(p.request=this.map._requestManager.transformRequest(l.browser.resolveURL(f),l.ResourceType.Source),p.request.collectResourceTiming=this._collectResourceTiming):p.data=JSON.stringify(f),this.actor.send(this.type+".loadData",p,function(d,y){s._removed||y&&y.abandoned||(s._loaded=!0,y&&y.resourceTiming&&y.resourceTiming[s.id]&&(s._resourceTiming=y.resourceTiming[s.id].slice(0)),s.actor.send(s.type+".coalesce",{source:p.source},null),n(d))})},a.prototype.loaded=function(){return this._loaded},a.prototype.loadTile=function(n,s){var p=this,f=n.actor?"reloadTile":"loadTile";n.actor=this.actor,n.request=this.actor.send(f,{type:this.type,uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:l.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(d,y){return delete n.request,n.unloadVectorData(),n.aborted?s(null):d?s(d):(n.loadVectorData(y,p.map.painter,f==="reloadTile"),s(null))})},a.prototype.abortTile=function(n){n.request&&(n.request.cancel(),delete n.request),n.aborted=!0},a.prototype.unloadTile=function(n){n.unloadVectorData(),this.actor.send("removeTile",{uid:n.uid,type:this.type,source:this.id})},a.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},a.prototype.serialize=function(){return l.extend({},this._options,{type:this.type,data:this._data})},a.prototype.hasTransition=function(){return!1},a}(l.Evented),$t=l.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),ar=function(i){function a(n,s,p,f){i.call(this),this.id=n,this.dispatcher=p,this.coordinates=s.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(f),this.options=s}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.load=function(n,s){var p=this;this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this.url=this.options.url,l.getImage(this.map._requestManager.transformRequest(this.url,l.ResourceType.Image),function(f,d){p._loaded=!0,f?p.fire(new l.ErrorEvent(f)):d&&(p.image=d,n&&(p.coordinates=n),s&&s(),p._finishLoading())})},a.prototype.loaded=function(){return this._loaded},a.prototype.updateImage=function(n){var s=this;return this.image&&n.url?(this.options.url=n.url,this.load(n.coordinates,function(){s.texture=null}),this):this},a.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})))},a.prototype.onAdd=function(n){this.map=n,this.load()},a.prototype.setCoordinates=function(n){var s=this;this.coordinates=n;var p=n.map(l.MercatorCoordinate.fromLngLat);this.tileID=function(d){for(var y=1/0,g=1/0,S=-1/0,I=-1/0,P=0,A=d;P<A.length;P+=1){var B=A[P];y=Math.min(y,B.x),g=Math.min(g,B.y),S=Math.max(S,B.x),I=Math.max(I,B.y)}var R=Math.max(S-y,I-g),N=Math.max(0,Math.floor(-Math.log(R)/Math.LN2)),L=Math.pow(2,N);return new l.CanonicalTileID(N,Math.floor((y+S)/2*L),Math.floor((g+I)/2*L))}(p),this.minzoom=this.maxzoom=this.tileID.z;var f=p.map(function(d){return s.tileID.getTilePoint(d)._round()});return this._boundsArray=new l.StructArrayLayout4i8,this._boundsArray.emplaceBack(f[0].x,f[0].y,0,0),this._boundsArray.emplaceBack(f[1].x,f[1].y,l.EXTENT,0),this._boundsArray.emplaceBack(f[3].x,f[3].y,0,l.EXTENT),this._boundsArray.emplaceBack(f[2].x,f[2].y,l.EXTENT,l.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"})),this},a.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var n=this.map.painter.context,s=n.gl;for(var p in this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,$t.members)),this.boundsSegments||(this.boundsSegments=l.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new l.Texture(n,this.image,s.RGBA),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE)),this.tiles){var f=this.tiles[p];f.state!=="loaded"&&(f.state="loaded",f.texture=this.texture)}}},a.prototype.loadTile=function(n,s){this.tileID&&this.tileID.equals(n.tileID.canonical)?(this.tiles[String(n.tileID.wrap)]=n,n.buckets={},s(null)):(n.state="errored",s(null))},a.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},a.prototype.hasTransition=function(){return!1},a}(l.Evented),Sr=function(i){function a(n,s,p,f){i.call(this,n,s,p,f),this.roundZoom=!0,this.type="video",this.options=s}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.load=function(){var n=this;this._loaded=!1;var s=this.options;this.urls=[];for(var p=0,f=s.urls;p<f.length;p+=1)this.urls.push(this.map._requestManager.transformRequest(f[p],l.ResourceType.Source).url);l.getVideo(this.urls,function(d,y){n._loaded=!0,d?n.fire(new l.ErrorEvent(d)):y&&(n.video=y,n.video.loop=!0,n.video.addEventListener("playing",function(){n.map.triggerRepaint()}),n.map&&n.video.play(),n._finishLoading())})},a.prototype.pause=function(){this.video&&this.video.pause()},a.prototype.play=function(){this.video&&this.video.play()},a.prototype.seek=function(n){if(this.video){var s=this.video.seekable;n<s.start(0)||n>s.end(0)?this.fire(new l.ErrorEvent(new l.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+s.start(0)+" and "+s.end(0)+"-second mark."))):this.video.currentTime=n}},a.prototype.getVideo=function(){return this.video},a.prototype.onAdd=function(n){this.map||(this.map=n,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},a.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var n=this.map.painter.context,s=n.gl;for(var p in this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,$t.members)),this.boundsSegments||(this.boundsSegments=l.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE),s.texSubImage2D(s.TEXTURE_2D,0,0,0,s.RGBA,s.UNSIGNED_BYTE,this.video)):(this.texture=new l.Texture(n,this.video,s.RGBA),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE)),this.tiles){var f=this.tiles[p];f.state!=="loaded"&&(f.state="loaded",f.texture=this.texture)}}},a.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},a.prototype.hasTransition=function(){return this.video&&!this.video.paused},a}(ar),je=function(i){function a(n,s,p,f){i.call(this,n,s,p,f),s.coordinates?Array.isArray(s.coordinates)&&s.coordinates.length===4&&!s.coordinates.some(function(d){return!Array.isArray(d)||d.length!==2||d.some(function(y){return typeof y!="number"})})||this.fire(new l.ErrorEvent(new l.ValidationError("sources."+n,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new l.ErrorEvent(new l.ValidationError("sources."+n,null,'missing required property "coordinates"'))),s.animate&&typeof s.animate!="boolean"&&this.fire(new l.ErrorEvent(new l.ValidationError("sources."+n,null,'optional "animate" property must be a boolean value'))),s.canvas?typeof s.canvas=="string"||s.canvas instanceof l.window.HTMLCanvasElement||this.fire(new l.ErrorEvent(new l.ValidationError("sources."+n,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new l.ErrorEvent(new l.ValidationError("sources."+n,null,'missing required property "canvas"'))),this.options=s,this.animate=s.animate===void 0||s.animate}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof l.window.HTMLCanvasElement?this.options.canvas:l.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new l.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},a.prototype.getCanvas=function(){return this.canvas},a.prototype.onAdd=function(n){this.map=n,this.load(),this.canvas&&this.animate&&this.play()},a.prototype.onRemove=function(){this.pause()},a.prototype.prepare=function(){var n=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,n=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,n=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var s=this.map.painter.context,p=s.gl;for(var f in this.boundsBuffer||(this.boundsBuffer=s.createVertexBuffer(this._boundsArray,$t.members)),this.boundsSegments||(this.boundsSegments=l.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(n||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new l.Texture(s,this.canvas,p.RGBA,{premultiply:!0}),this.tiles){var d=this.tiles[f];d.state!=="loaded"&&(d.state="loaded",d.texture=this.texture)}}},a.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},a.prototype.hasTransition=function(){return this._playing},a.prototype._hasInvalidDimensions=function(){for(var n=0,s=[this.canvas.width,this.canvas.height];n<s.length;n+=1){var p=s[n];if(isNaN(p)||p<=0)return!0}return!1},a}(ar),et={vector:fr,raster:nn,"raster-dem":Ze,geojson:ei,video:Sr,image:ar,canvas:je};function ft(i,a){var n=l.identity([]);return l.translate(n,n,[1,1,0]),l.scale(n,n,[.5*i.width,.5*i.height,1]),l.multiply(n,n,i.calculatePosMatrix(a.toUnwrapped()))}function it(i,a,n,s,p,f){var d=function(N,L,q){if(N)for(var X=0,rt=N;X<rt.length;X+=1){var ct=L[rt[X]];if(ct&&ct.source===q&&ct.type==="fill-extrusion")return!0}else for(var ot in L){var $=L[ot];if($.source===q&&$.type==="fill-extrusion")return!0}return!1}(p&&p.layers,a,i.id),y=f.maxPitchScaleFactor(),g=i.tilesIn(s,y,d);g.sort(_t);for(var S=[],I=0,P=g;I<P.length;I+=1){var A=P[I];S.push({wrappedTileID:A.tileID.wrapped().key,queryResults:A.tile.queryRenderedFeatures(a,n,i._state,A.queryGeometry,A.cameraQueryGeometry,A.scale,p,f,y,ft(i.transform,A.tileID))})}var B=function(N){for(var L={},q={},X=0,rt=N;X<rt.length;X+=1){var ct=rt[X],ot=ct.queryResults,$=ct.wrappedTileID,yt=q[$]=q[$]||{};for(var kt in ot)for(var Mt=ot[kt],Nt=yt[kt]=yt[kt]||{},ye=L[kt]=L[kt]||[],le=0,pe=Mt;le<pe.length;le+=1){var Ge=pe[le];Nt[Ge.featureIndex]||(Nt[Ge.featureIndex]=!0,ye.push(Ge))}}return L}(S);for(var R in B)B[R].forEach(function(N){var L=N.feature,q=i.getFeatureState(L.layer["source-layer"],L.id);L.source=L.layer.source,L.layer["source-layer"]&&(L.sourceLayer=L.layer["source-layer"]),L.state=q});return B}function _t(i,a){var n=i.tileID,s=a.tileID;return n.overscaledZ-s.overscaledZ||n.canonical.y-s.canonical.y||n.wrap-s.wrap||n.canonical.x-s.canonical.x}var Et=function(i,a){this.max=i,this.onRemove=a,this.reset()};Et.prototype.reset=function(){for(var i in this.data)for(var a=0,n=this.data[i];a<n.length;a+=1){var s=n[a];s.timeout&&clearTimeout(s.timeout),this.onRemove(s.value)}return this.data={},this.order=[],this},Et.prototype.add=function(i,a,n){var s=this,p=i.wrapped().key;this.data[p]===void 0&&(this.data[p]=[]);var f={value:a,timeout:void 0};if(n!==void 0&&(f.timeout=setTimeout(function(){s.remove(i,f)},n)),this.data[p].push(f),this.order.push(p),this.order.length>this.max){var d=this._getAndRemoveByKey(this.order[0]);d&&this.onRemove(d)}return this},Et.prototype.has=function(i){return i.wrapped().key in this.data},Et.prototype.getAndRemove=function(i){return this.has(i)?this._getAndRemoveByKey(i.wrapped().key):null},Et.prototype._getAndRemoveByKey=function(i){var a=this.data[i].shift();return a.timeout&&clearTimeout(a.timeout),this.data[i].length===0&&delete this.data[i],this.order.splice(this.order.indexOf(i),1),a.value},Et.prototype.getByKey=function(i){var a=this.data[i];return a?a[0].value:null},Et.prototype.get=function(i){return this.has(i)?this.data[i.wrapped().key][0].value:null},Et.prototype.remove=function(i,a){if(!this.has(i))return this;var n=i.wrapped().key,s=a===void 0?0:this.data[n].indexOf(a),p=this.data[n][s];return this.data[n].splice(s,1),p.timeout&&clearTimeout(p.timeout),this.data[n].length===0&&delete this.data[n],this.onRemove(p.value),this.order.splice(this.order.indexOf(n),1),this},Et.prototype.setMaxSize=function(i){for(this.max=i;this.order.length>this.max;){var a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this},Et.prototype.filter=function(i){var a=[];for(var n in this.data)for(var s=0,p=this.data[n];s<p.length;s+=1){var f=p[s];i(f.value)||a.push(f)}for(var d=0,y=a;d<y.length;d+=1){var g=y[d];this.remove(g.value.tileID,g)}};var de=function(i,a,n){this.context=i;var s=i.gl;this.buffer=s.createBuffer(),this.dynamicDraw=Boolean(n),this.context.unbindVAO(),i.bindElementBuffer.set(this.buffer),s.bufferData(s.ELEMENT_ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?s.DYNAMIC_DRAW:s.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer};de.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},de.prototype.updateData=function(i){var a=this.context.gl;this.context.unbindVAO(),this.bind(),a.bufferSubData(a.ELEMENT_ARRAY_BUFFER,0,i.arrayBuffer)},de.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var Ee={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},Fe=function(i,a,n,s){this.length=a.length,this.attributes=n,this.itemSize=a.bytesPerElement,this.dynamicDraw=s,this.context=i;var p=i.gl;this.buffer=p.createBuffer(),i.bindVertexBuffer.set(this.buffer),p.bufferData(p.ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?p.DYNAMIC_DRAW:p.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer};Fe.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},Fe.prototype.updateData=function(i){var a=this.context.gl;this.bind(),a.bufferSubData(a.ARRAY_BUFFER,0,i.arrayBuffer)},Fe.prototype.enableAttributes=function(i,a){for(var n=0;n<this.attributes.length;n++){var s=a.attributes[this.attributes[n].name];s!==void 0&&i.enableVertexAttribArray(s)}},Fe.prototype.setVertexAttribPointers=function(i,a,n){for(var s=0;s<this.attributes.length;s++){var p=this.attributes[s],f=a.attributes[p.name];f!==void 0&&i.vertexAttribPointer(f,p.components,i[Ee[p.type]],!1,this.itemSize,p.offset+this.itemSize*(n||0))}},Fe.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var ee=function(i){this.gl=i.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};ee.prototype.get=function(){return this.current},ee.prototype.set=function(i){},ee.prototype.getDefault=function(){return this.default},ee.prototype.setDefault=function(){this.set(this.default)};var Se=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.getDefault=function(){return l.Color.transparent},a.prototype.set=function(n){var s=this.current;(n.r!==s.r||n.g!==s.g||n.b!==s.b||n.a!==s.a||this.dirty)&&(this.gl.clearColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)},a}(ee),Ce=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.getDefault=function(){return 1},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.clearDepth(n),this.current=n,this.dirty=!1)},a}(ee),Rr=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.getDefault=function(){return 0},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.clearStencil(n),this.current=n,this.dirty=!1)},a}(ee),ai=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.getDefault=function(){return[!0,!0,!0,!0]},a.prototype.set=function(n){var s=this.current;(n[0]!==s[0]||n[1]!==s[1]||n[2]!==s[2]||n[3]!==s[3]||this.dirty)&&(this.gl.colorMask(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)},a}(ee),Mr=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.getDefault=function(){return!0},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.depthMask(n),this.current=n,this.dirty=!1)},a}(ee),_i=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.getDefault=function(){return 255},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.stencilMask(n),this.current=n,this.dirty=!1)},a}(ee),gr=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},a.prototype.set=function(n){var s=this.current;(n.func!==s.func||n.ref!==s.ref||n.mask!==s.mask||this.dirty)&&(this.gl.stencilFunc(n.func,n.ref,n.mask),this.current=n,this.dirty=!1)},a}(ee),an=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.getDefault=function(){var n=this.gl;return[n.KEEP,n.KEEP,n.KEEP]},a.prototype.set=function(n){var s=this.current;(n[0]!==s[0]||n[1]!==s[1]||n[2]!==s[2]||this.dirty)&&(this.gl.stencilOp(n[0],n[1],n[2]),this.current=n,this.dirty=!1)},a}(ee),Gr=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(n){if(n!==this.current||this.dirty){var s=this.gl;n?s.enable(s.STENCIL_TEST):s.disable(s.STENCIL_TEST),this.current=n,this.dirty=!1}},a}(ee),ri=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.getDefault=function(){return[0,1]},a.prototype.set=function(n){var s=this.current;(n[0]!==s[0]||n[1]!==s[1]||this.dirty)&&(this.gl.depthRange(n[0],n[1]),this.current=n,this.dirty=!1)},a}(ee),oi=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(n){if(n!==this.current||this.dirty){var s=this.gl;n?s.enable(s.DEPTH_TEST):s.disable(s.DEPTH_TEST),this.current=n,this.dirty=!1}},a}(ee),on=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.LESS},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.depthFunc(n),this.current=n,this.dirty=!1)},a}(ee),tr=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(n){if(n!==this.current||this.dirty){var s=this.gl;n?s.enable(s.BLEND):s.disable(s.BLEND),this.current=n,this.dirty=!1}},a}(ee),si=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.getDefault=function(){var n=this.gl;return[n.ONE,n.ZERO]},a.prototype.set=function(n){var s=this.current;(n[0]!==s[0]||n[1]!==s[1]||this.dirty)&&(this.gl.blendFunc(n[0],n[1]),this.current=n,this.dirty=!1)},a}(ee),la=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.getDefault=function(){return l.Color.transparent},a.prototype.set=function(n){var s=this.current;(n.r!==s.r||n.g!==s.g||n.b!==s.b||n.a!==s.a||this.dirty)&&(this.gl.blendColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)},a}(ee),Ji=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.FUNC_ADD},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.blendEquation(n),this.current=n,this.dirty=!1)},a}(ee),Qi=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(n){if(n!==this.current||this.dirty){var s=this.gl;n?s.enable(s.CULL_FACE):s.disable(s.CULL_FACE),this.current=n,this.dirty=!1}},a}(ee),zr=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.BACK},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.cullFace(n),this.current=n,this.dirty=!1)},a}(ee),ua=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.CCW},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.frontFace(n),this.current=n,this.dirty=!1)},a}(ee),Ga=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.useProgram(n),this.current=n,this.dirty=!1)},a}(ee),ki=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.TEXTURE0},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.activeTexture(n),this.current=n,this.dirty=!1)},a}(ee),Mi=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.getDefault=function(){var n=this.gl;return[0,0,n.drawingBufferWidth,n.drawingBufferHeight]},a.prototype.set=function(n){var s=this.current;(n[0]!==s[0]||n[1]!==s[1]||n[2]!==s[2]||n[3]!==s[3]||this.dirty)&&(this.gl.viewport(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)},a}(ee),bn=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(n){if(n!==this.current||this.dirty){var s=this.gl;s.bindFramebuffer(s.FRAMEBUFFER,n),this.current=n,this.dirty=!1}},a}(ee),li=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(n){if(n!==this.current||this.dirty){var s=this.gl;s.bindRenderbuffer(s.RENDERBUFFER,n),this.current=n,this.dirty=!1}},a}(ee),qi=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(n){if(n!==this.current||this.dirty){var s=this.gl;s.bindTexture(s.TEXTURE_2D,n),this.current=n,this.dirty=!1}},a}(ee),cn=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(n){if(n!==this.current||this.dirty){var s=this.gl;s.bindBuffer(s.ARRAY_BUFFER,n),this.current=n,this.dirty=!1}},a}(ee),dr=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(n){var s=this.gl;s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,n),this.current=n,this.dirty=!1},a}(ee),Bi=function(i){function a(n){i.call(this,n),this.vao=n.extVertexArrayObject}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(n){this.vao&&(n!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(n),this.current=n,this.dirty=!1)},a}(ee),zn=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.getDefault=function(){return 4},a.prototype.set=function(n){if(n!==this.current||this.dirty){var s=this.gl;s.pixelStorei(s.UNPACK_ALIGNMENT,n),this.current=n,this.dirty=!1}},a}(ee),Ve=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(n){if(n!==this.current||this.dirty){var s=this.gl;s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n),this.current=n,this.dirty=!1}},a}(ee),Qr=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(n){if(n!==this.current||this.dirty){var s=this.gl;s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,n),this.current=n,this.dirty=!1}},a}(ee),mr=function(i){function a(n,s){i.call(this,n),this.context=n,this.parent=s}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a}(ee),b=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.setDirty=function(){this.dirty=!0},a.prototype.set=function(n){if(n!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var s=this.gl;s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,n,0),this.current=n,this.dirty=!1}},a}(mr),T=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.set=function(n){if(n!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var s=this.gl;s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.RENDERBUFFER,n),this.current=n,this.dirty=!1}},a}(mr),C=function(i,a,n,s){this.context=i,this.width=a,this.height=n;var p=this.framebuffer=i.gl.createFramebuffer();this.colorAttachment=new b(i,p),s&&(this.depthAttachment=new T(i,p))};C.prototype.destroy=function(){var i=this.context.gl,a=this.colorAttachment.get();if(a&&i.deleteTexture(a),this.depthAttachment){var n=this.depthAttachment.get();n&&i.deleteRenderbuffer(n)}i.deleteFramebuffer(this.framebuffer)};var k=function(i,a,n){this.func=i,this.mask=a,this.range=n};k.ReadOnly=!1,k.ReadWrite=!0,k.disabled=new k(519,k.ReadOnly,[0,1]);var U=function(i,a,n,s,p,f){this.test=i,this.ref=a,this.mask=n,this.fail=s,this.depthFail=p,this.pass=f};U.disabled=new U({func:519,mask:0},0,0,7680,7680,7680);var K=function(i,a,n){this.blendFunction=i,this.blendColor=a,this.mask=n};K.disabled=new K(K.Replace=[1,0],l.Color.transparent,[!1,!1,!1,!1]),K.unblended=new K(K.Replace,l.Color.transparent,[!0,!0,!0,!0]),K.alphaBlended=new K([1,771],l.Color.transparent,[!0,!0,!0,!0]);var tt=function(i,a,n){this.enable=i,this.mode=a,this.frontFace=n};tt.disabled=new tt(!1,1029,2305),tt.backCCW=new tt(!0,1029,2305);var W=function(i){this.gl=i,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new Se(this),this.clearDepth=new Ce(this),this.clearStencil=new Rr(this),this.colorMask=new ai(this),this.depthMask=new Mr(this),this.stencilMask=new _i(this),this.stencilFunc=new gr(this),this.stencilOp=new an(this),this.stencilTest=new Gr(this),this.depthRange=new ri(this),this.depthTest=new oi(this),this.depthFunc=new on(this),this.blend=new tr(this),this.blendFunc=new si(this),this.blendColor=new la(this),this.blendEquation=new Ji(this),this.cullFace=new Qi(this),this.cullFaceSide=new zr(this),this.frontFace=new ua(this),this.program=new Ga(this),this.activeTexture=new ki(this),this.viewport=new Mi(this),this.bindFramebuffer=new bn(this),this.bindRenderbuffer=new li(this),this.bindTexture=new qi(this),this.bindVertexBuffer=new cn(this),this.bindElementBuffer=new dr(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Bi(this),this.pixelStoreUnpack=new zn(this),this.pixelStoreUnpackPremultiplyAlpha=new Ve(this),this.pixelStoreUnpackFlipY=new Qr(this),this.extTextureFilterAnisotropic=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=i.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=i.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(i.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=i.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=i.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=i.getParameter(i.MAX_TEXTURE_SIZE)};W.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},W.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},W.prototype.createIndexBuffer=function(i,a){return new de(this,i,a)},W.prototype.createVertexBuffer=function(i,a,n){return new Fe(this,i,a,n)},W.prototype.createRenderbuffer=function(i,a,n){var s=this.gl,p=s.createRenderbuffer();return this.bindRenderbuffer.set(p),s.renderbufferStorage(s.RENDERBUFFER,i,a,n),this.bindRenderbuffer.set(null),p},W.prototype.createFramebuffer=function(i,a,n){return new C(this,i,a,n)},W.prototype.clear=function(i){var a=i.color,n=i.depth,s=this.gl,p=0;a&&(p|=s.COLOR_BUFFER_BIT,this.clearColor.set(a),this.colorMask.set([!0,!0,!0,!0])),n!==void 0&&(p|=s.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(n),this.depthMask.set(!0)),s.clear(p)},W.prototype.setCullFace=function(i){i.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(i.mode),this.frontFace.set(i.frontFace))},W.prototype.setDepthMode=function(i){i.func!==this.gl.ALWAYS||i.mask?(this.depthTest.set(!0),this.depthFunc.set(i.func),this.depthMask.set(i.mask),this.depthRange.set(i.range)):this.depthTest.set(!1)},W.prototype.setStencilMode=function(i){i.test.func!==this.gl.ALWAYS||i.mask?(this.stencilTest.set(!0),this.stencilMask.set(i.mask),this.stencilOp.set([i.fail,i.depthFail,i.pass]),this.stencilFunc.set({func:i.test.func,ref:i.ref,mask:i.test.mask})):this.stencilTest.set(!1)},W.prototype.setColorMode=function(i){l.deepEqual(i.blendFunction,K.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(i.blendFunction),this.blendColor.set(i.blendColor)),this.colorMask.set(i.mask)},W.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var M=function(i){function a(n,s,p){var f=this;i.call(this),this.id=n,this.dispatcher=p,this.on("data",function(d){d.dataType==="source"&&d.sourceDataType==="metadata"&&(f._sourceLoaded=!0),f._sourceLoaded&&!f._paused&&d.dataType==="source"&&d.sourceDataType==="content"&&(f.reload(),f.transform&&f.update(f.transform))}),this.on("error",function(){f._sourceErrored=!0}),this._source=function(d,y,g,S){var I=new et[y.type](d,y,g,S);if(I.id!==d)throw new Error("Expected Source id to be "+d+" instead of "+I.id);return l.bindAll(["load","abort","unload","serialize","prepare"],I),I}(n,s,p,this),this._tiles={},this._cache=new Et(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new l.SourceFeatureState}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.onAdd=function(n){this.map=n,this._maxTileCacheSize=n?n._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(n)},a.prototype.onRemove=function(n){this._source&&this._source.onRemove&&this._source.onRemove(n)},a.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var n in this._tiles){var s=this._tiles[n];if(s.state!=="loaded"&&s.state!=="errored")return!1}return!0},a.prototype.getSource=function(){return this._source},a.prototype.pause=function(){this._paused=!0},a.prototype.resume=function(){if(this._paused){var n=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,n&&this.reload(),this.transform&&this.update(this.transform)}},a.prototype._loadTile=function(n,s){return this._source.loadTile(n,s)},a.prototype._unloadTile=function(n){if(this._source.unloadTile)return this._source.unloadTile(n,function(){})},a.prototype._abortTile=function(n){if(this._source.abortTile)return this._source.abortTile(n,function(){})},a.prototype.serialize=function(){return this._source.serialize()},a.prototype.prepare=function(n){for(var s in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var p=this._tiles[s];p.upload(n),p.prepare(this.map.style.imageManager)}},a.prototype.getIds=function(){return l.values(this._tiles).map(function(n){return n.tileID}).sort(j).map(function(n){return n.key})},a.prototype.getRenderableIds=function(n){var s=this,p=[];for(var f in this._tiles)this._isIdRenderable(f,n)&&p.push(this._tiles[f]);return n?p.sort(function(d,y){var g=d.tileID,S=y.tileID,I=new l.Point(g.canonical.x,g.canonical.y)._rotate(s.transform.angle),P=new l.Point(S.canonical.x,S.canonical.y)._rotate(s.transform.angle);return g.overscaledZ-S.overscaledZ||P.y-I.y||P.x-I.x}).map(function(d){return d.tileID.key}):p.map(function(d){return d.tileID}).sort(j).map(function(d){return d.key})},a.prototype.hasRenderableParent=function(n){var s=this.findLoadedParent(n,0);return!!s&&this._isIdRenderable(s.tileID.key)},a.prototype._isIdRenderable=function(n,s){return this._tiles[n]&&this._tiles[n].hasData()&&!this._coveredTiles[n]&&(s||!this._tiles[n].holdingForFade())},a.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var n in this._cache.reset(),this._tiles)this._tiles[n].state!=="errored"&&this._reloadTile(n,"reloading")},a.prototype._reloadTile=function(n,s){var p=this._tiles[n];p&&(p.state!=="loading"&&(p.state=s),this._loadTile(p,this._tileLoaded.bind(this,p,n,s)))},a.prototype._tileLoaded=function(n,s,p,f){if(f)return n.state="errored",void(f.status!==404?this._source.fire(new l.ErrorEvent(f,{tile:n})):this.update(this.transform));n.timeAdded=l.browser.now(),p==="expired"&&(n.refreshedUponExpiration=!0),this._setTileReloadTimer(s,n),this.getSource().type==="raster-dem"&&n.dem&&this._backfillDEM(n),this._state.initializeTileState(n,this.map?this.map.painter:null),this._source.fire(new l.Event("data",{dataType:"source",tile:n,coord:n.tileID}))},a.prototype._backfillDEM=function(n){for(var s=this.getRenderableIds(),p=0;p<s.length;p++){var f=s[p];if(n.neighboringTiles&&n.neighboringTiles[f]){var d=this.getTileByID(f);y(n,d),y(d,n)}}function y(g,S){g.needsHillshadePrepare=!0;var I=S.tileID.canonical.x-g.tileID.canonical.x,P=S.tileID.canonical.y-g.tileID.canonical.y,A=Math.pow(2,g.tileID.canonical.z),B=S.tileID.key;I===0&&P===0||Math.abs(P)>1||(Math.abs(I)>1&&(Math.abs(I+A)===1?I+=A:Math.abs(I-A)===1&&(I-=A)),S.dem&&g.dem&&(g.dem.backfillBorder(S.dem,I,P),g.neighboringTiles&&g.neighboringTiles[B]&&(g.neighboringTiles[B].backfilled=!0)))}},a.prototype.getTile=function(n){return this.getTileByID(n.key)},a.prototype.getTileByID=function(n){return this._tiles[n]},a.prototype._retainLoadedChildren=function(n,s,p,f){for(var d in this._tiles){var y=this._tiles[d];if(!(f[d]||!y.hasData()||y.tileID.overscaledZ<=s||y.tileID.overscaledZ>p)){for(var g=y.tileID;y&&y.tileID.overscaledZ>s+1;){var S=y.tileID.scaledTo(y.tileID.overscaledZ-1);(y=this._tiles[S.key])&&y.hasData()&&(g=S)}for(var I=g;I.overscaledZ>s;)if(n[(I=I.scaledTo(I.overscaledZ-1)).key]){f[g.key]=g;break}}}},a.prototype.findLoadedParent=function(n,s){if(n.key in this._loadedParentTiles){var p=this._loadedParentTiles[n.key];return p&&p.tileID.overscaledZ>=s?p:null}for(var f=n.overscaledZ-1;f>=s;f--){var d=n.scaledTo(f),y=this._getLoadedTile(d);if(y)return y}},a.prototype._getLoadedTile=function(n){var s=this._tiles[n.key];return s&&s.hasData()?s:this._cache.getByKey(n.wrapped().key)},a.prototype.updateCacheSize=function(n){var s=Math.ceil(n.width/this._source.tileSize)+1,p=Math.ceil(n.height/this._source.tileSize)+1,f=Math.floor(s*p*5),d=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,f):f;this._cache.setMaxSize(d)},a.prototype.handleWrapJump=function(n){var s=Math.round((n-(this._prevLng===void 0?n:this._prevLng))/360);if(this._prevLng=n,s){var p={};for(var f in this._tiles){var d=this._tiles[f];d.tileID=d.tileID.unwrapTo(d.tileID.wrap+s),p[d.tileID.key]=d}for(var y in this._tiles=p,this._timers)clearTimeout(this._timers[y]),delete this._timers[y];for(var g in this._tiles)this._setTileReloadTimer(g,this._tiles[g])}},a.prototype.update=function(n){var s=this;if(this.transform=n,this._sourceLoaded&&!this._paused){var p;this.updateCacheSize(n),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?p=n.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(yt){return new l.OverscaledTileID(yt.canonical.z,yt.wrap,yt.canonical.z,yt.canonical.x,yt.canonical.y)}):(p=n.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(p=p.filter(function(yt){return s._source.hasTile(yt)}))):p=[];var f=n.coveringZoomLevel(this._source),d=Math.max(f-a.maxOverzooming,this._source.minzoom),y=Math.max(f+a.maxUnderzooming,this._source.minzoom),g=this._updateRetainedTiles(p,f);if(Dt(this._source.type)){for(var S={},I={},P=0,A=Object.keys(g);P<A.length;P+=1){var B=A[P],R=g[B],N=this._tiles[B];if(N&&!(N.fadeEndTime&&N.fadeEndTime<=l.browser.now())){var L=this.findLoadedParent(R,d);L&&(this._addTile(L.tileID),S[L.tileID.key]=L.tileID),I[B]=R}}for(var q in this._retainLoadedChildren(I,f,y,g),S)g[q]||(this._coveredTiles[q]=!0,g[q]=S[q])}for(var X in g)this._tiles[X].clearFadeHold();for(var rt=0,ct=l.keysDifference(this._tiles,g);rt<ct.length;rt+=1){var ot=ct[rt],$=this._tiles[ot];$.hasSymbolBuckets&&!$.holdingForFade()?$.setHoldDuration(this.map._fadeDuration):$.hasSymbolBuckets&&!$.symbolFadeFinished()||this._removeTile(ot)}this._updateLoadedParentTileCache()}},a.prototype.releaseSymbolFadeTiles=function(){for(var n in this._tiles)this._tiles[n].holdingForFade()&&this._removeTile(n)},a.prototype._updateRetainedTiles=function(n,s){for(var p={},f={},d=Math.max(s-a.maxOverzooming,this._source.minzoom),y=Math.max(s+a.maxUnderzooming,this._source.minzoom),g={},S=0,I=n;S<I.length;S+=1){var P=I[S],A=this._addTile(P);p[P.key]=P,A.hasData()||s<this._source.maxzoom&&(g[P.key]=P)}this._retainLoadedChildren(g,s,y,p);for(var B=0,R=n;B<R.length;B+=1){var N=R[B],L=this._tiles[N.key];if(!L.hasData()){if(s+1>this._source.maxzoom){var q=N.children(this._source.maxzoom)[0],X=this.getTile(q);if(X&&X.hasData()){p[q.key]=q;continue}}else{var rt=N.children(this._source.maxzoom);if(p[rt[0].key]&&p[rt[1].key]&&p[rt[2].key]&&p[rt[3].key])continue}for(var ct=L.wasRequested(),ot=N.overscaledZ-1;ot>=d;--ot){var $=N.scaledTo(ot);if(f[$.key]||(f[$.key]=!0,!(L=this.getTile($))&&ct&&(L=this._addTile($)),L&&(p[$.key]=$,ct=L.wasRequested(),L.hasData())))break}}}return p},a.prototype._updateLoadedParentTileCache=function(){for(var n in this._loadedParentTiles={},this._tiles){for(var s=[],p=void 0,f=this._tiles[n].tileID;f.overscaledZ>0;){if(f.key in this._loadedParentTiles){p=this._loadedParentTiles[f.key];break}s.push(f.key);var d=f.scaledTo(f.overscaledZ-1);if(p=this._getLoadedTile(d))break;f=d}for(var y=0,g=s;y<g.length;y+=1)this._loadedParentTiles[g[y]]=p}},a.prototype._addTile=function(n){var s=this._tiles[n.key];if(s)return s;(s=this._cache.getAndRemove(n))&&(this._setTileReloadTimer(n.key,s),s.tileID=n,this._state.initializeTileState(s,this.map?this.map.painter:null),this._cacheTimers[n.key]&&(clearTimeout(this._cacheTimers[n.key]),delete this._cacheTimers[n.key],this._setTileReloadTimer(n.key,s)));var p=Boolean(s);return p||(s=new l.Tile(n,this._source.tileSize*n.overscaleFactor()),this._loadTile(s,this._tileLoaded.bind(this,s,n.key,s.state))),s?(s.uses++,this._tiles[n.key]=s,p||this._source.fire(new l.Event("dataloading",{tile:s,coord:s.tileID,dataType:"source"})),s):null},a.prototype._setTileReloadTimer=function(n,s){var p=this;n in this._timers&&(clearTimeout(this._timers[n]),delete this._timers[n]);var f=s.getExpiryTimeout();f&&(this._timers[n]=setTimeout(function(){p._reloadTile(n,"expired"),delete p._timers[n]},f))},a.prototype._removeTile=function(n){var s=this._tiles[n];s&&(s.uses--,delete this._tiles[n],this._timers[n]&&(clearTimeout(this._timers[n]),delete this._timers[n]),s.uses>0||(s.hasData()&&s.state!=="reloading"?this._cache.add(s.tileID,s,s.getExpiryTimeout()):(s.aborted=!0,this._abortTile(s),this._unloadTile(s))))},a.prototype.clearTiles=function(){for(var n in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(n);this._cache.reset()},a.prototype.tilesIn=function(n,s,p){var f=this,d=[],y=this.transform;if(!y)return d;for(var g=p?y.getCameraQueryGeometry(n):n,S=n.map(function(ot){return y.pointCoordinate(ot)}),I=g.map(function(ot){return y.pointCoordinate(ot)}),P=this.getIds(),A=1/0,B=1/0,R=-1/0,N=-1/0,L=0,q=I;L<q.length;L+=1){var X=q[L];A=Math.min(A,X.x),B=Math.min(B,X.y),R=Math.max(R,X.x),N=Math.max(N,X.y)}for(var rt=function(ot){var $=f._tiles[P[ot]];if(!$.holdingForFade()){var yt=$.tileID,kt=Math.pow(2,y.zoom-$.tileID.overscaledZ),Mt=s*$.queryPadding*l.EXTENT/$.tileSize/kt,Nt=[yt.getTilePoint(new l.MercatorCoordinate(A,B)),yt.getTilePoint(new l.MercatorCoordinate(R,N))];if(Nt[0].x-Mt<l.EXTENT&&Nt[0].y-Mt<l.EXTENT&&Nt[1].x+Mt>=0&&Nt[1].y+Mt>=0){var ye=S.map(function(pe){return yt.getTilePoint(pe)}),le=I.map(function(pe){return yt.getTilePoint(pe)});d.push({tile:$,tileID:yt,queryGeometry:ye,cameraQueryGeometry:le,scale:kt})}}},ct=0;ct<P.length;ct++)rt(ct);return d},a.prototype.getVisibleCoordinates=function(n){for(var s=this,p=this.getRenderableIds(n).map(function(g){return s._tiles[g].tileID}),f=0,d=p;f<d.length;f+=1){var y=d[f];y.posMatrix=this.transform.calculatePosMatrix(y.toUnwrapped())}return p},a.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Dt(this._source.type))for(var n in this._tiles){var s=this._tiles[n];if(s.fadeEndTime!==void 0&&s.fadeEndTime>=l.browser.now())return!0}return!1},a.prototype.setFeatureState=function(n,s,p){this._state.updateState(n=n||"_geojsonTileLayer",s,p)},a.prototype.removeFeatureState=function(n,s,p){this._state.removeFeatureState(n=n||"_geojsonTileLayer",s,p)},a.prototype.getFeatureState=function(n,s){return this._state.getState(n=n||"_geojsonTileLayer",s)},a.prototype.setDependencies=function(n,s,p){var f=this._tiles[n];f&&f.setDependencies(s,p)},a.prototype.reloadTilesForDependencies=function(n,s){for(var p in this._tiles)this._tiles[p].hasDependency(n,s)&&this._reloadTile(p,"reloading");this._cache.filter(function(f){return!f.hasDependency(n,s)})},a}(l.Evented);function j(i,a){var n=Math.abs(2*i.wrap)-+(i.wrap<0),s=Math.abs(2*a.wrap)-+(a.wrap<0);return i.overscaledZ-a.overscaledZ||s-n||a.canonical.y-i.canonical.y||a.canonical.x-i.canonical.x}function Dt(i){return i==="raster"||i==="image"||i==="video"}function Ft(){return new l.window.Worker(ne.workerUrl)}M.maxOverzooming=10,M.maxUnderzooming=3;var lt="mapboxgl_preloaded_worker_pool",It=function(){this.active={}};It.prototype.acquire=function(i){if(!this.workers)for(this.workers=[];this.workers.length<It.workerCount;)this.workers.push(new Ft);return this.active[i]=!0,this.workers.slice()},It.prototype.release=function(i){delete this.active[i],this.numActive()===0&&(this.workers.forEach(function(a){a.terminate()}),this.workers=null)},It.prototype.isPreloaded=function(){return!!this.active[lt]},It.prototype.numActive=function(){return Object.keys(this.active).length};var Xt,Jt=Math.floor(l.browser.hardwareConcurrency/2);function me(){return Xt||(Xt=new It),Xt}function Ct(i,a){var n={};for(var s in i)s!=="ref"&&(n[s]=i[s]);return l.refProperties.forEach(function(p){p in a&&(n[p]=a[p])}),n}function qt(i){i=i.slice();for(var a=Object.create(null),n=0;n<i.length;n++)a[i[n].id]=i[n];for(var s=0;s<i.length;s++)"ref"in i[s]&&(i[s]=Ct(i[s],a[i[s].ref]));return i}It.workerCount=Math.max(Math.min(Jt,6),1);var Pt={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Ue(i,a,n){n.push({command:Pt.addSource,args:[i,a[i]]})}function Oe(i,a,n){a.push({command:Pt.removeSource,args:[i]}),n[i]=!0}function ae(i,a,n,s){Oe(i,n,s),Ue(i,a,n)}function Br(i,a,n){var s;for(s in i[n])if(i[n].hasOwnProperty(s)&&s!=="data"&&!l.deepEqual(i[n][s],a[n][s]))return!1;for(s in a[n])if(a[n].hasOwnProperty(s)&&s!=="data"&&!l.deepEqual(i[n][s],a[n][s]))return!1;return!0}function Me(i,a,n,s,p,f){var d;for(d in a=a||{},i=i||{})i.hasOwnProperty(d)&&(l.deepEqual(i[d],a[d])||n.push({command:f,args:[s,d,a[d],p]}));for(d in a)a.hasOwnProperty(d)&&!i.hasOwnProperty(d)&&(l.deepEqual(i[d],a[d])||n.push({command:f,args:[s,d,a[d],p]}))}function Hr(i){return i.id}function er(i,a){return i[a.id]=a,i}var nr=function(i,a){this.reset(i,a)};nr.prototype.reset=function(i,a){this.points=i||[],this._distances=[0];for(var n=1;n<this.points.length;n++)this._distances[n]=this._distances[n-1]+this.points[n].dist(this.points[n-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(a||0,.5*this.length),this.paddedLength=this.length-2*this.padding},nr.prototype.lerp=function(i){if(this.points.length===1)return this.points[0];i=l.clamp(i,0,1);for(var a=1,n=this._distances[a],s=i*this.paddedLength+this.padding;n<s&&a<this._distances.length;)n=this._distances[++a];var p=a-1,f=this._distances[p],d=n-f,y=d>0?(s-f)/d:0;return this.points[p].mult(1-y).add(this.points[a].mult(y))};var Or=function(i,a,n){var s=this.boxCells=[],p=this.circleCells=[];this.xCellCount=Math.ceil(i/n),this.yCellCount=Math.ceil(a/n);for(var f=0;f<this.xCellCount*this.yCellCount;f++)s.push([]),p.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=i,this.height=a,this.xScale=this.xCellCount/i,this.yScale=this.yCellCount/a,this.boxUid=0,this.circleUid=0};function gi(i,a,n,s,p){var f=l.create();return a?(l.scale(f,f,[1/p,1/p,1]),n||l.rotateZ(f,f,s.angle)):l.multiply(f,s.labelPlaneMatrix,i),f}function Ur(i,a,n,s,p){if(a){var f=l.clone(i);return l.scale(f,f,[p,p,1]),n||l.rotateZ(f,f,-s.angle),f}return s.glCoordMatrix}function Ke(i,a){var n=[i.x,i.y,0,1];Kn(n,n,a);var s=n[3];return{point:new l.Point(n[0]/s,n[1]/s),signedDistanceFromCamera:s}}function Bo(i,a){return .5+i/a*.5}function $e(i,a){var n=i[0]/i[3],s=i[1]/i[3];return n>=-a[0]&&n<=a[0]&&s>=-a[1]&&s<=a[1]}function Ha(i,a,n,s,p,f,d,y){var g=s?i.textSizeData:i.iconSizeData,S=l.evaluateSizeForZoom(g,n.transform.zoom),I=[256/n.width*2+1,256/n.height*2+1],P=s?i.text.dynamicLayoutVertexArray:i.icon.dynamicLayoutVertexArray;P.clear();for(var A=i.lineVertexArray,B=s?i.text.placedSymbolArray:i.icon.placedSymbolArray,R=n.transform.width/n.transform.height,N=!1,L=0;L<B.length;L++){var q=B.get(L);if(q.hidden||q.writingMode===l.WritingMode.vertical&&!N)ca(q.numGlyphs,P);else{N=!1;var X=[q.anchorX,q.anchorY,0,1];if(l.transformMat4(X,X,a),$e(X,I)){var rt=Bo(n.transform.cameraToCenterDistance,X[3]),ct=l.evaluateSizeForFeature(g,S,q),ot=d?ct/rt:ct*rt,$=new l.Point(q.anchorX,q.anchorY),yt=Ke($,p).point,kt={},Mt=Pn(q,ot,!1,y,a,p,f,i.glyphOffsetArray,A,P,yt,$,kt,R);N=Mt.useVertical,(Mt.notEnoughRoom||N||Mt.needsFlipping&&Pn(q,ot,!0,y,a,p,f,i.glyphOffsetArray,A,P,yt,$,kt,R).notEnoughRoom)&&ca(q.numGlyphs,P)}else ca(q.numGlyphs,P)}}s?i.text.dynamicLayoutVertexBuffer.updateData(P):i.icon.dynamicLayoutVertexBuffer.updateData(P)}function go(i,a,n,s,p,f,d,y,g,S,I){var P=y.glyphStartIndex+y.numGlyphs,A=y.lineStartIndex,B=y.lineStartIndex+y.lineLength,R=a.getoffsetX(y.glyphStartIndex),N=a.getoffsetX(P-1),L=Oo(i*R,n,s,p,f,d,y.segment,A,B,g,S,I);if(!L)return null;var q=Oo(i*N,n,s,p,f,d,y.segment,A,B,g,S,I);return q?{first:L,last:q}:null}function $i(i,a,n,s){return i===l.WritingMode.horizontal&&Math.abs(n.y-a.y)>Math.abs(n.x-a.x)*s?{useVertical:!0}:(i===l.WritingMode.vertical?a.y<n.y:a.x>n.x)?{needsFlipping:!0}:null}function Pn(i,a,n,s,p,f,d,y,g,S,I,P,A,B){var R,N=a/24,L=i.lineOffsetX*N,q=i.lineOffsetY*N;if(i.numGlyphs>1){var X=i.glyphStartIndex+i.numGlyphs,rt=i.lineStartIndex,ct=i.lineStartIndex+i.lineLength,ot=go(N,y,L,q,n,I,P,i,g,f,A);if(!ot)return{notEnoughRoom:!0};var $=Ke(ot.first.point,d).point,yt=Ke(ot.last.point,d).point;if(s&&!n){var kt=$i(i.writingMode,$,yt,B);if(kt)return kt}R=[ot.first];for(var Mt=i.glyphStartIndex+1;Mt<X-1;Mt++)R.push(Oo(N*y.getoffsetX(Mt),L,q,n,I,P,i.segment,rt,ct,g,f,A));R.push(ot.last)}else{if(s&&!n){var Nt=Ke(P,p).point,ye=i.lineStartIndex+i.segment+1,le=new l.Point(g.getx(ye),g.gety(ye)),pe=Ke(le,p),Ge=pe.signedDistanceFromCamera>0?pe.point:rs(P,le,Nt,1,p),jt=$i(i.writingMode,Nt,Ge,B);if(jt)return jt}var Re=Oo(N*y.getoffsetX(i.glyphStartIndex),L,q,n,I,P,i.segment,i.lineStartIndex,i.lineStartIndex+i.lineLength,g,f,A);if(!Re)return{notEnoughRoom:!0};R=[Re]}for(var Pe=0,_e=R;Pe<_e.length;Pe+=1){var Ie=_e[Pe];l.addDynamicAttributes(S,Ie.point,Ie.angle)}return{}}function rs(i,a,n,s,p){var f=Ke(i.add(i.sub(a)._unit()),p).point,d=n.sub(f);return n.add(d._mult(s/d.mag()))}function Oo(i,a,n,s,p,f,d,y,g,S,I,P){var A=s?i-a:i+a,B=A>0?1:-1,R=0;s&&(B*=-1,R=Math.PI),B<0&&(R+=Math.PI);for(var N=B>0?y+d:y+d+1,L=p,q=p,X=0,rt=0,ct=Math.abs(A),ot=[];X+rt<=ct;){if((N+=B)<y||N>=g)return null;if(q=L,ot.push(L),(L=P[N])===void 0){var $=new l.Point(S.getx(N),S.gety(N)),yt=Ke($,I);if(yt.signedDistanceFromCamera>0)L=P[N]=yt.point;else{var kt=N-B;L=rs(X===0?f:new l.Point(S.getx(kt),S.gety(kt)),$,q,ct-X+1,I)}}X+=rt,rt=q.dist(L)}var Mt=(ct-X)/rt,Nt=L.sub(q),ye=Nt.mult(Mt)._add(q);ye._add(Nt._unit()._perp()._mult(n*B));var le=R+Math.atan2(L.y-q.y,L.x-q.x);return ot.push(ye),{point:ye,angle:le,path:ot}}Or.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},Or.prototype.insert=function(i,a,n,s,p){this._forEachCell(a,n,s,p,this._insertBoxCell,this.boxUid++),this.boxKeys.push(i),this.bboxes.push(a),this.bboxes.push(n),this.bboxes.push(s),this.bboxes.push(p)},Or.prototype.insertCircle=function(i,a,n,s){this._forEachCell(a-s,n-s,a+s,n+s,this._insertCircleCell,this.circleUid++),this.circleKeys.push(i),this.circles.push(a),this.circles.push(n),this.circles.push(s)},Or.prototype._insertBoxCell=function(i,a,n,s,p,f){this.boxCells[p].push(f)},Or.prototype._insertCircleCell=function(i,a,n,s,p,f){this.circleCells[p].push(f)},Or.prototype._query=function(i,a,n,s,p,f){if(n<0||i>this.width||s<0||a>this.height)return!p&&[];var d=[];if(i<=0&&a<=0&&this.width<=n&&this.height<=s){if(p)return!0;for(var y=0;y<this.boxKeys.length;y++)d.push({key:this.boxKeys[y],x1:this.bboxes[4*y],y1:this.bboxes[4*y+1],x2:this.bboxes[4*y+2],y2:this.bboxes[4*y+3]});for(var g=0;g<this.circleKeys.length;g++){var S=this.circles[3*g],I=this.circles[3*g+1],P=this.circles[3*g+2];d.push({key:this.circleKeys[g],x1:S-P,y1:I-P,x2:S+P,y2:I+P})}return f?d.filter(f):d}return this._forEachCell(i,a,n,s,this._queryCell,d,{hitTest:p,seenUids:{box:{},circle:{}}},f),p?d.length>0:d},Or.prototype._queryCircle=function(i,a,n,s,p){var f=i-n,d=i+n,y=a-n,g=a+n;if(d<0||f>this.width||g<0||y>this.height)return!s&&[];var S=[];return this._forEachCell(f,y,d,g,this._queryCellCircle,S,{hitTest:s,circle:{x:i,y:a,radius:n},seenUids:{box:{},circle:{}}},p),s?S.length>0:S},Or.prototype.query=function(i,a,n,s,p){return this._query(i,a,n,s,!1,p)},Or.prototype.hitTest=function(i,a,n,s,p){return this._query(i,a,n,s,!0,p)},Or.prototype.hitTestCircle=function(i,a,n,s){return this._queryCircle(i,a,n,!0,s)},Or.prototype._queryCell=function(i,a,n,s,p,f,d,y){var g=d.seenUids,S=this.boxCells[p];if(S!==null)for(var I=this.bboxes,P=0,A=S;P<A.length;P+=1){var B=A[P];if(!g.box[B]){g.box[B]=!0;var R=4*B;if(i<=I[R+2]&&a<=I[R+3]&&n>=I[R+0]&&s>=I[R+1]&&(!y||y(this.boxKeys[B]))){if(d.hitTest)return f.push(!0),!0;f.push({key:this.boxKeys[B],x1:I[R],y1:I[R+1],x2:I[R+2],y2:I[R+3]})}}}var N=this.circleCells[p];if(N!==null)for(var L=this.circles,q=0,X=N;q<X.length;q+=1){var rt=X[q];if(!g.circle[rt]){g.circle[rt]=!0;var ct=3*rt;if(this._circleAndRectCollide(L[ct],L[ct+1],L[ct+2],i,a,n,s)&&(!y||y(this.circleKeys[rt]))){if(d.hitTest)return f.push(!0),!0;var ot=L[ct],$=L[ct+1],yt=L[ct+2];f.push({key:this.circleKeys[rt],x1:ot-yt,y1:$-yt,x2:ot+yt,y2:$+yt})}}}},Or.prototype._queryCellCircle=function(i,a,n,s,p,f,d,y){var g=d.circle,S=d.seenUids,I=this.boxCells[p];if(I!==null)for(var P=this.bboxes,A=0,B=I;A<B.length;A+=1){var R=B[A];if(!S.box[R]){S.box[R]=!0;var N=4*R;if(this._circleAndRectCollide(g.x,g.y,g.radius,P[N+0],P[N+1],P[N+2],P[N+3])&&(!y||y(this.boxKeys[R])))return f.push(!0),!0}}var L=this.circleCells[p];if(L!==null)for(var q=this.circles,X=0,rt=L;X<rt.length;X+=1){var ct=rt[X];if(!S.circle[ct]){S.circle[ct]=!0;var ot=3*ct;if(this._circlesCollide(q[ot],q[ot+1],q[ot+2],g.x,g.y,g.radius)&&(!y||y(this.circleKeys[ct])))return f.push(!0),!0}}},Or.prototype._forEachCell=function(i,a,n,s,p,f,d,y){for(var g=this._convertToXCellCoord(i),S=this._convertToYCellCoord(a),I=this._convertToXCellCoord(n),P=this._convertToYCellCoord(s),A=g;A<=I;A++)for(var B=S;B<=P;B++)if(p.call(this,i,a,n,s,this.xCellCount*B+A,f,d,y))return},Or.prototype._convertToXCellCoord=function(i){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(i*this.xScale)))},Or.prototype._convertToYCellCoord=function(i){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(i*this.yScale)))},Or.prototype._circlesCollide=function(i,a,n,s,p,f){var d=s-i,y=p-a,g=n+f;return g*g>d*d+y*y},Or.prototype._circleAndRectCollide=function(i,a,n,s,p,f,d){var y=(f-s)/2,g=Math.abs(i-(s+y));if(g>y+n)return!1;var S=(d-p)/2,I=Math.abs(a-(p+S));if(I>S+n)return!1;if(g<=y||I<=S)return!0;var P=g-y,A=I-S;return P*P+A*A<=n*n};var Oi=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function ca(i,a){for(var n=0;n<i;n++){var s=a.length;a.resize(s+4),a.float32.set(Oi,3*s)}}function Kn(i,a,n){var s=a[0],p=a[1];return i[0]=n[0]*s+n[4]*p+n[12],i[1]=n[1]*s+n[5]*p+n[13],i[3]=n[3]*s+n[7]*p+n[15],i}var ii=function(i,a,n){a===void 0&&(a=new Or(i.width+200,i.height+200,25)),n===void 0&&(n=new Or(i.width+200,i.height+200,25)),this.transform=i,this.grid=a,this.ignoredGrid=n,this.pitchfactor=Math.cos(i._pitch)*i.cameraToCenterDistance,this.screenRightBoundary=i.width+100,this.screenBottomBoundary=i.height+100,this.gridRightBoundary=i.width+200,this.gridBottomBoundary=i.height+200};function wn(i,a,n){return a*(l.EXTENT/(i.tileSize*Math.pow(2,n-i.tileID.overscaledZ)))}ii.prototype.placeCollisionBox=function(i,a,n,s,p){var f=this.projectAndGetPerspectiveRatio(s,i.anchorPointX,i.anchorPointY),d=n*f.perspectiveRatio,y=i.x1*d+f.point.x,g=i.y1*d+f.point.y,S=i.x2*d+f.point.x,I=i.y2*d+f.point.y;return!this.isInsideGrid(y,g,S,I)||!a&&this.grid.hitTest(y,g,S,I,p)?{box:[],offscreen:!1}:{box:[y,g,S,I],offscreen:this.isOffscreen(y,g,S,I)}},ii.prototype.placeCollisionCircles=function(i,a,n,s,p,f,d,y,g,S,I,P,A){var B=[],R=new l.Point(a.anchorX,a.anchorY),N=Ke(R,f),L=Bo(this.transform.cameraToCenterDistance,N.signedDistanceFromCamera),q=(S?p/L:p*L)/l.ONE_EM,X=Ke(R,d).point,rt=go(q,s,a.lineOffsetX*q,a.lineOffsetY*q,!1,X,R,a,n,d,{}),ct=!1,ot=!1,$=!0;if(rt){for(var yt=.5*P*L+A,kt=new l.Point(-100,-100),Mt=new l.Point(this.screenRightBoundary,this.screenBottomBoundary),Nt=new nr,ye=rt.first,le=rt.last,pe=[],Ge=ye.path.length-1;Ge>=1;Ge--)pe.push(ye.path[Ge]);for(var jt=1;jt<le.path.length;jt++)pe.push(le.path[jt]);var Re=2.5*yt;if(y){var Pe=pe.map(function(Kr){return Ke(Kr,y)});pe=Pe.some(function(Kr){return Kr.signedDistanceFromCamera<=0})?[]:Pe.map(function(Kr){return Kr.point})}var _e=[];if(pe.length>0){for(var Ie=pe[0].clone(),ge=pe[0].clone(),se=1;se<pe.length;se++)Ie.x=Math.min(Ie.x,pe[se].x),Ie.y=Math.min(Ie.y,pe[se].y),ge.x=Math.max(ge.x,pe[se].x),ge.y=Math.max(ge.y,pe[se].y);_e=Ie.x>=kt.x&&ge.x<=Mt.x&&Ie.y>=kt.y&&ge.y<=Mt.y?[pe]:ge.x<kt.x||Ie.x>Mt.x||ge.y<kt.y||Ie.y>Mt.y?[]:l.clipLine([pe],kt.x,kt.y,Mt.x,Mt.y)}for(var oe=0,He=_e;oe<He.length;oe+=1){var Be;Nt.reset(He[oe],.25*yt),Be=Nt.length<=.5*yt?1:Math.ceil(Nt.paddedLength/Re)+1;for(var fi=0;fi<Be;fi++){var di=fi/Math.max(Be-1,1),xi=Nt.lerp(di),jr=xi.x+100,bi=xi.y+100;B.push(jr,bi,yt,0);var Qe=jr-yt,Lr=bi-yt,Pi=jr+yt,Ir=bi+yt;if($=$&&this.isOffscreen(Qe,Lr,Pi,Ir),ot=ot||this.isInsideGrid(Qe,Lr,Pi,Ir),!i&&this.grid.hitTestCircle(jr,bi,yt,I)&&(ct=!0,!g))return{circles:[],offscreen:!1,collisionDetected:ct}}}}return{circles:!g&&ct||!ot?[]:B,offscreen:$,collisionDetected:ct}},ii.prototype.queryRenderedSymbols=function(i){if(i.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var a=[],n=1/0,s=1/0,p=-1/0,f=-1/0,d=0,y=i;d<y.length;d+=1){var g=y[d],S=new l.Point(g.x+100,g.y+100);n=Math.min(n,S.x),s=Math.min(s,S.y),p=Math.max(p,S.x),f=Math.max(f,S.y),a.push(S)}for(var I={},P={},A=0,B=this.grid.query(n,s,p,f).concat(this.ignoredGrid.query(n,s,p,f));A<B.length;A+=1){var R=B[A],N=R.key;if(I[N.bucketInstanceId]===void 0&&(I[N.bucketInstanceId]={}),!I[N.bucketInstanceId][N.featureIndex]){var L=[new l.Point(R.x1,R.y1),new l.Point(R.x2,R.y1),new l.Point(R.x2,R.y2),new l.Point(R.x1,R.y2)];l.polygonIntersectsPolygon(a,L)&&(I[N.bucketInstanceId][N.featureIndex]=!0,P[N.bucketInstanceId]===void 0&&(P[N.bucketInstanceId]=[]),P[N.bucketInstanceId].push(N.featureIndex))}}return P},ii.prototype.insertCollisionBox=function(i,a,n,s,p){(a?this.ignoredGrid:this.grid).insert({bucketInstanceId:n,featureIndex:s,collisionGroupID:p},i[0],i[1],i[2],i[3])},ii.prototype.insertCollisionCircles=function(i,a,n,s,p){for(var f=a?this.ignoredGrid:this.grid,d={bucketInstanceId:n,featureIndex:s,collisionGroupID:p},y=0;y<i.length;y+=4)f.insertCircle(d,i[y],i[y+1],i[y+2])},ii.prototype.projectAndGetPerspectiveRatio=function(i,a,n){var s=[a,n,0,1];return Kn(s,s,i),{point:new l.Point((s[0]/s[3]+1)/2*this.transform.width+100,(-s[1]/s[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/s[3]*.5}},ii.prototype.isOffscreen=function(i,a,n,s){return n<100||i>=this.screenRightBoundary||s<100||a>this.screenBottomBoundary},ii.prototype.isInsideGrid=function(i,a,n,s){return n>=0&&i<this.gridRightBoundary&&s>=0&&a<this.gridBottomBoundary},ii.prototype.getViewportMatrix=function(){var i=l.identity([]);return l.translate(i,i,[-100,-100,0]),i};var Sn=function(i,a,n,s){this.opacity=i?Math.max(0,Math.min(1,i.opacity+(i.placed?a:-a))):s&&n?1:0,this.placed=n};Sn.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var Yn=function(i,a,n,s,p){this.text=new Sn(i?i.text:null,a,n,p),this.icon=new Sn(i?i.icon:null,a,s,p)};Yn.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var ao=function(i,a,n){this.text=i,this.icon=a,this.skipFade=n},Fo=function(){this.invProjMatrix=l.create(),this.viewportMatrix=l.create(),this.circles=[]},Nn=function(i,a,n,s,p){this.bucketInstanceId=i,this.featureIndex=a,this.sourceLayerIndex=n,this.bucketIndex=s,this.tileID=p},xl=function(i){this.crossSourceCollisions=i,this.maxGroupID=0,this.collisionGroups={}};function wa(i,a,n,s,p){var f=l.getAnchorAlignment(i),d=-(f.horizontalAlign-.5)*a,y=-(f.verticalAlign-.5)*n,g=l.evaluateVariableOffset(i,s);return new l.Point(d+g[0]*p,y+g[1]*p)}function ui(i,a,n,s,p,f){var d=i.x1,y=i.x2,g=i.y1,S=i.y2,I=i.anchorPointX,P=i.anchorPointY,A=new l.Point(a,n);return s&&A._rotate(p?f:-f),{x1:d+A.x,y1:g+A.y,x2:y+A.x,y2:S+A.y,anchorPointX:I,anchorPointY:P}}xl.prototype.get=function(i){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[i]){var a=++this.maxGroupID;this.collisionGroups[i]={ID:a,predicate:function(n){return n.collisionGroupID===a}}}return this.collisionGroups[i]};var Fi=function(i,a,n,s){this.transform=i.clone(),this.collisionIndex=new ii(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=a,this.retainedQueryData={},this.collisionGroups=new xl(n),this.collisionCircleArrays={},this.prevPlacement=s,s&&(s.prevPlacement=void 0),this.placedOrientations={}};function Uo(i,a,n,s,p){i.emplaceBack(a?1:0,n?1:0,s||0,p||0),i.emplaceBack(a?1:0,n?1:0,s||0,p||0),i.emplaceBack(a?1:0,n?1:0,s||0,p||0),i.emplaceBack(a?1:0,n?1:0,s||0,p||0)}Fi.prototype.getBucketParts=function(i,a,n,s){var p=n.getBucket(a),f=n.latestFeatureIndex;if(p&&f&&a.id===p.layerIds[0]){var d=n.collisionBoxArray,y=p.layers[0].layout,g=Math.pow(2,this.transform.zoom-n.tileID.overscaledZ),S=n.tileSize/l.EXTENT,I=this.transform.calculatePosMatrix(n.tileID.toUnwrapped()),P=y.get("text-pitch-alignment")==="map",A=y.get("text-rotation-alignment")==="map",B=wn(n,1,this.transform.zoom),R=gi(I,P,A,this.transform,B),N=null;if(P){var L=Ur(I,P,A,this.transform,B);N=l.multiply([],this.transform.labelPlaneMatrix,L)}this.retainedQueryData[p.bucketInstanceId]=new Nn(p.bucketInstanceId,f,p.sourceLayerIndex,p.index,n.tileID);var q={bucket:p,layout:y,posMatrix:I,textLabelPlaneMatrix:R,labelToScreenMatrix:N,scale:g,textPixelRatio:S,holdingForFade:n.holdingForFade(),collisionBoxArray:d,partiallyEvaluatedTextSize:l.evaluateSizeForZoom(p.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(p.sourceID)};if(s)for(var X=0,rt=p.sortKeyRanges;X<rt.length;X+=1){var ct=rt[X];i.push({sortKey:ct.sortKey,symbolInstanceStart:ct.symbolInstanceStart,symbolInstanceEnd:ct.symbolInstanceEnd,parameters:q})}else i.push({symbolInstanceStart:0,symbolInstanceEnd:p.symbolInstances.length,parameters:q})}},Fi.prototype.attemptAnchorPlacement=function(i,a,n,s,p,f,d,y,g,S,I,P,A,B,R){var N,L=[P.textOffset0,P.textOffset1],q=wa(i,n,s,L,p),X=this.collisionIndex.placeCollisionBox(ui(a,q.x,q.y,f,d,this.transform.angle),I,y,g,S.predicate);if(!R||this.collisionIndex.placeCollisionBox(ui(R,q.x,q.y,f,d,this.transform.angle),I,y,g,S.predicate).box.length!==0)return X.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[P.crossTileID]&&this.prevPlacement.placements[P.crossTileID]&&this.prevPlacement.placements[P.crossTileID].text&&(N=this.prevPlacement.variableOffsets[P.crossTileID].anchor),this.variableOffsets[P.crossTileID]={textOffset:L,width:n,height:s,anchor:i,textBoxScale:p,prevAnchor:N},this.markUsedJustification(A,i,P,B),A.allowVerticalPlacement&&(this.markUsedOrientation(A,B,P),this.placedOrientations[P.crossTileID]=B),{shift:q,placedGlyphBoxes:X}):void 0},Fi.prototype.placeLayerBucketPart=function(i,a,n){var s=this,p=i.parameters,f=p.bucket,d=p.layout,y=p.posMatrix,g=p.textLabelPlaneMatrix,S=p.labelToScreenMatrix,I=p.textPixelRatio,P=p.holdingForFade,A=p.collisionBoxArray,B=p.partiallyEvaluatedTextSize,R=p.collisionGroup,N=d.get("text-optional"),L=d.get("icon-optional"),q=d.get("text-allow-overlap"),X=d.get("icon-allow-overlap"),rt=d.get("text-rotation-alignment")==="map",ct=d.get("text-pitch-alignment")==="map",ot=d.get("icon-text-fit")!=="none",$=d.get("symbol-z-order")==="viewport-y",yt=q&&(X||!f.hasIconData()||L),kt=X&&(q||!f.hasTextData()||N);!f.collisionArrays&&A&&f.deserializeCollisionBoxes(A);var Mt=function(jt,Re){if(!a[jt.crossTileID])if(P)s.placements[jt.crossTileID]=new ao(!1,!1,!1);else{var Pe,_e=!1,Ie=!1,ge=!0,se=null,oe={box:null,offscreen:null},He={box:null,offscreen:null},Be=null,fi=null,di=0,xi=0,jr=0;Re.textFeatureIndex?di=Re.textFeatureIndex:jt.useRuntimeCollisionCircles&&(di=jt.featureIndex),Re.verticalTextFeatureIndex&&(xi=Re.verticalTextFeatureIndex);var bi=Re.textBox;if(bi){var Qe=function(xr){var qr=l.WritingMode.horizontal;if(f.allowVerticalPlacement&&!xr&&s.prevPlacement){var cr=s.prevPlacement.placedOrientations[jt.crossTileID];cr&&(s.placedOrientations[jt.crossTileID]=cr,s.markUsedOrientation(f,qr=cr,jt))}return qr},Lr=function(xr,qr){if(f.allowVerticalPlacement&&jt.numVerticalGlyphVertices>0&&Re.verticalTextBox)for(var cr=0,Fn=f.writingModes;cr<Fn.length&&(Fn[cr]===l.WritingMode.vertical?(oe=qr(),He=oe):oe=xr(),!(oe&&oe.box&&oe.box.length));cr+=1);else oe=xr()};if(d.get("text-variable-anchor")){var Pi=d.get("text-variable-anchor");if(s.prevPlacement&&s.prevPlacement.variableOffsets[jt.crossTileID]){var Ir=s.prevPlacement.variableOffsets[jt.crossTileID];Pi.indexOf(Ir.anchor)>0&&(Pi=Pi.filter(function(xr){return xr!==Ir.anchor})).unshift(Ir.anchor)}var Kr=function(xr,qr,cr){for(var Fn=xr.x2-xr.x1,_a=xr.y2-xr.y1,sn=jt.textBoxScale,ka=ot&&!X?qr:null,ga={box:[],offscreen:!1},yo=q?2*Pi.length:Pi.length,Un=0;Un<yo;++Un){var na=s.attemptAnchorPlacement(Pi[Un%Pi.length],xr,Fn,_a,sn,rt,ct,I,y,R,Un>=Pi.length,jt,f,cr,ka);if(na&&(ga=na.placedGlyphBoxes)&&ga.box&&ga.box.length){_e=!0,se=na.shift;break}}return ga};Lr(function(){return Kr(bi,Re.iconBox,l.WritingMode.horizontal)},function(){var xr=Re.verticalTextBox;return f.allowVerticalPlacement&&!(oe&&oe.box&&oe.box.length)&&jt.numVerticalGlyphVertices>0&&xr?Kr(xr,Re.verticalIconBox,l.WritingMode.vertical):{box:null,offscreen:null}}),oe&&(_e=oe.box,ge=oe.offscreen);var ra=Qe(oe&&oe.box);if(!_e&&s.prevPlacement){var Pa=s.prevPlacement.variableOffsets[jt.crossTileID];Pa&&(s.variableOffsets[jt.crossTileID]=Pa,s.markUsedJustification(f,Pa.anchor,jt,ra))}}else{var mo=function(xr,qr){var cr=s.collisionIndex.placeCollisionBox(xr,q,I,y,R.predicate);return cr&&cr.box&&cr.box.length&&(s.markUsedOrientation(f,qr,jt),s.placedOrientations[jt.crossTileID]=qr),cr};Lr(function(){return mo(bi,l.WritingMode.horizontal)},function(){var xr=Re.verticalTextBox;return f.allowVerticalPlacement&&jt.numVerticalGlyphVertices>0&&xr?mo(xr,l.WritingMode.vertical):{box:null,offscreen:null}}),Qe(oe&&oe.box&&oe.box.length)}}if(_e=(Pe=oe)&&Pe.box&&Pe.box.length>0,ge=Pe&&Pe.offscreen,jt.useRuntimeCollisionCircles){var vn=f.text.placedSymbolArray.get(jt.centerJustifiedTextSymbolIndex),ia=l.evaluateSizeForFeature(f.textSizeData,B,vn),Ae=d.get("text-padding");Be=s.collisionIndex.placeCollisionCircles(q,vn,f.lineVertexArray,f.glyphOffsetArray,ia,y,g,S,n,ct,R.predicate,jt.collisionCircleDiameter,Ae),_e=q||Be.circles.length>0&&!Be.collisionDetected,ge=ge&&Be.offscreen}if(Re.iconFeatureIndex&&(jr=Re.iconFeatureIndex),Re.iconBox){var be=function(xr){var qr=ot&&se?ui(xr,se.x,se.y,rt,ct,s.transform.angle):xr;return s.collisionIndex.placeCollisionBox(qr,X,I,y,R.predicate)};Ie=He&&He.box&&He.box.length&&Re.verticalIconBox?(fi=be(Re.verticalIconBox)).box.length>0:(fi=be(Re.iconBox)).box.length>0,ge=ge&&fi.offscreen}var mi=N||jt.numHorizontalGlyphVertices===0&&jt.numVerticalGlyphVertices===0,Er=L||jt.numIconVertices===0;if(mi||Er?Er?mi||(Ie=Ie&&_e):_e=Ie&&_e:Ie=_e=Ie&&_e,_e&&Pe&&Pe.box&&s.collisionIndex.insertCollisionBox(Pe.box,d.get("text-ignore-placement"),f.bucketInstanceId,He&&He.box&&xi?xi:di,R.ID),Ie&&fi&&s.collisionIndex.insertCollisionBox(fi.box,d.get("icon-ignore-placement"),f.bucketInstanceId,jr,R.ID),Be&&(_e&&s.collisionIndex.insertCollisionCircles(Be.circles,d.get("text-ignore-placement"),f.bucketInstanceId,di,R.ID),n)){var yr=f.bucketInstanceId,Vi=s.collisionCircleArrays[yr];Vi===void 0&&(Vi=s.collisionCircleArrays[yr]=new Fo);for(var yi=0;yi<Be.circles.length;yi+=4)Vi.circles.push(Be.circles[yi+0]),Vi.circles.push(Be.circles[yi+1]),Vi.circles.push(Be.circles[yi+2]),Vi.circles.push(Be.collisionDetected?1:0)}s.placements[jt.crossTileID]=new ao(_e||yt,Ie||kt,ge||f.justReloaded),a[jt.crossTileID]=!0}};if($)for(var Nt=f.getSortedSymbolIndexes(this.transform.angle),ye=Nt.length-1;ye>=0;--ye){var le=Nt[ye];Mt(f.symbolInstances.get(le),f.collisionArrays[le])}else for(var pe=i.symbolInstanceStart;pe<i.symbolInstanceEnd;pe++)Mt(f.symbolInstances.get(pe),f.collisionArrays[pe]);if(n&&f.bucketInstanceId in this.collisionCircleArrays){var Ge=this.collisionCircleArrays[f.bucketInstanceId];l.invert(Ge.invProjMatrix,y),Ge.viewportMatrix=this.collisionIndex.getViewportMatrix()}f.justReloaded=!1},Fi.prototype.markUsedJustification=function(i,a,n,s){var p;p=s===l.WritingMode.vertical?n.verticalPlacedTextSymbolIndex:{left:n.leftJustifiedTextSymbolIndex,center:n.centerJustifiedTextSymbolIndex,right:n.rightJustifiedTextSymbolIndex}[l.getAnchorJustification(a)];for(var f=0,d=[n.leftJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.rightJustifiedTextSymbolIndex,n.verticalPlacedTextSymbolIndex];f<d.length;f+=1){var y=d[f];y>=0&&(i.text.placedSymbolArray.get(y).crossTileID=p>=0&&y!==p?0:n.crossTileID)}},Fi.prototype.markUsedOrientation=function(i,a,n){for(var s=a===l.WritingMode.horizontal||a===l.WritingMode.horizontalOnly?a:0,p=a===l.WritingMode.vertical?a:0,f=0,d=[n.leftJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.rightJustifiedTextSymbolIndex];f<d.length;f+=1)i.text.placedSymbolArray.get(d[f]).placedOrientation=s;n.verticalPlacedTextSymbolIndex&&(i.text.placedSymbolArray.get(n.verticalPlacedTextSymbolIndex).placedOrientation=p)},Fi.prototype.commit=function(i){this.commitTime=i,this.zoomAtLastRecencyCheck=this.transform.zoom;var a=this.prevPlacement,n=!1;this.prevZoomAdjustment=a?a.zoomAdjustment(this.transform.zoom):0;var s=a?a.symbolFadeChange(i):1,p=a?a.opacities:{},f=a?a.variableOffsets:{},d=a?a.placedOrientations:{};for(var y in this.placements){var g=this.placements[y],S=p[y];S?(this.opacities[y]=new Yn(S,s,g.text,g.icon),n=n||g.text!==S.text.placed||g.icon!==S.icon.placed):(this.opacities[y]=new Yn(null,s,g.text,g.icon,g.skipFade),n=n||g.text||g.icon)}for(var I in p){var P=p[I];if(!this.opacities[I]){var A=new Yn(P,s,!1,!1);A.isHidden()||(this.opacities[I]=A,n=n||P.text.placed||P.icon.placed)}}for(var B in f)this.variableOffsets[B]||!this.opacities[B]||this.opacities[B].isHidden()||(this.variableOffsets[B]=f[B]);for(var R in d)this.placedOrientations[R]||!this.opacities[R]||this.opacities[R].isHidden()||(this.placedOrientations[R]=d[R]);n?this.lastPlacementChangeTime=i:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=a?a.lastPlacementChangeTime:i)},Fi.prototype.updateLayerOpacities=function(i,a){for(var n={},s=0,p=a;s<p.length;s+=1){var f=p[s],d=f.getBucket(i);d&&f.latestFeatureIndex&&i.id===d.layerIds[0]&&this.updateBucketOpacities(d,n,f.collisionBoxArray)}},Fi.prototype.updateBucketOpacities=function(i,a,n){var s=this;i.hasTextData()&&i.text.opacityVertexArray.clear(),i.hasIconData()&&i.icon.opacityVertexArray.clear(),i.hasIconCollisionBoxData()&&i.iconCollisionBox.collisionVertexArray.clear(),i.hasTextCollisionBoxData()&&i.textCollisionBox.collisionVertexArray.clear();var p=i.layers[0].layout,f=new Yn(null,0,!1,!1,!0),d=p.get("text-allow-overlap"),y=p.get("icon-allow-overlap"),g=p.get("text-variable-anchor"),S=p.get("text-rotation-alignment")==="map",I=p.get("text-pitch-alignment")==="map",P=p.get("icon-text-fit")!=="none",A=new Yn(null,0,d&&(y||!i.hasIconData()||p.get("icon-optional")),y&&(d||!i.hasTextData()||p.get("text-optional")),!0);!i.collisionArrays&&n&&(i.hasIconCollisionBoxData()||i.hasTextCollisionBoxData())&&i.deserializeCollisionBoxes(n);for(var B=function(q,X,rt){for(var ct=0;ct<X/4;ct++)q.opacityVertexArray.emplaceBack(rt)},R=function(q){var X=i.symbolInstances.get(q),rt=X.numHorizontalGlyphVertices,ct=X.numVerticalGlyphVertices,ot=X.crossTileID,$=s.opacities[ot];a[ot]?$=f:$||(s.opacities[ot]=$=A),a[ot]=!0;var yt=X.numIconVertices>0,kt=s.placedOrientations[X.crossTileID],Mt=kt===l.WritingMode.vertical,Nt=kt===l.WritingMode.horizontal||kt===l.WritingMode.horizontalOnly;if(rt>0||ct>0){var ye=Js($.text);B(i.text,rt,Mt?Ss:ye),B(i.text,ct,Nt?Ss:ye);var le=$.text.isHidden();[X.rightJustifiedTextSymbolIndex,X.centerJustifiedTextSymbolIndex,X.leftJustifiedTextSymbolIndex].forEach(function(oe){oe>=0&&(i.text.placedSymbolArray.get(oe).hidden=le||Mt?1:0)}),X.verticalPlacedTextSymbolIndex>=0&&(i.text.placedSymbolArray.get(X.verticalPlacedTextSymbolIndex).hidden=le||Nt?1:0);var pe=s.variableOffsets[X.crossTileID];pe&&s.markUsedJustification(i,pe.anchor,X,kt);var Ge=s.placedOrientations[X.crossTileID];Ge&&(s.markUsedJustification(i,"left",X,Ge),s.markUsedOrientation(i,Ge,X))}if(yt){var jt=Js($.icon),Re=!(P&&X.verticalPlacedIconSymbolIndex&&Mt);X.placedIconSymbolIndex>=0&&(B(i.icon,X.numIconVertices,Re?jt:Ss),i.icon.placedSymbolArray.get(X.placedIconSymbolIndex).hidden=$.icon.isHidden()),X.verticalPlacedIconSymbolIndex>=0&&(B(i.icon,X.numVerticalIconVertices,Re?Ss:jt),i.icon.placedSymbolArray.get(X.verticalPlacedIconSymbolIndex).hidden=$.icon.isHidden())}if(i.hasIconCollisionBoxData()||i.hasTextCollisionBoxData()){var Pe=i.collisionArrays[q];if(Pe){var _e=new l.Point(0,0);if(Pe.textBox||Pe.verticalTextBox){var Ie=!0;if(g){var ge=s.variableOffsets[ot];ge?(_e=wa(ge.anchor,ge.width,ge.height,ge.textOffset,ge.textBoxScale),S&&_e._rotate(I?s.transform.angle:-s.transform.angle)):Ie=!1}Pe.textBox&&Uo(i.textCollisionBox.collisionVertexArray,$.text.placed,!Ie||Mt,_e.x,_e.y),Pe.verticalTextBox&&Uo(i.textCollisionBox.collisionVertexArray,$.text.placed,!Ie||Nt,_e.x,_e.y)}var se=Boolean(!Nt&&Pe.verticalIconBox);Pe.iconBox&&Uo(i.iconCollisionBox.collisionVertexArray,$.icon.placed,se,P?_e.x:0,P?_e.y:0),Pe.verticalIconBox&&Uo(i.iconCollisionBox.collisionVertexArray,$.icon.placed,!se,P?_e.x:0,P?_e.y:0)}}},N=0;N<i.symbolInstances.length;N++)R(N);if(i.sortFeatures(this.transform.angle),this.retainedQueryData[i.bucketInstanceId]&&(this.retainedQueryData[i.bucketInstanceId].featureSortOrder=i.featureSortOrder),i.hasTextData()&&i.text.opacityVertexBuffer&&i.text.opacityVertexBuffer.updateData(i.text.opacityVertexArray),i.hasIconData()&&i.icon.opacityVertexBuffer&&i.icon.opacityVertexBuffer.updateData(i.icon.opacityVertexArray),i.hasIconCollisionBoxData()&&i.iconCollisionBox.collisionVertexBuffer&&i.iconCollisionBox.collisionVertexBuffer.updateData(i.iconCollisionBox.collisionVertexArray),i.hasTextCollisionBoxData()&&i.textCollisionBox.collisionVertexBuffer&&i.textCollisionBox.collisionVertexBuffer.updateData(i.textCollisionBox.collisionVertexArray),i.bucketInstanceId in this.collisionCircleArrays){var L=this.collisionCircleArrays[i.bucketInstanceId];i.placementInvProjMatrix=L.invProjMatrix,i.placementViewportMatrix=L.viewportMatrix,i.collisionCircleArray=L.circles,delete this.collisionCircleArrays[i.bucketInstanceId]}},Fi.prototype.symbolFadeChange=function(i){return this.fadeDuration===0?1:(i-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},Fi.prototype.zoomAdjustment=function(i){return Math.max(0,(this.transform.zoom-i)/1.5)},Fi.prototype.hasTransitions=function(i){return this.stale||i-this.lastPlacementChangeTime<this.fadeDuration},Fi.prototype.stillRecent=function(i,a){var n=this.zoomAtLastRecencyCheck===a?1-this.zoomAdjustment(a):1;return this.zoomAtLastRecencyCheck=a,this.commitTime+this.fadeDuration*n>i},Fi.prototype.setStale=function(){this.stale=!0};var ws=Math.pow(2,25),jl=Math.pow(2,24),ql=Math.pow(2,17),Vo=Math.pow(2,16),bl=Math.pow(2,9),is=Math.pow(2,8),Zl=Math.pow(2,1);function Js(i){if(i.opacity===0&&!i.placed)return 0;if(i.opacity===1&&i.placed)return 4294967295;var a=i.placed?1:0,n=Math.floor(127*i.opacity);return n*ws+a*jl+n*ql+a*Vo+n*bl+a*is+n*Zl+a}var Ss=0,Qs=function(i){this._sortAcrossTiles=i.layout.get("symbol-z-order")!=="viewport-y"&&!i.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};Qs.prototype.continuePlacement=function(i,a,n,s,p){for(var f=this._bucketParts;this._currentTileIndex<i.length;)if(a.getBucketParts(f,s,i[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,p())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,f.sort(function(d,y){return d.sortKey-y.sortKey}));this._currentPartIndex<f.length;)if(a.placeLayerBucketPart(f[this._currentPartIndex],this._seenCrossTileIDs,n),this._currentPartIndex++,p())return!0;return!1};var Ts=function(i,a,n,s,p,f,d){this.placement=new Fi(i,p,f,d),this._currentPlacementIndex=a.length-1,this._forceFullPlacement=n,this._showCollisionBoxes=s,this._done=!1};Ts.prototype.isDone=function(){return this._done},Ts.prototype.continuePlacement=function(i,a,n){for(var s=this,p=l.browser.now(),f=function(){var g=l.browser.now()-p;return!s._forceFullPlacement&&g>2};this._currentPlacementIndex>=0;){var d=a[i[this._currentPlacementIndex]],y=this.placement.collisionIndex.transform.zoom;if(d.type==="symbol"&&(!d.minzoom||d.minzoom<=y)&&(!d.maxzoom||d.maxzoom>y)){if(this._inProgressLayer||(this._inProgressLayer=new Qs(d)),this._inProgressLayer.continuePlacement(n[d.source],this.placement,this._showCollisionBoxes,d,f))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},Ts.prototype.commit=function(i){return this.placement.commit(i),this.placement};var xo=512/l.EXTENT/2,No=function(i,a,n){this.tileID=i,this.indexedSymbolInstances={},this.bucketInstanceId=n;for(var s=0;s<a.length;s++){var p=a.get(s),f=p.key;this.indexedSymbolInstances[f]||(this.indexedSymbolInstances[f]=[]),this.indexedSymbolInstances[f].push({crossTileID:p.crossTileID,coord:this.getScaledCoordinates(p,i)})}};No.prototype.getScaledCoordinates=function(i,a){var n=xo/Math.pow(2,a.canonical.z-this.tileID.canonical.z);return{x:Math.floor((a.canonical.x*l.EXTENT+i.anchorX)*n),y:Math.floor((a.canonical.y*l.EXTENT+i.anchorY)*n)}},No.prototype.findMatches=function(i,a,n){for(var s=this.tileID.canonical.z<a.canonical.z?1:Math.pow(2,this.tileID.canonical.z-a.canonical.z),p=0;p<i.length;p++){var f=i.get(p);if(!f.crossTileID){var d=this.indexedSymbolInstances[f.key];if(d)for(var y=this.getScaledCoordinates(f,a),g=0,S=d;g<S.length;g+=1){var I=S[g];if(Math.abs(I.coord.x-y.x)<=s&&Math.abs(I.coord.y-y.y)<=s&&!n[I.crossTileID]){n[I.crossTileID]=!0,f.crossTileID=I.crossTileID;break}}}}};var Es=function(){this.maxCrossTileID=0};Es.prototype.generate=function(){return++this.maxCrossTileID};var Tn=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Tn.prototype.handleWrapJump=function(i){var a=Math.round((i-this.lng)/360);if(a!==0)for(var n in this.indexes){var s=this.indexes[n],p={};for(var f in s){var d=s[f];d.tileID=d.tileID.unwrapTo(d.tileID.wrap+a),p[d.tileID.key]=d}this.indexes[n]=p}this.lng=i},Tn.prototype.addBucket=function(i,a,n){if(this.indexes[i.overscaledZ]&&this.indexes[i.overscaledZ][i.key]){if(this.indexes[i.overscaledZ][i.key].bucketInstanceId===a.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(i.overscaledZ,this.indexes[i.overscaledZ][i.key])}for(var s=0;s<a.symbolInstances.length;s++)a.symbolInstances.get(s).crossTileID=0;this.usedCrossTileIDs[i.overscaledZ]||(this.usedCrossTileIDs[i.overscaledZ]={});var p=this.usedCrossTileIDs[i.overscaledZ];for(var f in this.indexes){var d=this.indexes[f];if(Number(f)>i.overscaledZ)for(var y in d){var g=d[y];g.tileID.isChildOf(i)&&g.findMatches(a.symbolInstances,i,p)}else{var S=d[i.scaledTo(Number(f)).key];S&&S.findMatches(a.symbolInstances,i,p)}}for(var I=0;I<a.symbolInstances.length;I++){var P=a.symbolInstances.get(I);P.crossTileID||(P.crossTileID=n.generate(),p[P.crossTileID]=!0)}return this.indexes[i.overscaledZ]===void 0&&(this.indexes[i.overscaledZ]={}),this.indexes[i.overscaledZ][i.key]=new No(i,a.symbolInstances,a.bucketInstanceId),!0},Tn.prototype.removeBucketCrossTileIDs=function(i,a){for(var n in a.indexedSymbolInstances)for(var s=0,p=a.indexedSymbolInstances[n];s<p.length;s+=1)delete this.usedCrossTileIDs[i][p[s].crossTileID]},Tn.prototype.removeStaleBuckets=function(i){var a=!1;for(var n in this.indexes){var s=this.indexes[n];for(var p in s)i[s[p].bucketInstanceId]||(this.removeBucketCrossTileIDs(n,s[p]),delete s[p],a=!0)}return a};var oo=function(){this.layerIndexes={},this.crossTileIDs=new Es,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};oo.prototype.addLayer=function(i,a,n){var s=this.layerIndexes[i.id];s===void 0&&(s=this.layerIndexes[i.id]=new Tn);var p=!1,f={};s.handleWrapJump(n);for(var d=0,y=a;d<y.length;d+=1){var g=y[d],S=g.getBucket(i);S&&i.id===S.layerIds[0]&&(S.bucketInstanceId||(S.bucketInstanceId=++this.maxBucketInstanceId),s.addBucket(g.tileID,S,this.crossTileIDs)&&(p=!0),f[S.bucketInstanceId]=!0)}return s.removeStaleBuckets(f)&&(p=!0),p},oo.prototype.pruneUnusedLayers=function(i){var a={};for(var n in i.forEach(function(s){a[s]=!0}),this.layerIndexes)a[n]||delete this.layerIndexes[n]};var so=function(i,a){return l.emitValidationErrors(i,a&&a.filter(function(n){return n.identifier!=="source.canvas"}))},bo=l.pick(Pt,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),ci=l.pick(Pt,["setCenter","setZoom","setBearing","setPitch"]),kn=function(){var i={},a=l.styleSpec.$version;for(var n in l.styleSpec.$root){var s,p=l.styleSpec.$root[n];p.required&&(s=n==="version"?a:p.type==="array"?[]:{})!=null&&(i[n]=s)}return i}(),lo=function(i){function a(n,s){var p=this;s===void 0&&(s={}),i.call(this),this.map=n,this.dispatcher=new ke(me(),this),this.imageManager=new bt,this.imageManager.setEventedParent(this),this.glyphManager=new Te(n._requestManager,s.localIdeographFontFamily),this.lineAtlas=new Gt(256,512),this.crossTileSymbolIndex=new oo,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new l.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",l.getReferrer());var f=this;this._rtlTextPluginCallback=a.registerForPluginStateChange(function(d){f.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:d.pluginStatus,pluginURL:d.pluginURL},function(y,g){if(l.triggerPluginCompletionEvent(y),g&&g.every(function(I){return I}))for(var S in f.sourceCaches)f.sourceCaches[S].reload()})}),this.on("data",function(d){if(d.dataType==="source"&&d.sourceDataType==="metadata"){var y=p.sourceCaches[d.sourceId];if(y){var g=y.getSource();if(g&&g.vectorLayerIds)for(var S in p._layers){var I=p._layers[S];I.source===g.id&&p._validateLayer(I)}}}})}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.loadURL=function(n,s){var p=this;s===void 0&&(s={}),this.fire(new l.Event("dataloading",{dataType:"style"}));var f=typeof s.validate=="boolean"?s.validate:!l.isMapboxURL(n);n=this.map._requestManager.normalizeStyleURL(n,s.accessToken);var d=this.map._requestManager.transformRequest(n,l.ResourceType.Style);this._request=l.getJSON(d,function(y,g){p._request=null,y?p.fire(new l.ErrorEvent(y)):g&&p._load(g,f)})},a.prototype.loadJSON=function(n,s){var p=this;s===void 0&&(s={}),this.fire(new l.Event("dataloading",{dataType:"style"})),this._request=l.browser.frame(function(){p._request=null,p._load(n,s.validate!==!1)})},a.prototype.loadEmpty=function(){this.fire(new l.Event("dataloading",{dataType:"style"})),this._load(kn,!1)},a.prototype._load=function(n,s){if(!s||!so(this,l.validateStyle(n))){for(var p in this._loaded=!0,this.stylesheet=n,n.sources)this.addSource(p,n.sources[p],{validate:!1});n.sprite?this._loadSprite(n.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(n.glyphs);var f=qt(this.stylesheet.layers);this._order=f.map(function(S){return S.id}),this._layers={},this._serializedLayers={};for(var d=0,y=f;d<y.length;d+=1){var g=y[d];(g=l.createStyleLayer(g)).setEventedParent(this,{layer:{id:g.id}}),this._layers[g.id]=g,this._serializedLayers[g.id]=g.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Jr(this.stylesheet.light),this.fire(new l.Event("data",{dataType:"style"})),this.fire(new l.Event("style.load"))}},a.prototype._loadSprite=function(n){var s=this;this._spriteRequest=function(p,f,d){var y,g,S,I=l.browser.devicePixelRatio>1?"@2x":"",P=l.getJSON(f.transformRequest(f.normalizeSpriteURL(p,I,".json"),l.ResourceType.SpriteJSON),function(R,N){P=null,S||(S=R,y=N,B())}),A=l.getImage(f.transformRequest(f.normalizeSpriteURL(p,I,".png"),l.ResourceType.SpriteImage),function(R,N){A=null,S||(S=R,g=N,B())});function B(){if(S)d(S);else if(y&&g){var R=l.browser.getImageData(g),N={};for(var L in y){var q=y[L],X=q.width,rt=q.height,ct=q.x,ot=q.y,$=q.sdf,yt=q.pixelRatio,kt=q.stretchX,Mt=q.stretchY,Nt=q.content,ye=new l.RGBAImage({width:X,height:rt});l.RGBAImage.copy(R,ye,{x:ct,y:ot},{x:0,y:0},{width:X,height:rt}),N[L]={data:ye,pixelRatio:yt,sdf:$,stretchX:kt,stretchY:Mt,content:Nt}}d(null,N)}}return{cancel:function(){P&&(P.cancel(),P=null),A&&(A.cancel(),A=null)}}}(n,this.map._requestManager,function(p,f){if(s._spriteRequest=null,p)s.fire(new l.ErrorEvent(p));else if(f)for(var d in f)s.imageManager.addImage(d,f[d]);s.imageManager.setLoaded(!0),s._availableImages=s.imageManager.listImages(),s.dispatcher.broadcast("setImages",s._availableImages),s.fire(new l.Event("data",{dataType:"style"}))})},a.prototype._validateLayer=function(n){var s=this.sourceCaches[n.source];if(s){var p=n.sourceLayer;if(p){var f=s.getSource();(f.type==="geojson"||f.vectorLayerIds&&f.vectorLayerIds.indexOf(p)===-1)&&this.fire(new l.ErrorEvent(new Error('Source layer "'+p+'" does not exist on source "'+f.id+'" as specified by style layer "'+n.id+'"')))}}},a.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var n in this.sourceCaches)if(!this.sourceCaches[n].loaded())return!1;return!!this.imageManager.isLoaded()},a.prototype._serializeLayers=function(n){for(var s=[],p=0,f=n;p<f.length;p+=1){var d=this._layers[f[p]];d.type!=="custom"&&s.push(d.serialize())}return s},a.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var n in this.sourceCaches)if(this.sourceCaches[n].hasTransition())return!0;for(var s in this._layers)if(this._layers[s].hasTransition())return!0;return!1},a.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},a.prototype.update=function(n){if(this._loaded){var s=this._changed;if(this._changed){var p=Object.keys(this._updatedLayers),f=Object.keys(this._removedLayers);for(var d in(p.length||f.length)&&this._updateWorkerLayers(p,f),this._updatedSources){var y=this._updatedSources[d];y==="reload"?this._reloadSource(d):y==="clear"&&this._clearSource(d)}for(var g in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[g].updateTransitions(n);this.light.updateTransitions(n),this._resetUpdates()}var S={};for(var I in this.sourceCaches){var P=this.sourceCaches[I];S[I]=P.used,P.used=!1}for(var A=0,B=this._order;A<B.length;A+=1){var R=this._layers[B[A]];R.recalculate(n,this._availableImages),!R.isHidden(n.zoom)&&R.source&&(this.sourceCaches[R.source].used=!0)}for(var N in S){var L=this.sourceCaches[N];S[N]!==L.used&&L.fire(new l.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:N}))}this.light.recalculate(n),this.z=n.zoom,s&&this.fire(new l.Event("data",{dataType:"style"}))}},a.prototype._updateTilesForChangedImages=function(){var n=Object.keys(this._changedImages);if(n.length){for(var s in this.sourceCaches)this.sourceCaches[s].reloadTilesForDependencies(["icons","patterns"],n);this._changedImages={}}},a.prototype._updateWorkerLayers=function(n,s){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(n),removedIds:s})},a.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},a.prototype.setState=function(n){var s=this;if(this._checkLoaded(),so(this,l.validateStyle(n)))return!1;(n=l.clone$1(n)).layers=qt(n.layers);var p=function(d,y){if(!d)return[{command:Pt.setStyle,args:[y]}];var g=[];try{if(!l.deepEqual(d.version,y.version))return[{command:Pt.setStyle,args:[y]}];l.deepEqual(d.center,y.center)||g.push({command:Pt.setCenter,args:[y.center]}),l.deepEqual(d.zoom,y.zoom)||g.push({command:Pt.setZoom,args:[y.zoom]}),l.deepEqual(d.bearing,y.bearing)||g.push({command:Pt.setBearing,args:[y.bearing]}),l.deepEqual(d.pitch,y.pitch)||g.push({command:Pt.setPitch,args:[y.pitch]}),l.deepEqual(d.sprite,y.sprite)||g.push({command:Pt.setSprite,args:[y.sprite]}),l.deepEqual(d.glyphs,y.glyphs)||g.push({command:Pt.setGlyphs,args:[y.glyphs]}),l.deepEqual(d.transition,y.transition)||g.push({command:Pt.setTransition,args:[y.transition]}),l.deepEqual(d.light,y.light)||g.push({command:Pt.setLight,args:[y.light]});var S={},I=[];(function(A,B,R,N){var L;for(L in B=B||{},A=A||{})A.hasOwnProperty(L)&&(B.hasOwnProperty(L)||Oe(L,R,N));for(L in B)B.hasOwnProperty(L)&&(A.hasOwnProperty(L)?l.deepEqual(A[L],B[L])||(A[L].type==="geojson"&&B[L].type==="geojson"&&Br(A,B,L)?R.push({command:Pt.setGeoJSONSourceData,args:[L,B[L].data]}):ae(L,B,R,N)):Ue(L,B,R))})(d.sources,y.sources,I,S);var P=[];d.layers&&d.layers.forEach(function(A){S[A.source]?g.push({command:Pt.removeLayer,args:[A.id]}):P.push(A)}),g=g.concat(I),function(A,B,R){B=B||[];var N,L,q,X,rt,ct,ot,$=(A=A||[]).map(Hr),yt=B.map(Hr),kt=A.reduce(er,{}),Mt=B.reduce(er,{}),Nt=$.slice(),ye=Object.create(null);for(N=0,L=0;N<$.length;N++)Mt.hasOwnProperty(q=$[N])?L++:(R.push({command:Pt.removeLayer,args:[q]}),Nt.splice(Nt.indexOf(q,L),1));for(N=0,L=0;N<yt.length;N++)Nt[Nt.length-1-N]!==(q=yt[yt.length-1-N])&&(kt.hasOwnProperty(q)?(R.push({command:Pt.removeLayer,args:[q]}),Nt.splice(Nt.lastIndexOf(q,Nt.length-L),1)):L++,R.push({command:Pt.addLayer,args:[Mt[q],ct=Nt[Nt.length-N]]}),Nt.splice(Nt.length-N,0,q),ye[q]=!0);for(N=0;N<yt.length;N++)if(X=kt[q=yt[N]],rt=Mt[q],!ye[q]&&!l.deepEqual(X,rt))if(l.deepEqual(X.source,rt.source)&&l.deepEqual(X["source-layer"],rt["source-layer"])&&l.deepEqual(X.type,rt.type)){for(ot in Me(X.layout,rt.layout,R,q,null,Pt.setLayoutProperty),Me(X.paint,rt.paint,R,q,null,Pt.setPaintProperty),l.deepEqual(X.filter,rt.filter)||R.push({command:Pt.setFilter,args:[q,rt.filter]}),l.deepEqual(X.minzoom,rt.minzoom)&&l.deepEqual(X.maxzoom,rt.maxzoom)||R.push({command:Pt.setLayerZoomRange,args:[q,rt.minzoom,rt.maxzoom]}),X)X.hasOwnProperty(ot)&&ot!=="layout"&&ot!=="paint"&&ot!=="filter"&&ot!=="metadata"&&ot!=="minzoom"&&ot!=="maxzoom"&&(ot.indexOf("paint.")===0?Me(X[ot],rt[ot],R,q,ot.slice(6),Pt.setPaintProperty):l.deepEqual(X[ot],rt[ot])||R.push({command:Pt.setLayerProperty,args:[q,ot,rt[ot]]}));for(ot in rt)rt.hasOwnProperty(ot)&&!X.hasOwnProperty(ot)&&ot!=="layout"&&ot!=="paint"&&ot!=="filter"&&ot!=="metadata"&&ot!=="minzoom"&&ot!=="maxzoom"&&(ot.indexOf("paint.")===0?Me(X[ot],rt[ot],R,q,ot.slice(6),Pt.setPaintProperty):l.deepEqual(X[ot],rt[ot])||R.push({command:Pt.setLayerProperty,args:[q,ot,rt[ot]]}))}else R.push({command:Pt.removeLayer,args:[q]}),ct=Nt[Nt.lastIndexOf(q)+1],R.push({command:Pt.addLayer,args:[rt,ct]})}(P,y.layers,g)}catch(A){console.warn("Unable to compute style diff:",A),g=[{command:Pt.setStyle,args:[y]}]}return g}(this.serialize(),n).filter(function(d){return!(d.command in ci)});if(p.length===0)return!1;var f=p.filter(function(d){return!(d.command in bo)});if(f.length>0)throw new Error("Unimplemented: "+f.map(function(d){return d.command}).join(", ")+".");return p.forEach(function(d){d.command!=="setTransition"&&s[d.command].apply(s,d.args)}),this.stylesheet=n,!0},a.prototype.addImage=function(n,s){if(this.getImage(n))return this.fire(new l.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(n,s),this._afterImageUpdated(n)},a.prototype.updateImage=function(n,s){this.imageManager.updateImage(n,s)},a.prototype.getImage=function(n){return this.imageManager.getImage(n)},a.prototype.removeImage=function(n){if(!this.getImage(n))return this.fire(new l.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(n),this._afterImageUpdated(n)},a.prototype._afterImageUpdated=function(n){this._availableImages=this.imageManager.listImages(),this._changedImages[n]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new l.Event("data",{dataType:"style"}))},a.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},a.prototype.addSource=function(n,s,p){var f=this;if(p===void 0&&(p={}),this._checkLoaded(),this.sourceCaches[n]!==void 0)throw new Error("There is already a source with this ID");if(!s.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(s).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(s.type)>=0&&this._validate(l.validateStyle.source,"sources."+n,s,null,p))){this.map&&this.map._collectResourceTiming&&(s.collectResourceTiming=!0);var d=this.sourceCaches[n]=new M(n,s,this.dispatcher);d.style=this,d.setEventedParent(this,function(){return{isSourceLoaded:f.loaded(),source:d.serialize(),sourceId:n}}),d.onAdd(this.map),this._changed=!0}},a.prototype.removeSource=function(n){if(this._checkLoaded(),this.sourceCaches[n]===void 0)throw new Error("There is no source with this ID");for(var s in this._layers)if(this._layers[s].source===n)return this.fire(new l.ErrorEvent(new Error('Source "'+n+'" cannot be removed while layer "'+s+'" is using it.')));var p=this.sourceCaches[n];delete this.sourceCaches[n],delete this._updatedSources[n],p.fire(new l.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:n})),p.setEventedParent(null),p.clearTiles(),p.onRemove&&p.onRemove(this.map),this._changed=!0},a.prototype.setGeoJSONSourceData=function(n,s){this._checkLoaded(),this.sourceCaches[n].getSource().setData(s),this._changed=!0},a.prototype.getSource=function(n){return this.sourceCaches[n]&&this.sourceCaches[n].getSource()},a.prototype.addLayer=function(n,s,p){p===void 0&&(p={}),this._checkLoaded();var f=n.id;if(this.getLayer(f))this.fire(new l.ErrorEvent(new Error('Layer with id "'+f+'" already exists on this map')));else{var d;if(n.type==="custom"){if(so(this,l.validateCustomStyleLayer(n)))return;d=l.createStyleLayer(n)}else{if(typeof n.source=="object"&&(this.addSource(f,n.source),n=l.clone$1(n),n=l.extend(n,{source:f})),this._validate(l.validateStyle.layer,"layers."+f,n,{arrayIndex:-1},p))return;d=l.createStyleLayer(n),this._validateLayer(d),d.setEventedParent(this,{layer:{id:f}}),this._serializedLayers[d.id]=d.serialize()}var y=s?this._order.indexOf(s):this._order.length;if(s&&y===-1)this.fire(new l.ErrorEvent(new Error('Layer with id "'+s+'" does not exist on this map.')));else{if(this._order.splice(y,0,f),this._layerOrderChanged=!0,this._layers[f]=d,this._removedLayers[f]&&d.source&&d.type!=="custom"){var g=this._removedLayers[f];delete this._removedLayers[f],g.type!==d.type?this._updatedSources[d.source]="clear":(this._updatedSources[d.source]="reload",this.sourceCaches[d.source].pause())}this._updateLayer(d),d.onAdd&&d.onAdd(this.map)}}},a.prototype.moveLayer=function(n,s){if(this._checkLoaded(),this._changed=!0,this._layers[n]){if(n!==s){var p=this._order.indexOf(n);this._order.splice(p,1);var f=s?this._order.indexOf(s):this._order.length;s&&f===-1?this.fire(new l.ErrorEvent(new Error('Layer with id "'+s+'" does not exist on this map.'))):(this._order.splice(f,0,n),this._layerOrderChanged=!0)}}else this.fire(new l.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be moved.")))},a.prototype.removeLayer=function(n){this._checkLoaded();var s=this._layers[n];if(s){s.setEventedParent(null);var p=this._order.indexOf(n);this._order.splice(p,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[n]=s,delete this._layers[n],delete this._serializedLayers[n],delete this._updatedLayers[n],delete this._updatedPaintProps[n],s.onRemove&&s.onRemove(this.map)}else this.fire(new l.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be removed.")))},a.prototype.getLayer=function(n){return this._layers[n]},a.prototype.hasLayer=function(n){return n in this._layers},a.prototype.setLayerZoomRange=function(n,s,p){this._checkLoaded();var f=this.getLayer(n);f?f.minzoom===s&&f.maxzoom===p||(s!=null&&(f.minzoom=s),p!=null&&(f.maxzoom=p),this._updateLayer(f)):this.fire(new l.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot have zoom extent.")))},a.prototype.setFilter=function(n,s,p){p===void 0&&(p={}),this._checkLoaded();var f=this.getLayer(n);if(f){if(!l.deepEqual(f.filter,s))return s==null?(f.filter=void 0,void this._updateLayer(f)):void(this._validate(l.validateStyle.filter,"layers."+f.id+".filter",s,null,p)||(f.filter=l.clone$1(s),this._updateLayer(f)))}else this.fire(new l.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be filtered.")))},a.prototype.getFilter=function(n){return l.clone$1(this.getLayer(n).filter)},a.prototype.setLayoutProperty=function(n,s,p,f){f===void 0&&(f={}),this._checkLoaded();var d=this.getLayer(n);d?l.deepEqual(d.getLayoutProperty(s),p)||(d.setLayoutProperty(s,p,f),this._updateLayer(d)):this.fire(new l.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be styled.")))},a.prototype.getLayoutProperty=function(n,s){var p=this.getLayer(n);if(p)return p.getLayoutProperty(s);this.fire(new l.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style.")))},a.prototype.setPaintProperty=function(n,s,p,f){f===void 0&&(f={}),this._checkLoaded();var d=this.getLayer(n);d?l.deepEqual(d.getPaintProperty(s),p)||(d.setPaintProperty(s,p,f)&&this._updateLayer(d),this._changed=!0,this._updatedPaintProps[n]=!0):this.fire(new l.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be styled.")))},a.prototype.getPaintProperty=function(n,s){return this.getLayer(n).getPaintProperty(s)},a.prototype.setFeatureState=function(n,s){this._checkLoaded();var p=n.source,f=n.sourceLayer,d=this.sourceCaches[p];if(d!==void 0){var y=d.getSource().type;y==="geojson"&&f?this.fire(new l.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):y!=="vector"||f?(n.id===void 0&&this.fire(new l.ErrorEvent(new Error("The feature id parameter must be provided."))),d.setFeatureState(f,n.id,s)):this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new l.ErrorEvent(new Error("The source '"+p+"' does not exist in the map's style.")))},a.prototype.removeFeatureState=function(n,s){this._checkLoaded();var p=n.source,f=this.sourceCaches[p];if(f!==void 0){var d=f.getSource().type,y=d==="vector"?n.sourceLayer:void 0;d!=="vector"||y?s&&typeof n.id!="string"&&typeof n.id!="number"?this.fire(new l.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):f.removeFeatureState(y,n.id,s):this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new l.ErrorEvent(new Error("The source '"+p+"' does not exist in the map's style.")))},a.prototype.getFeatureState=function(n){this._checkLoaded();var s=n.source,p=n.sourceLayer,f=this.sourceCaches[s];if(f!==void 0){if(f.getSource().type!=="vector"||p)return n.id===void 0&&this.fire(new l.ErrorEvent(new Error("The feature id parameter must be provided."))),f.getFeatureState(p,n.id);this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new l.ErrorEvent(new Error("The source '"+s+"' does not exist in the map's style.")))},a.prototype.getTransition=function(){return l.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},a.prototype.serialize=function(){return l.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:l.mapObject(this.sourceCaches,function(n){return n.serialize()}),layers:this._serializeLayers(this._order)},function(n){return n!==void 0})},a.prototype._updateLayer=function(n){this._updatedLayers[n.id]=!0,n.source&&!this._updatedSources[n.source]&&this.sourceCaches[n.source].getSource().type!=="raster"&&(this._updatedSources[n.source]="reload",this.sourceCaches[n.source].pause()),this._changed=!0},a.prototype._flattenAndSortRenderedFeatures=function(n){for(var s=this,p=function(kt){return s._layers[kt].type==="fill-extrusion"},f={},d=[],y=this._order.length-1;y>=0;y--){var g=this._order[y];if(p(g)){f[g]=y;for(var S=0,I=n;S<I.length;S+=1){var P=I[S][g];if(P)for(var A=0,B=P;A<B.length;A+=1)d.push(B[A])}}}d.sort(function(kt,Mt){return Mt.intersectionZ-kt.intersectionZ});for(var R=[],N=this._order.length-1;N>=0;N--){var L=this._order[N];if(p(L))for(var q=d.length-1;q>=0;q--){var X=d[q].feature;if(f[X.layer.id]<N)break;R.push(X),d.pop()}else for(var rt=0,ct=n;rt<ct.length;rt+=1){var ot=ct[rt][L];if(ot)for(var $=0,yt=ot;$<yt.length;$+=1)R.push(yt[$].feature)}}return R},a.prototype.queryRenderedFeatures=function(n,s,p){s&&s.filter&&this._validate(l.validateStyle.filter,"queryRenderedFeatures.filter",s.filter,null,s);var f={};if(s&&s.layers){if(!Array.isArray(s.layers))return this.fire(new l.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var d=0,y=s.layers;d<y.length;d+=1){var g=y[d],S=this._layers[g];if(!S)return this.fire(new l.ErrorEvent(new Error("The layer '"+g+"' does not exist in the map's style and cannot be queried for features."))),[];f[S.source]=!0}}var I=[];for(var P in s.availableImages=this._availableImages,this.sourceCaches)s.layers&&!f[P]||I.push(it(this.sourceCaches[P],this._layers,this._serializedLayers,n,s,p));return this.placement&&I.push(function(A,B,R,N,L,q,X){for(var rt={},ct=q.queryRenderedSymbols(N),ot=[],$=0,yt=Object.keys(ct).map(Number);$<yt.length;$+=1)ot.push(X[yt[$]]);ot.sort(_t);for(var kt=function(){var pe=Nt[Mt],Ge=pe.featureIndex.lookupSymbolFeatures(ct[pe.bucketInstanceId],B,pe.bucketIndex,pe.sourceLayerIndex,L.filter,L.layers,L.availableImages,A);for(var jt in Ge){var Re=rt[jt]=rt[jt]||[],Pe=Ge[jt];Pe.sort(function(ge,se){var oe=pe.featureSortOrder;if(oe){var He=oe.indexOf(ge.featureIndex);return oe.indexOf(se.featureIndex)-He}return se.featureIndex-ge.featureIndex});for(var _e=0,Ie=Pe;_e<Ie.length;_e+=1)Re.push(Ie[_e])}},Mt=0,Nt=ot;Mt<Nt.length;Mt+=1)kt();var ye=function(pe){rt[pe].forEach(function(Ge){var jt=Ge.feature,Re=R[A[pe].source].getFeatureState(jt.layer["source-layer"],jt.id);jt.source=jt.layer.source,jt.layer["source-layer"]&&(jt.sourceLayer=jt.layer["source-layer"]),jt.state=Re})};for(var le in rt)ye(le);return rt}(this._layers,this._serializedLayers,this.sourceCaches,n,s,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(I)},a.prototype.querySourceFeatures=function(n,s){s&&s.filter&&this._validate(l.validateStyle.filter,"querySourceFeatures.filter",s.filter,null,s);var p=this.sourceCaches[n];return p?function(f,d){for(var y=f.getRenderableIds().map(function(B){return f.getTileByID(B)}),g=[],S={},I=0;I<y.length;I++){var P=y[I],A=P.tileID.canonical.key;S[A]||(S[A]=!0,P.querySourceFeatures(g,d))}return g}(p,s):[]},a.prototype.addSourceType=function(n,s,p){return a.getSourceType(n)?p(new Error('A source type called "'+n+'" already exists.')):(a.setSourceType(n,s),s.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:n,url:s.workerSourceURL},p):p(null,null))},a.prototype.getLight=function(){return this.light.getLight()},a.prototype.setLight=function(n,s){s===void 0&&(s={}),this._checkLoaded();var p=this.light.getLight(),f=!1;for(var d in n)if(!l.deepEqual(n[d],p[d])){f=!0;break}if(f){var y={now:l.browser.now(),transition:l.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(n,s),this.light.updateTransitions(y)}},a.prototype._validate=function(n,s,p,f,d){return d===void 0&&(d={}),(!d||d.validate!==!1)&&so(this,n.call(l.validateStyle,l.extend({key:s,style:this.serialize(),value:p,styleSpec:l.styleSpec},f)))},a.prototype._remove=function(){for(var n in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),l.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[n].setEventedParent(null);for(var s in this.sourceCaches)this.sourceCaches[s].clearTiles(),this.sourceCaches[s].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},a.prototype._clearSource=function(n){this.sourceCaches[n].clearTiles()},a.prototype._reloadSource=function(n){this.sourceCaches[n].resume(),this.sourceCaches[n].reload()},a.prototype._updateSources=function(n){for(var s in this.sourceCaches)this.sourceCaches[s].update(n)},a.prototype._generateCollisionBoxes=function(){for(var n in this.sourceCaches)this._reloadSource(n)},a.prototype._updatePlacement=function(n,s,p,f,d){d===void 0&&(d=!1);for(var y=!1,g=!1,S={},I=0,P=this._order;I<P.length;I+=1){var A=this._layers[P[I]];if(A.type==="symbol"){if(!S[A.source]){var B=this.sourceCaches[A.source];S[A.source]=B.getRenderableIds(!0).map(function(X){return B.getTileByID(X)}).sort(function(X,rt){return rt.tileID.overscaledZ-X.tileID.overscaledZ||(X.tileID.isLessThan(rt.tileID)?-1:1)})}var R=this.crossTileSymbolIndex.addLayer(A,S[A.source],n.center.lng);y=y||R}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((d=d||this._layerOrderChanged||p===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(l.browser.now(),n.zoom))&&(this.pauseablePlacement=new Ts(n,this._order,d,s,p,f,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,S),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(l.browser.now()),g=!0),y&&this.pauseablePlacement.placement.setStale()),g||y)for(var N=0,L=this._order;N<L.length;N+=1){var q=this._layers[L[N]];q.type==="symbol"&&this.placement.updateLayerOpacities(q,S[q.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(l.browser.now())},a.prototype._releaseSymbolFadeTiles=function(){for(var n in this.sourceCaches)this.sourceCaches[n].releaseSymbolFadeTiles()},a.prototype.getImages=function(n,s,p){this.imageManager.getImages(s.icons,p),this._updateTilesForChangedImages();var f=this.sourceCaches[s.source];f&&f.setDependencies(s.tileID.key,s.type,s.icons)},a.prototype.getGlyphs=function(n,s,p){this.glyphManager.getGlyphs(s.stacks,p)},a.prototype.getResource=function(n,s,p){return l.makeRequest(s,p)},a}(l.Evented);lo.getSourceType=function(i){return et[i]},lo.setSourceType=function(i,a){et[i]=a},lo.registerForPluginStateChange=l.registerForPluginStateChange;var Sa=l.createLayout([{name:"a_pos",type:"Int16",components:2}]),ni=Vr(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),Is=Vr(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),wl=Vr(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Sl=Vr(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),As=Vr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),ns=Vr(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),Ta=Vr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),wo=Vr("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),uo=Vr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),Tr=Vr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),Ne=Vr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),Da=Vr(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),jn=Vr(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),Mn=Vr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),lr=Vr(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),ur=Vr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),La=Vr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),Di=Vr(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),Dn=Vr(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),Zi=Vr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),pa=Vr(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),Ra=Vr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),Ba=Vr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),ha=Vr(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),Oa=Vr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),as=Vr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function Vr(i,a){var n=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,s=a.match(/attribute ([\w]+) ([\w]+)/g),p=i.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),f=a.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),d=f?f.concat(p):p,y={};return{fragmentSource:i=i.replace(n,function(g,S,I,P,A){return y[A]=!0,S==="define"?`
#ifndef HAS_UNIFORM_u_`+A+`
varying `+I+" "+P+" "+A+`;
#else
uniform `+I+" "+P+" u_"+A+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+A+`
    `+I+" "+P+" "+A+" = u_"+A+`;
#endif
`}),vertexSource:a=a.replace(n,function(g,S,I,P,A){var B=P==="float"?"vec2":"vec4",R=A.match(/color/)?"color":B;return y[A]?S==="define"?`
#ifndef HAS_UNIFORM_u_`+A+`
uniform lowp float u_`+A+`_t;
attribute `+I+" "+B+" a_"+A+`;
varying `+I+" "+P+" "+A+`;
#else
uniform `+I+" "+P+" u_"+A+`;
#endif
`:R==="vec4"?`
#ifndef HAS_UNIFORM_u_`+A+`
    `+A+" = a_"+A+`;
#else
    `+I+" "+P+" "+A+" = u_"+A+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+A+`
    `+A+" = unpack_mix_"+R+"(a_"+A+", u_"+A+`_t);
#else
    `+I+" "+P+" "+A+" = u_"+A+`;
#endif
`:S==="define"?`
#ifndef HAS_UNIFORM_u_`+A+`
uniform lowp float u_`+A+`_t;
attribute `+I+" "+B+" a_"+A+`;
#else
uniform `+I+" "+P+" u_"+A+`;
#endif
`:R==="vec4"?`
#ifndef HAS_UNIFORM_u_`+A+`
    `+I+" "+P+" "+A+" = a_"+A+`;
#else
    `+I+" "+P+" "+A+" = u_"+A+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+A+`
    `+I+" "+P+" "+A+" = unpack_mix_"+R+"(a_"+A+", u_"+A+`_t);
#else
    `+I+" "+P+" "+A+" = u_"+A+`;
#endif
`}),staticAttributes:s,staticUniforms:d}}var Fa=Object.freeze({__proto__:null,prelude:ni,background:Is,backgroundPattern:wl,circle:Sl,clippingMask:As,heatmap:ns,heatmapTexture:Ta,collisionBox:wo,collisionCircle:uo,debug:Tr,fill:Ne,fillOutline:Da,fillOutlinePattern:jn,fillPattern:Mn,fillExtrusion:lr,fillExtrusionPattern:ur,hillshadePrepare:La,hillshade:Di,line:Dn,lineGradient:Zi,linePattern:pa,lineSDF:Ra,raster:Ba,symbolIcon:ha,symbolSDF:Oa,symbolTextAndIcon:as}),Ua=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function Jn(i){for(var a=[],n=0;n<i.length;n++)if(i[n]!==null){var s=i[n].split(" ");a.push(s.pop())}return a}Ua.prototype.bind=function(i,a,n,s,p,f,d,y){this.context=i;for(var g=this.boundPaintVertexBuffers.length!==s.length,S=0;!g&&S<s.length;S++)this.boundPaintVertexBuffers[S]!==s[S]&&(g=!0);i.extVertexArrayObject&&this.vao&&this.boundProgram===a&&this.boundLayoutVertexBuffer===n&&!g&&this.boundIndexBuffer===p&&this.boundVertexOffset===f&&this.boundDynamicVertexBuffer===d&&this.boundDynamicVertexBuffer2===y?(i.bindVertexArrayOES.set(this.vao),d&&d.bind(),p&&p.dynamicDraw&&p.bind(),y&&y.bind()):this.freshBind(a,n,s,p,f,d,y)},Ua.prototype.freshBind=function(i,a,n,s,p,f,d){var y,g=i.numAttributes,S=this.context,I=S.gl;if(S.extVertexArrayObject)this.vao&&this.destroy(),this.vao=S.extVertexArrayObject.createVertexArrayOES(),S.bindVertexArrayOES.set(this.vao),y=0,this.boundProgram=i,this.boundLayoutVertexBuffer=a,this.boundPaintVertexBuffers=n,this.boundIndexBuffer=s,this.boundVertexOffset=p,this.boundDynamicVertexBuffer=f,this.boundDynamicVertexBuffer2=d;else{y=S.currentNumAttributes||0;for(var P=g;P<y;P++)I.disableVertexAttribArray(P)}a.enableAttributes(I,i);for(var A=0,B=n;A<B.length;A+=1)B[A].enableAttributes(I,i);f&&f.enableAttributes(I,i),d&&d.enableAttributes(I,i),a.bind(),a.setVertexAttribPointers(I,i,p);for(var R=0,N=n;R<N.length;R+=1){var L=N[R];L.bind(),L.setVertexAttribPointers(I,i,p)}f&&(f.bind(),f.setVertexAttribPointers(I,i,p)),s&&s.bind(),d&&(d.bind(),d.setVertexAttribPointers(I,i,p)),S.currentNumAttributes=g},Ua.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var Cs=function(i,a,n,s,p,f){var d=i.gl;this.program=d.createProgram();for(var y=Jn(n.staticAttributes),g=s?s.getBinderAttributes():[],S=y.concat(g),I=n.staticUniforms?Jn(n.staticUniforms):[],P=s?s.getBinderUniforms():[],A=[],B=0,R=I.concat(P);B<R.length;B+=1){var N=R[B];A.indexOf(N)<0&&A.push(N)}var L=s?s.defines():[];f&&L.push("#define OVERDRAW_INSPECTOR;");var q=L.concat(ni.fragmentSource,n.fragmentSource).join(`
`),X=L.concat(ni.vertexSource,n.vertexSource).join(`
`),rt=d.createShader(d.FRAGMENT_SHADER);if(d.isContextLost())this.failedToCreate=!0;else{d.shaderSource(rt,q),d.compileShader(rt),d.attachShader(this.program,rt);var ct=d.createShader(d.VERTEX_SHADER);if(d.isContextLost())this.failedToCreate=!0;else{d.shaderSource(ct,X),d.compileShader(ct),d.attachShader(this.program,ct),this.attributes={};var ot={};this.numAttributes=S.length;for(var $=0;$<this.numAttributes;$++)S[$]&&(d.bindAttribLocation(this.program,$,S[$]),this.attributes[S[$]]=$);d.linkProgram(this.program),d.deleteShader(ct),d.deleteShader(rt);for(var yt=0;yt<A.length;yt++){var kt=A[yt];if(kt&&!ot[kt]){var Mt=d.getUniformLocation(this.program,kt);Mt&&(ot[kt]=Mt)}}this.fixedUniforms=p(i,ot),this.binderUniforms=s?s.getUniforms(i,ot):[]}}};function zs(i,a,n){var s=1/wn(n,1,a.transform.tileZoom),p=Math.pow(2,n.tileID.overscaledZ),f=n.tileSize*Math.pow(2,a.transform.tileZoom)/p,d=f*(n.tileID.canonical.x+n.tileID.wrap*p),y=f*n.tileID.canonical.y;return{u_image:0,u_texsize:n.imageAtlasTexture.size,u_scale:[s,i.fromScale,i.toScale],u_fade:i.t,u_pixel_coord_upper:[d>>16,y>>16],u_pixel_coord_lower:[65535&d,65535&y]}}Cs.prototype.draw=function(i,a,n,s,p,f,d,y,g,S,I,P,A,B,R,N){var L,q=i.gl;if(!this.failedToCreate){for(var X in i.program.set(this.program),i.setDepthMode(n),i.setStencilMode(s),i.setColorMode(p),i.setCullFace(f),this.fixedUniforms)this.fixedUniforms[X].set(d[X]);B&&B.setUniforms(i,this.binderUniforms,P,{zoom:A});for(var rt=(L={},L[q.LINES]=2,L[q.TRIANGLES]=3,L[q.LINE_STRIP]=1,L)[a],ct=0,ot=I.get();ct<ot.length;ct+=1){var $=ot[ct],yt=$.vaos||($.vaos={});(yt[y]||(yt[y]=new Ua)).bind(i,this,g,B?B.getPaintVertexBuffers():[],S,$.vertexOffset,R,N),q.drawElements(a,$.primitiveLength*rt,q.UNSIGNED_SHORT,$.primitiveOffset*rt*2)}}};var co=function(i,a,n,s){var p=a.style.light,f=p.properties.get("position"),d=[f.x,f.y,f.z],y=l.create$1();p.properties.get("anchor")==="viewport"&&l.fromRotation(y,-a.transform.angle),l.transformMat3(d,d,y);var g=p.properties.get("color");return{u_matrix:i,u_lightpos:d,u_lightintensity:p.properties.get("intensity"),u_lightcolor:[g.r,g.g,g.b],u_vertical_gradient:+n,u_opacity:s}},jo=function(i,a,n,s,p,f,d){return l.extend(co(i,a,n,s),zs(f,a,d),{u_height_factor:-Math.pow(2,p.overscaledZ)/d.tileSize/8})},pn=function(i){return{u_matrix:i}},Ea=function(i,a,n,s){return l.extend(pn(i),zs(n,a,s))},Ia=function(i,a){return{u_matrix:i,u_world:a}},Tl=function(i,a,n,s,p){return l.extend(Ea(i,a,n,s),{u_world:p})},Va=function(i,a,n,s){var p,f,d=i.transform;if(s.paint.get("circle-pitch-alignment")==="map"){var y=wn(n,1,d.zoom);p=!0,f=[y,y]}else p=!1,f=d.pixelsToGLUnits;return{u_camera_to_center_distance:d.cameraToCenterDistance,u_scale_with_map:+(s.paint.get("circle-pitch-scale")==="map"),u_matrix:i.translatePosMatrix(a.posMatrix,n,s.paint.get("circle-translate"),s.paint.get("circle-translate-anchor")),u_pitch_with_map:+p,u_device_pixel_ratio:l.browser.devicePixelRatio,u_extrude_scale:f}},qo=function(i,a,n){var s=wn(n,1,a.zoom),p=Math.pow(2,a.zoom-n.tileID.overscaledZ),f=n.tileID.overscaleFactor();return{u_matrix:i,u_camera_to_center_distance:a.cameraToCenterDistance,u_pixels_to_tile_units:s,u_extrude_scale:[a.pixelsToGLUnits[0]/(s*p),a.pixelsToGLUnits[1]/(s*p)],u_overscale_factor:f}},hn=function(i,a,n){return{u_matrix:i,u_inv_matrix:a,u_camera_to_center_distance:n.cameraToCenterDistance,u_viewport_size:[n.width,n.height]}},Wa=function(i,a,n){return n===void 0&&(n=1),{u_matrix:i,u_color:a,u_overlay:0,u_overlay_scale:n}},So=function(i){return{u_matrix:i}},To=function(i,a,n,s){return{u_matrix:i,u_extrude_scale:wn(a,1,n),u_intensity:s}},Ps=function(i,a,n){var s=i.transform;return{u_matrix:Zo(i,a,n),u_ratio:1/wn(a,1,s.zoom),u_device_pixel_ratio:l.browser.devicePixelRatio,u_units_to_pixels:[1/s.pixelsToGLUnits[0],1/s.pixelsToGLUnits[1]]}},$s=function(i,a,n,s){return l.extend(Ps(i,a,n),{u_image:0,u_image_height:s})},Wr=function(i,a,n,s){var p=i.transform,f=El(a,p);return{u_matrix:Zo(i,a,n),u_texsize:a.imageAtlasTexture.size,u_ratio:1/wn(a,1,p.zoom),u_device_pixel_ratio:l.browser.devicePixelRatio,u_image:0,u_scale:[f,s.fromScale,s.toScale],u_fade:s.t,u_units_to_pixels:[1/p.pixelsToGLUnits[0],1/p.pixelsToGLUnits[1]]}},ks=function(i,a,n,s,p){var f=i.lineAtlas,d=El(a,i.transform),y=n.layout.get("line-cap")==="round",g=f.getDash(s.from,y),S=f.getDash(s.to,y),I=g.width*p.fromScale,P=S.width*p.toScale;return l.extend(Ps(i,a,n),{u_patternscale_a:[d/I,-g.height/2],u_patternscale_b:[d/P,-S.height/2],u_sdfgamma:f.width/(256*Math.min(I,P)*l.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:g.y,u_tex_y_b:S.y,u_mix:p.t})};function El(i,a){return 1/wn(i,1,a.tileZoom)}function Zo(i,a,n){return i.translatePosMatrix(a.tileID.posMatrix,a,n.paint.get("line-translate"),n.paint.get("line-translate-anchor"))}var Gl=function(i,a,n,s,p){return{u_matrix:i,u_tl_parent:a,u_scale_parent:n,u_buffer_scale:1,u_fade_t:s.mix,u_opacity:s.opacity*p.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:p.paint.get("raster-brightness-min"),u_brightness_high:p.paint.get("raster-brightness-max"),u_saturation_factor:(d=p.paint.get("raster-saturation"),d>0?1-1/(1.001-d):-d),u_contrast_factor:(f=p.paint.get("raster-contrast"),f>0?1/(1-f):1+f),u_spin_weights:os(p.paint.get("raster-hue-rotate"))};var f,d};function os(i){i*=Math.PI/180;var a=Math.sin(i),n=Math.cos(i);return[(2*n+1)/3,(-Math.sqrt(3)*a-n+1)/3,(Math.sqrt(3)*a-n+1)/3]}var Xa,tl=function(i,a,n,s,p,f,d,y,g,S){var I=p.transform;return{u_is_size_zoom_constant:+(i==="constant"||i==="source"),u_is_size_feature_constant:+(i==="constant"||i==="camera"),u_size_t:a?a.uSizeT:0,u_size:a?a.uSize:0,u_camera_to_center_distance:I.cameraToCenterDistance,u_pitch:I.pitch/360*2*Math.PI,u_rotate_symbol:+n,u_aspect_ratio:I.width/I.height,u_fade_change:p.options.fadeDuration?p.symbolFadeChange:1,u_matrix:f,u_label_plane_matrix:d,u_coord_matrix:y,u_is_text:+g,u_pitch_with_map:+s,u_texsize:S,u_texture:0}},Eo=function(i,a,n,s,p,f,d,y,g,S,I){var P=p.transform;return l.extend(tl(i,a,n,s,p,f,d,y,g,S),{u_gamma_scale:s?Math.cos(P._pitch)*P.cameraToCenterDistance:1,u_device_pixel_ratio:l.browser.devicePixelRatio,u_is_halo:+I})},Ms=function(i,a,n,s,p,f,d,y,g,S){return l.extend(Eo(i,a,n,s,p,f,d,y,!0,g,!0),{u_texsize_icon:S,u_texture_icon:1})},Ds=function(i,a,n){return{u_matrix:i,u_opacity:a,u_color:n}},ss=function(i,a,n,s,p,f){return l.extend(function(d,y,g,S){var I=g.imageManager.getPattern(d.from.toString()),P=g.imageManager.getPattern(d.to.toString()),A=g.imageManager.getPixelSize(),B=A.width,R=A.height,N=Math.pow(2,S.tileID.overscaledZ),L=S.tileSize*Math.pow(2,g.transform.tileZoom)/N,q=L*(S.tileID.canonical.x+S.tileID.wrap*N),X=L*S.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:I.tl,u_pattern_br_a:I.br,u_pattern_tl_b:P.tl,u_pattern_br_b:P.br,u_texsize:[B,R],u_mix:y.t,u_pattern_size_a:I.displaySize,u_pattern_size_b:P.displaySize,u_scale_a:y.fromScale,u_scale_b:y.toScale,u_tile_units_to_pixels:1/wn(S,1,g.transform.tileZoom),u_pixel_coord_upper:[q>>16,X>>16],u_pixel_coord_lower:[65535&q,65535&X]}}(s,f,n,p),{u_matrix:i,u_opacity:a})},Go={fillExtrusion:function(i,a){return{u_matrix:new l.UniformMatrix4f(i,a.u_matrix),u_lightpos:new l.Uniform3f(i,a.u_lightpos),u_lightintensity:new l.Uniform1f(i,a.u_lightintensity),u_lightcolor:new l.Uniform3f(i,a.u_lightcolor),u_vertical_gradient:new l.Uniform1f(i,a.u_vertical_gradient),u_opacity:new l.Uniform1f(i,a.u_opacity)}},fillExtrusionPattern:function(i,a){return{u_matrix:new l.UniformMatrix4f(i,a.u_matrix),u_lightpos:new l.Uniform3f(i,a.u_lightpos),u_lightintensity:new l.Uniform1f(i,a.u_lightintensity),u_lightcolor:new l.Uniform3f(i,a.u_lightcolor),u_vertical_gradient:new l.Uniform1f(i,a.u_vertical_gradient),u_height_factor:new l.Uniform1f(i,a.u_height_factor),u_image:new l.Uniform1i(i,a.u_image),u_texsize:new l.Uniform2f(i,a.u_texsize),u_pixel_coord_upper:new l.Uniform2f(i,a.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(i,a.u_pixel_coord_lower),u_scale:new l.Uniform3f(i,a.u_scale),u_fade:new l.Uniform1f(i,a.u_fade),u_opacity:new l.Uniform1f(i,a.u_opacity)}},fill:function(i,a){return{u_matrix:new l.UniformMatrix4f(i,a.u_matrix)}},fillPattern:function(i,a){return{u_matrix:new l.UniformMatrix4f(i,a.u_matrix),u_image:new l.Uniform1i(i,a.u_image),u_texsize:new l.Uniform2f(i,a.u_texsize),u_pixel_coord_upper:new l.Uniform2f(i,a.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(i,a.u_pixel_coord_lower),u_scale:new l.Uniform3f(i,a.u_scale),u_fade:new l.Uniform1f(i,a.u_fade)}},fillOutline:function(i,a){return{u_matrix:new l.UniformMatrix4f(i,a.u_matrix),u_world:new l.Uniform2f(i,a.u_world)}},fillOutlinePattern:function(i,a){return{u_matrix:new l.UniformMatrix4f(i,a.u_matrix),u_world:new l.Uniform2f(i,a.u_world),u_image:new l.Uniform1i(i,a.u_image),u_texsize:new l.Uniform2f(i,a.u_texsize),u_pixel_coord_upper:new l.Uniform2f(i,a.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(i,a.u_pixel_coord_lower),u_scale:new l.Uniform3f(i,a.u_scale),u_fade:new l.Uniform1f(i,a.u_fade)}},circle:function(i,a){return{u_camera_to_center_distance:new l.Uniform1f(i,a.u_camera_to_center_distance),u_scale_with_map:new l.Uniform1i(i,a.u_scale_with_map),u_pitch_with_map:new l.Uniform1i(i,a.u_pitch_with_map),u_extrude_scale:new l.Uniform2f(i,a.u_extrude_scale),u_device_pixel_ratio:new l.Uniform1f(i,a.u_device_pixel_ratio),u_matrix:new l.UniformMatrix4f(i,a.u_matrix)}},collisionBox:function(i,a){return{u_matrix:new l.UniformMatrix4f(i,a.u_matrix),u_camera_to_center_distance:new l.Uniform1f(i,a.u_camera_to_center_distance),u_pixels_to_tile_units:new l.Uniform1f(i,a.u_pixels_to_tile_units),u_extrude_scale:new l.Uniform2f(i,a.u_extrude_scale),u_overscale_factor:new l.Uniform1f(i,a.u_overscale_factor)}},collisionCircle:function(i,a){return{u_matrix:new l.UniformMatrix4f(i,a.u_matrix),u_inv_matrix:new l.UniformMatrix4f(i,a.u_inv_matrix),u_camera_to_center_distance:new l.Uniform1f(i,a.u_camera_to_center_distance),u_viewport_size:new l.Uniform2f(i,a.u_viewport_size)}},debug:function(i,a){return{u_color:new l.UniformColor(i,a.u_color),u_matrix:new l.UniformMatrix4f(i,a.u_matrix),u_overlay:new l.Uniform1i(i,a.u_overlay),u_overlay_scale:new l.Uniform1f(i,a.u_overlay_scale)}},clippingMask:function(i,a){return{u_matrix:new l.UniformMatrix4f(i,a.u_matrix)}},heatmap:function(i,a){return{u_extrude_scale:new l.Uniform1f(i,a.u_extrude_scale),u_intensity:new l.Uniform1f(i,a.u_intensity),u_matrix:new l.UniformMatrix4f(i,a.u_matrix)}},heatmapTexture:function(i,a){return{u_matrix:new l.UniformMatrix4f(i,a.u_matrix),u_world:new l.Uniform2f(i,a.u_world),u_image:new l.Uniform1i(i,a.u_image),u_color_ramp:new l.Uniform1i(i,a.u_color_ramp),u_opacity:new l.Uniform1f(i,a.u_opacity)}},hillshade:function(i,a){return{u_matrix:new l.UniformMatrix4f(i,a.u_matrix),u_image:new l.Uniform1i(i,a.u_image),u_latrange:new l.Uniform2f(i,a.u_latrange),u_light:new l.Uniform2f(i,a.u_light),u_shadow:new l.UniformColor(i,a.u_shadow),u_highlight:new l.UniformColor(i,a.u_highlight),u_accent:new l.UniformColor(i,a.u_accent)}},hillshadePrepare:function(i,a){return{u_matrix:new l.UniformMatrix4f(i,a.u_matrix),u_image:new l.Uniform1i(i,a.u_image),u_dimension:new l.Uniform2f(i,a.u_dimension),u_zoom:new l.Uniform1f(i,a.u_zoom),u_unpack:new l.Uniform4f(i,a.u_unpack)}},line:function(i,a){return{u_matrix:new l.UniformMatrix4f(i,a.u_matrix),u_ratio:new l.Uniform1f(i,a.u_ratio),u_device_pixel_ratio:new l.Uniform1f(i,a.u_device_pixel_ratio),u_units_to_pixels:new l.Uniform2f(i,a.u_units_to_pixels)}},lineGradient:function(i,a){return{u_matrix:new l.UniformMatrix4f(i,a.u_matrix),u_ratio:new l.Uniform1f(i,a.u_ratio),u_device_pixel_ratio:new l.Uniform1f(i,a.u_device_pixel_ratio),u_units_to_pixels:new l.Uniform2f(i,a.u_units_to_pixels),u_image:new l.Uniform1i(i,a.u_image),u_image_height:new l.Uniform1f(i,a.u_image_height)}},linePattern:function(i,a){return{u_matrix:new l.UniformMatrix4f(i,a.u_matrix),u_texsize:new l.Uniform2f(i,a.u_texsize),u_ratio:new l.Uniform1f(i,a.u_ratio),u_device_pixel_ratio:new l.Uniform1f(i,a.u_device_pixel_ratio),u_image:new l.Uniform1i(i,a.u_image),u_units_to_pixels:new l.Uniform2f(i,a.u_units_to_pixels),u_scale:new l.Uniform3f(i,a.u_scale),u_fade:new l.Uniform1f(i,a.u_fade)}},lineSDF:function(i,a){return{u_matrix:new l.UniformMatrix4f(i,a.u_matrix),u_ratio:new l.Uniform1f(i,a.u_ratio),u_device_pixel_ratio:new l.Uniform1f(i,a.u_device_pixel_ratio),u_units_to_pixels:new l.Uniform2f(i,a.u_units_to_pixels),u_patternscale_a:new l.Uniform2f(i,a.u_patternscale_a),u_patternscale_b:new l.Uniform2f(i,a.u_patternscale_b),u_sdfgamma:new l.Uniform1f(i,a.u_sdfgamma),u_image:new l.Uniform1i(i,a.u_image),u_tex_y_a:new l.Uniform1f(i,a.u_tex_y_a),u_tex_y_b:new l.Uniform1f(i,a.u_tex_y_b),u_mix:new l.Uniform1f(i,a.u_mix)}},raster:function(i,a){return{u_matrix:new l.UniformMatrix4f(i,a.u_matrix),u_tl_parent:new l.Uniform2f(i,a.u_tl_parent),u_scale_parent:new l.Uniform1f(i,a.u_scale_parent),u_buffer_scale:new l.Uniform1f(i,a.u_buffer_scale),u_fade_t:new l.Uniform1f(i,a.u_fade_t),u_opacity:new l.Uniform1f(i,a.u_opacity),u_image0:new l.Uniform1i(i,a.u_image0),u_image1:new l.Uniform1i(i,a.u_image1),u_brightness_low:new l.Uniform1f(i,a.u_brightness_low),u_brightness_high:new l.Uniform1f(i,a.u_brightness_high),u_saturation_factor:new l.Uniform1f(i,a.u_saturation_factor),u_contrast_factor:new l.Uniform1f(i,a.u_contrast_factor),u_spin_weights:new l.Uniform3f(i,a.u_spin_weights)}},symbolIcon:function(i,a){return{u_is_size_zoom_constant:new l.Uniform1i(i,a.u_is_size_zoom_constant),u_is_size_feature_constant:new l.Uniform1i(i,a.u_is_size_feature_constant),u_size_t:new l.Uniform1f(i,a.u_size_t),u_size:new l.Uniform1f(i,a.u_size),u_camera_to_center_distance:new l.Uniform1f(i,a.u_camera_to_center_distance),u_pitch:new l.Uniform1f(i,a.u_pitch),u_rotate_symbol:new l.Uniform1i(i,a.u_rotate_symbol),u_aspect_ratio:new l.Uniform1f(i,a.u_aspect_ratio),u_fade_change:new l.Uniform1f(i,a.u_fade_change),u_matrix:new l.UniformMatrix4f(i,a.u_matrix),u_label_plane_matrix:new l.UniformMatrix4f(i,a.u_label_plane_matrix),u_coord_matrix:new l.UniformMatrix4f(i,a.u_coord_matrix),u_is_text:new l.Uniform1i(i,a.u_is_text),u_pitch_with_map:new l.Uniform1i(i,a.u_pitch_with_map),u_texsize:new l.Uniform2f(i,a.u_texsize),u_texture:new l.Uniform1i(i,a.u_texture)}},symbolSDF:function(i,a){return{u_is_size_zoom_constant:new l.Uniform1i(i,a.u_is_size_zoom_constant),u_is_size_feature_constant:new l.Uniform1i(i,a.u_is_size_feature_constant),u_size_t:new l.Uniform1f(i,a.u_size_t),u_size:new l.Uniform1f(i,a.u_size),u_camera_to_center_distance:new l.Uniform1f(i,a.u_camera_to_center_distance),u_pitch:new l.Uniform1f(i,a.u_pitch),u_rotate_symbol:new l.Uniform1i(i,a.u_rotate_symbol),u_aspect_ratio:new l.Uniform1f(i,a.u_aspect_ratio),u_fade_change:new l.Uniform1f(i,a.u_fade_change),u_matrix:new l.UniformMatrix4f(i,a.u_matrix),u_label_plane_matrix:new l.UniformMatrix4f(i,a.u_label_plane_matrix),u_coord_matrix:new l.UniformMatrix4f(i,a.u_coord_matrix),u_is_text:new l.Uniform1i(i,a.u_is_text),u_pitch_with_map:new l.Uniform1i(i,a.u_pitch_with_map),u_texsize:new l.Uniform2f(i,a.u_texsize),u_texture:new l.Uniform1i(i,a.u_texture),u_gamma_scale:new l.Uniform1f(i,a.u_gamma_scale),u_device_pixel_ratio:new l.Uniform1f(i,a.u_device_pixel_ratio),u_is_halo:new l.Uniform1i(i,a.u_is_halo)}},symbolTextAndIcon:function(i,a){return{u_is_size_zoom_constant:new l.Uniform1i(i,a.u_is_size_zoom_constant),u_is_size_feature_constant:new l.Uniform1i(i,a.u_is_size_feature_constant),u_size_t:new l.Uniform1f(i,a.u_size_t),u_size:new l.Uniform1f(i,a.u_size),u_camera_to_center_distance:new l.Uniform1f(i,a.u_camera_to_center_distance),u_pitch:new l.Uniform1f(i,a.u_pitch),u_rotate_symbol:new l.Uniform1i(i,a.u_rotate_symbol),u_aspect_ratio:new l.Uniform1f(i,a.u_aspect_ratio),u_fade_change:new l.Uniform1f(i,a.u_fade_change),u_matrix:new l.UniformMatrix4f(i,a.u_matrix),u_label_plane_matrix:new l.UniformMatrix4f(i,a.u_label_plane_matrix),u_coord_matrix:new l.UniformMatrix4f(i,a.u_coord_matrix),u_is_text:new l.Uniform1i(i,a.u_is_text),u_pitch_with_map:new l.Uniform1i(i,a.u_pitch_with_map),u_texsize:new l.Uniform2f(i,a.u_texsize),u_texsize_icon:new l.Uniform2f(i,a.u_texsize_icon),u_texture:new l.Uniform1i(i,a.u_texture),u_texture_icon:new l.Uniform1i(i,a.u_texture_icon),u_gamma_scale:new l.Uniform1f(i,a.u_gamma_scale),u_device_pixel_ratio:new l.Uniform1f(i,a.u_device_pixel_ratio),u_is_halo:new l.Uniform1i(i,a.u_is_halo)}},background:function(i,a){return{u_matrix:new l.UniformMatrix4f(i,a.u_matrix),u_opacity:new l.Uniform1f(i,a.u_opacity),u_color:new l.UniformColor(i,a.u_color)}},backgroundPattern:function(i,a){return{u_matrix:new l.UniformMatrix4f(i,a.u_matrix),u_opacity:new l.Uniform1f(i,a.u_opacity),u_image:new l.Uniform1i(i,a.u_image),u_pattern_tl_a:new l.Uniform2f(i,a.u_pattern_tl_a),u_pattern_br_a:new l.Uniform2f(i,a.u_pattern_br_a),u_pattern_tl_b:new l.Uniform2f(i,a.u_pattern_tl_b),u_pattern_br_b:new l.Uniform2f(i,a.u_pattern_br_b),u_texsize:new l.Uniform2f(i,a.u_texsize),u_mix:new l.Uniform1f(i,a.u_mix),u_pattern_size_a:new l.Uniform2f(i,a.u_pattern_size_a),u_pattern_size_b:new l.Uniform2f(i,a.u_pattern_size_b),u_scale_a:new l.Uniform1f(i,a.u_scale_a),u_scale_b:new l.Uniform1f(i,a.u_scale_b),u_pixel_coord_upper:new l.Uniform2f(i,a.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(i,a.u_pixel_coord_lower),u_tile_units_to_pixels:new l.Uniform1f(i,a.u_tile_units_to_pixels)}}};function el(i,a,n,s,p,f,d){for(var y=i.context,g=y.gl,S=i.useProgram("collisionBox"),I=[],P=0,A=0,B=0;B<s.length;B++){var R=s[B],N=a.getTile(R),L=N.getBucket(n);if(L){var q=R.posMatrix;p[0]===0&&p[1]===0||(q=i.translatePosMatrix(R.posMatrix,N,p,f));var X=d?L.textCollisionBox:L.iconCollisionBox,rt=L.collisionCircleArray;if(rt.length>0){var ct=l.create(),ot=q;l.mul(ct,L.placementInvProjMatrix,i.transform.glCoordMatrix),l.mul(ct,ct,L.placementViewportMatrix),I.push({circleArray:rt,circleOffset:A,transform:ot,invTransform:ct}),A=P+=rt.length/4}X&&S.draw(y,g.LINES,k.disabled,U.disabled,i.colorModeForRenderPass(),tt.disabled,qo(q,i.transform,N),n.id,X.layoutVertexBuffer,X.indexBuffer,X.segments,null,i.transform.zoom,null,null,X.collisionVertexBuffer)}}if(d&&I.length){var $=i.useProgram("collisionCircle"),yt=new l.StructArrayLayout2f1f2i16;yt.resize(4*P),yt._trim();for(var kt=0,Mt=0,Nt=I;Mt<Nt.length;Mt+=1)for(var ye=Nt[Mt],le=0;le<ye.circleArray.length/4;le++){var pe=4*le,Ge=ye.circleArray[pe+0],jt=ye.circleArray[pe+1],Re=ye.circleArray[pe+2],Pe=ye.circleArray[pe+3];yt.emplace(kt++,Ge,jt,Re,Pe,0),yt.emplace(kt++,Ge,jt,Re,Pe,1),yt.emplace(kt++,Ge,jt,Re,Pe,2),yt.emplace(kt++,Ge,jt,Re,Pe,3)}(!Xa||Xa.length<2*P)&&(Xa=function(Be){var fi=2*Be,di=new l.StructArrayLayout3ui6;di.resize(fi),di._trim();for(var xi=0;xi<fi;xi++){var jr=6*xi;di.uint16[jr+0]=4*xi+0,di.uint16[jr+1]=4*xi+1,di.uint16[jr+2]=4*xi+2,di.uint16[jr+3]=4*xi+2,di.uint16[jr+4]=4*xi+3,di.uint16[jr+5]=4*xi+0}return di}(P));for(var _e=y.createIndexBuffer(Xa,!0),Ie=y.createVertexBuffer(yt,l.collisionCircleLayout.members,!0),ge=0,se=I;ge<se.length;ge+=1){var oe=se[ge],He=hn(oe.transform,oe.invTransform,i.transform);$.draw(y,g.TRIANGLES,k.disabled,U.disabled,i.colorModeForRenderPass(),tt.disabled,He,n.id,Ie,_e,l.SegmentVector.simpleSegment(0,2*oe.circleOffset,oe.circleArray.length,oe.circleArray.length/2),null,i.transform.zoom,null,null,null)}Ie.destroy(),_e.destroy()}}var ls=l.identity(new Float32Array(16));function fa(i,a,n,s,p,f){var d=l.getAnchorAlignment(i),y=-(d.horizontalAlign-.5)*a,g=-(d.verticalAlign-.5)*n,S=l.evaluateVariableOffset(i,s);return new l.Point((y/p+S[0])*f,(g/p+S[1])*f)}function Il(i,a,n,s,p,f,d,y,g,S,I){var P=i.text.placedSymbolArray,A=i.text.dynamicLayoutVertexArray,B=i.icon.dynamicLayoutVertexArray,R={};A.clear();for(var N=0;N<P.length;N++){var L=P.get(N),q=L.hidden||!L.crossTileID||i.allowVerticalPlacement&&!L.placedOrientation?null:s[L.crossTileID];if(q){var X=new l.Point(L.anchorX,L.anchorY),rt=Ke(X,n?y:d),ct=Bo(f.cameraToCenterDistance,rt.signedDistanceFromCamera),ot=p.evaluateSizeForFeature(i.textSizeData,S,L)*ct/l.ONE_EM;n&&(ot*=i.tilePixelRatio/g);for(var $=fa(q.anchor,q.width,q.height,q.textOffset,q.textBoxScale,ot),yt=n?Ke(X.add($),d).point:rt.point.add(a?$.rotate(-f.angle):$),kt=i.allowVerticalPlacement&&L.placedOrientation===l.WritingMode.vertical?Math.PI/2:0,Mt=0;Mt<L.numGlyphs;Mt++)l.addDynamicAttributes(A,yt,kt);I&&L.associatedIconIndex>=0&&(R[L.associatedIconIndex]={shiftedAnchor:yt,angle:kt})}else ca(L.numGlyphs,A)}if(I){B.clear();for(var Nt=i.icon.placedSymbolArray,ye=0;ye<Nt.length;ye++){var le=Nt.get(ye);if(le.hidden)ca(le.numGlyphs,B);else{var pe=R[ye];if(pe)for(var Ge=0;Ge<le.numGlyphs;Ge++)l.addDynamicAttributes(B,pe.shiftedAnchor,pe.angle);else ca(le.numGlyphs,B)}}i.icon.dynamicLayoutVertexBuffer.updateData(B)}i.text.dynamicLayoutVertexBuffer.updateData(A)}function Ka(i,a,n){return n.iconsInText&&a?"symbolTextAndIcon":i?"symbolSDF":"symbolIcon"}function Ho(i,a,n,s,p,f,d,y,g,S,I,P){for(var A=i.context,B=A.gl,R=i.transform,N=y==="map",L=g==="map",q=N&&n.layout.get("symbol-placement")!=="point",X=N&&!L&&!q,rt=!n.layout.get("symbol-sort-key").isConstant(),ct=!1,ot=i.depthModeForSublayer(0,k.ReadOnly),$=n.layout.get("text-variable-anchor"),yt=[],kt=0,Mt=s;kt<Mt.length;kt+=1){var Nt=Mt[kt],ye=a.getTile(Nt),le=ye.getBucket(n);if(le){var pe=p?le.text:le.icon;if(pe&&pe.segments.get().length){var Ge=pe.programConfigurations.get(n.id),jt=p||le.sdfIcons,Re=p?le.textSizeData:le.iconSizeData,Pe=L||R.pitch!==0,_e=i.useProgram(Ka(jt,p,le),Ge),Ie=l.evaluateSizeForZoom(Re,R.zoom),ge=void 0,se=[0,0],oe=void 0,He=void 0,Be=null,fi=void 0;if(p)oe=ye.glyphAtlasTexture,He=B.LINEAR,ge=ye.glyphAtlasTexture.size,le.iconsInText&&(se=ye.imageAtlasTexture.size,Be=ye.imageAtlasTexture,fi=Pe||i.options.rotating||i.options.zooming||Re.kind==="composite"||Re.kind==="camera"?B.LINEAR:B.NEAREST);else{var di=n.layout.get("icon-size").constantOr(0)!==1||le.iconsNeedLinear;oe=ye.imageAtlasTexture,He=jt||i.options.rotating||i.options.zooming||di||Pe?B.LINEAR:B.NEAREST,ge=ye.imageAtlasTexture.size}var xi=wn(ye,1,i.transform.zoom),jr=gi(Nt.posMatrix,L,N,i.transform,xi),bi=Ur(Nt.posMatrix,L,N,i.transform,xi),Qe=$&&le.hasTextData(),Lr=n.layout.get("icon-text-fit")!=="none"&&Qe&&le.hasIconData();q&&Ha(le,Nt.posMatrix,i,p,jr,bi,L,S);var Pi=i.translatePosMatrix(Nt.posMatrix,ye,f,d),Ir=q||p&&$||Lr?ls:jr,Kr=i.translatePosMatrix(bi,ye,f,d,!0),ra=jt&&n.paint.get(p?"text-halo-width":"icon-halo-width").constantOr(1)!==0,Pa={program:_e,buffers:pe,uniformValues:jt?le.iconsInText?Ms(Re.kind,Ie,X,L,i,Pi,Ir,Kr,ge,se):Eo(Re.kind,Ie,X,L,i,Pi,Ir,Kr,p,ge,!0):tl(Re.kind,Ie,X,L,i,Pi,Ir,Kr,p,ge),atlasTexture:oe,atlasTextureIcon:Be,atlasInterpolation:He,atlasInterpolationIcon:fi,isSDF:jt,hasHalo:ra};if(rt&&le.canOverlap){ct=!0;for(var mo=0,vn=pe.segments.get();mo<vn.length;mo+=1){var ia=vn[mo];yt.push({segments:new l.SegmentVector([ia]),sortKey:ia.sortKey,state:Pa})}}else yt.push({segments:pe.segments,sortKey:0,state:Pa})}}}ct&&yt.sort(function(Vi,yi){return Vi.sortKey-yi.sortKey});for(var Ae=0,be=yt;Ae<be.length;Ae+=1){var mi=be[Ae],Er=mi.state;if(A.activeTexture.set(B.TEXTURE0),Er.atlasTexture.bind(Er.atlasInterpolation,B.CLAMP_TO_EDGE),Er.atlasTextureIcon&&(A.activeTexture.set(B.TEXTURE1),Er.atlasTextureIcon&&Er.atlasTextureIcon.bind(Er.atlasInterpolationIcon,B.CLAMP_TO_EDGE)),Er.isSDF){var yr=Er.uniformValues;Er.hasHalo&&(yr.u_is_halo=1,po(Er.buffers,mi.segments,n,i,Er.program,ot,I,P,yr)),yr.u_is_halo=0}po(Er.buffers,mi.segments,n,i,Er.program,ot,I,P,Er.uniformValues)}}function po(i,a,n,s,p,f,d,y,g){var S=s.context;p.draw(S,S.gl.TRIANGLES,f,d,y,tt.disabled,g,n.id,i.layoutVertexBuffer,i.indexBuffer,a,n.paint,s.transform.zoom,i.programConfigurations.get(n.id),i.dynamicLayoutVertexBuffer,i.opacityVertexBuffer)}function Io(i,a,n,s,p,f,d){var y,g,S,I,P,A=i.context.gl,B=n.paint.get("fill-pattern"),R=B&&B.constantOr(1),N=n.getCrossfadeParameters();d?(g=R&&!n.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",y=A.LINES):(g=R?"fillPattern":"fill",y=A.TRIANGLES);for(var L=0,q=s;L<q.length;L+=1){var X=q[L],rt=a.getTile(X);if(!R||rt.patternsLoaded()){var ct=rt.getBucket(n);if(ct){var ot=ct.programConfigurations.get(n.id),$=i.useProgram(g,ot);R&&(i.context.activeTexture.set(A.TEXTURE0),rt.imageAtlasTexture.bind(A.LINEAR,A.CLAMP_TO_EDGE),ot.updatePaintBuffers(N));var yt=B.constantOr(null);if(yt&&rt.imageAtlas){var kt=rt.imageAtlas,Mt=kt.patternPositions[yt.to.toString()],Nt=kt.patternPositions[yt.from.toString()];Mt&&Nt&&ot.setConstantPatternPositions(Mt,Nt)}var ye=i.translatePosMatrix(X.posMatrix,rt,n.paint.get("fill-translate"),n.paint.get("fill-translate-anchor"));if(d){I=ct.indexBuffer2,P=ct.segments2;var le=[A.drawingBufferWidth,A.drawingBufferHeight];S=g==="fillOutlinePattern"&&R?Tl(ye,i,N,rt,le):Ia(ye,le)}else I=ct.indexBuffer,P=ct.segments,S=R?Ea(ye,i,N,rt):pn(ye);$.draw(i.context,y,p,i.stencilModeForClipping(X),f,tt.disabled,S,n.id,ct.layoutVertexBuffer,I,P,n.paint,i.transform.zoom,ot)}}}}function Wo(i,a,n,s,p,f,d){for(var y=i.context,g=y.gl,S=n.paint.get("fill-extrusion-pattern"),I=S.constantOr(1),P=n.getCrossfadeParameters(),A=n.paint.get("fill-extrusion-opacity"),B=0,R=s;B<R.length;B+=1){var N=R[B],L=a.getTile(N),q=L.getBucket(n);if(q){var X=q.programConfigurations.get(n.id),rt=i.useProgram(I?"fillExtrusionPattern":"fillExtrusion",X);I&&(i.context.activeTexture.set(g.TEXTURE0),L.imageAtlasTexture.bind(g.LINEAR,g.CLAMP_TO_EDGE),X.updatePaintBuffers(P));var ct=S.constantOr(null);if(ct&&L.imageAtlas){var ot=L.imageAtlas,$=ot.patternPositions[ct.to.toString()],yt=ot.patternPositions[ct.from.toString()];$&&yt&&X.setConstantPatternPositions($,yt)}var kt=i.translatePosMatrix(N.posMatrix,L,n.paint.get("fill-extrusion-translate"),n.paint.get("fill-extrusion-translate-anchor")),Mt=n.paint.get("fill-extrusion-vertical-gradient"),Nt=I?jo(kt,i,Mt,A,N,P,L):co(kt,i,Mt,A);rt.draw(y,y.gl.TRIANGLES,p,f,d,tt.backCCW,Nt,n.id,q.layoutVertexBuffer,q.indexBuffer,q.segments,n.paint,i.transform.zoom,X)}}}function Hl(i,a,n,s,p,f){var d=i.context,y=d.gl,g=a.fbo;if(g){var S=i.useProgram("hillshade");d.activeTexture.set(y.TEXTURE0),y.bindTexture(y.TEXTURE_2D,g.colorAttachment.get());var I=function(P,A,B){var R=B.paint.get("hillshade-shadow-color"),N=B.paint.get("hillshade-highlight-color"),L=B.paint.get("hillshade-accent-color"),q=B.paint.get("hillshade-illumination-direction")*(Math.PI/180);B.paint.get("hillshade-illumination-anchor")==="viewport"&&(q-=P.transform.angle);var X,rt,ct,ot=!P.options.moving;return{u_matrix:P.transform.calculatePosMatrix(A.tileID.toUnwrapped(),ot),u_image:0,u_latrange:(X=A.tileID,rt=Math.pow(2,X.canonical.z),ct=X.canonical.y,[new l.MercatorCoordinate(0,ct/rt).toLngLat().lat,new l.MercatorCoordinate(0,(ct+1)/rt).toLngLat().lat]),u_light:[B.paint.get("hillshade-exaggeration"),q],u_shadow:R,u_highlight:N,u_accent:L}}(i,a,n);S.draw(d,y.TRIANGLES,s,p,f,tt.disabled,I,n.id,i.rasterBoundsBuffer,i.quadTriangleIndexBuffer,i.rasterBoundsSegments)}}function Ls(i,a,n,s,p,f){var d=i.context,y=d.gl,g=a.dem;if(g&&g.data){var S=g.dim,I=g.stride,P=g.getPixels();if(d.activeTexture.set(y.TEXTURE1),d.pixelStoreUnpackPremultiplyAlpha.set(!1),a.demTexture=a.demTexture||i.getTileTexture(I),a.demTexture){var A=a.demTexture;A.update(P,{premultiply:!1}),A.bind(y.NEAREST,y.CLAMP_TO_EDGE)}else a.demTexture=new l.Texture(d,P,y.RGBA,{premultiply:!1}),a.demTexture.bind(y.NEAREST,y.CLAMP_TO_EDGE);d.activeTexture.set(y.TEXTURE0);var B=a.fbo;if(!B){var R=new l.Texture(d,{width:S,height:S,data:null},y.RGBA);R.bind(y.LINEAR,y.CLAMP_TO_EDGE),(B=a.fbo=d.createFramebuffer(S,S,!0)).colorAttachment.set(R.texture)}d.bindFramebuffer.set(B.framebuffer),d.viewport.set([0,0,S,S]),i.useProgram("hillshadePrepare").draw(d,y.TRIANGLES,s,p,f,tt.disabled,function(N,L){var q=L.stride,X=l.create();return l.ortho(X,0,l.EXTENT,-l.EXTENT,0,0,1),l.translate(X,X,[0,-l.EXTENT,0]),{u_matrix:X,u_image:1,u_dimension:[q,q],u_zoom:N.overscaledZ,u_unpack:L.getUnpackVector()}}(a.tileID,g),n.id,i.rasterBoundsBuffer,i.quadTriangleIndexBuffer,i.rasterBoundsSegments),a.needsHillshadePrepare=!1}}function Wl(i,a,n,s,p){var f=s.paint.get("raster-fade-duration");if(f>0){var d=l.browser.now(),y=(d-i.timeAdded)/f,g=a?(d-a.timeAdded)/f:-1,S=n.getSource(),I=p.coveringZoomLevel({tileSize:S.tileSize,roundZoom:S.roundZoom}),P=!a||Math.abs(a.tileID.overscaledZ-I)>Math.abs(i.tileID.overscaledZ-I),A=P&&i.refreshedUponExpiration?1:l.clamp(P?y:1-g,0,1);return i.refreshedUponExpiration&&y>=1&&(i.refreshedUponExpiration=!1),a?{opacity:1,mix:1-A}:{opacity:A,mix:0}}return{opacity:1,mix:0}}var Na=new l.Color(1,0,0,1),rl=new l.Color(0,1,0,1),Rs=new l.Color(0,0,1,1),Bs=new l.Color(1,0,1,1),us=new l.Color(0,1,1,1);function cs(i,a,n,s){ps(i,0,a+n/2,i.transform.width,n,s)}function Aa(i,a,n,s){ps(i,a-n/2,0,n,i.transform.height,s)}function ps(i,a,n,s,p,f){var d=i.context,y=d.gl;y.enable(y.SCISSOR_TEST),y.scissor(a*l.browser.devicePixelRatio,n*l.browser.devicePixelRatio,s*l.browser.devicePixelRatio,p*l.browser.devicePixelRatio),d.clear({color:f}),y.disable(y.SCISSOR_TEST)}function il(i,a,n){var s=i.context,p=s.gl,f=n.posMatrix,d=i.useProgram("debug"),y=k.disabled,g=U.disabled,S=i.colorModeForRenderPass();s.activeTexture.set(p.TEXTURE0),i.emptyTexture.bind(p.LINEAR,p.CLAMP_TO_EDGE),d.draw(s,p.LINE_STRIP,y,g,S,tt.disabled,Wa(f,l.Color.red),"$debug",i.debugBuffer,i.tileBorderIndexBuffer,i.debugSegments);var I=a.getTileByID(n.key).latestRawTileData,P=Math.floor((I&&I.byteLength||0)/1024),A=a.getTile(n).tileSize,B=512/Math.min(A,512)*(n.overscaledZ/i.transform.zoom)*.5,R=n.canonical.toString();n.overscaledZ!==n.canonical.z&&(R+=" => "+n.overscaledZ),function(N,L){N.initDebugOverlayCanvas();var q=N.debugOverlayCanvas,X=N.context.gl,rt=N.debugOverlayCanvas.getContext("2d");rt.clearRect(0,0,q.width,q.height),rt.shadowColor="white",rt.shadowBlur=2,rt.lineWidth=1.5,rt.strokeStyle="white",rt.textBaseline="top",rt.font="bold 36px Open Sans, sans-serif",rt.fillText(L,5,5),rt.strokeText(L,5,5),N.debugOverlayTexture.update(q),N.debugOverlayTexture.bind(X.LINEAR,X.CLAMP_TO_EDGE)}(i,R+" "+P+"kb"),d.draw(s,p.TRIANGLES,y,g,K.alphaBlended,tt.disabled,Wa(f,l.Color.transparent,B),"$debug",i.debugBuffer,i.quadTriangleIndexBuffer,i.debugSegments)}var Os={symbol:function(i,a,n,s,p){if(i.renderPass==="translucent"){var f=U.disabled,d=i.colorModeForRenderPass();n.layout.get("text-variable-anchor")&&function(y,g,S,I,P,A,B){for(var R=g.transform,N=P==="map",L=A==="map",q=0,X=y;q<X.length;q+=1){var rt=X[q],ct=I.getTile(rt),ot=ct.getBucket(S);if(ot&&ot.text&&ot.text.segments.get().length){var $=l.evaluateSizeForZoom(ot.textSizeData,R.zoom),yt=wn(ct,1,g.transform.zoom),kt=gi(rt.posMatrix,L,N,g.transform,yt),Mt=S.layout.get("icon-text-fit")!=="none"&&ot.hasIconData();if($){var Nt=Math.pow(2,R.zoom-ct.tileID.overscaledZ);Il(ot,N,L,B,l.symbolSize,R,kt,rt.posMatrix,Nt,$,Mt)}}}}(s,i,n,a,n.layout.get("text-rotation-alignment"),n.layout.get("text-pitch-alignment"),p),n.paint.get("icon-opacity").constantOr(1)!==0&&Ho(i,a,n,s,!1,n.paint.get("icon-translate"),n.paint.get("icon-translate-anchor"),n.layout.get("icon-rotation-alignment"),n.layout.get("icon-pitch-alignment"),n.layout.get("icon-keep-upright"),f,d),n.paint.get("text-opacity").constantOr(1)!==0&&Ho(i,a,n,s,!0,n.paint.get("text-translate"),n.paint.get("text-translate-anchor"),n.layout.get("text-rotation-alignment"),n.layout.get("text-pitch-alignment"),n.layout.get("text-keep-upright"),f,d),a.map.showCollisionBoxes&&(el(i,a,n,s,n.paint.get("text-translate"),n.paint.get("text-translate-anchor"),!0),el(i,a,n,s,n.paint.get("icon-translate"),n.paint.get("icon-translate-anchor"),!1))}},circle:function(i,a,n,s){if(i.renderPass==="translucent"){var p=n.paint.get("circle-opacity"),f=n.paint.get("circle-stroke-width"),d=n.paint.get("circle-stroke-opacity"),y=!n.layout.get("circle-sort-key").isConstant();if(p.constantOr(1)!==0||f.constantOr(1)!==0&&d.constantOr(1)!==0){for(var g=i.context,S=g.gl,I=i.depthModeForSublayer(0,k.ReadOnly),P=U.disabled,A=i.colorModeForRenderPass(),B=[],R=0;R<s.length;R++){var N=s[R],L=a.getTile(N),q=L.getBucket(n);if(q){var X=q.programConfigurations.get(n.id),rt={programConfiguration:X,program:i.useProgram("circle",X),layoutVertexBuffer:q.layoutVertexBuffer,indexBuffer:q.indexBuffer,uniformValues:Va(i,N,L,n)};if(y)for(var ct=0,ot=q.segments.get();ct<ot.length;ct+=1){var $=ot[ct];B.push({segments:new l.SegmentVector([$]),sortKey:$.sortKey,state:rt})}else B.push({segments:q.segments,sortKey:0,state:rt})}}y&&B.sort(function(ye,le){return ye.sortKey-le.sortKey});for(var yt=0,kt=B;yt<kt.length;yt+=1){var Mt=kt[yt],Nt=Mt.state;Nt.program.draw(g,S.TRIANGLES,I,P,A,tt.disabled,Nt.uniformValues,n.id,Nt.layoutVertexBuffer,Nt.indexBuffer,Mt.segments,n.paint,i.transform.zoom,Nt.programConfiguration)}}}},heatmap:function(i,a,n,s){if(n.paint.get("heatmap-opacity")!==0)if(i.renderPass==="offscreen"){var p=i.context,f=p.gl,d=U.disabled,y=new K([f.ONE,f.ONE],l.Color.transparent,[!0,!0,!0,!0]);(function(B,R,N){var L=B.gl;B.activeTexture.set(L.TEXTURE1),B.viewport.set([0,0,R.width/4,R.height/4]);var q=N.heatmapFbo;if(q)L.bindTexture(L.TEXTURE_2D,q.colorAttachment.get()),B.bindFramebuffer.set(q.framebuffer);else{var X=L.createTexture();L.bindTexture(L.TEXTURE_2D,X),L.texParameteri(L.TEXTURE_2D,L.TEXTURE_WRAP_S,L.CLAMP_TO_EDGE),L.texParameteri(L.TEXTURE_2D,L.TEXTURE_WRAP_T,L.CLAMP_TO_EDGE),L.texParameteri(L.TEXTURE_2D,L.TEXTURE_MIN_FILTER,L.LINEAR),L.texParameteri(L.TEXTURE_2D,L.TEXTURE_MAG_FILTER,L.LINEAR),q=N.heatmapFbo=B.createFramebuffer(R.width/4,R.height/4,!1),function(rt,ct,ot,$){var yt=rt.gl;yt.texImage2D(yt.TEXTURE_2D,0,yt.RGBA,ct.width/4,ct.height/4,0,yt.RGBA,rt.extRenderToTextureHalfFloat?rt.extTextureHalfFloat.HALF_FLOAT_OES:yt.UNSIGNED_BYTE,null),$.colorAttachment.set(ot)}(B,R,X,q)}})(p,i,n),p.clear({color:l.Color.transparent});for(var g=0;g<s.length;g++){var S=s[g];if(!a.hasRenderableParent(S)){var I=a.getTile(S),P=I.getBucket(n);if(P){var A=P.programConfigurations.get(n.id);i.useProgram("heatmap",A).draw(p,f.TRIANGLES,k.disabled,d,y,tt.disabled,To(S.posMatrix,I,i.transform.zoom,n.paint.get("heatmap-intensity")),n.id,P.layoutVertexBuffer,P.indexBuffer,P.segments,n.paint,i.transform.zoom,A)}}}p.viewport.set([0,0,i.width,i.height])}else i.renderPass==="translucent"&&(i.context.setColorMode(i.colorModeForRenderPass()),function(B,R){var N=B.context,L=N.gl,q=R.heatmapFbo;if(q){N.activeTexture.set(L.TEXTURE0),L.bindTexture(L.TEXTURE_2D,q.colorAttachment.get()),N.activeTexture.set(L.TEXTURE1);var X=R.colorRampTexture;X||(X=R.colorRampTexture=new l.Texture(N,R.colorRamp,L.RGBA)),X.bind(L.LINEAR,L.CLAMP_TO_EDGE),B.useProgram("heatmapTexture").draw(N,L.TRIANGLES,k.disabled,U.disabled,B.colorModeForRenderPass(),tt.disabled,function(rt,ct,ot,$){var yt=l.create();l.ortho(yt,0,rt.width,rt.height,0,0,1);var kt=rt.context.gl;return{u_matrix:yt,u_world:[kt.drawingBufferWidth,kt.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:ct.paint.get("heatmap-opacity")}}(B,R),R.id,B.viewportBuffer,B.quadTriangleIndexBuffer,B.viewportSegments,R.paint,B.transform.zoom)}}(i,n))},line:function(i,a,n,s){if(i.renderPass==="translucent"){var p=n.paint.get("line-opacity"),f=n.paint.get("line-width");if(p.constantOr(1)!==0&&f.constantOr(1)!==0)for(var d=i.depthModeForSublayer(0,k.ReadOnly),y=i.colorModeForRenderPass(),g=n.paint.get("line-dasharray"),S=n.paint.get("line-pattern"),I=S.constantOr(1),P=n.paint.get("line-gradient"),A=n.getCrossfadeParameters(),B=I?"linePattern":g?"lineSDF":P?"lineGradient":"line",R=i.context,N=R.gl,L=!0,q=0,X=s;q<X.length;q+=1){var rt=X[q],ct=a.getTile(rt);if(!I||ct.patternsLoaded()){var ot=ct.getBucket(n);if(ot){var $=ot.programConfigurations.get(n.id),yt=i.context.program.get(),kt=i.useProgram(B,$),Mt=L||kt.program!==yt,Nt=S.constantOr(null);if(Nt&&ct.imageAtlas){var ye=ct.imageAtlas,le=ye.patternPositions[Nt.to.toString()],pe=ye.patternPositions[Nt.from.toString()];le&&pe&&$.setConstantPatternPositions(le,pe)}var Ge=I?Wr(i,ct,n,A):g?ks(i,ct,n,g,A):P?$s(i,ct,n,ot.lineClipsArray.length):Ps(i,ct,n);if(I)R.activeTexture.set(N.TEXTURE0),ct.imageAtlasTexture.bind(N.LINEAR,N.CLAMP_TO_EDGE),$.updatePaintBuffers(A);else if(g&&(Mt||i.lineAtlas.dirty))R.activeTexture.set(N.TEXTURE0),i.lineAtlas.bind(R);else if(P){var jt=ot.gradients[n.id],Re=jt.texture;if(n.gradientVersion!==jt.version){var Pe=256;if(n.stepInterpolant){var _e=a.getSource().maxzoom,Ie=rt.canonical.z===_e?Math.ceil(1<<i.transform.maxZoom-rt.canonical.z):1;Pe=l.clamp(l.nextPowerOfTwo(ot.maxLineLength/l.EXTENT*1024*Ie),256,R.maxTextureSize)}jt.gradient=l.renderColorRamp({expression:n.gradientExpression(),evaluationKey:"lineProgress",resolution:Pe,image:jt.gradient||void 0,clips:ot.lineClipsArray}),jt.texture?jt.texture.update(jt.gradient):jt.texture=new l.Texture(R,jt.gradient,N.RGBA),jt.version=n.gradientVersion,Re=jt.texture}R.activeTexture.set(N.TEXTURE0),Re.bind(n.stepInterpolant?N.NEAREST:N.LINEAR,N.CLAMP_TO_EDGE)}kt.draw(R,N.TRIANGLES,d,i.stencilModeForClipping(rt),y,tt.disabled,Ge,n.id,ot.layoutVertexBuffer,ot.indexBuffer,ot.segments,n.paint,i.transform.zoom,$,ot.layoutVertexBuffer2),L=!1}}}}},fill:function(i,a,n,s){var p=n.paint.get("fill-color"),f=n.paint.get("fill-opacity");if(f.constantOr(1)!==0){var d=i.colorModeForRenderPass(),y=n.paint.get("fill-pattern"),g=i.opaquePassEnabledForLayer()&&!y.constantOr(1)&&p.constantOr(l.Color.transparent).a===1&&f.constantOr(0)===1?"opaque":"translucent";if(i.renderPass===g){var S=i.depthModeForSublayer(1,i.renderPass==="opaque"?k.ReadWrite:k.ReadOnly);Io(i,a,n,s,S,d,!1)}if(i.renderPass==="translucent"&&n.paint.get("fill-antialias")){var I=i.depthModeForSublayer(n.getPaintProperty("fill-outline-color")?2:0,k.ReadOnly);Io(i,a,n,s,I,d,!0)}}},"fill-extrusion":function(i,a,n,s){var p=n.paint.get("fill-extrusion-opacity");if(p!==0&&i.renderPass==="translucent"){var f=new k(i.context.gl.LEQUAL,k.ReadWrite,i.depthRangeFor3D);if(p!==1||n.paint.get("fill-extrusion-pattern").constantOr(1))Wo(i,a,n,s,f,U.disabled,K.disabled),Wo(i,a,n,s,f,i.stencilModeFor3D(),i.colorModeForRenderPass());else{var d=i.colorModeForRenderPass();Wo(i,a,n,s,f,U.disabled,d)}}},hillshade:function(i,a,n,s){if(i.renderPass==="offscreen"||i.renderPass==="translucent"){for(var p=i.context,f=i.depthModeForSublayer(0,k.ReadOnly),d=i.colorModeForRenderPass(),y=i.renderPass==="translucent"?i.stencilConfigForOverlap(s):[{},s],g=y[0],S=0,I=y[1];S<I.length;S+=1){var P=I[S],A=a.getTile(P);A.needsHillshadePrepare&&i.renderPass==="offscreen"?Ls(i,A,n,f,U.disabled,d):i.renderPass==="translucent"&&Hl(i,A,n,f,g[P.overscaledZ],d)}p.viewport.set([0,0,i.width,i.height])}},raster:function(i,a,n,s){if(i.renderPass==="translucent"&&n.paint.get("raster-opacity")!==0&&s.length)for(var p=i.context,f=p.gl,d=a.getSource(),y=i.useProgram("raster"),g=i.colorModeForRenderPass(),S=d instanceof ar?[{},s]:i.stencilConfigForOverlap(s),I=S[0],P=S[1],A=P[P.length-1].overscaledZ,B=!i.options.moving,R=0,N=P;R<N.length;R+=1){var L=N[R],q=i.depthModeForSublayer(L.overscaledZ-A,n.paint.get("raster-opacity")===1?k.ReadWrite:k.ReadOnly,f.LESS),X=a.getTile(L),rt=i.transform.calculatePosMatrix(L.toUnwrapped(),B);X.registerFadeDuration(n.paint.get("raster-fade-duration"));var ct=a.findLoadedParent(L,0),ot=Wl(X,ct,a,n,i.transform),$=void 0,yt=void 0,kt=n.paint.get("raster-resampling")==="nearest"?f.NEAREST:f.LINEAR;p.activeTexture.set(f.TEXTURE0),X.texture.bind(kt,f.CLAMP_TO_EDGE,f.LINEAR_MIPMAP_NEAREST),p.activeTexture.set(f.TEXTURE1),ct?(ct.texture.bind(kt,f.CLAMP_TO_EDGE,f.LINEAR_MIPMAP_NEAREST),$=Math.pow(2,ct.tileID.overscaledZ-X.tileID.overscaledZ),yt=[X.tileID.canonical.x*$%1,X.tileID.canonical.y*$%1]):X.texture.bind(kt,f.CLAMP_TO_EDGE,f.LINEAR_MIPMAP_NEAREST);var Mt=Gl(rt,yt||[0,0],$||1,ot,n);d instanceof ar?y.draw(p,f.TRIANGLES,q,U.disabled,g,tt.disabled,Mt,n.id,d.boundsBuffer,i.quadTriangleIndexBuffer,d.boundsSegments):y.draw(p,f.TRIANGLES,q,I[L.overscaledZ],g,tt.disabled,Mt,n.id,i.rasterBoundsBuffer,i.quadTriangleIndexBuffer,i.rasterBoundsSegments)}},background:function(i,a,n){var s=n.paint.get("background-color"),p=n.paint.get("background-opacity");if(p!==0){var f=i.context,d=f.gl,y=i.transform,g=y.tileSize,S=n.paint.get("background-pattern");if(!i.isPatternMissing(S)){var I=!S&&s.a===1&&p===1&&i.opaquePassEnabledForLayer()?"opaque":"translucent";if(i.renderPass===I){var P=U.disabled,A=i.depthModeForSublayer(0,I==="opaque"?k.ReadWrite:k.ReadOnly),B=i.colorModeForRenderPass(),R=i.useProgram(S?"backgroundPattern":"background"),N=y.coveringTiles({tileSize:g});S&&(f.activeTexture.set(d.TEXTURE0),i.imageManager.bind(i.context));for(var L=n.getCrossfadeParameters(),q=0,X=N;q<X.length;q+=1){var rt=X[q],ct=i.transform.calculatePosMatrix(rt.toUnwrapped()),ot=S?ss(ct,p,i,S,{tileID:rt,tileSize:g},L):Ds(ct,p,s);R.draw(f,d.TRIANGLES,A,P,B,tt.disabled,ot,n.id,i.tileExtentBuffer,i.quadTriangleIndexBuffer,i.tileExtentSegments)}}}}},debug:function(i,a,n){for(var s=0;s<n.length;s++)il(i,a,n[s])},custom:function(i,a,n){var s=i.context,p=n.implementation;if(i.renderPass==="offscreen"){var f=p.prerender;f&&(i.setCustomLayerDefaults(),s.setColorMode(i.colorModeForRenderPass()),f.call(p,s.gl,i.transform.customLayerMatrix()),s.setDirty(),i.setBaseState())}else if(i.renderPass==="translucent"){i.setCustomLayerDefaults(),s.setColorMode(i.colorModeForRenderPass()),s.setStencilMode(U.disabled);var d=p.renderingMode==="3d"?new k(i.context.gl.LEQUAL,k.ReadWrite,i.depthRangeFor3D):i.depthModeForSublayer(0,k.ReadOnly);s.setDepthMode(d),p.render(s.gl,i.transform.customLayerMatrix()),s.setDirty(),i.setBaseState(),s.bindFramebuffer.set(null)}}},Dr=function(i,a){this.context=new W(i),this.transform=a,this._tileTextures={},this.setup(),this.numSublayers=M.maxUnderzooming+M.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new oo,this.gpuTimers={}};Dr.prototype.resize=function(i,a){if(this.width=i*l.browser.devicePixelRatio,this.height=a*l.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var n=0,s=this.style._order;n<s.length;n+=1)this.style._layers[s[n]].resize()},Dr.prototype.setup=function(){var i=this.context,a=new l.StructArrayLayout2i4;a.emplaceBack(0,0),a.emplaceBack(l.EXTENT,0),a.emplaceBack(0,l.EXTENT),a.emplaceBack(l.EXTENT,l.EXTENT),this.tileExtentBuffer=i.createVertexBuffer(a,Sa.members),this.tileExtentSegments=l.SegmentVector.simpleSegment(0,0,4,2);var n=new l.StructArrayLayout2i4;n.emplaceBack(0,0),n.emplaceBack(l.EXTENT,0),n.emplaceBack(0,l.EXTENT),n.emplaceBack(l.EXTENT,l.EXTENT),this.debugBuffer=i.createVertexBuffer(n,Sa.members),this.debugSegments=l.SegmentVector.simpleSegment(0,0,4,5);var s=new l.StructArrayLayout4i8;s.emplaceBack(0,0,0,0),s.emplaceBack(l.EXTENT,0,l.EXTENT,0),s.emplaceBack(0,l.EXTENT,0,l.EXTENT),s.emplaceBack(l.EXTENT,l.EXTENT,l.EXTENT,l.EXTENT),this.rasterBoundsBuffer=i.createVertexBuffer(s,$t.members),this.rasterBoundsSegments=l.SegmentVector.simpleSegment(0,0,4,2);var p=new l.StructArrayLayout2i4;p.emplaceBack(0,0),p.emplaceBack(1,0),p.emplaceBack(0,1),p.emplaceBack(1,1),this.viewportBuffer=i.createVertexBuffer(p,Sa.members),this.viewportSegments=l.SegmentVector.simpleSegment(0,0,4,2);var f=new l.StructArrayLayout1ui2;f.emplaceBack(0),f.emplaceBack(1),f.emplaceBack(3),f.emplaceBack(2),f.emplaceBack(0),this.tileBorderIndexBuffer=i.createIndexBuffer(f);var d=new l.StructArrayLayout3ui6;d.emplaceBack(0,1,2),d.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=i.createIndexBuffer(d),this.emptyTexture=new l.Texture(i,{width:1,height:1,data:new Uint8Array([0,0,0,0])},i.gl.RGBA);var y=this.context.gl;this.stencilClearMode=new U({func:y.ALWAYS,mask:0},0,255,y.ZERO,y.ZERO,y.ZERO)},Dr.prototype.clearStencil=function(){var i=this.context,a=i.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var n=l.create();l.ortho(n,0,this.width,this.height,0,0,1),l.scale(n,n,[a.drawingBufferWidth,a.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(i,a.TRIANGLES,k.disabled,this.stencilClearMode,K.disabled,tt.disabled,So(n),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},Dr.prototype._renderTileClippingMasks=function(i,a){if(this.currentStencilSource!==i.source&&i.isTileClipped()&&a&&a.length){this.currentStencilSource=i.source;var n=this.context,s=n.gl;this.nextStencilID+a.length>256&&this.clearStencil(),n.setColorMode(K.disabled),n.setDepthMode(k.disabled);var p=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var f=0,d=a;f<d.length;f+=1){var y=d[f],g=this._tileClippingMaskIDs[y.key]=this.nextStencilID++;p.draw(n,s.TRIANGLES,k.disabled,new U({func:s.ALWAYS,mask:0},g,255,s.KEEP,s.KEEP,s.REPLACE),K.disabled,tt.disabled,So(y.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},Dr.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var i=this.nextStencilID++,a=this.context.gl;return new U({func:a.NOTEQUAL,mask:255},i,255,a.KEEP,a.KEEP,a.REPLACE)},Dr.prototype.stencilModeForClipping=function(i){var a=this.context.gl;return new U({func:a.EQUAL,mask:255},this._tileClippingMaskIDs[i.key],0,a.KEEP,a.KEEP,a.REPLACE)},Dr.prototype.stencilConfigForOverlap=function(i){var a,n=this.context.gl,s=i.sort(function(g,S){return S.overscaledZ-g.overscaledZ}),p=s[s.length-1].overscaledZ,f=s[0].overscaledZ-p+1;if(f>1){this.currentStencilSource=void 0,this.nextStencilID+f>256&&this.clearStencil();for(var d={},y=0;y<f;y++)d[y+p]=new U({func:n.GEQUAL,mask:255},y+this.nextStencilID,255,n.KEEP,n.KEEP,n.REPLACE);return this.nextStencilID+=f,[d,s]}return[(a={},a[p]=U.disabled,a),s]},Dr.prototype.colorModeForRenderPass=function(){var i=this.context.gl;return this._showOverdrawInspector?new K([i.CONSTANT_COLOR,i.ONE],new l.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?K.unblended:K.alphaBlended},Dr.prototype.depthModeForSublayer=function(i,a,n){if(!this.opaquePassEnabledForLayer())return k.disabled;var s=1-((1+this.currentLayer)*this.numSublayers+i)*this.depthEpsilon;return new k(n||this.context.gl.LEQUAL,a,[s,s])},Dr.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},Dr.prototype.render=function(i,a){var n=this;this.style=i,this.options=a,this.lineAtlas=i.lineAtlas,this.imageManager=i.imageManager,this.glyphManager=i.glyphManager,this.symbolFadeChange=i.placement.symbolFadeChange(l.browser.now()),this.imageManager.beginFrame();var s=this.style._order,p=this.style.sourceCaches;for(var f in p){var d=p[f];d.used&&d.prepare(this.context)}var y,g,S={},I={},P={};for(var A in p){var B=p[A];S[A]=B.getVisibleCoordinates(),I[A]=S[A].slice().reverse(),P[A]=B.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var R=0;R<s.length;R++)if(this.style._layers[s[R]].is3D()){this.opaquePassCutoff=R;break}this.renderPass="offscreen";for(var N=0,L=s;N<L.length;N+=1){var q=this.style._layers[L[N]];if(q.hasOffscreenPass()&&!q.isHidden(this.transform.zoom)){var X=I[q.source];(q.type==="custom"||X.length)&&this.renderLayer(this,p[q.source],q,X)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:a.showOverdrawInspector?l.Color.black:l.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=a.showOverdrawInspector,this.depthRangeFor3D=[0,1-(i._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=s.length-1;this.currentLayer>=0;this.currentLayer--){var rt=this.style._layers[s[this.currentLayer]],ct=p[rt.source],ot=S[rt.source];this._renderTileClippingMasks(rt,ot),this.renderLayer(this,ct,rt,ot)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<s.length;this.currentLayer++){var $=this.style._layers[s[this.currentLayer]],yt=p[$.source],kt=($.type==="symbol"?P:I)[$.source];this._renderTileClippingMasks($,S[$.source]),this.renderLayer(this,yt,$,kt)}this.options.showTileBoundaries&&(l.values(this.style._layers).forEach(function(Mt){Mt.source&&!Mt.isHidden(n.transform.zoom)&&(Mt.source!==(g&&g.id)&&(g=n.style.sourceCaches[Mt.source]),(!y||y.getSource().maxzoom<g.getSource().maxzoom)&&(y=g))}),y&&Os.debug(this,y,y.getVisibleCoordinates())),this.options.showPadding&&function(Mt){var Nt=Mt.transform.padding;cs(Mt,Mt.transform.height-(Nt.top||0),3,Na),cs(Mt,Nt.bottom||0,3,rl),Aa(Mt,Nt.left||0,3,Rs),Aa(Mt,Mt.transform.width-(Nt.right||0),3,Bs);var ye=Mt.transform.centerPoint;(function(le,pe,Ge,jt){ps(le,pe-1,Ge-10,2,20,jt),ps(le,pe-10,Ge-1,20,2,jt)})(Mt,ye.x,Mt.transform.height-ye.y,us)}(this),this.context.setDefault()},Dr.prototype.renderLayer=function(i,a,n,s){n.isHidden(this.transform.zoom)||(n.type==="background"||n.type==="custom"||s.length)&&(this.id=n.id,this.gpuTimingStart(n),Os[n.type](i,a,n,s,this.style.placement.variableOffsets),this.gpuTimingEnd())},Dr.prototype.gpuTimingStart=function(i){if(this.options.gpuTiming){var a=this.context.extTimerQuery,n=this.gpuTimers[i.id];n||(n=this.gpuTimers[i.id]={calls:0,cpuTime:0,query:a.createQueryEXT()}),n.calls++,a.beginQueryEXT(a.TIME_ELAPSED_EXT,n.query)}},Dr.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var i=this.context.extTimerQuery;i.endQueryEXT(i.TIME_ELAPSED_EXT)}},Dr.prototype.collectGpuTimers=function(){var i=this.gpuTimers;return this.gpuTimers={},i},Dr.prototype.queryGpuTimers=function(i){var a={};for(var n in i){var s=i[n],p=this.context.extTimerQuery,f=p.getQueryObjectEXT(s.query,p.QUERY_RESULT_EXT)/1e6;p.deleteQueryEXT(s.query),a[n]=f}return a},Dr.prototype.translatePosMatrix=function(i,a,n,s,p){if(!n[0]&&!n[1])return i;var f=p?s==="map"?this.transform.angle:0:s==="viewport"?-this.transform.angle:0;if(f){var d=Math.sin(f),y=Math.cos(f);n=[n[0]*y-n[1]*d,n[0]*d+n[1]*y]}var g=[p?n[0]:wn(a,n[0],this.transform.zoom),p?n[1]:wn(a,n[1],this.transform.zoom),0],S=new Float32Array(16);return l.translate(S,i,g),S},Dr.prototype.saveTileTexture=function(i){var a=this._tileTextures[i.size[0]];a?a.push(i):this._tileTextures[i.size[0]]=[i]},Dr.prototype.getTileTexture=function(i){var a=this._tileTextures[i];return a&&a.length>0?a.pop():null},Dr.prototype.isPatternMissing=function(i){if(!i)return!1;if(!i.from||!i.to)return!0;var a=this.imageManager.getPattern(i.from.toString()),n=this.imageManager.getPattern(i.to.toString());return!a||!n},Dr.prototype.useProgram=function(i,a){this.cache=this.cache||{};var n=""+i+(a?a.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[n]||(this.cache[n]=new Cs(this.context,i,Fa[i],a,Go[i],this._showOverdrawInspector)),this.cache[n]},Dr.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},Dr.prototype.setBaseState=function(){var i=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(i.FUNC_ADD)},Dr.prototype.initDebugOverlayCanvas=function(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=l.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new l.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},Dr.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var Fs=function(i,a){this.points=i,this.planes=a};Fs.fromInvProjectionMatrix=function(i,a,n){var s=Math.pow(2,n),p=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(d){return l.transformMat4([],d,i)}).map(function(d){return l.scale$1([],d,1/d[3]/a*s)}),f=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(d){var y=l.sub([],p[d[0]],p[d[1]]),g=l.sub([],p[d[2]],p[d[1]]),S=l.normalize([],l.cross([],y,g)),I=-l.dot(S,p[d[1]]);return S.concat(I)});return new Fs(p,f)};var Ao=function(i,a){this.min=i,this.max=a,this.center=l.scale$2([],l.add([],this.min,this.max),.5)};Ao.prototype.quadrant=function(i){for(var a=[i%2==0,i<2],n=l.clone$2(this.min),s=l.clone$2(this.max),p=0;p<a.length;p++)n[p]=a[p]?this.min[p]:this.center[p],s[p]=a[p]?this.center[p]:this.max[p];return s[2]=this.max[2],new Ao(n,s)},Ao.prototype.distanceX=function(i){return Math.max(Math.min(this.max[0],i[0]),this.min[0])-i[0]},Ao.prototype.distanceY=function(i){return Math.max(Math.min(this.max[1],i[1]),this.min[1])-i[1]},Ao.prototype.intersects=function(i){for(var a=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],n=!0,s=0;s<i.planes.length;s++){for(var p=i.planes[s],f=0,d=0;d<a.length;d++)f+=l.dot$1(p,a[d])>=0;if(f===0)return 0;f!==a.length&&(n=!1)}if(n)return 2;for(var y=0;y<3;y++){for(var g=Number.MAX_VALUE,S=-Number.MAX_VALUE,I=0;I<i.points.length;I++){var P=i.points[I][y]-this.min[y];g=Math.min(g,P),S=Math.max(S,P)}if(S<0||g>this.max[y]-this.min[y])return 0}return 1};var Ya=function(i,a,n,s){if(i===void 0&&(i=0),a===void 0&&(a=0),n===void 0&&(n=0),s===void 0&&(s=0),isNaN(i)||i<0||isNaN(a)||a<0||isNaN(n)||n<0||isNaN(s)||s<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=i,this.bottom=a,this.left=n,this.right=s};Ya.prototype.interpolate=function(i,a,n){return a.top!=null&&i.top!=null&&(this.top=l.number(i.top,a.top,n)),a.bottom!=null&&i.bottom!=null&&(this.bottom=l.number(i.bottom,a.bottom,n)),a.left!=null&&i.left!=null&&(this.left=l.number(i.left,a.left,n)),a.right!=null&&i.right!=null&&(this.right=l.number(i.right,a.right,n)),this},Ya.prototype.getCenter=function(i,a){var n=l.clamp((this.left+i-this.right)/2,0,i),s=l.clamp((this.top+a-this.bottom)/2,0,a);return new l.Point(n,s)},Ya.prototype.equals=function(i){return this.top===i.top&&this.bottom===i.bottom&&this.left===i.left&&this.right===i.right},Ya.prototype.clone=function(){return new Ya(this.top,this.bottom,this.left,this.right)},Ya.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var Pr=function(i,a,n,s,p){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=p===void 0||p,this._minZoom=i||0,this._maxZoom=a||22,this._minPitch=n==null?0:n,this._maxPitch=s==null?60:s,this.setMaxBounds(),this.width=0,this.height=0,this._center=new l.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Ya,this._posMatrixCache={},this._alignedPosMatrixCache={}},Ye={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};Pr.prototype.clone=function(){var i=new Pr(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return i.tileSize=this.tileSize,i.latRange=this.latRange,i.width=this.width,i.height=this.height,i._center=this._center,i.zoom=this.zoom,i.angle=this.angle,i._fov=this._fov,i._pitch=this._pitch,i._unmodified=this._unmodified,i._edgeInsets=this._edgeInsets.clone(),i._calcMatrices(),i},Ye.minZoom.get=function(){return this._minZoom},Ye.minZoom.set=function(i){this._minZoom!==i&&(this._minZoom=i,this.zoom=Math.max(this.zoom,i))},Ye.maxZoom.get=function(){return this._maxZoom},Ye.maxZoom.set=function(i){this._maxZoom!==i&&(this._maxZoom=i,this.zoom=Math.min(this.zoom,i))},Ye.minPitch.get=function(){return this._minPitch},Ye.minPitch.set=function(i){this._minPitch!==i&&(this._minPitch=i,this.pitch=Math.max(this.pitch,i))},Ye.maxPitch.get=function(){return this._maxPitch},Ye.maxPitch.set=function(i){this._maxPitch!==i&&(this._maxPitch=i,this.pitch=Math.min(this.pitch,i))},Ye.renderWorldCopies.get=function(){return this._renderWorldCopies},Ye.renderWorldCopies.set=function(i){i===void 0?i=!0:i===null&&(i=!1),this._renderWorldCopies=i},Ye.worldSize.get=function(){return this.tileSize*this.scale},Ye.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},Ye.size.get=function(){return new l.Point(this.width,this.height)},Ye.bearing.get=function(){return-this.angle/Math.PI*180},Ye.bearing.set=function(i){var a=-l.wrap(i,-180,180)*Math.PI/180;this.angle!==a&&(this._unmodified=!1,this.angle=a,this._calcMatrices(),this.rotationMatrix=l.create$2(),l.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},Ye.pitch.get=function(){return this._pitch/Math.PI*180},Ye.pitch.set=function(i){var a=l.clamp(i,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==a&&(this._unmodified=!1,this._pitch=a,this._calcMatrices())},Ye.fov.get=function(){return this._fov/Math.PI*180},Ye.fov.set=function(i){i=Math.max(.01,Math.min(60,i)),this._fov!==i&&(this._unmodified=!1,this._fov=i/180*Math.PI,this._calcMatrices())},Ye.zoom.get=function(){return this._zoom},Ye.zoom.set=function(i){var a=Math.min(Math.max(i,this.minZoom),this.maxZoom);this._zoom!==a&&(this._unmodified=!1,this._zoom=a,this.scale=this.zoomScale(a),this.tileZoom=Math.floor(a),this.zoomFraction=a-this.tileZoom,this._constrain(),this._calcMatrices())},Ye.center.get=function(){return this._center},Ye.center.set=function(i){i.lat===this._center.lat&&i.lng===this._center.lng||(this._unmodified=!1,this._center=i,this._constrain(),this._calcMatrices())},Ye.padding.get=function(){return this._edgeInsets.toJSON()},Ye.padding.set=function(i){this._edgeInsets.equals(i)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,i,1),this._calcMatrices())},Ye.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},Pr.prototype.isPaddingEqual=function(i){return this._edgeInsets.equals(i)},Pr.prototype.interpolatePadding=function(i,a,n){this._unmodified=!1,this._edgeInsets.interpolate(i,a,n),this._constrain(),this._calcMatrices()},Pr.prototype.coveringZoomLevel=function(i){var a=(i.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/i.tileSize));return Math.max(0,a)},Pr.prototype.getVisibleUnwrappedCoordinates=function(i){var a=[new l.UnwrappedTileID(0,i)];if(this._renderWorldCopies)for(var n=this.pointCoordinate(new l.Point(0,0)),s=this.pointCoordinate(new l.Point(this.width,0)),p=this.pointCoordinate(new l.Point(this.width,this.height)),f=this.pointCoordinate(new l.Point(0,this.height)),d=Math.floor(Math.min(n.x,s.x,p.x,f.x)),y=Math.floor(Math.max(n.x,s.x,p.x,f.x)),g=d-1;g<=y+1;g++)g!==0&&a.push(new l.UnwrappedTileID(g,i));return a},Pr.prototype.coveringTiles=function(i){var a=this.coveringZoomLevel(i),n=a;if(i.minzoom!==void 0&&a<i.minzoom)return[];i.maxzoom!==void 0&&a>i.maxzoom&&(a=i.maxzoom);var s=l.MercatorCoordinate.fromLngLat(this.center),p=Math.pow(2,a),f=[p*s.x,p*s.y,0],d=Fs.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,a),y=i.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(y=a);var g=function(Mt){return{aabb:new Ao([Mt*p,0,0],[(Mt+1)*p,p,0]),zoom:0,x:0,y:0,wrap:Mt,fullyVisible:!1}},S=[],I=[],P=a,A=i.reparseOverscaled?n:a;if(this._renderWorldCopies)for(var B=1;B<=3;B++)S.push(g(-B)),S.push(g(B));for(S.push(g(0));S.length>0;){var R=S.pop(),N=R.x,L=R.y,q=R.fullyVisible;if(!q){var X=R.aabb.intersects(d);if(X===0)continue;q=X===2}var rt=R.aabb.distanceX(f),ct=R.aabb.distanceY(f),ot=Math.max(Math.abs(rt),Math.abs(ct));if(R.zoom===P||ot>3+(1<<P-R.zoom)-2&&R.zoom>=y)I.push({tileID:new l.OverscaledTileID(R.zoom===P?A:R.zoom,R.wrap,R.zoom,N,L),distanceSq:l.sqrLen([f[0]-.5-N,f[1]-.5-L])});else for(var $=0;$<4;$++){var yt=(N<<1)+$%2,kt=(L<<1)+($>>1);S.push({aabb:R.aabb.quadrant($),zoom:R.zoom+1,x:yt,y:kt,wrap:R.wrap,fullyVisible:q})}}return I.sort(function(Mt,Nt){return Mt.distanceSq-Nt.distanceSq}).map(function(Mt){return Mt.tileID})},Pr.prototype.resize=function(i,a){this.width=i,this.height=a,this.pixelsToGLUnits=[2/i,-2/a],this._constrain(),this._calcMatrices()},Ye.unmodified.get=function(){return this._unmodified},Pr.prototype.zoomScale=function(i){return Math.pow(2,i)},Pr.prototype.scaleZoom=function(i){return Math.log(i)/Math.LN2},Pr.prototype.project=function(i){var a=l.clamp(i.lat,-this.maxValidLatitude,this.maxValidLatitude);return new l.Point(l.mercatorXfromLng(i.lng)*this.worldSize,l.mercatorYfromLat(a)*this.worldSize)},Pr.prototype.unproject=function(i){return new l.MercatorCoordinate(i.x/this.worldSize,i.y/this.worldSize).toLngLat()},Ye.point.get=function(){return this.project(this.center)},Pr.prototype.setLocationAtPoint=function(i,a){var n=this.pointCoordinate(a),s=this.pointCoordinate(this.centerPoint),p=this.locationCoordinate(i),f=new l.MercatorCoordinate(p.x-(n.x-s.x),p.y-(n.y-s.y));this.center=this.coordinateLocation(f),this._renderWorldCopies&&(this.center=this.center.wrap())},Pr.prototype.locationPoint=function(i){return this.coordinatePoint(this.locationCoordinate(i))},Pr.prototype.pointLocation=function(i){return this.coordinateLocation(this.pointCoordinate(i))},Pr.prototype.locationCoordinate=function(i){return l.MercatorCoordinate.fromLngLat(i)},Pr.prototype.coordinateLocation=function(i){return i.toLngLat()},Pr.prototype.pointCoordinate=function(i){var a=[i.x,i.y,0,1],n=[i.x,i.y,1,1];l.transformMat4(a,a,this.pixelMatrixInverse),l.transformMat4(n,n,this.pixelMatrixInverse);var s=a[3],p=n[3],f=a[1]/s,d=n[1]/p,y=a[2]/s,g=n[2]/p,S=y===g?0:(0-y)/(g-y);return new l.MercatorCoordinate(l.number(a[0]/s,n[0]/p,S)/this.worldSize,l.number(f,d,S)/this.worldSize)},Pr.prototype.coordinatePoint=function(i){var a=[i.x*this.worldSize,i.y*this.worldSize,0,1];return l.transformMat4(a,a,this.pixelMatrix),new l.Point(a[0]/a[3],a[1]/a[3])},Pr.prototype.getBounds=function(){return new l.LngLatBounds().extend(this.pointLocation(new l.Point(0,0))).extend(this.pointLocation(new l.Point(this.width,0))).extend(this.pointLocation(new l.Point(this.width,this.height))).extend(this.pointLocation(new l.Point(0,this.height)))},Pr.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new l.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},Pr.prototype.setMaxBounds=function(i){i?(this.lngRange=[i.getWest(),i.getEast()],this.latRange=[i.getSouth(),i.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},Pr.prototype.calculatePosMatrix=function(i,a){a===void 0&&(a=!1);var n=i.key,s=a?this._alignedPosMatrixCache:this._posMatrixCache;if(s[n])return s[n];var p=i.canonical,f=this.worldSize/this.zoomScale(p.z),d=p.x+Math.pow(2,p.z)*i.wrap,y=l.identity(new Float64Array(16));return l.translate(y,y,[d*f,p.y*f,0]),l.scale(y,y,[f/l.EXTENT,f/l.EXTENT,1]),l.multiply(y,a?this.alignedProjMatrix:this.projMatrix,y),s[n]=new Float32Array(y),s[n]},Pr.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},Pr.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var i,a,n,s,p=-90,f=90,d=-180,y=180,g=this.size,S=this._unmodified;if(this.latRange){var I=this.latRange;p=l.mercatorYfromLat(I[1])*this.worldSize,i=(f=l.mercatorYfromLat(I[0])*this.worldSize)-p<g.y?g.y/(f-p):0}if(this.lngRange){var P=this.lngRange;d=l.mercatorXfromLng(P[0])*this.worldSize,a=(y=l.mercatorXfromLng(P[1])*this.worldSize)-d<g.x?g.x/(y-d):0}var A=this.point,B=Math.max(a||0,i||0);if(B)return this.center=this.unproject(new l.Point(a?(y+d)/2:A.x,i?(f+p)/2:A.y)),this.zoom+=this.scaleZoom(B),this._unmodified=S,void(this._constraining=!1);if(this.latRange){var R=A.y,N=g.y/2;R-N<p&&(s=p+N),R+N>f&&(s=f-N)}if(this.lngRange){var L=A.x,q=g.x/2;L-q<d&&(n=d+q),L+q>y&&(n=y-q)}n===void 0&&s===void 0||(this.center=this.unproject(new l.Point(n!==void 0?n:A.x,s!==void 0?s:A.y))),this._unmodified=S,this._constraining=!1}},Pr.prototype._calcMatrices=function(){if(this.height){var i=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var a=Math.PI/2+this._pitch,n=this._fov*(.5+i.y/this.height),s=Math.sin(n)*this.cameraToCenterDistance/Math.sin(l.clamp(Math.PI-a-n,.01,Math.PI-.01)),p=this.point,f=p.x,d=p.y,y=1.01*(Math.cos(Math.PI/2-this._pitch)*s+this.cameraToCenterDistance),g=this.height/50,S=new Float64Array(16);l.perspective(S,this._fov,this.width/this.height,g,y),S[8]=2*-i.x/this.width,S[9]=2*i.y/this.height,l.scale(S,S,[1,-1,1]),l.translate(S,S,[0,0,-this.cameraToCenterDistance]),l.rotateX(S,S,this._pitch),l.rotateZ(S,S,this.angle),l.translate(S,S,[-f,-d,0]),this.mercatorMatrix=l.scale([],S,[this.worldSize,this.worldSize,this.worldSize]),l.scale(S,S,[1,1,l.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=S,this.invProjMatrix=l.invert([],this.projMatrix);var I=this.width%2/2,P=this.height%2/2,A=Math.cos(this.angle),B=Math.sin(this.angle),R=f-Math.round(f)+A*I+B*P,N=d-Math.round(d)+A*P+B*I,L=new Float64Array(S);if(l.translate(L,L,[R>.5?R-1:R,N>.5?N-1:N,0]),this.alignedProjMatrix=L,S=l.create(),l.scale(S,S,[this.width/2,-this.height/2,1]),l.translate(S,S,[1,-1,0]),this.labelPlaneMatrix=S,S=l.create(),l.scale(S,S,[1,-1,1]),l.translate(S,S,[-1,-1,0]),l.scale(S,S,[2/this.width,2/this.height,1]),this.glCoordMatrix=S,this.pixelMatrix=l.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(S=l.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=S,this._posMatrixCache={},this._alignedPosMatrixCache={}}},Pr.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var i=this.pointCoordinate(new l.Point(0,0)),a=[i.x*this.worldSize,i.y*this.worldSize,0,1];return l.transformMat4(a,a,this.pixelMatrix)[3]/this.cameraToCenterDistance},Pr.prototype.getCameraPoint=function(){var i=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new l.Point(0,i))},Pr.prototype.getCameraQueryGeometry=function(i){var a=this.getCameraPoint();if(i.length===1)return[i[0],a];for(var n=a.x,s=a.y,p=a.x,f=a.y,d=0,y=i;d<y.length;d+=1){var g=y[d];n=Math.min(n,g.x),s=Math.min(s,g.y),p=Math.max(p,g.x),f=Math.max(f,g.y)}return[new l.Point(n,s),new l.Point(p,s),new l.Point(p,f),new l.Point(n,f),new l.Point(n,s)]},Object.defineProperties(Pr.prototype,Ye);var fn=function(i){var a,n,s,p;this._hashName=i&&encodeURIComponent(i),l.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(a=this._updateHashUnthrottled.bind(this),n=!1,s=null,p=function(){s=null,n&&(a(),s=setTimeout(p,300),n=!1)},function(){return n=!0,s||p(),s})};fn.prototype.addTo=function(i){return this._map=i,l.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},fn.prototype.remove=function(){return l.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},fn.prototype.getHashString=function(i){var a=this._map.getCenter(),n=Math.round(100*this._map.getZoom())/100,s=Math.ceil((n*Math.LN2+Math.log(512/360/.5))/Math.LN10),p=Math.pow(10,s),f=Math.round(a.lng*p)/p,d=Math.round(a.lat*p)/p,y=this._map.getBearing(),g=this._map.getPitch(),S="";if(S+=i?"/"+f+"/"+d+"/"+n:n+"/"+d+"/"+f,(y||g)&&(S+="/"+Math.round(10*y)/10),g&&(S+="/"+Math.round(g)),this._hashName){var I=this._hashName,P=!1,A=l.window.location.hash.slice(1).split("&").map(function(B){var R=B.split("=")[0];return R===I?(P=!0,R+"="+S):B}).filter(function(B){return B});return P||A.push(I+"="+S),"#"+A.join("&")}return"#"+S},fn.prototype._getCurrentHash=function(){var i,a=this,n=l.window.location.hash.replace("#","");return this._hashName?(n.split("&").map(function(s){return s.split("=")}).forEach(function(s){s[0]===a._hashName&&(i=s)}),(i&&i[1]||"").split("/")):n.split("/")},fn.prototype._onHashChange=function(){var i=this._getCurrentHash();if(i.length>=3&&!i.some(function(n){return isNaN(n)})){var a=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(i[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+i[2],+i[1]],zoom:+i[0],bearing:a,pitch:+(i[4]||0)}),!0}return!1},fn.prototype._updateHashUnthrottled=function(){var i=l.window.location.href.replace(/(#.+)?$/,this.getHashString());try{l.window.history.replaceState(l.window.history.state,null,i)}catch{}};var Ln={linearity:.3,easing:l.bezier(0,0,.3,1)},nl=l.extend({deceleration:2500,maxSpeed:1400},Ln),da=l.extend({deceleration:20,maxSpeed:1400},Ln),Co=l.extend({deceleration:1e3,maxSpeed:360},Ln),al=l.extend({deceleration:1e3,maxSpeed:90},Ln),Xo=function(i){this._map=i,this.clear()};function hs(i,a){(!i.duration||i.duration<a.duration)&&(i.duration=a.duration,i.easing=a.easing)}function dn(i,a,n){var s=n.maxSpeed,p=n.linearity,f=n.deceleration,d=l.clamp(i*p/(a/1e3),-s,s),y=Math.abs(d)/(f*p);return{easing:n.easing,duration:1e3*y,amount:d*(y/2)}}Xo.prototype.clear=function(){this._inertiaBuffer=[]},Xo.prototype.record=function(i){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:l.browser.now(),settings:i})},Xo.prototype._drainInertiaBuffer=function(){for(var i=this._inertiaBuffer,a=l.browser.now();i.length>0&&a-i[0].time>160;)i.shift()},Xo.prototype._onMoveEnd=function(i){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var a={zoom:0,bearing:0,pitch:0,pan:new l.Point(0,0),pinchAround:void 0,around:void 0},n=0,s=this._inertiaBuffer;n<s.length;n+=1){var p=s[n].settings;a.zoom+=p.zoomDelta||0,a.bearing+=p.bearingDelta||0,a.pitch+=p.pitchDelta||0,p.panDelta&&a.pan._add(p.panDelta),p.around&&(a.around=p.around),p.pinchAround&&(a.pinchAround=p.pinchAround)}var f=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,d={};if(a.pan.mag()){var y=dn(a.pan.mag(),f,l.extend({},nl,i||{}));d.offset=a.pan.mult(y.amount/a.pan.mag()),d.center=this._map.transform.center,hs(d,y)}if(a.zoom){var g=dn(a.zoom,f,da);d.zoom=this._map.transform.zoom+g.amount,hs(d,g)}if(a.bearing){var S=dn(a.bearing,f,Co);d.bearing=this._map.transform.bearing+l.clamp(S.amount,-179,179),hs(d,S)}if(a.pitch){var I=dn(a.pitch,f,al);d.pitch=this._map.transform.pitch+I.amount,hs(d,I)}if(d.zoom||d.bearing){var P=a.pinchAround===void 0?a.around:a.pinchAround;d.around=P?this._map.unproject(P):this._map.getCenter()}return this.clear(),l.extend(d,{noMoveStart:!0})}};var pi=function(i){function a(s,p,f,d){d===void 0&&(d={});var y=G.mousePos(p.getCanvasContainer(),f),g=p.unproject(y);i.call(this,s,l.extend({point:y,lngLat:g,originalEvent:f},d)),this._defaultPrevented=!1,this.target=p}i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a;var n={defaultPrevented:{configurable:!0}};return a.prototype.preventDefault=function(){this._defaultPrevented=!0},n.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(a.prototype,n),a}(l.Event),Rn=function(i){function a(s,p,f){var d=s==="touchend"?f.changedTouches:f.touches,y=G.touchPos(p.getCanvasContainer(),d),g=y.map(function(P){return p.unproject(P)}),S=y.reduce(function(P,A,B,R){return P.add(A.div(R.length))},new l.Point(0,0)),I=p.unproject(S);i.call(this,s,{points:y,point:S,lngLats:g,lngLat:I,originalEvent:f}),this._defaultPrevented=!1}i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a;var n={defaultPrevented:{configurable:!0}};return a.prototype.preventDefault=function(){this._defaultPrevented=!0},n.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(a.prototype,n),a}(l.Event),Xl=function(i){function a(s,p,f){i.call(this,s,{originalEvent:f}),this._defaultPrevented=!1}i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a;var n={defaultPrevented:{configurable:!0}};return a.prototype.preventDefault=function(){this._defaultPrevented=!0},n.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(a.prototype,n),a}(l.Event),tn=function(i,a){this._map=i,this._clickTolerance=a.clickTolerance};tn.prototype.reset=function(){delete this._mousedownPos},tn.prototype.wheel=function(i){return this._firePreventable(new Xl(i.type,this._map,i))},tn.prototype.mousedown=function(i,a){return this._mousedownPos=a,this._firePreventable(new pi(i.type,this._map,i))},tn.prototype.mouseup=function(i){this._map.fire(new pi(i.type,this._map,i))},tn.prototype.click=function(i,a){this._mousedownPos&&this._mousedownPos.dist(a)>=this._clickTolerance||this._map.fire(new pi(i.type,this._map,i))},tn.prototype.dblclick=function(i){return this._firePreventable(new pi(i.type,this._map,i))},tn.prototype.mouseover=function(i){this._map.fire(new pi(i.type,this._map,i))},tn.prototype.mouseout=function(i){this._map.fire(new pi(i.type,this._map,i))},tn.prototype.touchstart=function(i){return this._firePreventable(new Rn(i.type,this._map,i))},tn.prototype.touchmove=function(i){this._map.fire(new Rn(i.type,this._map,i))},tn.prototype.touchend=function(i){this._map.fire(new Rn(i.type,this._map,i))},tn.prototype.touchcancel=function(i){this._map.fire(new Rn(i.type,this._map,i))},tn.prototype._firePreventable=function(i){if(this._map.fire(i),i.defaultPrevented)return{}},tn.prototype.isEnabled=function(){return!0},tn.prototype.isActive=function(){return!1},tn.prototype.enable=function(){},tn.prototype.disable=function(){};var Bn=function(i){this._map=i};Bn.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},Bn.prototype.mousemove=function(i){this._map.fire(new pi(i.type,this._map,i))},Bn.prototype.mousedown=function(){this._delayContextMenu=!0},Bn.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new pi("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},Bn.prototype.contextmenu=function(i){this._delayContextMenu?this._contextMenuEvent=i:this._map.fire(new pi(i.type,this._map,i)),this._map.listens("contextmenu")&&i.preventDefault()},Bn.prototype.isEnabled=function(){return!0},Bn.prototype.isActive=function(){return!1},Bn.prototype.enable=function(){},Bn.prototype.disable=function(){};var re=function(i,a){this._map=i,this._el=i.getCanvasContainer(),this._container=i.getContainer(),this._clickTolerance=a.clickTolerance||1};function fs(i,a){for(var n={},s=0;s<i.length;s++)n[i[s].identifier]=a[s];return n}re.prototype.isEnabled=function(){return!!this._enabled},re.prototype.isActive=function(){return!!this._active},re.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},re.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},re.prototype.mousedown=function(i,a){this.isEnabled()&&i.shiftKey&&i.button===0&&(G.disableDrag(),this._startPos=this._lastPos=a,this._active=!0)},re.prototype.mousemoveWindow=function(i,a){if(this._active){var n=a;if(!(this._lastPos.equals(n)||!this._box&&n.dist(this._startPos)<this._clickTolerance)){var s=this._startPos;this._lastPos=n,this._box||(this._box=G.create("div","maplibregl-boxzoom mapboxgl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair","mapboxgl-crosshair"),this._fireEvent("boxzoomstart",i));var p=Math.min(s.x,n.x),f=Math.max(s.x,n.x),d=Math.min(s.y,n.y),y=Math.max(s.y,n.y);G.setTransform(this._box,"translate("+p+"px,"+d+"px)"),this._box.style.width=f-p+"px",this._box.style.height=y-d+"px"}}},re.prototype.mouseupWindow=function(i,a){var n=this;if(this._active&&i.button===0){var s=this._startPos,p=a;if(this.reset(),G.suppressClick(),s.x!==p.x||s.y!==p.y)return this._map.fire(new l.Event("boxzoomend",{originalEvent:i})),{cameraAnimation:function(f){return f.fitScreenCoordinates(s,p,n._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",i)}},re.prototype.keydown=function(i){this._active&&i.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",i))},re.prototype.reset=function(){this._active=!1,this._container.classList.remove("maplibregl-crosshair","mapboxgl-crosshair"),this._box&&(G.remove(this._box),this._box=null),G.enableDrag(),delete this._startPos,delete this._lastPos},re.prototype._fireEvent=function(i,a){return this._map.fire(new l.Event(i,{originalEvent:a}))};var Ko=function(i){this.reset(),this.numTouches=i.numTouches};Ko.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},Ko.prototype.touchstart=function(i,a,n){(this.centroid||n.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=i.timeStamp),n.length===this.numTouches&&(this.centroid=function(s){for(var p=new l.Point(0,0),f=0,d=s;f<d.length;f+=1)p._add(d[f]);return p.div(s.length)}(a),this.touches=fs(n,a)))},Ko.prototype.touchmove=function(i,a,n){if(!this.aborted&&this.centroid){var s=fs(n,a);for(var p in this.touches){var f=s[p];(!f||f.dist(this.touches[p])>30)&&(this.aborted=!0)}}},Ko.prototype.touchend=function(i,a,n){if((!this.centroid||i.timeStamp-this.startTime>500)&&(this.aborted=!0),n.length===0){var s=!this.aborted&&this.centroid;if(this.reset(),s)return s}};var zo=function(i){this.singleTap=new Ko(i),this.numTaps=i.numTaps,this.reset()};zo.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},zo.prototype.touchstart=function(i,a,n){this.singleTap.touchstart(i,a,n)},zo.prototype.touchmove=function(i,a,n){this.singleTap.touchmove(i,a,n)},zo.prototype.touchend=function(i,a,n){var s=this.singleTap.touchend(i,a,n);if(s){var p=i.timeStamp-this.lastTime<500,f=!this.lastTap||this.lastTap.dist(s)<30;if(p&&f||this.reset(),this.count++,this.lastTime=i.timeStamp,this.lastTap=s,this.count===this.numTaps)return this.reset(),s}};var mn=function(){this._zoomIn=new zo({numTouches:1,numTaps:2}),this._zoomOut=new zo({numTouches:2,numTaps:1}),this.reset()};mn.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},mn.prototype.touchstart=function(i,a,n){this._zoomIn.touchstart(i,a,n),this._zoomOut.touchstart(i,a,n)},mn.prototype.touchmove=function(i,a,n){this._zoomIn.touchmove(i,a,n),this._zoomOut.touchmove(i,a,n)},mn.prototype.touchend=function(i,a,n){var s=this,p=this._zoomIn.touchend(i,a,n),f=this._zoomOut.touchend(i,a,n);return p?(this._active=!0,i.preventDefault(),setTimeout(function(){return s.reset()},0),{cameraAnimation:function(d){return d.easeTo({duration:300,zoom:d.getZoom()+1,around:d.unproject(p)},{originalEvent:i})}}):f?(this._active=!0,i.preventDefault(),setTimeout(function(){return s.reset()},0),{cameraAnimation:function(d){return d.easeTo({duration:300,zoom:d.getZoom()-1,around:d.unproject(f)},{originalEvent:i})}}):void 0},mn.prototype.touchcancel=function(){this.reset()},mn.prototype.enable=function(){this._enabled=!0},mn.prototype.disable=function(){this._enabled=!1,this.reset()},mn.prototype.isEnabled=function(){return this._enabled},mn.prototype.isActive=function(){return this._active};var Yo={0:1,2:2},En=function(i){this.reset(),this._clickTolerance=i.clickTolerance||1};En.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},En.prototype._correctButton=function(i,a){return!1},En.prototype._move=function(i,a){return{}},En.prototype.mousedown=function(i,a){if(!this._lastPoint){var n=G.mouseButton(i);this._correctButton(i,n)&&(this._lastPoint=a,this._eventButton=n)}},En.prototype.mousemoveWindow=function(i,a){var n=this._lastPoint;if(n){if(i.preventDefault(),function(s,p){var f=Yo[p];return s.buttons===void 0||(s.buttons&f)!==f}(i,this._eventButton))this.reset();else if(this._moved||!(a.dist(n)<this._clickTolerance))return this._moved=!0,this._lastPoint=a,this._move(n,a)}},En.prototype.mouseupWindow=function(i){this._lastPoint&&G.mouseButton(i)===this._eventButton&&(this._moved&&G.suppressClick(),this.reset())},En.prototype.enable=function(){this._enabled=!0},En.prototype.disable=function(){this._enabled=!1,this.reset()},En.prototype.isEnabled=function(){return this._enabled},En.prototype.isActive=function(){return this._active};var ie=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.mousedown=function(n,s){i.prototype.mousedown.call(this,n,s),this._lastPoint&&(this._active=!0)},a.prototype._correctButton=function(n,s){return s===0&&!n.ctrlKey},a.prototype._move=function(n,s){return{around:s,panDelta:s.sub(n)}},a}(En),Us=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype._correctButton=function(n,s){return s===0&&n.ctrlKey||s===2},a.prototype._move=function(n,s){var p=.8*(s.x-n.x);if(p)return this._active=!0,{bearingDelta:p}},a.prototype.contextmenu=function(n){n.preventDefault()},a}(En),ol=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype._correctButton=function(n,s){return s===0&&n.ctrlKey||s===2},a.prototype._move=function(n,s){var p=-.5*(s.y-n.y);if(p)return this._active=!0,{pitchDelta:p}},a.prototype.contextmenu=function(n){n.preventDefault()},a}(En),Ca=function(i){this._minTouches=1,this._clickTolerance=i.clickTolerance||1,this.reset()};Ca.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new l.Point(0,0)},Ca.prototype.touchstart=function(i,a,n){return this._calculateTransform(i,a,n)},Ca.prototype.touchmove=function(i,a,n){if(this._active&&!(n.length<this._minTouches))return i.preventDefault(),this._calculateTransform(i,a,n)},Ca.prototype.touchend=function(i,a,n){this._calculateTransform(i,a,n),this._active&&n.length<this._minTouches&&this.reset()},Ca.prototype.touchcancel=function(){this.reset()},Ca.prototype._calculateTransform=function(i,a,n){n.length>0&&(this._active=!0);var s=fs(n,a),p=new l.Point(0,0),f=new l.Point(0,0),d=0;for(var y in s){var g=s[y],S=this._touches[y];S&&(p._add(g),f._add(g.sub(S)),d++,s[y]=g)}if(this._touches=s,!(d<this._minTouches)&&f.mag()){var I=f.div(d);if(this._sum._add(I),!(this._sum.mag()<this._clickTolerance))return{around:p.div(d),panDelta:I}}},Ca.prototype.enable=function(){this._enabled=!0},Ca.prototype.disable=function(){this._enabled=!1,this.reset()},Ca.prototype.isEnabled=function(){return this._enabled},Ca.prototype.isActive=function(){return this._active};var qn=function(){this.reset()};function sl(i,a,n){for(var s=0;s<i.length;s++)if(i[s].identifier===n)return a[s]}function ll(i,a){return Math.log(i/a)/Math.LN2}qn.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},qn.prototype._start=function(i){},qn.prototype._move=function(i,a,n){return{}},qn.prototype.touchstart=function(i,a,n){this._firstTwoTouches||n.length<2||(this._firstTwoTouches=[n[0].identifier,n[1].identifier],this._start([a[0],a[1]]))},qn.prototype.touchmove=function(i,a,n){if(this._firstTwoTouches){i.preventDefault();var s=this._firstTwoTouches,p=s[1],f=sl(n,a,s[0]),d=sl(n,a,p);if(f&&d){var y=this._aroundCenter?null:f.add(d).div(2);return this._move([f,d],y,i)}}},qn.prototype.touchend=function(i,a,n){if(this._firstTwoTouches){var s=this._firstTwoTouches,p=s[1],f=sl(n,a,s[0]),d=sl(n,a,p);f&&d||(this._active&&G.suppressClick(),this.reset())}},qn.prototype.touchcancel=function(){this.reset()},qn.prototype.enable=function(i){this._enabled=!0,this._aroundCenter=!!i&&i.around==="center"},qn.prototype.disable=function(){this._enabled=!1,this.reset()},qn.prototype.isEnabled=function(){return this._enabled},qn.prototype.isActive=function(){return this._active};var Vs=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.reset=function(){i.prototype.reset.call(this),delete this._distance,delete this._startDistance},a.prototype._start=function(n){this._startDistance=this._distance=n[0].dist(n[1])},a.prototype._move=function(n,s){var p=this._distance;if(this._distance=n[0].dist(n[1]),this._active||!(Math.abs(ll(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:ll(this._distance,p),pinchAround:s}},a}(qn);function Si(i,a){return 180*i.angleWith(a)/Math.PI}var ho=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.reset=function(){i.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},a.prototype._start=function(n){this._startVector=this._vector=n[0].sub(n[1]),this._minDiameter=n[0].dist(n[1])},a.prototype._move=function(n,s){var p=this._vector;if(this._vector=n[0].sub(n[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Si(this._vector,p),pinchAround:s}},a.prototype._isBelowThreshold=function(n){this._minDiameter=Math.min(this._minDiameter,n.mag());var s=25/(Math.PI*this._minDiameter)*360,p=Si(n,this._startVector);return Math.abs(p)<s},a}(qn);function ds(i){return Math.abs(i.y)>Math.abs(i.x)}var Ns=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.reset=function(){i.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},a.prototype._start=function(n){this._lastPoints=n,ds(n[0].sub(n[1]))&&(this._valid=!1)},a.prototype._move=function(n,s,p){var f=n[0].sub(this._lastPoints[0]),d=n[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(f,d,p.timeStamp),this._valid)return this._lastPoints=n,this._active=!0,{pitchDelta:(f.y+d.y)/2*-.5}},a.prototype.gestureBeginsVertically=function(n,s,p){if(this._valid!==void 0)return this._valid;var f=n.mag()>=2,d=s.mag()>=2;if(f||d){if(!f||!d)return this._firstMove===void 0&&(this._firstMove=p),p-this._firstMove<100&&void 0;var y=n.y>0==s.y>0;return ds(n)&&ds(s)&&y}},a}(qn),Al={panStep:100,bearingStep:15,pitchStep:10},ma=function(){var i=Al;this._panStep=i.panStep,this._bearingStep=i.bearingStep,this._pitchStep=i.pitchStep,this._rotationDisabled=!1};function Cl(i){return i*(2-i)}ma.prototype.reset=function(){this._active=!1},ma.prototype.keydown=function(i){var a=this;if(!(i.altKey||i.ctrlKey||i.metaKey)){var n=0,s=0,p=0,f=0,d=0;switch(i.keyCode){case 61:case 107:case 171:case 187:n=1;break;case 189:case 109:case 173:n=-1;break;case 37:i.shiftKey?s=-1:(i.preventDefault(),f=-1);break;case 39:i.shiftKey?s=1:(i.preventDefault(),f=1);break;case 38:i.shiftKey?p=1:(i.preventDefault(),d=-1);break;case 40:i.shiftKey?p=-1:(i.preventDefault(),d=1);break;default:return}return this._rotationDisabled&&(s=0,p=0),{cameraAnimation:function(y){var g=y.getZoom();y.easeTo({duration:300,easeId:"keyboardHandler",easing:Cl,zoom:n?Math.round(g)+n*(i.shiftKey?2:1):g,bearing:y.getBearing()+s*a._bearingStep,pitch:y.getPitch()+p*a._pitchStep,offset:[-f*a._panStep,-d*a._panStep],center:y.getCenter()},{originalEvent:i})}}}},ma.prototype.enable=function(){this._enabled=!0},ma.prototype.disable=function(){this._enabled=!1,this.reset()},ma.prototype.isEnabled=function(){return this._enabled},ma.prototype.isActive=function(){return this._active},ma.prototype.disableRotation=function(){this._rotationDisabled=!0},ma.prototype.enableRotation=function(){this._rotationDisabled=!1};var hi=function(i,a){this._map=i,this._el=i.getCanvasContainer(),this._handler=a,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,l.bindAll(["_onTimeout"],this)};hi.prototype.setZoomRate=function(i){this._defaultZoomRate=i},hi.prototype.setWheelZoomRate=function(i){this._wheelZoomRate=i},hi.prototype.isEnabled=function(){return!!this._enabled},hi.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},hi.prototype.isZooming=function(){return!!this._zooming},hi.prototype.enable=function(i){this.isEnabled()||(this._enabled=!0,this._aroundCenter=i&&i.around==="center")},hi.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},hi.prototype.wheel=function(i){if(this.isEnabled()){var a=i.deltaMode===l.window.WheelEvent.DOM_DELTA_LINE?40*i.deltaY:i.deltaY,n=l.browser.now(),s=n-(this._lastWheelEventTime||0);this._lastWheelEventTime=n,a!==0&&a%4.000244140625==0?this._type="wheel":a!==0&&Math.abs(a)<4?this._type="trackpad":s>400?(this._type=null,this._lastValue=a,this._timeout=setTimeout(this._onTimeout,40,i)):this._type||(this._type=Math.abs(s*a)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,a+=this._lastValue)),i.shiftKey&&a&&(a/=4),this._type&&(this._lastWheelEvent=i,this._delta-=a,this._active||this._start(i)),i.preventDefault()}},hi.prototype._onTimeout=function(i){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(i)},hi.prototype._start=function(i){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var a=G.mousePos(this._el,i);this._around=l.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(a)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},hi.prototype.renderFrame=function(){var i=this;if(this._frameId&&(this._frameId=null,this.isActive())){var a=this._map.transform;if(this._delta!==0){var n=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,s=2/(1+Math.exp(-Math.abs(this._delta*n)));this._delta<0&&s!==0&&(s=1/s);var p=typeof this._targetZoom=="number"?a.zoomScale(this._targetZoom):a.scale;this._targetZoom=Math.min(a.maxZoom,Math.max(a.minZoom,a.scaleZoom(p*s))),this._type==="wheel"&&(this._startZoom=a.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var f,d=typeof this._targetZoom=="number"?this._targetZoom:a.zoom,y=this._startZoom,g=this._easing,S=!1;if(this._type==="wheel"&&y&&g){var I=Math.min((l.browser.now()-this._lastWheelEventTime)/200,1),P=g(I);f=l.number(y,d,P),I<1?this._frameId||(this._frameId=!0):S=!0}else f=d,S=!0;return this._active=!0,S&&(this._active=!1,this._finishTimeout=setTimeout(function(){i._zooming=!1,i._handler._triggerRenderFrame(),delete i._targetZoom,delete i._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!S,zoomDelta:f-a.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},hi.prototype._smoothOutEasing=function(i){var a=l.ease;if(this._prevEase){var n=this._prevEase,s=(l.browser.now()-n.start)/n.duration,p=n.easing(s+.01)-n.easing(s),f=.27/Math.sqrt(p*p+1e-4)*.01,d=Math.sqrt(.0729-f*f);a=l.bezier(f,d,.25,1)}return this._prevEase={start:l.browser.now(),duration:i,easing:a},a},hi.prototype.reset=function(){this._active=!1};var rr=function(i,a){this._clickZoom=i,this._tapZoom=a};rr.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},rr.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},rr.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},rr.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var Qn=function(){this.reset()};Qn.prototype.reset=function(){this._active=!1},Qn.prototype.dblclick=function(i,a){return i.preventDefault(),{cameraAnimation:function(n){n.easeTo({duration:300,zoom:n.getZoom()+(i.shiftKey?-1:1),around:n.unproject(a)},{originalEvent:i})}}},Qn.prototype.enable=function(){this._enabled=!0},Qn.prototype.disable=function(){this._enabled=!1,this.reset()},Qn.prototype.isEnabled=function(){return this._enabled},Qn.prototype.isActive=function(){return this._active};var zi=function(){this._tap=new zo({numTouches:1,numTaps:1}),this.reset()};zi.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},zi.prototype.touchstart=function(i,a,n){this._swipePoint||(this._tapTime&&i.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?n.length>0&&(this._swipePoint=a[0],this._swipeTouch=n[0].identifier):this._tap.touchstart(i,a,n))},zi.prototype.touchmove=function(i,a,n){if(this._tapTime){if(this._swipePoint){if(n[0].identifier!==this._swipeTouch)return;var s=a[0],p=s.y-this._swipePoint.y;return this._swipePoint=s,i.preventDefault(),this._active=!0,{zoomDelta:p/128}}}else this._tap.touchmove(i,a,n)},zi.prototype.touchend=function(i,a,n){this._tapTime?this._swipePoint&&n.length===0&&this.reset():this._tap.touchend(i,a,n)&&(this._tapTime=i.timeStamp)},zi.prototype.touchcancel=function(){this.reset()},zi.prototype.enable=function(){this._enabled=!0},zi.prototype.disable=function(){this._enabled=!1,this.reset()},zi.prototype.isEnabled=function(){return this._enabled},zi.prototype.isActive=function(){return this._active};var $n=function(i,a,n){this._el=i,this._mousePan=a,this._touchPan=n};$n.prototype.enable=function(i){this._inertiaOptions=i||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")},$n.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")},$n.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},$n.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var yn=function(i,a,n){this._pitchWithRotate=i.pitchWithRotate,this._mouseRotate=a,this._mousePitch=n};yn.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},yn.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},yn.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},yn.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var za=function(i,a,n,s){this._el=i,this._touchZoom=a,this._touchRotate=n,this._tapDragZoom=s,this._rotationDisabled=!1,this._enabled=!0};za.prototype.enable=function(i){this._touchZoom.enable(i),this._rotationDisabled||this._touchRotate.enable(i),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")},za.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")},za.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},za.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},za.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},za.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var Po=function(i){return i.zoom||i.drag||i.pitch||i.rotate},Ti=function(i){function a(){i.apply(this,arguments)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a}(l.Event);function ya(i){return i.panDelta&&i.panDelta.mag()||i.zoomDelta||i.bearingDelta||i.pitchDelta}var Kt=function(i,a){this._map=i,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Xo(i),this._bearingSnap=a.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(a),l.bindAll(["handleEvent","handleWindowEvent"],this);var n=this._el;this._listeners=[[n,"touchstart",{passive:!0}],[n,"touchmove",{passive:!1}],[n,"touchend",void 0],[n,"touchcancel",void 0],[n,"mousedown",void 0],[n,"mousemove",void 0],[n,"mouseup",void 0],[l.window.document,"mousemove",{capture:!0}],[l.window.document,"mouseup",void 0],[n,"mouseover",void 0],[n,"mouseout",void 0],[n,"dblclick",void 0],[n,"click",void 0],[n,"keydown",{capture:!1}],[n,"keyup",void 0],[n,"wheel",{passive:!1}],[n,"contextmenu",void 0],[l.window,"blur",void 0]];for(var s=0,p=this._listeners;s<p.length;s+=1){var f=p[s],d=f[0];G.addEventListener(d,f[1],d===l.window.document?this.handleWindowEvent:this.handleEvent,f[2])}};Kt.prototype.destroy=function(){for(var i=0,a=this._listeners;i<a.length;i+=1){var n=a[i],s=n[0];G.removeEventListener(s,n[1],s===l.window.document?this.handleWindowEvent:this.handleEvent,n[2])}},Kt.prototype._addDefaultHandlers=function(i){var a=this._map,n=a.getCanvasContainer();this._add("mapEvent",new tn(a,i));var s=a.boxZoom=new re(a,i);this._add("boxZoom",s);var p=new mn,f=new Qn;a.doubleClickZoom=new rr(f,p),this._add("tapZoom",p),this._add("clickZoom",f);var d=new zi;this._add("tapDragZoom",d);var y=a.touchPitch=new Ns;this._add("touchPitch",y);var g=new Us(i),S=new ol(i);a.dragRotate=new yn(i,g,S),this._add("mouseRotate",g,["mousePitch"]),this._add("mousePitch",S,["mouseRotate"]);var I=new ie(i),P=new Ca(i);a.dragPan=new $n(n,I,P),this._add("mousePan",I),this._add("touchPan",P,["touchZoom","touchRotate"]);var A=new ho,B=new Vs;a.touchZoomRotate=new za(n,B,A,d),this._add("touchRotate",A,["touchPan","touchZoom"]),this._add("touchZoom",B,["touchPan","touchRotate"]);var R=a.scrollZoom=new hi(a,this);this._add("scrollZoom",R,["mousePan"]);var N=a.keyboard=new ma;this._add("keyboard",N),this._add("blockableMapEvent",new Bn(a));for(var L=0,q=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];L<q.length;L+=1){var X=q[L];i.interactive&&i[X]&&a[X].enable(i[X])}},Kt.prototype._add=function(i,a,n){this._handlers.push({handlerName:i,handler:a,allowed:n}),this._handlersById[i]=a},Kt.prototype.stop=function(i){if(!this._updatingCamera){for(var a=0,n=this._handlers;a<n.length;a+=1)n[a].handler.reset();this._inertia.clear(),this._fireEvents({},{},i),this._changes=[]}},Kt.prototype.isActive=function(){for(var i=0,a=this._handlers;i<a.length;i+=1)if(a[i].handler.isActive())return!0;return!1},Kt.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},Kt.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},Kt.prototype.isMoving=function(){return Boolean(Po(this._eventsInProgress))||this.isZooming()},Kt.prototype._blockedByActive=function(i,a,n){for(var s in i)if(s!==n&&(!a||a.indexOf(s)<0))return!0;return!1},Kt.prototype.handleWindowEvent=function(i){this.handleEvent(i,i.type+"Window")},Kt.prototype._getMapTouches=function(i){for(var a=[],n=0,s=i;n<s.length;n+=1){var p=s[n];this._el.contains(p.target)&&a.push(p)}return a},Kt.prototype.handleEvent=function(i,a){if(i.type!=="blur"){this._updatingCamera=!0;for(var n=i.type==="renderFrame"?void 0:i,s={needsRenderFrame:!1},p={},f={},d=i.touches?this._getMapTouches(i.touches):void 0,y=d?G.touchPos(this._el,d):G.mousePos(this._el,i),g=0,S=this._handlers;g<S.length;g+=1){var I=S[g],P=I.handlerName,A=I.handler,B=I.allowed;if(A.isEnabled()){var R=void 0;this._blockedByActive(f,B,P)?A.reset():A[a||i.type]&&(R=A[a||i.type](i,y,d),this.mergeHandlerResult(s,p,R,P,n),R&&R.needsRenderFrame&&this._triggerRenderFrame()),(R||A.isActive())&&(f[P]=A)}}var N={};for(var L in this._previousActiveHandlers)f[L]||(N[L]=n);this._previousActiveHandlers=f,(Object.keys(N).length||ya(s))&&(this._changes.push([s,p,N]),this._triggerRenderFrame()),(Object.keys(f).length||ya(s))&&this._map._stop(!0),this._updatingCamera=!1;var q=s.cameraAnimation;q&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],q(this._map))}else this.stop(!0)},Kt.prototype.mergeHandlerResult=function(i,a,n,s,p){if(n){l.extend(i,n);var f={handlerName:s,originalEvent:n.originalEvent||p};n.zoomDelta!==void 0&&(a.zoom=f),n.panDelta!==void 0&&(a.drag=f),n.pitchDelta!==void 0&&(a.pitch=f),n.bearingDelta!==void 0&&(a.rotate=f)}},Kt.prototype._applyChanges=function(){for(var i={},a={},n={},s=0,p=this._changes;s<p.length;s+=1){var f=p[s],d=f[0],y=f[1],g=f[2];d.panDelta&&(i.panDelta=(i.panDelta||new l.Point(0,0))._add(d.panDelta)),d.zoomDelta&&(i.zoomDelta=(i.zoomDelta||0)+d.zoomDelta),d.bearingDelta&&(i.bearingDelta=(i.bearingDelta||0)+d.bearingDelta),d.pitchDelta&&(i.pitchDelta=(i.pitchDelta||0)+d.pitchDelta),d.around!==void 0&&(i.around=d.around),d.pinchAround!==void 0&&(i.pinchAround=d.pinchAround),d.noInertia&&(i.noInertia=d.noInertia),l.extend(a,y),l.extend(n,g)}this._updateMapTransform(i,a,n),this._changes=[]},Kt.prototype._updateMapTransform=function(i,a,n){var s=this._map,p=s.transform;if(!ya(i))return this._fireEvents(a,n,!0);var f=i.panDelta,d=i.zoomDelta,y=i.bearingDelta,g=i.pitchDelta,S=i.around,I=i.pinchAround;I!==void 0&&(S=I),s._stop(!0),S=S||s.transform.centerPoint;var P=p.pointLocation(f?S.sub(f):S);y&&(p.bearing+=y),g&&(p.pitch+=g),d&&(p.zoom+=d),p.setLocationAtPoint(P,S),this._map._update(),i.noInertia||this._inertia.record(i),this._fireEvents(a,n,!0)},Kt.prototype._fireEvents=function(i,a,n){var s=this,p=Po(this._eventsInProgress),f=Po(i),d={};for(var y in i)this._eventsInProgress[y]||(d[y+"start"]=i[y].originalEvent),this._eventsInProgress[y]=i[y];for(var g in!p&&f&&this._fireEvent("movestart",f.originalEvent),d)this._fireEvent(g,d[g]);for(var S in f&&this._fireEvent("move",f.originalEvent),i)this._fireEvent(S,i[S].originalEvent);var I,P={};for(var A in this._eventsInProgress){var B=this._eventsInProgress[A],R=B.handlerName,N=B.originalEvent;this._handlersById[R].isActive()||(delete this._eventsInProgress[A],P[A+"end"]=I=a[R]||N)}for(var L in P)this._fireEvent(L,P[L]);var q=Po(this._eventsInProgress);if(n&&(p||f)&&!q){this._updatingCamera=!0;var X=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),rt=function(ct){return ct!==0&&-s._bearingSnap<ct&&ct<s._bearingSnap};X?(rt(X.bearing||this._map.getBearing())&&(X.bearing=0),this._map.easeTo(X,{originalEvent:I})):(this._map.fire(new l.Event("moveend",{originalEvent:I})),rt(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},Kt.prototype._fireEvent=function(i,a){this._map.fire(new l.Event(i,a?{originalEvent:a}:{}))},Kt.prototype._requestFrame=function(){var i=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(a){delete i._frameId,i.handleEvent(new Ti("renderFrame",{timeStamp:a})),i._applyChanges()})},Kt.prototype._triggerRenderFrame=function(){this._frameId===void 0&&(this._frameId=this._requestFrame())};var De=function(i){function a(n,s){i.call(this),this._moving=!1,this._zooming=!1,this.transform=n,this._bearingSnap=s.bearingSnap,l.bindAll(["_renderFrameCallback"],this)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.getCenter=function(){return new l.LngLat(this.transform.center.lng,this.transform.center.lat)},a.prototype.setCenter=function(n,s){return this.jumpTo({center:n},s)},a.prototype.panBy=function(n,s,p){return n=l.Point.convert(n).mult(-1),this.panTo(this.transform.center,l.extend({offset:n},s),p)},a.prototype.panTo=function(n,s,p){return this.easeTo(l.extend({center:n},s),p)},a.prototype.getZoom=function(){return this.transform.zoom},a.prototype.setZoom=function(n,s){return this.jumpTo({zoom:n},s),this},a.prototype.zoomTo=function(n,s,p){return this.easeTo(l.extend({zoom:n},s),p)},a.prototype.zoomIn=function(n,s){return this.zoomTo(this.getZoom()+1,n,s),this},a.prototype.zoomOut=function(n,s){return this.zoomTo(this.getZoom()-1,n,s),this},a.prototype.getBearing=function(){return this.transform.bearing},a.prototype.setBearing=function(n,s){return this.jumpTo({bearing:n},s),this},a.prototype.getPadding=function(){return this.transform.padding},a.prototype.setPadding=function(n,s){return this.jumpTo({padding:n},s),this},a.prototype.rotateTo=function(n,s,p){return this.easeTo(l.extend({bearing:n},s),p)},a.prototype.resetNorth=function(n,s){return this.rotateTo(0,l.extend({duration:1e3},n),s),this},a.prototype.resetNorthPitch=function(n,s){return this.easeTo(l.extend({bearing:0,pitch:0,duration:1e3},n),s),this},a.prototype.snapToNorth=function(n,s){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(n,s):this},a.prototype.getPitch=function(){return this.transform.pitch},a.prototype.setPitch=function(n,s){return this.jumpTo({pitch:n},s),this},a.prototype.cameraForBounds=function(n,s){n=l.LngLatBounds.convert(n);var p=s&&s.bearing||0;return this._cameraForBoxAndBearing(n.getNorthWest(),n.getSouthEast(),p,s)},a.prototype._cameraForBoxAndBearing=function(n,s,p,f){var d={top:0,bottom:0,right:0,left:0};if(typeof(f=l.extend({padding:d,offset:[0,0],maxZoom:this.transform.maxZoom},f)).padding=="number"){var y=f.padding;f.padding={top:y,bottom:y,right:y,left:y}}f.padding=l.extend(d,f.padding);var g=this.transform,S=g.padding,I=g.project(l.LngLat.convert(n)),P=g.project(l.LngLat.convert(s)),A=I.rotate(-p*Math.PI/180),B=P.rotate(-p*Math.PI/180),R=new l.Point(Math.max(A.x,B.x),Math.max(A.y,B.y)),N=new l.Point(Math.min(A.x,B.x),Math.min(A.y,B.y)),L=R.sub(N),q=(g.width-(S.left+S.right+f.padding.left+f.padding.right))/L.x,X=(g.height-(S.top+S.bottom+f.padding.top+f.padding.bottom))/L.y;if(!(X<0||q<0)){var rt=Math.min(g.scaleZoom(g.scale*Math.min(q,X)),f.maxZoom),ct=typeof f.offset.x=="number"?new l.Point(f.offset.x,f.offset.y):l.Point.convert(f.offset),ot=new l.Point((f.padding.left-f.padding.right)/2,(f.padding.top-f.padding.bottom)/2).rotate(p*Math.PI/180),$=ct.add(ot).mult(g.scale/g.zoomScale(rt));return{center:g.unproject(I.add(P).div(2).sub($)),zoom:rt,bearing:p}}l.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},a.prototype.fitBounds=function(n,s,p){return this._fitInternal(this.cameraForBounds(n,s),s,p)},a.prototype.fitScreenCoordinates=function(n,s,p,f,d){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(l.Point.convert(n)),this.transform.pointLocation(l.Point.convert(s)),p,f),f,d)},a.prototype._fitInternal=function(n,s,p){return n?(delete(s=l.extend(n,s)).padding,s.linear?this.easeTo(s,p):this.flyTo(s,p)):this},a.prototype.jumpTo=function(n,s){this.stop();var p=this.transform,f=!1,d=!1,y=!1;return"zoom"in n&&p.zoom!==+n.zoom&&(f=!0,p.zoom=+n.zoom),n.center!==void 0&&(p.center=l.LngLat.convert(n.center)),"bearing"in n&&p.bearing!==+n.bearing&&(d=!0,p.bearing=+n.bearing),"pitch"in n&&p.pitch!==+n.pitch&&(y=!0,p.pitch=+n.pitch),n.padding==null||p.isPaddingEqual(n.padding)||(p.padding=n.padding),this.fire(new l.Event("movestart",s)).fire(new l.Event("move",s)),f&&this.fire(new l.Event("zoomstart",s)).fire(new l.Event("zoom",s)).fire(new l.Event("zoomend",s)),d&&this.fire(new l.Event("rotatestart",s)).fire(new l.Event("rotate",s)).fire(new l.Event("rotateend",s)),y&&this.fire(new l.Event("pitchstart",s)).fire(new l.Event("pitch",s)).fire(new l.Event("pitchend",s)),this.fire(new l.Event("moveend",s))},a.prototype.easeTo=function(n,s){var p=this;this._stop(!1,n.easeId),((n=l.extend({offset:[0,0],duration:500,easing:l.ease},n)).animate===!1||!n.essential&&l.browser.prefersReducedMotion)&&(n.duration=0);var f=this.transform,d=this.getZoom(),y=this.getBearing(),g=this.getPitch(),S=this.getPadding(),I="zoom"in n?+n.zoom:d,P="bearing"in n?this._normalizeBearing(n.bearing,y):y,A="pitch"in n?+n.pitch:g,B="padding"in n?n.padding:f.padding,R=l.Point.convert(n.offset),N=f.centerPoint.add(R),L=f.pointLocation(N),q=l.LngLat.convert(n.center||L);this._normalizeCenter(q);var X,rt,ct=f.project(L),ot=f.project(q).sub(ct),$=f.zoomScale(I-d);n.around&&(X=l.LngLat.convert(n.around),rt=f.locationPoint(X));var yt={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||I!==d,this._rotating=this._rotating||y!==P,this._pitching=this._pitching||A!==g,this._padding=!f.isPaddingEqual(B),this._easeId=n.easeId,this._prepareEase(s,n.noMoveStart,yt),this._ease(function(kt){if(p._zooming&&(f.zoom=l.number(d,I,kt)),p._rotating&&(f.bearing=l.number(y,P,kt)),p._pitching&&(f.pitch=l.number(g,A,kt)),p._padding&&(f.interpolatePadding(S,B,kt),N=f.centerPoint.add(R)),X)f.setLocationAtPoint(X,rt);else{var Mt=f.zoomScale(f.zoom-d),Nt=I>d?Math.min(2,$):Math.max(.5,$),ye=Math.pow(Nt,1-kt),le=f.unproject(ct.add(ot.mult(kt*ye)).mult(Mt));f.setLocationAtPoint(f.renderWorldCopies?le.wrap():le,N)}p._fireMoveEvents(s)},function(kt){p._afterEase(s,kt)},n),this},a.prototype._prepareEase=function(n,s,p){p===void 0&&(p={}),this._moving=!0,s||p.moving||this.fire(new l.Event("movestart",n)),this._zooming&&!p.zooming&&this.fire(new l.Event("zoomstart",n)),this._rotating&&!p.rotating&&this.fire(new l.Event("rotatestart",n)),this._pitching&&!p.pitching&&this.fire(new l.Event("pitchstart",n))},a.prototype._fireMoveEvents=function(n){this.fire(new l.Event("move",n)),this._zooming&&this.fire(new l.Event("zoom",n)),this._rotating&&this.fire(new l.Event("rotate",n)),this._pitching&&this.fire(new l.Event("pitch",n))},a.prototype._afterEase=function(n,s){if(!this._easeId||!s||this._easeId!==s){delete this._easeId;var p=this._zooming,f=this._rotating,d=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,p&&this.fire(new l.Event("zoomend",n)),f&&this.fire(new l.Event("rotateend",n)),d&&this.fire(new l.Event("pitchend",n)),this.fire(new l.Event("moveend",n))}},a.prototype.flyTo=function(n,s){var p=this;if(!n.essential&&l.browser.prefersReducedMotion){var f=l.pick(n,["center","zoom","bearing","pitch","around"]);return this.jumpTo(f,s)}this.stop(),n=l.extend({offset:[0,0],speed:1.2,curve:1.42,easing:l.ease},n);var d=this.transform,y=this.getZoom(),g=this.getBearing(),S=this.getPitch(),I=this.getPadding(),P="zoom"in n?l.clamp(+n.zoom,d.minZoom,d.maxZoom):y,A="bearing"in n?this._normalizeBearing(n.bearing,g):g,B="pitch"in n?+n.pitch:S,R="padding"in n?n.padding:d.padding,N=d.zoomScale(P-y),L=l.Point.convert(n.offset),q=d.centerPoint.add(L),X=d.pointLocation(q),rt=l.LngLat.convert(n.center||X);this._normalizeCenter(rt);var ct=d.project(X),ot=d.project(rt).sub(ct),$=n.curve,yt=Math.max(d.width,d.height),kt=yt/N,Mt=ot.mag();if("minZoom"in n){var Nt=l.clamp(Math.min(n.minZoom,y,P),d.minZoom,d.maxZoom),ye=yt/d.zoomScale(Nt-y);$=Math.sqrt(ye/Mt*2)}var le=$*$;function pe(se){var oe=(kt*kt-yt*yt+(se?-1:1)*le*le*Mt*Mt)/(2*(se?kt:yt)*le*Mt);return Math.log(Math.sqrt(oe*oe+1)-oe)}function Ge(se){return(Math.exp(se)-Math.exp(-se))/2}function jt(se){return(Math.exp(se)+Math.exp(-se))/2}var Re=pe(0),Pe=function(se){return jt(Re)/jt(Re+$*se)},_e=function(se){return yt*((jt(Re)*(Ge(oe=Re+$*se)/jt(oe))-Ge(Re))/le)/Mt;var oe},Ie=(pe(1)-Re)/$;if(Math.abs(Mt)<1e-6||!isFinite(Ie)){if(Math.abs(yt-kt)<1e-6)return this.easeTo(n,s);var ge=kt<yt?-1:1;Ie=Math.abs(Math.log(kt/yt))/$,_e=function(){return 0},Pe=function(se){return Math.exp(ge*$*se)}}return n.duration="duration"in n?+n.duration:1e3*Ie/("screenSpeed"in n?+n.screenSpeed/$:+n.speed),n.maxDuration&&n.duration>n.maxDuration&&(n.duration=0),this._zooming=!0,this._rotating=g!==A,this._pitching=B!==S,this._padding=!d.isPaddingEqual(R),this._prepareEase(s,!1),this._ease(function(se){var oe=se*Ie,He=1/Pe(oe);d.zoom=se===1?P:y+d.scaleZoom(He),p._rotating&&(d.bearing=l.number(g,A,se)),p._pitching&&(d.pitch=l.number(S,B,se)),p._padding&&(d.interpolatePadding(I,R,se),q=d.centerPoint.add(L));var Be=se===1?rt:d.unproject(ct.add(ot.mult(_e(oe))).mult(He));d.setLocationAtPoint(d.renderWorldCopies?Be.wrap():Be,q),p._fireMoveEvents(s)},function(){return p._afterEase(s)},n),this},a.prototype.isEasing=function(){return!!this._easeFrameId},a.prototype.stop=function(){return this._stop()},a.prototype._stop=function(n,s){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var p=this._onEaseEnd;delete this._onEaseEnd,p.call(this,s)}if(!n){var f=this.handlers;f&&f.stop(!1)}return this},a.prototype._ease=function(n,s,p){p.animate===!1||p.duration===0?(n(1),s()):(this._easeStart=l.browser.now(),this._easeOptions=p,this._onEaseFrame=n,this._onEaseEnd=s,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},a.prototype._renderFrameCallback=function(){var n=Math.min((l.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(n)),n<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},a.prototype._normalizeBearing=function(n,s){n=l.wrap(n,-180,180);var p=Math.abs(n-s);return Math.abs(n-360-s)<p&&(n-=360),Math.abs(n+360-s)<p&&(n+=360),n},a.prototype._normalizeCenter=function(n){var s=this.transform;if(s.renderWorldCopies&&!s.lngRange){var p=n.lng-s.center.lng;n.lng+=p>180?-360:p<-180?360:0}},a}(l.Evented),Zn=function(i){i===void 0&&(i={}),this.options=i,l.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};Zn.prototype.getDefaultPosition=function(){return"bottom-right"},Zn.prototype.onAdd=function(i){var a=this.options&&this.options.compact;return this._map=i,this._container=G.create("div","maplibregl-ctrl maplibregl-ctrl-attrib mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=G.create("button","maplibregl-ctrl-attrib-button mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.type="button",this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=G.create("div","maplibregl-ctrl-attrib-inner mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),a&&this._container.classList.add("maplibregl-compact","mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),a===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},Zn.prototype.onRemove=function(){G.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},Zn.prototype._setElementTitle=function(i,a){var n=this._map._getUIString("AttributionControl."+a);i.title=n,i.setAttribute("aria-label",n)},Zn.prototype._toggleAttribution=function(){this._container.classList.contains("maplibregl-compact-show")||this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("maplibregl-compact-show","mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},Zn.prototype._updateEditLink=function(){var i=this._editLink;i||(i=this._editLink=this._container.querySelector(".mapbox-improve-map"));var a=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||l.config.ACCESS_TOKEN}];if(i){var n=a.reduce(function(s,p,f){return p.value&&(s+=p.key+"="+p.value+(f<a.length-1?"&":"")),s},"?");i.href=l.config.FEEDBACK_URL+"/"+n+(this._map._hash?this._map._hash.getHashString(!0):""),i.rel="noopener nofollow",this._setElementTitle(i,"MapFeedback")}},Zn.prototype._updateData=function(i){!i||i.sourceDataType!=="metadata"&&i.sourceDataType!=="visibility"&&i.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},Zn.prototype._updateAttributions=function(){if(this._map.style){var i=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?i=i.concat(this.options.customAttribution.map(function(y){return typeof y!="string"?"":y})):typeof this.options.customAttribution=="string"&&i.push(this.options.customAttribution)),this._map.style.stylesheet){var a=this._map.style.stylesheet;this.styleOwner=a.owner,this.styleId=a.id}var n=this._map.style.sourceCaches;for(var s in n){var p=n[s];if(p.used){var f=p.getSource();f.attribution&&i.indexOf(f.attribution)<0&&i.push(f.attribution)}}i.sort(function(y,g){return y.length-g.length});var d=(i=i.filter(function(y,g){for(var S=g+1;S<i.length;S++)if(i[S].indexOf(y)>=0)return!1;return!0})).join(" | ");d!==this._attribHTML&&(this._attribHTML=d,i.length?(this._innerContainer.innerHTML=d,this._container.classList.remove("maplibregl-attrib-empty","mapboxgl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty","mapboxgl-attrib-empty"),this._editLink=null)}},Zn.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("maplibregl-compact","mapboxgl-compact"):this._container.classList.remove("maplibregl-compact","maplibregl-compact-show","mapboxgl-compact","mapboxgl-compact-show")};var ta=function(){l.bindAll(["_updateLogo"],this),l.bindAll(["_updateCompact"],this)};ta.prototype.onAdd=function(i){this._map=i,this._container=G.create("div","maplibregl-ctrl mapboxgl-ctrl");var a=G.create("a","maplibregl-ctrl-logo mapboxgl-ctrl-logo");return a.target="_blank",a.rel="noopener nofollow",a.href="https://maplibre.org/",a.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),a.setAttribute("rel","noopener nofollow"),this._container.appendChild(a),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},ta.prototype.onRemove=function(){G.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},ta.prototype.getDefaultPosition=function(){return"bottom-left"},ta.prototype._updateLogo=function(i){i&&i.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},ta.prototype._logoRequired=function(){if(this._map.style){var i=this._map.style.sourceCaches;for(var a in i)if(i[a].getSource().mapbox_logo)return!0;return!1}},ta.prototype._updateCompact=function(){var i=this._container.children;if(i.length){var a=i[0];this._map.getCanvasContainer().offsetWidth<250?a.classList.add("maplibregl-compact","mapboxgl-compact"):a.classList.remove("maplibregl-compact","mapboxgl-compact")}};var Ja=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};Ja.prototype.add=function(i){var a=++this._id;return this._queue.push({callback:i,id:a,cancelled:!1}),a},Ja.prototype.remove=function(i){for(var a=this._currentlyRunning,n=0,s=a?this._queue.concat(a):this._queue;n<s.length;n+=1){var p=s[n];if(p.id===i)return void(p.cancelled=!0)}},Ja.prototype.run=function(i){i===void 0&&(i=0);var a=this._currentlyRunning=this._queue;this._queue=[];for(var n=0,s=a;n<s.length;n+=1){var p=s[n];if(!p.cancelled&&(p.callback(i),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},Ja.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var ea={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},Gi=l.window.HTMLImageElement,Tu=l.window.HTMLElement,va=l.window.ImageBitmap,Xr={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},Nr=function(i){function a(s){var p=this;if((s=l.extend({},Xr,s)).minZoom!=null&&s.maxZoom!=null&&s.minZoom>s.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(s.minPitch!=null&&s.maxPitch!=null&&s.minPitch>s.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(s.minPitch!=null&&s.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(s.maxPitch!=null&&s.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var f=new Pr(s.minZoom,s.maxZoom,s.minPitch,s.maxPitch,s.renderWorldCopies);if(i.call(this,f,s),this._interactive=s.interactive,this._maxTileCacheSize=s.maxTileCacheSize,this._failIfMajorPerformanceCaveat=s.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=s.preserveDrawingBuffer,this._antialias=s.antialias,this._trackResize=s.trackResize,this._bearingSnap=s.bearingSnap,this._refreshExpiredTiles=s.refreshExpiredTiles,this._fadeDuration=s.fadeDuration,this._crossSourceCollisions=s.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=s.collectResourceTiming,this._renderTaskQueue=new Ja,this._controls=[],this._mapId=l.uniqueId(),this._locale=l.extend({},ea,s.locale),this._clickTolerance=s.clickTolerance,this._requestManager=new l.RequestManager(s.transformRequest,s.accessToken),typeof s.container=="string"){if(this._container=l.window.document.getElementById(s.container),!this._container)throw new Error("Container '"+s.container+"' not found.")}else{if(!(s.container instanceof Tu))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=s.container}if(s.maxBounds&&this.setMaxBounds(s.maxBounds),l.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return p._update(!1)}),this.on("moveend",function(){return p._update(!1)}),this.on("zoom",function(){return p._update(!0)}),l.window!==void 0&&(l.window.addEventListener("online",this._onWindowOnline,!1),l.window.addEventListener("resize",this._onWindowResize,!1),l.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new Kt(this,s),this._hash=s.hash&&new fn(typeof s.hash=="string"&&s.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:s.center,zoom:s.zoom,bearing:s.bearing,pitch:s.pitch}),s.bounds&&(this.resize(),this.fitBounds(s.bounds,l.extend({},s.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=s.localIdeographFontFamily,s.style&&this.setStyle(s.style,{localIdeographFontFamily:s.localIdeographFontFamily}),s.attributionControl&&this.addControl(new Zn({customAttribution:s.customAttribution})),this.addControl(new ta,s.logoPosition),this.on("style.load",function(){p.transform.unmodified&&p.jumpTo(p.style.stylesheet)}),this.on("data",function(d){p._update(d.dataType==="style"),p.fire(new l.Event(d.dataType+"data",d))}),this.on("dataloading",function(d){p.fire(new l.Event(d.dataType+"dataloading",d))})}i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a;var n={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return a.prototype._getMapId=function(){return this._mapId},a.prototype.addControl=function(s,p){if(p===void 0&&(p=s.getDefaultPosition?s.getDefaultPosition():"top-right"),!s||!s.onAdd)return this.fire(new l.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var f=s.onAdd(this);this._controls.push(s);var d=this._controlPositions[p];return p.indexOf("bottom")!==-1?d.insertBefore(f,d.firstChild):d.appendChild(f),this},a.prototype.removeControl=function(s){if(!s||!s.onRemove)return this.fire(new l.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var p=this._controls.indexOf(s);return p>-1&&this._controls.splice(p,1),s.onRemove(this),this},a.prototype.hasControl=function(s){return this._controls.indexOf(s)>-1},a.prototype.resize=function(s){var p=this._containerDimensions(),f=p[0],d=p[1];this._resizeCanvas(f,d),this.transform.resize(f,d),this.painter.resize(f,d);var y=!this._moving;return y&&(this.stop(),this.fire(new l.Event("movestart",s)).fire(new l.Event("move",s))),this.fire(new l.Event("resize",s)),y&&this.fire(new l.Event("moveend",s)),this},a.prototype.getBounds=function(){return this.transform.getBounds()},a.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},a.prototype.setMaxBounds=function(s){return this.transform.setMaxBounds(l.LngLatBounds.convert(s)),this._update()},a.prototype.setMinZoom=function(s){if((s=s==null?-2:s)>=-2&&s<=this.transform.maxZoom)return this.transform.minZoom=s,this._update(),this.getZoom()<s&&this.setZoom(s),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},a.prototype.getMinZoom=function(){return this.transform.minZoom},a.prototype.setMaxZoom=function(s){if((s=s==null?22:s)>=this.transform.minZoom)return this.transform.maxZoom=s,this._update(),this.getZoom()>s&&this.setZoom(s),this;throw new Error("maxZoom must be greater than the current minZoom")},a.prototype.getMaxZoom=function(){return this.transform.maxZoom},a.prototype.setMinPitch=function(s){if((s=s==null?0:s)<0)throw new Error("minPitch must be greater than or equal to 0");if(s>=0&&s<=this.transform.maxPitch)return this.transform.minPitch=s,this._update(),this.getPitch()<s&&this.setPitch(s),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},a.prototype.getMinPitch=function(){return this.transform.minPitch},a.prototype.setMaxPitch=function(s){if((s=s==null?60:s)>60)throw new Error("maxPitch must be less than or equal to 60");if(s>=this.transform.minPitch)return this.transform.maxPitch=s,this._update(),this.getPitch()>s&&this.setPitch(s),this;throw new Error("maxPitch must be greater than the current minPitch")},a.prototype.getMaxPitch=function(){return this.transform.maxPitch},a.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},a.prototype.setRenderWorldCopies=function(s){return this.transform.renderWorldCopies=s,this._update()},a.prototype.project=function(s){return this.transform.locationPoint(l.LngLat.convert(s))},a.prototype.unproject=function(s){return this.transform.pointLocation(l.Point.convert(s))},a.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},a.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},a.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},a.prototype._createDelegatedListener=function(s,p,f){var d,y=this;if(s==="mouseenter"||s==="mouseover"){var g=!1;return{layer:p,listener:f,delegates:{mousemove:function(I){var P=y.getLayer(p)?y.queryRenderedFeatures(I.point,{layers:[p]}):[];P.length?g||(g=!0,f.call(y,new pi(s,y,I.originalEvent,{features:P}))):g=!1},mouseout:function(){g=!1}}}}if(s==="mouseleave"||s==="mouseout"){var S=!1;return{layer:p,listener:f,delegates:{mousemove:function(I){(y.getLayer(p)?y.queryRenderedFeatures(I.point,{layers:[p]}):[]).length?S=!0:S&&(S=!1,f.call(y,new pi(s,y,I.originalEvent)))},mouseout:function(I){S&&(S=!1,f.call(y,new pi(s,y,I.originalEvent)))}}}}return{layer:p,listener:f,delegates:(d={},d[s]=function(I){var P=y.getLayer(p)?y.queryRenderedFeatures(I.point,{layers:[p]}):[];P.length&&(I.features=P,f.call(y,I),delete I.features)},d)}},a.prototype.on=function(s,p,f){if(f===void 0)return i.prototype.on.call(this,s,p);var d=this._createDelegatedListener(s,p,f);for(var y in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[s]=this._delegatedListeners[s]||[],this._delegatedListeners[s].push(d),d.delegates)this.on(y,d.delegates[y]);return this},a.prototype.once=function(s,p,f){if(f===void 0)return i.prototype.once.call(this,s,p);var d=this._createDelegatedListener(s,p,f);for(var y in d.delegates)this.once(y,d.delegates[y]);return this},a.prototype.off=function(s,p,f){var d=this;return f===void 0?i.prototype.off.call(this,s,p):(this._delegatedListeners&&this._delegatedListeners[s]&&function(y){for(var g=y[s],S=0;S<g.length;S++){var I=g[S];if(I.layer===p&&I.listener===f){for(var P in I.delegates)d.off(P,I.delegates[P]);return g.splice(S,1),d}}}(this._delegatedListeners),this)},a.prototype.queryRenderedFeatures=function(s,p){if(!this.style)return[];var f;if(p!==void 0||s===void 0||s instanceof l.Point||Array.isArray(s)||(p=s,s=void 0),p=p||{},(s=s||[[0,0],[this.transform.width,this.transform.height]])instanceof l.Point||typeof s[0]=="number")f=[l.Point.convert(s)];else{var d=l.Point.convert(s[0]),y=l.Point.convert(s[1]);f=[d,new l.Point(y.x,d.y),y,new l.Point(d.x,y.y),d]}return this.style.queryRenderedFeatures(f,p,this.transform)},a.prototype.querySourceFeatures=function(s,p){return this.style.querySourceFeatures(s,p)},a.prototype.setStyle=function(s,p){return(p=l.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},p)).diff!==!1&&p.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&s?(this._diffStyle(s,p),this):(this._localIdeographFontFamily=p.localIdeographFontFamily,this._updateStyle(s,p))},a.prototype.setTransformRequest=function(s){return this._requestManager.setTransformRequest(s),this},a.prototype._getUIString=function(s){var p=this._locale[s];if(p==null)throw new Error("Missing UI string '"+s+"'");return p},a.prototype._updateStyle=function(s,p){return this.style&&(this.style.setEventedParent(null),this.style._remove()),s?(this.style=new lo(this,p||{}),this.style.setEventedParent(this,{style:this.style}),typeof s=="string"?this.style.loadURL(s):this.style.loadJSON(s),this):(delete this.style,this)},a.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new lo(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},a.prototype._diffStyle=function(s,p){var f=this;if(typeof s=="string"){var d=this._requestManager.normalizeStyleURL(s),y=this._requestManager.transformRequest(d,l.ResourceType.Style);l.getJSON(y,function(g,S){g?f.fire(new l.ErrorEvent(g)):S&&f._updateDiff(S,p)})}else typeof s=="object"&&this._updateDiff(s,p)},a.prototype._updateDiff=function(s,p){try{this.style.setState(s)&&this._update(!0)}catch(f){l.warnOnce("Unable to perform style diff: "+(f.message||f.error||f)+".  Rebuilding the style from scratch."),this._updateStyle(s,p)}},a.prototype.getStyle=function(){if(this.style)return this.style.serialize()},a.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():l.warnOnce("There is no style added to the map.")},a.prototype.addSource=function(s,p){return this._lazyInitEmptyStyle(),this.style.addSource(s,p),this._update(!0)},a.prototype.isSourceLoaded=function(s){var p=this.style&&this.style.sourceCaches[s];if(p!==void 0)return p.loaded();this.fire(new l.ErrorEvent(new Error("There is no source with ID '"+s+"'")))},a.prototype.areTilesLoaded=function(){var s=this.style&&this.style.sourceCaches;for(var p in s){var f=s[p]._tiles;for(var d in f){var y=f[d];if(y.state!=="loaded"&&y.state!=="errored")return!1}}return!0},a.prototype.addSourceType=function(s,p,f){return this._lazyInitEmptyStyle(),this.style.addSourceType(s,p,f)},a.prototype.removeSource=function(s){return this.style.removeSource(s),this._update(!0)},a.prototype.getSource=function(s){return this.style.getSource(s)},a.prototype.addImage=function(s,p,f){f===void 0&&(f={});var d=f.pixelRatio;d===void 0&&(d=1);var y=f.sdf;y===void 0&&(y=!1);var g=f.stretchX,S=f.stretchY,I=f.content;if(this._lazyInitEmptyStyle(),p instanceof Gi||va&&p instanceof va){var P=l.browser.getImageData(p);this.style.addImage(s,{data:new l.RGBAImage({width:P.width,height:P.height},P.data),pixelRatio:d,stretchX:g,stretchY:S,content:I,sdf:y,version:0})}else{if(p.width===void 0||p.height===void 0)return this.fire(new l.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var A=p;this.style.addImage(s,{data:new l.RGBAImage({width:p.width,height:p.height},new Uint8Array(p.data)),pixelRatio:d,stretchX:g,stretchY:S,content:I,sdf:y,version:0,userImage:A}),A.onAdd&&A.onAdd(this,s)}},a.prototype.updateImage=function(s,p){var f=this.style.getImage(s);if(!f)return this.fire(new l.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var d=p instanceof Gi||va&&p instanceof va?l.browser.getImageData(p):p,y=d.width,g=d.height,S=d.data;return y===void 0||g===void 0?this.fire(new l.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):y!==f.data.width||g!==f.data.height?this.fire(new l.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(f.data.replace(S,!(p instanceof Gi||va&&p instanceof va)),void this.style.updateImage(s,f))},a.prototype.hasImage=function(s){return s?!!this.style.getImage(s):(this.fire(new l.ErrorEvent(new Error("Missing required image id"))),!1)},a.prototype.removeImage=function(s){this.style.removeImage(s)},a.prototype.loadImage=function(s,p){l.getImage(this._requestManager.transformRequest(s,l.ResourceType.Image),p)},a.prototype.listImages=function(){return this.style.listImages()},a.prototype.addLayer=function(s,p){return this._lazyInitEmptyStyle(),this.style.addLayer(s,p),this._update(!0)},a.prototype.moveLayer=function(s,p){return this.style.moveLayer(s,p),this._update(!0)},a.prototype.removeLayer=function(s){return this.style.removeLayer(s),this._update(!0)},a.prototype.getLayer=function(s){return this.style.getLayer(s)},a.prototype.setLayerZoomRange=function(s,p,f){return this.style.setLayerZoomRange(s,p,f),this._update(!0)},a.prototype.setFilter=function(s,p,f){return f===void 0&&(f={}),this.style.setFilter(s,p,f),this._update(!0)},a.prototype.getFilter=function(s){return this.style.getFilter(s)},a.prototype.setPaintProperty=function(s,p,f,d){return d===void 0&&(d={}),this.style.setPaintProperty(s,p,f,d),this._update(!0)},a.prototype.getPaintProperty=function(s,p){return this.style.getPaintProperty(s,p)},a.prototype.setLayoutProperty=function(s,p,f,d){return d===void 0&&(d={}),this.style.setLayoutProperty(s,p,f,d),this._update(!0)},a.prototype.getLayoutProperty=function(s,p){return this.style.getLayoutProperty(s,p)},a.prototype.setLight=function(s,p){return p===void 0&&(p={}),this._lazyInitEmptyStyle(),this.style.setLight(s,p),this._update(!0)},a.prototype.getLight=function(){return this.style.getLight()},a.prototype.setFeatureState=function(s,p){return this.style.setFeatureState(s,p),this._update()},a.prototype.removeFeatureState=function(s,p){return this.style.removeFeatureState(s,p),this._update()},a.prototype.getFeatureState=function(s){return this.style.getFeatureState(s)},a.prototype.getContainer=function(){return this._container},a.prototype.getCanvasContainer=function(){return this._canvasContainer},a.prototype.getCanvas=function(){return this._canvas},a.prototype._containerDimensions=function(){var s=0,p=0;return this._container&&(s=this._container.clientWidth||400,p=this._container.clientHeight||300),[s,p]},a.prototype._setupContainer=function(){var s=this._container;s.classList.add("maplibregl-map","mapboxgl-map");var p=this._canvasContainer=G.create("div","maplibregl-canvas-container mapboxgl-canvas-container",s);this._interactive&&p.classList.add("maplibregl-interactive","mapboxgl-interactive"),this._canvas=G.create("canvas","maplibregl-canvas mapboxgl-canvas",p),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var f=this._containerDimensions();this._resizeCanvas(f[0],f[1]);var d=this._controlContainer=G.create("div","maplibregl-control-container mapboxgl-control-container",s),y=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(g){y[g]=G.create("div","maplibregl-ctrl-"+g+" mapboxgl-ctrl-"+g,d)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},a.prototype._resizeCanvas=function(s,p){var f=l.browser.devicePixelRatio||1;this._canvas.width=f*s,this._canvas.height=f*p,this._canvas.style.width=s+"px",this._canvas.style.height=p+"px"},a.prototype._setupPainter=function(){var s=l.extend({},Ut.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),p=this._canvas.getContext("webgl",s)||this._canvas.getContext("experimental-webgl",s);p?(this.painter=new Dr(p,this.transform),l.webpSupported.testSupport(p)):this.fire(new l.ErrorEvent(new Error("Failed to initialize WebGL")))},a.prototype._contextLost=function(s){s.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new l.Event("webglcontextlost",{originalEvent:s}))},a.prototype._contextRestored=function(s){this._setupPainter(),this.resize(),this._update(),this.fire(new l.Event("webglcontextrestored",{originalEvent:s}))},a.prototype._onMapScroll=function(s){if(s.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},a.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},a.prototype._update=function(s){return this.style?(this._styleDirty=this._styleDirty||s,this._sourcesDirty=!0,this.triggerRepaint(),this):this},a.prototype._requestRenderFrame=function(s){return this._update(),this._renderTaskQueue.add(s)},a.prototype._cancelRenderFrame=function(s){this._renderTaskQueue.remove(s)},a.prototype._render=function(s){var p,f=this,d=0,y=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(p=y.createQueryEXT(),y.beginQueryEXT(y.TIME_ELAPSED_EXT,p),d=l.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(s),!this._removed){var g=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var S=this.transform.zoom,I=l.browser.now();this.style.zoomHistory.update(S,I);var P=new l.EvaluationParameters(S,{now:I,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),A=P.crossFadingFactor();A===1&&A===this._crossFadingFactor||(g=!0,this._crossFadingFactor=A),this.style.update(P)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new l.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new l.Event("load"))),this.style&&(this.style.hasTransitions()||g)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var B=l.browser.now()-d;y.endQueryEXT(y.TIME_ELAPSED_EXT,p),setTimeout(function(){var L=y.getQueryObjectEXT(p,y.QUERY_RESULT_EXT)/1e6;y.deleteQueryEXT(p),f.fire(new l.Event("gpu-timing-frame",{cpuTime:B,gpuTime:L}))},50)}if(this.listens("gpu-timing-layer")){var R=this.painter.collectGpuTimers();setTimeout(function(){var L=f.painter.queryGpuTimers(R);f.fire(new l.Event("gpu-timing-layer",{layerTimes:L}))},50)}var N=this._sourcesDirty||this._styleDirty||this._placementDirty;return N||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new l.Event("idle")),!this._loaded||this._fullyLoaded||N||(this._fullyLoaded=!0),this}},a.prototype.remove=function(){this._hash&&this._hash.remove();for(var s=0,p=this._controls;s<p.length;s+=1)p[s].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),l.window!==void 0&&(l.window.removeEventListener("resize",this._onWindowResize,!1),l.window.removeEventListener("orientationchange",this._onWindowResize,!1),l.window.removeEventListener("online",this._onWindowOnline,!1));var f=this.painter.context.gl.getExtension("WEBGL_lose_context");f&&f.loseContext(),ja(this._canvasContainer),ja(this._controlContainer),this._container.classList.remove("maplibregl-map","mapboxgl-map"),this._removed=!0,this.fire(new l.Event("remove"))},a.prototype.triggerRepaint=function(){var s=this;this.style&&!this._frame&&(this._frame=l.browser.frame(function(p){s._frame=null,s._render(p)}))},a.prototype._onWindowOnline=function(){this._update()},a.prototype._onWindowResize=function(s){this._trackResize&&this.resize({originalEvent:s})._update()},n.showTileBoundaries.get=function(){return!!this._showTileBoundaries},n.showTileBoundaries.set=function(s){this._showTileBoundaries!==s&&(this._showTileBoundaries=s,this._update())},n.showPadding.get=function(){return!!this._showPadding},n.showPadding.set=function(s){this._showPadding!==s&&(this._showPadding=s,this._update())},n.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},n.showCollisionBoxes.set=function(s){this._showCollisionBoxes!==s&&(this._showCollisionBoxes=s,s?this.style._generateCollisionBoxes():this._update())},n.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},n.showOverdrawInspector.set=function(s){this._showOverdrawInspector!==s&&(this._showOverdrawInspector=s,this._update())},n.repaint.get=function(){return!!this._repaint},n.repaint.set=function(s){this._repaint!==s&&(this._repaint=s,this.triggerRepaint())},n.vertices.get=function(){return!!this._vertices},n.vertices.set=function(s){this._vertices=s,this._update()},a.prototype._setCacheLimits=function(s,p){l.setCacheLimits(s,p)},n.version.get=function(){return l.version},Object.defineProperties(a.prototype,n),a}(De);function ja(i){i.parentNode&&i.parentNode.removeChild(i)}var Jo={showCompass:!0,showZoom:!0,visualizePitch:!1},fo=function(i){var a=this;this.options=l.extend({},Jo,i),this._container=G.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(n){return n.preventDefault()}),this.options.showZoom&&(l.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in mapboxgl-ctrl-zoom-in",function(n){return a._map.zoomIn({},{originalEvent:n})}),G.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out mapboxgl-ctrl-zoom-out",function(n){return a._map.zoomOut({},{originalEvent:n})}),G.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(l.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("maplibregl-ctrl-compass mapboxgl-ctrl-compass",function(n){a.options.visualizePitch?a._map.resetNorthPitch({},{originalEvent:n}):a._map.resetNorth({},{originalEvent:n})}),this._compassIcon=G.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};fo.prototype._updateZoomButtons=function(){var i=this._map.getZoom(),a=i===this._map.getMaxZoom(),n=i===this._map.getMinZoom();this._zoomInButton.disabled=a,this._zoomOutButton.disabled=n,this._zoomInButton.setAttribute("aria-disabled",a.toString()),this._zoomOutButton.setAttribute("aria-disabled",n.toString())},fo.prototype._rotateCompassArrow=function(){var i=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=i},fo.prototype.onAdd=function(i){return this._map=i,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Gn(this._map,this._compass,this.options.visualizePitch)),this._container},fo.prototype.onRemove=function(){G.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},fo.prototype._createButton=function(i,a){var n=G.create("button",i,this._container);return n.type="button",n.addEventListener("click",a),n},fo.prototype._setButtonTitle=function(i,a){var n=this._map._getUIString("NavigationControl."+a);i.title=n,i.setAttribute("aria-label",n)};var Gn=function(i,a,n){n===void 0&&(n=!1),this._clickTolerance=10,this.element=a,this.mouseRotate=new Us({clickTolerance:i.dragRotate._mouseRotate._clickTolerance}),this.map=i,n&&(this.mousePitch=new ol({clickTolerance:i.dragRotate._mousePitch._clickTolerance})),l.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),G.addEventListener(a,"mousedown",this.mousedown),G.addEventListener(a,"touchstart",this.touchstart,{passive:!1}),G.addEventListener(a,"touchmove",this.touchmove),G.addEventListener(a,"touchend",this.touchend),G.addEventListener(a,"touchcancel",this.reset)};function Qa(i,a,n){if(i=new l.LngLat(i.lng,i.lat),a){var s=new l.LngLat(i.lng-360,i.lat),p=new l.LngLat(i.lng+360,i.lat),f=n.locationPoint(i).distSqr(a);n.locationPoint(s).distSqr(a)<f?i=s:n.locationPoint(p).distSqr(a)<f&&(i=p)}for(;Math.abs(i.lng-n.center.lng)>180;){var d=n.locationPoint(i);if(d.x>=0&&d.y>=0&&d.x<=n.width&&d.y<=n.height)break;i.lng>n.center.lng?i.lng-=360:i.lng+=360}return i}Gn.prototype.down=function(i,a){this.mouseRotate.mousedown(i,a),this.mousePitch&&this.mousePitch.mousedown(i,a),G.disableDrag()},Gn.prototype.move=function(i,a){var n=this.map,s=this.mouseRotate.mousemoveWindow(i,a);if(s&&s.bearingDelta&&n.setBearing(n.getBearing()+s.bearingDelta),this.mousePitch){var p=this.mousePitch.mousemoveWindow(i,a);p&&p.pitchDelta&&n.setPitch(n.getPitch()+p.pitchDelta)}},Gn.prototype.off=function(){var i=this.element;G.removeEventListener(i,"mousedown",this.mousedown),G.removeEventListener(i,"touchstart",this.touchstart,{passive:!1}),G.removeEventListener(i,"touchmove",this.touchmove),G.removeEventListener(i,"touchend",this.touchend),G.removeEventListener(i,"touchcancel",this.reset),this.offTemp()},Gn.prototype.offTemp=function(){G.enableDrag(),G.removeEventListener(l.window,"mousemove",this.mousemove),G.removeEventListener(l.window,"mouseup",this.mouseup)},Gn.prototype.mousedown=function(i){this.down(l.extend({},i,{ctrlKey:!0,preventDefault:function(){return i.preventDefault()}}),G.mousePos(this.element,i)),G.addEventListener(l.window,"mousemove",this.mousemove),G.addEventListener(l.window,"mouseup",this.mouseup)},Gn.prototype.mousemove=function(i){this.move(i,G.mousePos(this.element,i))},Gn.prototype.mouseup=function(i){this.mouseRotate.mouseupWindow(i),this.mousePitch&&this.mousePitch.mouseupWindow(i),this.offTemp()},Gn.prototype.touchstart=function(i){i.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=G.touchPos(this.element,i.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return i.preventDefault()}},this._startPos))},Gn.prototype.touchmove=function(i){i.targetTouches.length!==1?this.reset():(this._lastPos=G.touchPos(this.element,i.targetTouches)[0],this.move({preventDefault:function(){return i.preventDefault()}},this._lastPos))},Gn.prototype.touchend=function(i){i.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},Gn.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var Hi={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function $r(i,a,n){var s=i.classList;for(var p in Hi)s.remove("maplibregl-"+n+"-anchor-"+p,"mapboxgl-"+n+"-anchor-"+p);s.add("maplibregl-"+n+"-anchor-"+a,"mapboxgl-"+n+"-anchor-"+a)}var Ui,On=function(i){function a(n,s){if(i.call(this),(n instanceof l.window.HTMLElement||s)&&(n=l.extend({element:n},s)),l.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=n&&n.anchor||"center",this._color=n&&n.color||"#3FB1CE",this._scale=n&&n.scale||1,this._draggable=n&&n.draggable||!1,this._clickTolerance=n&&n.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=n&&n.rotation||0,this._rotationAlignment=n&&n.rotationAlignment||"auto",this._pitchAlignment=n&&n.pitchAlignment&&n.pitchAlignment!=="auto"?n.pitchAlignment:this._rotationAlignment,n&&n.element)this._element=n.element,this._offset=l.Point.convert(n&&n.offset||[0,0]);else{this._defaultMarker=!0,this._element=G.create("div"),this._element.setAttribute("aria-label","Map marker");var p=G.createNS("http://www.w3.org/2000/svg","svg");p.setAttributeNS(null,"display","block"),p.setAttributeNS(null,"height","41px"),p.setAttributeNS(null,"width","27px"),p.setAttributeNS(null,"viewBox","0 0 27 41");var f=G.createNS("http://www.w3.org/2000/svg","g");f.setAttributeNS(null,"stroke","none"),f.setAttributeNS(null,"stroke-width","1"),f.setAttributeNS(null,"fill","none"),f.setAttributeNS(null,"fill-rule","evenodd");var d=G.createNS("http://www.w3.org/2000/svg","g");d.setAttributeNS(null,"fill-rule","nonzero");var y=G.createNS("http://www.w3.org/2000/svg","g");y.setAttributeNS(null,"transform","translate(3.0, 29.0)"),y.setAttributeNS(null,"fill","#000000");for(var g=0,S=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];g<S.length;g+=1){var I=S[g],P=G.createNS("http://www.w3.org/2000/svg","ellipse");P.setAttributeNS(null,"opacity","0.04"),P.setAttributeNS(null,"cx","10.5"),P.setAttributeNS(null,"cy","5.80029008"),P.setAttributeNS(null,"rx",I.rx),P.setAttributeNS(null,"ry",I.ry),y.appendChild(P)}var A=G.createNS("http://www.w3.org/2000/svg","g");A.setAttributeNS(null,"fill",this._color);var B=G.createNS("http://www.w3.org/2000/svg","path");B.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),A.appendChild(B);var R=G.createNS("http://www.w3.org/2000/svg","g");R.setAttributeNS(null,"opacity","0.25"),R.setAttributeNS(null,"fill","#000000");var N=G.createNS("http://www.w3.org/2000/svg","path");N.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),R.appendChild(N);var L=G.createNS("http://www.w3.org/2000/svg","g");L.setAttributeNS(null,"transform","translate(6.0, 7.0)"),L.setAttributeNS(null,"fill","#FFFFFF");var q=G.createNS("http://www.w3.org/2000/svg","g");q.setAttributeNS(null,"transform","translate(8.0, 8.0)");var X=G.createNS("http://www.w3.org/2000/svg","circle");X.setAttributeNS(null,"fill","#000000"),X.setAttributeNS(null,"opacity","0.25"),X.setAttributeNS(null,"cx","5.5"),X.setAttributeNS(null,"cy","5.5"),X.setAttributeNS(null,"r","5.4999962");var rt=G.createNS("http://www.w3.org/2000/svg","circle");rt.setAttributeNS(null,"fill","#FFFFFF"),rt.setAttributeNS(null,"cx","5.5"),rt.setAttributeNS(null,"cy","5.5"),rt.setAttributeNS(null,"r","5.4999962"),q.appendChild(X),q.appendChild(rt),d.appendChild(y),d.appendChild(A),d.appendChild(R),d.appendChild(L),d.appendChild(q),p.appendChild(d),p.setAttributeNS(null,"height",41*this._scale+"px"),p.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(p),this._offset=l.Point.convert(n&&n.offset||[0,-14])}this._element.classList.add("maplibregl-marker","mapboxgl-marker"),this._element.addEventListener("dragstart",function(ct){ct.preventDefault()}),this._element.addEventListener("mousedown",function(ct){ct.preventDefault()}),$r(this._element,this._anchor,"marker"),this._popup=null}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.addTo=function(n){return this.remove(),this._map=n,n.getCanvasContainer().appendChild(this._element),n.on("move",this._update),n.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},a.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),G.remove(this._element),this._popup&&this._popup.remove(),this},a.prototype.getLngLat=function(){return this._lngLat},a.prototype.setLngLat=function(n){return this._lngLat=l.LngLat.convert(n),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},a.prototype.getElement=function(){return this._element},a.prototype.setPopup=function(n){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),n){if(!("offset"in n.options)){var s=Math.sqrt(Math.pow(13.5,2)/2);n.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[s,-1*(24.6+s)],"bottom-right":[-s,-1*(24.6+s)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=n,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},a.prototype._onKeyPress=function(n){var s=n.code,p=n.charCode||n.keyCode;s!=="Space"&&s!=="Enter"&&p!==32&&p!==13||this.togglePopup()},a.prototype._onMapClick=function(n){var s=n.originalEvent.target,p=this._element;this._popup&&(s===p||p.contains(s))&&this.togglePopup()},a.prototype.getPopup=function(){return this._popup},a.prototype.togglePopup=function(){var n=this._popup;return n?(n.isOpen()?n.remove():n.addTo(this._map),this):this},a.prototype._update=function(n){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=Qa(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var s="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?s="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(s="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var p="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?p="rotateX(0deg)":this._pitchAlignment==="map"&&(p="rotateX("+this._map.getPitch()+"deg)"),n&&n.type!=="moveend"||(this._pos=this._pos.round()),G.setTransform(this._element,Hi[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+p+" "+s)}},a.prototype.getOffset=function(){return this._offset},a.prototype.setOffset=function(n){return this._offset=l.Point.convert(n),this._update(),this},a.prototype._onMove=function(n){if(!this._isDragging){var s=this._clickTolerance||this._map._clickTolerance;this._isDragging=n.point.dist(this._pointerdownPos)>=s}this._isDragging&&(this._pos=n.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new l.Event("dragstart"))),this.fire(new l.Event("drag")))},a.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new l.Event("dragend")),this._state="inactive"},a.prototype._addDragHandler=function(n){this._element.contains(n.originalEvent.target)&&(n.preventDefault(),this._positionDelta=n.point.sub(this._pos).add(this._offset),this._pointerdownPos=n.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},a.prototype.setDraggable=function(n){return this._draggable=!!n,this._map&&(n?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},a.prototype.isDraggable=function(){return this._draggable},a.prototype.setRotation=function(n){return this._rotation=n||0,this._update(),this},a.prototype.getRotation=function(){return this._rotation},a.prototype.setRotationAlignment=function(n){return this._rotationAlignment=n||"auto",this._update(),this},a.prototype.getRotationAlignment=function(){return this._rotationAlignment},a.prototype.setPitchAlignment=function(n){return this._pitchAlignment=n&&n!=="auto"?n:this._rotationAlignment,this._update(),this},a.prototype.getPitchAlignment=function(){return this._pitchAlignment},a}(l.Evented),qa={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},$a=0,ko=!1,V=function(i){function a(n){i.call(this),this.options=l.extend({},qa,n),l.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.onAdd=function(n){var s;return this._map=n,this._container=G.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),s=this._setupUI,Ui!==void 0?s(Ui):l.window.navigator.permissions!==void 0?l.window.navigator.permissions.query({name:"geolocation"}).then(function(p){s(Ui=p.state!=="denied")}):s(Ui=!!l.window.navigator.geolocation),this._container},a.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(l.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),G.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,$a=0,ko=!1},a.prototype._isOutOfMapMaxBounds=function(n){var s=this._map.getMaxBounds(),p=n.coords;return s&&(p.longitude<s.getWest()||p.longitude>s.getEast()||p.latitude<s.getSouth()||p.latitude>s.getNorth())},a.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting")}},a.prototype._onSuccess=function(n){if(this._map){if(this._isOutOfMapMaxBounds(n))return this._setErrorState(),this.fire(new l.Event("outofmaxbounds",n)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=n,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(n),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(n),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new l.Event("geolocate",n)),this._finish()}},a.prototype._updateCamera=function(n){var s=new l.LngLat(n.coords.longitude,n.coords.latitude),p=n.coords.accuracy,f=this._map.getBearing(),d=l.extend({bearing:f},this.options.fitBoundsOptions);this._map.fitBounds(s.toBounds(p),d,{geolocateSource:!0})},a.prototype._updateMarker=function(n){if(n){var s=new l.LngLat(n.coords.longitude,n.coords.latitude);this._accuracyCircleMarker.setLngLat(s).addTo(this._map),this._userLocationDotMarker.setLngLat(s).addTo(this._map),this._accuracy=n.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},a.prototype._updateCircleRadius=function(){var n=this._map._container.clientHeight/2,s=this._map.unproject([0,n]),p=this._map.unproject([1,n]),f=s.distanceTo(p),d=Math.ceil(2*this._accuracy/f);this._circleElement.style.width=d+"px",this._circleElement.style.height=d+"px"},a.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},a.prototype._onError=function(n){if(this._map){if(this.options.trackUserLocation)if(n.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=s,this._geolocateButton.setAttribute("aria-label",s),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(n.code===3&&ko)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new l.Event("error",n)),this._finish()}},a.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},a.prototype._setupUI=function(n){var s=this;if(this._container.addEventListener("contextmenu",function(d){return d.preventDefault()}),this._geolocateButton=G.create("button","maplibregl-ctrl-geolocate mapboxgl-ctrl-geolocate",this._container),G.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",n===!1){l.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var p=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=p,this._geolocateButton.setAttribute("aria-label",p)}else{var f=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=f,this._geolocateButton.setAttribute("aria-label",f)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=G.create("div","maplibregl-user-location-dot mapboxgl-user-location-dot"),this._userLocationDotMarker=new On(this._dotElement),this._circleElement=G.create("div","maplibregl-user-location-accuracy-circle mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new On({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(d){d.geolocateSource||s._watchState!=="ACTIVE_LOCK"||d.originalEvent&&d.originalEvent.type==="resize"||(s._watchState="BACKGROUND",s._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),s._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),s.fire(new l.Event("trackuserlocationend")))})},a.prototype.trigger=function(){if(!this._setup)return l.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new l.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":$a--,ko=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this.fire(new l.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new l.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var n;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++$a>1?(n={maximumAge:6e5,timeout:0},ko=!0):(n=this.options.positionOptions,ko=!1),this._geolocationWatchID=l.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,n)}}else l.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},a.prototype._clearWatch=function(){l.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},a}(l.Evented),Q={maxWidth:100,unit:"metric"},nt=function(i){this.options=l.extend({},Q,i),l.bindAll(["_onMove","setUnit"],this)};function pt(i,a,n){var s=n&&n.maxWidth||100,p=i._container.clientHeight/2,f=i.unproject([0,p]),d=i.unproject([s,p]),y=f.distanceTo(d);if(n&&n.unit==="imperial"){var g=3.2808*y;g>5280?xt(a,s,g/5280,i._getUIString("ScaleControl.Miles")):xt(a,s,g,i._getUIString("ScaleControl.Feet"))}else n&&n.unit==="nautical"?xt(a,s,y/1852,i._getUIString("ScaleControl.NauticalMiles")):y>=1e3?xt(a,s,y/1e3,i._getUIString("ScaleControl.Kilometers")):xt(a,s,y,i._getUIString("ScaleControl.Meters"))}function xt(i,a,n,s){var p,f,d,y=(p=n,(f=Math.pow(10,(""+Math.floor(p)).length-1))*(d=(d=p/f)>=10?10:d>=5?5:d>=3?3:d>=2?2:d>=1?1:function(g){var S=Math.pow(10,Math.ceil(-Math.log(g)/Math.LN10));return Math.round(g*S)/S}(d)));i.style.width=a*(y/n)+"px",i.innerHTML=y+"&nbsp;"+s}nt.prototype.getDefaultPosition=function(){return"bottom-left"},nt.prototype._onMove=function(){pt(this._map,this._container,this.options)},nt.prototype.onAdd=function(i){return this._map=i,this._container=G.create("div","maplibregl-ctrl maplibregl-ctrl-scale mapboxgl-ctrl mapboxgl-ctrl-scale",i.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},nt.prototype.onRemove=function(){G.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},nt.prototype.setUnit=function(i){this.options.unit=i,pt(this._map,this._container,this.options)};var Tt=function(i){this._fullscreen=!1,i&&i.container&&(i.container instanceof l.window.HTMLElement?this._container=i.container:l.warnOnce("Full screen control 'container' must be a DOM element.")),l.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in l.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in l.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in l.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in l.window.document&&(this._fullscreenchange="MSFullscreenChange")};Tt.prototype.onAdd=function(i){return this._map=i,this._container||(this._container=this._map.getContainer()),this._controlContainer=G.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",l.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},Tt.prototype.onRemove=function(){G.remove(this._controlContainer),this._map=null,l.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},Tt.prototype._checkFullscreenSupport=function(){return!!(l.window.document.fullscreenEnabled||l.window.document.mozFullScreenEnabled||l.window.document.msFullscreenEnabled||l.window.document.webkitFullscreenEnabled)},Tt.prototype._setupUI=function(){var i=this._fullscreenButton=G.create("button","maplibregl-ctrl-fullscreen mapboxgl-ctrl-fullscreen",this._controlContainer);G.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",i).setAttribute("aria-hidden",!0),i.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),l.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},Tt.prototype._updateTitle=function(){var i=this._getTitle();this._fullscreenButton.setAttribute("aria-label",i),this._fullscreenButton.title=i},Tt.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},Tt.prototype._isFullscreen=function(){return this._fullscreen},Tt.prototype._changeIcon=function(){(l.window.document.fullscreenElement||l.window.document.mozFullScreenElement||l.window.document.webkitFullscreenElement||l.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},Tt.prototype._onClickFullscreen=function(){this._isFullscreen()?l.window.document.exitFullscreen?l.window.document.exitFullscreen():l.window.document.mozCancelFullScreen?l.window.document.mozCancelFullScreen():l.window.document.msExitFullscreen?l.window.document.msExitFullscreen():l.window.document.webkitCancelFullScreen&&l.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var Rt={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},te=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),Ht=function(i){function a(n){i.call(this),this.options=l.extend(Object.create(Rt),n),l.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return i&&(a.__proto__=i),(a.prototype=Object.create(i&&i.prototype)).constructor=a,a.prototype.addTo=function(n){return this._map&&this.remove(),this._map=n,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new l.Event("open")),this},a.prototype.isOpen=function(){return!!this._map},a.prototype.remove=function(){return this._content&&G.remove(this._content),this._container&&(G.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new l.Event("close")),this},a.prototype.getLngLat=function(){return this._lngLat},a.prototype.setLngLat=function(n){return this._lngLat=l.LngLat.convert(n),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer","mapboxgl-track-pointer")),this},a.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")),this},a.prototype.getElement=function(){return this._container},a.prototype.setText=function(n){return this.setDOMContent(l.window.document.createTextNode(n))},a.prototype.setHTML=function(n){var s,p=l.window.document.createDocumentFragment(),f=l.window.document.createElement("body");for(f.innerHTML=n;s=f.firstChild;)p.appendChild(s);return this.setDOMContent(p)},a.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},a.prototype.setMaxWidth=function(n){return this.options.maxWidth=n,this._update(),this},a.prototype.setDOMContent=function(n){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=G.create("div","maplibregl-popup-content mapboxgl-popup-content",this._container);return this._content.appendChild(n),this._createCloseButton(),this._update(),this._focusFirstElement(),this},a.prototype.addClassName=function(n){this._container&&this._container.classList.add(n)},a.prototype.removeClassName=function(n){this._container&&this._container.classList.remove(n)},a.prototype.setOffset=function(n){return this.options.offset=n,this._update(),this},a.prototype.toggleClassName=function(n){if(this._container)return this._container.classList.toggle(n)},a.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=G.create("button","maplibregl-popup-close-button mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},a.prototype._onMouseUp=function(n){this._update(n.point)},a.prototype._onMouseMove=function(n){this._update(n.point)},a.prototype._onDrag=function(n){this._update(n.point)},a.prototype._update=function(n){var s=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=G.create("div","maplibregl-popup mapboxgl-popup",this._map.getContainer()),this._tip=G.create("div","maplibregl-popup-tip mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(P){return s._container.classList.add(P)}),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Qa(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||n)){var p=this._pos=this._trackPointer&&n?n:this._map.project(this._lngLat),f=this.options.anchor,d=function P(A){if(A){if(typeof A=="number"){var B=Math.round(Math.sqrt(.5*Math.pow(A,2)));return{center:new l.Point(0,0),top:new l.Point(0,A),"top-left":new l.Point(B,B),"top-right":new l.Point(-B,B),bottom:new l.Point(0,-A),"bottom-left":new l.Point(B,-B),"bottom-right":new l.Point(-B,-B),left:new l.Point(A,0),right:new l.Point(-A,0)}}if(A instanceof l.Point||Array.isArray(A)){var R=l.Point.convert(A);return{center:R,top:R,"top-left":R,"top-right":R,bottom:R,"bottom-left":R,"bottom-right":R,left:R,right:R}}return{center:l.Point.convert(A.center||[0,0]),top:l.Point.convert(A.top||[0,0]),"top-left":l.Point.convert(A["top-left"]||[0,0]),"top-right":l.Point.convert(A["top-right"]||[0,0]),bottom:l.Point.convert(A.bottom||[0,0]),"bottom-left":l.Point.convert(A["bottom-left"]||[0,0]),"bottom-right":l.Point.convert(A["bottom-right"]||[0,0]),left:l.Point.convert(A.left||[0,0]),right:l.Point.convert(A.right||[0,0])}}return P(new l.Point(0,0))}(this.options.offset);if(!f){var y,g=this._container.offsetWidth,S=this._container.offsetHeight;y=p.y+d.bottom.y<S?["top"]:p.y>this._map.transform.height-S?["bottom"]:[],p.x<g/2?y.push("left"):p.x>this._map.transform.width-g/2&&y.push("right"),f=y.length===0?"bottom":y.join("-")}var I=p.add(d[f]).round();G.setTransform(this._container,Hi[f]+" translate("+I.x+"px,"+I.y+"px)"),$r(this._container,f,"popup")}},a.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var n=this._container.querySelector(te);n&&n.focus()}},a.prototype._onClose=function(){this.remove()},a}(l.Evented),ne={version:l.version,supported:Ut,setRTLTextPlugin:l.setRTLTextPlugin,getRTLTextPluginStatus:l.getRTLTextPluginStatus,Map:Nr,NavigationControl:fo,GeolocateControl:V,AttributionControl:Zn,ScaleControl:nt,FullscreenControl:Tt,Popup:Ht,Marker:On,Style:lo,LngLat:l.LngLat,LngLatBounds:l.LngLatBounds,Point:l.Point,MercatorCoordinate:l.MercatorCoordinate,Evented:l.Evented,config:l.config,prewarm:function(){me().acquire(lt)},clearPrewarmedResources:function(){var i=Xt;i&&(i.isPreloaded()&&i.numActive()===1?(i.release(lt),Xt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return l.config.ACCESS_TOKEN},set accessToken(i){l.config.ACCESS_TOKEN=i},get baseApiUrl(){return l.config.API_URL},set baseApiUrl(i){l.config.API_URL=i},get workerCount(){return It.workerCount},set workerCount(i){It.workerCount=i},get maxParallelImageRequests(){return l.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(i){l.config.MAX_PARALLEL_IMAGE_REQUESTS=i},clearStorage:function(i){l.clearTileCache(i)},workerUrl:"",addProtocol:function(i,a){l.config.REGISTERED_PROTOCOLS[i]=a},removeProtocol:function(i){delete l.config.REGISTERED_PROTOCOLS[i]}};return ne}),Yt})})(Wd);function Mm(D){return 1-Math.sqrt(1-D*D)}function Dm(D){return Math.sqrt(1- --D*D)}function Xd(D){return D<.5?4*D*D*D:.5*Math.pow(2*D-2,3)+1}function pf(D){const Y=D-1;return Y*Y*Y+1}function Lm(D){return D===1?D:1-Math.pow(2,-10*D)}function Rm(D,{delay:Y=0,duration:ut=400,easing:gt=Tp}={}){const Yt=+getComputedStyle(D).opacity;return{delay:Y,duration:ut,easing:gt,css:ht=>`opacity: ${ht*Yt}`}}function Bm(D,{delay:Y=0,duration:ut=400,easing:gt=pf,x:Yt=0,y:ht=0,opacity:l=0}={}){const Ut=getComputedStyle(D),G=+Ut.opacity,St=Ut.transform==="none"?"":Ut.transform,Vt=G*(1-l);return{delay:Y,duration:ut,easing:gt,css:(We,vt)=>`
			transform: ${St} translate(${(1-We)*Yt}px, ${(1-We)*ht}px);
			opacity: ${G-Vt*vt}`}}function Om(D,{delay:Y=0,duration:ut=400,easing:gt=pf,start:Yt=0,opacity:ht=0}={}){const l=getComputedStyle(D),Ut=+l.opacity,G=l.transform==="none"?"":l.transform,St=1-Yt,Vt=Ut*(1-ht);return{delay:Y,duration:ut,easing:gt,css:(We,vt)=>`
			transform: ${G} scale(${1-St*vt});
			opacity: ${Ut-Vt*vt}
		`}}function Fm(D,{delay:Y=0,speed:ut,duration:gt,easing:Yt=Xd}={}){let ht=D.getTotalLength();const l=getComputedStyle(D);return l.strokeLinecap!=="butt"&&(ht+=parseInt(l.strokeWidth)),gt===void 0?ut===void 0?gt=800:gt=ht/ut:typeof gt=="function"&&(gt=gt(ht)),{delay:Y,duration:gt,easing:Yt,css:(Ut,G)=>`stroke-dasharray: ${Ut*ht} ${G*ht}`}}var hf={exports:{}};/*!
 * OverlayScrollbars
 * https://github.com/KingSora/OverlayScrollbars
 *
 * Version: 1.13.0
 *
 * Copyright KingSora | Rene Haas.
 * https://github.com/KingSora
 *
 * Released under the MIT license.
 * Date: 02.08.2020
 */(function(D){(function(Y,ut){D.exports=ut(Y,Y.document,void 0)})(typeof window!="undefined"?window:cf,function(Y,ut,gt){var Yt="OverlayScrollbars",ht={o:"object",f:"function",a:"array",s:"string",b:"boolean",n:"number",u:"undefined",z:"null"},l={c:"class",s:"style",i:"id",l:"length",p:"prototype",ti:"tabindex",oH:"offsetHeight",cH:"clientHeight",sH:"scrollHeight",oW:"offsetWidth",cW:"clientWidth",sW:"scrollWidth",hOP:"hasOwnProperty",bCR:"getBoundingClientRect"},Ut=function(){var Bt={},Lt={},Z=["-webkit-","-moz-","-o-","-ms-"],bt=["WebKit","Moz","O","MS"];function wt(At){return At.charAt(0).toUpperCase()+At.slice(1)}return{_cssPrefixes:Z,_jsPrefixes:bt,_cssProperty:function(At){var ue=Lt[At];if(Lt[l.hOP](At))return ue;for(var pr=wt(At),sr=ut.createElement("div")[l.s],he,Te=0,_r,ze;Te<Z.length;Te++)for(ze=Z[Te].replace(/-/g,""),he=[At,Z[Te]+At,ze+pr,wt(ze)+pr],_r=0;_r<he[l.l];_r++)if(sr[he[_r]]!==gt){ue=he[_r];break}return Lt[At]=ue,ue},_cssPropertyValue:function(At,ue,pr){var sr=At+" "+ue,he=Lt[sr];if(Lt[l.hOP](sr))return he;for(var Te=ut.createElement("div")[l.s],_r=ue.split(" "),ze=pr||"",Jr=0,Gt=-1,ke;Jr<_r[l.l];Jr++)for(;Gt<Ut._cssPrefixes[l.l];Gt++)if(ke=Gt<0?_r[Jr]:Ut._cssPrefixes[Gt]+_r[Jr],Te.cssText=At+":"+ke+ze,Te[l.l]){he=ke;break}return Lt[sr]=he,he},_jsAPI:function(At,ue,pr){var sr=0,he=Bt[At];if(!Bt[l.hOP](At)){for(he=Y[At];sr<bt[l.l];sr++)he=he||Y[(ue?bt[sr]:bt[sr].toLowerCase())+wt(At)];Bt[At]=he}return he||pr}}}(),G=function(){function Bt(Z){return Z?Y.innerWidth||ut.documentElement[l.cW]||ut.body[l.cW]:Y.innerHeight||ut.documentElement[l.cH]||ut.body[l.cH]}function Lt(Z,bt){if(typeof Z!=ht.f)throw"Can't bind function!";var wt=l.p,At=Array[wt].slice.call(arguments,2),ue=function(){},pr=function(){return Z.apply(this instanceof ue?this:bt,At.concat(Array[wt].slice.call(arguments)))};return Z[wt]&&(ue[wt]=Z[wt]),pr[wt]=new ue,pr}return{wW:Lt(Bt,0,!0),wH:Lt(Bt,0),mO:Lt(Ut._jsAPI,0,"MutationObserver",!0),rO:Lt(Ut._jsAPI,0,"ResizeObserver",!0),rAF:Lt(Ut._jsAPI,0,"requestAnimationFrame",!1,function(Z){return Y.setTimeout(Z,1e3/60)}),cAF:Lt(Ut._jsAPI,0,"cancelAnimationFrame",!1,function(Z){return Y.clearTimeout(Z)}),now:function(){return Date.now&&Date.now()||new Date().getTime()},stpP:function(Z){Z.stopPropagation?Z.stopPropagation():Z.cancelBubble=!0},prvD:function(Z){Z.preventDefault&&Z.cancelable?Z.preventDefault():Z.returnValue=!1},page:function(Z){Z=Z.originalEvent||Z;var bt="page",wt="client",At="X",ue="Y",pr=Z.target||Z.srcElement||ut,sr=pr.ownerDocument||ut,he=sr.documentElement,Te=sr.body;if(Z.touches!==gt){var _r=Z.touches[0];return{x:_r[bt+At],y:_r[bt+ue]}}return!Z[bt+At]&&Z[wt+At]&&Z[wt+At]!=null?{x:Z[wt+At]+(he&&he.scrollLeft||Te&&Te.scrollLeft||0)-(he&&he.clientLeft||Te&&Te.clientLeft||0),y:Z[wt+ue]+(he&&he.scrollTop||Te&&Te.scrollTop||0)-(he&&he.clientTop||Te&&Te.clientTop||0)}:{x:Z[bt+At],y:Z[bt+ue]}},mBtn:function(Z){var bt=Z.button;return!Z.which&&bt!==gt?bt&1?1:bt&2?3:bt&4?2:0:Z.which},inA:function(Z,bt){for(var wt=0;wt<bt[l.l];wt++)try{if(bt[wt]===Z)return wt}catch{}return-1},isA:function(Z){var bt=Array.isArray;return bt?bt(Z):this.type(Z)==ht.a},type:function(Z){return Z===gt||Z===null?Z+"":Object[l.p].toString.call(Z).replace(/^\[object (.+)\]$/,"$1").toLowerCase()},bind:Lt}}(),St=Math,Vt=Y.jQuery,We=function(){var Bt={p:St.PI,c:St.cos,s:St.sin,w:St.pow,t:St.sqrt,n:St.asin,a:St.abs,o:1.70158};return{swing:function(Lt,Z,bt,wt,At){return .5-Bt.c(Lt*Bt.p)/2},linear:function(Lt,Z,bt,wt,At){return Lt},easeInQuad:function(Lt,Z,bt,wt,At){return wt*(Z/=At)*Z+bt},easeOutQuad:function(Lt,Z,bt,wt,At){return-wt*(Z/=At)*(Z-2)+bt},easeInOutQuad:function(Lt,Z,bt,wt,At){return(Z/=At/2)<1?wt/2*Z*Z+bt:-wt/2*(--Z*(Z-2)-1)+bt},easeInCubic:function(Lt,Z,bt,wt,At){return wt*(Z/=At)*Z*Z+bt},easeOutCubic:function(Lt,Z,bt,wt,At){return wt*((Z=Z/At-1)*Z*Z+1)+bt},easeInOutCubic:function(Lt,Z,bt,wt,At){return(Z/=At/2)<1?wt/2*Z*Z*Z+bt:wt/2*((Z-=2)*Z*Z+2)+bt},easeInQuart:function(Lt,Z,bt,wt,At){return wt*(Z/=At)*Z*Z*Z+bt},easeOutQuart:function(Lt,Z,bt,wt,At){return-wt*((Z=Z/At-1)*Z*Z*Z-1)+bt},easeInOutQuart:function(Lt,Z,bt,wt,At){return(Z/=At/2)<1?wt/2*Z*Z*Z*Z+bt:-wt/2*((Z-=2)*Z*Z*Z-2)+bt},easeInQuint:function(Lt,Z,bt,wt,At){return wt*(Z/=At)*Z*Z*Z*Z+bt},easeOutQuint:function(Lt,Z,bt,wt,At){return wt*((Z=Z/At-1)*Z*Z*Z*Z+1)+bt},easeInOutQuint:function(Lt,Z,bt,wt,At){return(Z/=At/2)<1?wt/2*Z*Z*Z*Z*Z+bt:wt/2*((Z-=2)*Z*Z*Z*Z+2)+bt},easeInSine:function(Lt,Z,bt,wt,At){return-wt*Bt.c(Z/At*(Bt.p/2))+wt+bt},easeOutSine:function(Lt,Z,bt,wt,At){return wt*Bt.s(Z/At*(Bt.p/2))+bt},easeInOutSine:function(Lt,Z,bt,wt,At){return-wt/2*(Bt.c(Bt.p*Z/At)-1)+bt},easeInExpo:function(Lt,Z,bt,wt,At){return Z==0?bt:wt*Bt.w(2,10*(Z/At-1))+bt},easeOutExpo:function(Lt,Z,bt,wt,At){return Z==At?bt+wt:wt*(-Bt.w(2,-10*Z/At)+1)+bt},easeInOutExpo:function(Lt,Z,bt,wt,At){return Z==0?bt:Z==At?bt+wt:(Z/=At/2)<1?wt/2*Bt.w(2,10*(Z-1))+bt:wt/2*(-Bt.w(2,-10*--Z)+2)+bt},easeInCirc:function(Lt,Z,bt,wt,At){return-wt*(Bt.t(1-(Z/=At)*Z)-1)+bt},easeOutCirc:function(Lt,Z,bt,wt,At){return wt*Bt.t(1-(Z=Z/At-1)*Z)+bt},easeInOutCirc:function(Lt,Z,bt,wt,At){return(Z/=At/2)<1?-wt/2*(Bt.t(1-Z*Z)-1)+bt:wt/2*(Bt.t(1-(Z-=2)*Z)+1)+bt},easeInElastic:function(Lt,Z,bt,wt,At){var ue=Bt.o,pr=0,sr=wt;return Z==0?bt:(Z/=At)==1?bt+wt:(pr||(pr=At*.3),sr<Bt.a(wt)?(sr=wt,ue=pr/4):ue=pr/(2*Bt.p)*Bt.n(wt/sr),-(sr*Bt.w(2,10*(Z-=1))*Bt.s((Z*At-ue)*(2*Bt.p)/pr))+bt)},easeOutElastic:function(Lt,Z,bt,wt,At){var ue=Bt.o,pr=0,sr=wt;return Z==0?bt:(Z/=At)==1?bt+wt:(pr||(pr=At*.3),sr<Bt.a(wt)?(sr=wt,ue=pr/4):ue=pr/(2*Bt.p)*Bt.n(wt/sr),sr*Bt.w(2,-10*Z)*Bt.s((Z*At-ue)*(2*Bt.p)/pr)+wt+bt)},easeInOutElastic:function(Lt,Z,bt,wt,At){var ue=Bt.o,pr=0,sr=wt;return Z==0?bt:(Z/=At/2)==2?bt+wt:(pr||(pr=At*(.3*1.5)),sr<Bt.a(wt)?(sr=wt,ue=pr/4):ue=pr/(2*Bt.p)*Bt.n(wt/sr),Z<1?-.5*(sr*Bt.w(2,10*(Z-=1))*Bt.s((Z*At-ue)*(2*Bt.p)/pr))+bt:sr*Bt.w(2,-10*(Z-=1))*Bt.s((Z*At-ue)*(2*Bt.p)/pr)*.5+wt+bt)},easeInBack:function(Lt,Z,bt,wt,At,ue){return ue=ue||Bt.o,wt*(Z/=At)*Z*((ue+1)*Z-ue)+bt},easeOutBack:function(Lt,Z,bt,wt,At,ue){return ue=ue||Bt.o,wt*((Z=Z/At-1)*Z*((ue+1)*Z+ue)+1)+bt},easeInOutBack:function(Lt,Z,bt,wt,At,ue){return ue=ue||Bt.o,(Z/=At/2)<1?wt/2*(Z*Z*(((ue*=1.525)+1)*Z-ue))+bt:wt/2*((Z-=2)*Z*(((ue*=1.525)+1)*Z+ue)+2)+bt},easeInBounce:function(Lt,Z,bt,wt,At){return wt-this.easeOutBounce(Lt,At-Z,0,wt,At)+bt},easeOutBounce:function(Lt,Z,bt,wt,At){var ue=7.5625;return(Z/=At)<1/2.75?wt*(ue*Z*Z)+bt:Z<2/2.75?wt*(ue*(Z-=1.5/2.75)*Z+.75)+bt:Z<2.5/2.75?wt*(ue*(Z-=2.25/2.75)*Z+.9375)+bt:wt*(ue*(Z-=2.625/2.75)*Z+.984375)+bt},easeInOutBounce:function(Lt,Z,bt,wt,At){return Z<At/2?this.easeInBounce(Lt,Z*2,0,wt,At)*.5+bt:this.easeOutBounce(Lt,Z*2-At,0,wt,At)*.5+wt*.5+bt}}}(),vt=function(){var Bt=/[^\x20\t\r\n\f]+/g,Lt=" ",Z="",bt="scrollLeft",wt="scrollTop",At=[],ue=G.type,pr={animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0};function sr(){var et,ft,it,_t,Et,de,Ee=arguments[0]||{},Fe=1,ee=arguments[l.l],Se=!1;for(ue(Ee)==ht.b&&(Se=Ee,Ee=arguments[1]||{},Fe=2),ue(Ee)!=ht.o&&!ue(Ee)==ht.f&&(Ee={}),ee===Fe&&(Ee=je,--Fe);Fe<ee;Fe++)if((Et=arguments[Fe])!=null)for(_t in Et)et=Ee[_t],it=Et[_t],Ee!==it&&(Se&&it&&(ze(it)||(ft=G.isA(it)))?(ft?(ft=!1,de=et&&G.isA(et)?et:[]):de=et&&ze(et)?et:{},Ee[_t]=sr(Se,de,it)):it!==gt&&(Ee[_t]=it));return Ee}function he(et,ft,it){for(var _t=it||0;_t<ft[l.l];_t++)if(ft[_t]===et)return _t;return-1}function Te(et){return ue(et)==ht.f}function _r(et){for(var ft in et)return!1;return!0}function ze(et){if(!et||ue(et)!=ht.o)return!1;var ft,it=l.p,_t=Object[it].hasOwnProperty,Et=_t.call(et,"constructor"),de=et.constructor&&et.constructor[it]&&_t.call(et.constructor[it],"isPrototypeOf");if(et.constructor&&!Et&&!de)return!1;for(ft in et);return ue(ft)==ht.u||_t.call(et,ft)}function Jr(et,ft){var it=0;if(Gt(et))for(;it<et[l.l]&&ft.call(et[it],it,et[it])!==!1;it++);else for(it in et)if(ft.call(et[it],it,et[it])===!1)break;return et}function Gt(et){var ft=!!et&&[l.l]in et&&et[l.l],it=ue(et);return Te(it)?!1:it==ht.a||ft===0||ue(ft)==ht.n&&ft>0&&ft-1 in et}function ke(et){var ft=et.match(Bt)||[];return ft.join(Lt)}function Xe(et,ft){for(var it=(et.parentNode||ut).querySelectorAll(ft)||[],_t=it[l.l];_t--;)if(it[_t]==et)return!0;return!1}function ce(et,ft,it){if(G.isA(it))for(var _t=0;_t<it[l.l];_t++)ce(et,ft,it[_t]);else ue(it)==ht.s?et.insertAdjacentHTML(ft,it):et.insertAdjacentElement(ft,it.nodeType?it:it[0])}function fr(et,ft,it){try{et[l.s][ft]!==gt&&(et[l.s][ft]=nn(ft,it))}catch{}}function nn(et,ft){return!pr[et.toLowerCase()]&&ue(ft)==ht.n&&(ft+="px"),ft}function Ze(et,ft){var it,_t;ft!==!1&&et.q.splice(0,1),et.q[l.l]>0?(_t=et.q[0],$t(et.el,_t.props,_t.duration,_t.easing,_t.complete,!0)):(it=he(et,At),it>-1&&At.splice(it,1))}function ei(et,ft,it){ft===bt||ft===wt?et[ft]=it:fr(et,ft,it)}function $t(et,ft,it,_t,Et,de){var Ee=ze(it),Fe={},ee={},Se=0,Ce,Rr,ai,Mr,_i,gr;for(Ee?(_t=it.easing,ai=it.progress,Mr=it.step,_i=it.specialEasing,Et=it.complete,gr=it.duration):gr=it,_i=_i||{},gr=gr||400,_t=_t||"swing",de=de||!1;Se<At[l.l];Se++)if(At[Se].el===et){Rr=At[Se];break}Rr||(Rr={el:et,q:[]},At.push(Rr));for(Ce in ft)Ce===bt||Ce===wt?Fe[Ce]=et[Ce]:Fe[Ce]=je(et).css(Ce);for(Ce in Fe)Fe[Ce]!==ft[Ce]&&ft[Ce]!==gt&&(ee[Ce]=ft[Ce]);if(_r(ee))de&&Ze(Rr);else{var an,Gr,ri,oi,on,tr,si,la,Ji,Qi=de?0:he(zr,Rr.q),zr={props:ee,duration:Ee?it:gr,easing:_t,complete:Et};if(Qi===-1&&(Qi=Rr.q[l.l],Rr.q.push(zr)),Qi===0)if(gr>0)si=G.now(),la=function(){an=G.now(),Ji=an-si,Gr=zr.stop||Ji>=gr,ri=1-(St.max(0,si+gr-an)/gr||0);for(Ce in ee)oi=parseFloat(Fe[Ce]),on=parseFloat(ee[Ce]),tr=(on-oi)*We[_i[Ce]||_t](ri,ri*gr,0,1,gr)+oi,ei(et,Ce,tr),Te(Mr)&&Mr(tr,{elem:et,prop:Ce,start:oi,now:tr,end:on,pos:ri,options:{easing:_t,speacialEasing:_i,duration:gr,complete:Et,step:Mr},startTime:si});Te(ai)&&ai({},ri,St.max(0,gr-Ji)),Gr?(Ze(Rr),Te(Et)&&Et()):zr.frame=G.rAF()(la)},zr.frame=G.rAF()(la);else{for(Ce in ee)ei(et,Ce,ee[Ce]);Ze(Rr)}}}function ar(et,ft,it){for(var _t,Et,de,Ee=0;Ee<At[l.l];Ee++)if(_t=At[Ee],_t.el===et){if(_t.q[l.l]>0){if(Et=_t.q[0],Et.stop=!0,G.cAF()(Et.frame),_t.q.splice(0,1),it)for(de in Et.props)ei(et,de,Et.props[de]);ft?_t.q=[]:Ze(_t,!1)}break}}function Sr(et){return!!(et[l.oW]||et[l.oH]||et.getClientRects()[l.l])}function je(et){if(arguments[l.l]===0)return this;var ft=new je,it=et,_t=0,Et,de;if(ue(et)==ht.s)for(it=[],et.charAt(0)==="<"?(de=ut.createElement("div"),de.innerHTML=et,Et=de.children):Et=ut.querySelectorAll(et);_t<Et[l.l];_t++)it.push(Et[_t]);if(it){for(ue(it)!=ht.s&&(!Gt(it)||it===Y||it===it.self)&&(it=[it]),_t=0;_t<it[l.l];_t++)ft[_t]=it[_t];ft[l.l]=it[l.l]}return ft}return je[l.p]={on:function(et,ft){et=(et||Z).match(Bt)||[Z];var it=et[l.l],_t=0,Et;return this.each(function(){Et=this;try{if(Et.addEventListener)for(;_t<it;_t++)Et.addEventListener(et[_t],ft);else if(Et.detachEvent)for(;_t<it;_t++)Et.attachEvent("on"+et[_t],ft)}catch{}})},off:function(et,ft){et=(et||Z).match(Bt)||[Z];var it=et[l.l],_t=0,Et;return this.each(function(){Et=this;try{if(Et.removeEventListener)for(;_t<it;_t++)Et.removeEventListener(et[_t],ft);else if(Et.detachEvent)for(;_t<it;_t++)Et.detachEvent("on"+et[_t],ft)}catch{}})},one:function(et,ft){return et=(et||Z).match(Bt)||[Z],this.each(function(){var it=je(this);je.each(et,function(_t,Et){var de=function(Ee){ft.call(this,Ee),it.off(Et,de)};it.on(Et,de)})})},trigger:function(et){var ft,it;return this.each(function(){ft=this,ut.createEvent?(it=ut.createEvent("HTMLEvents"),it.initEvent(et,!0,!1),ft.dispatchEvent(it)):ft.fireEvent("on"+et)})},append:function(et){return this.each(function(){ce(this,"beforeend",et)})},prepend:function(et){return this.each(function(){ce(this,"afterbegin",et)})},before:function(et){return this.each(function(){ce(this,"beforebegin",et)})},after:function(et){return this.each(function(){ce(this,"afterend",et)})},remove:function(){return this.each(function(){var et=this,ft=et.parentNode;ft!=null&&ft.removeChild(et)})},unwrap:function(){var et=[],ft,it,_t;for(this.each(function(){_t=this.parentNode,he(_t,et)===-1&&et.push(_t)}),ft=0;ft<et[l.l];ft++){for(it=et[ft],_t=it.parentNode;it.firstChild;)_t.insertBefore(it.firstChild,it);_t.removeChild(it)}return this},wrapAll:function(et){for(var ft,it=this,_t=je(et)[0],Et=_t,de=it[0].parentNode,Ee=it[0].previousSibling;Et.childNodes[l.l]>0;)Et=Et.childNodes[0];for(ft=0;it[l.l]-ft;Et.firstChild===it[0]&&ft++)Et.appendChild(it[ft]);var Fe=Ee?Ee.nextSibling:de.firstChild;return de.insertBefore(_t,Fe),this},wrapInner:function(et){return this.each(function(){var ft=je(this),it=ft.contents();it[l.l]?it.wrapAll(et):ft.append(et)})},wrap:function(et){return this.each(function(){je(this).wrapAll(et)})},css:function(et,ft){var it,_t,Et,de=Y.getComputedStyle;return ue(et)==ht.s?ft===gt?(it=this[0],Et=de?de(it,null):it.currentStyle[et],de?Et!=null?Et.getPropertyValue(et):it[l.s][et]:Et):this.each(function(){fr(this,et,ft)}):this.each(function(){for(_t in et)fr(this,_t,et[_t])})},hasClass:function(et){for(var ft,it=0,_t=Lt+et+Lt,Et;ft=this[it++];){if(Et=ft.classList,Et&&Et.contains(et))return!0;if(ft.nodeType===1&&(Lt+ke(ft.className+Z)+Lt).indexOf(_t)>-1)return!0}return!1},addClass:function(et){var ft,it,_t,Et,de,Ee,Fe,ee,Se=0,Ce=0;if(et){for(ft=et.match(Bt)||[];it=this[Se++];)if(ee=it.classList,Fe===gt&&(Fe=ee!==gt),Fe)for(;de=ft[Ce++];)ee.add(de);else if(Et=it.className+Z,_t=it.nodeType===1&&Lt+ke(Et)+Lt,_t){for(;de=ft[Ce++];)_t.indexOf(Lt+de+Lt)<0&&(_t+=de+Lt);Ee=ke(_t),Et!==Ee&&(it.className=Ee)}}return this},removeClass:function(et){var ft,it,_t,Et,de,Ee,Fe,ee,Se=0,Ce=0;if(et){for(ft=et.match(Bt)||[];it=this[Se++];)if(ee=it.classList,Fe===gt&&(Fe=ee!==gt),Fe)for(;de=ft[Ce++];)ee.remove(de);else if(Et=it.className+Z,_t=it.nodeType===1&&Lt+ke(Et)+Lt,_t){for(;de=ft[Ce++];)for(;_t.indexOf(Lt+de+Lt)>-1;)_t=_t.replace(Lt+de+Lt,Lt);Ee=ke(_t),Et!==Ee&&(it.className=Ee)}}return this},hide:function(){return this.each(function(){this[l.s].display="none"})},show:function(){return this.each(function(){this[l.s].display="block"})},attr:function(et,ft){for(var it=0,_t;_t=this[it++];){if(ft===gt)return _t.getAttribute(et);_t.setAttribute(et,ft)}return this},removeAttr:function(et){return this.each(function(){this.removeAttribute(et)})},offset:function(){var et=this[0],ft=et[l.bCR](),it=Y.pageXOffset||ut.documentElement[bt],_t=Y.pageYOffset||ut.documentElement[wt];return{top:ft.top+_t,left:ft.left+it}},position:function(){var et=this[0];return{top:et.offsetTop,left:et.offsetLeft}},scrollLeft:function(et){for(var ft=0,it;it=this[ft++];){if(et===gt)return it[bt];it[bt]=et}return this},scrollTop:function(et){for(var ft=0,it;it=this[ft++];){if(et===gt)return it[wt];it[wt]=et}return this},val:function(et){var ft=this[0];return et?(ft.value=et,this):ft.value},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(et){return je(this[et>=0?et:this[l.l]+et])},find:function(et){var ft=[],it;return this.each(function(){var _t=this,Et=_t.querySelectorAll(et);for(it=0;it<Et[l.l];it++)ft.push(Et[it])}),je(ft)},children:function(et){var ft=[],it,_t,Et;return this.each(function(){for(_t=this.children,Et=0;Et<_t[l.l];Et++)it=_t[Et],et?(it.matches&&it.matches(et)||Xe(it,et))&&ft.push(it):ft.push(it)}),je(ft)},parent:function(et){var ft=[],it;return this.each(function(){it=this.parentNode,(et?je(it).is(et):!0)&&ft.push(it)}),je(ft)},is:function(et){var ft,it;for(it=0;it<this[l.l];it++){if(ft=this[it],et===":visible")return Sr(ft);if(et===":hidden")return!Sr(ft);if(ft.matches&&ft.matches(et)||Xe(ft,et))return!0}return!1},contents:function(){var et=[],ft,it;return this.each(function(){for(ft=this.childNodes,it=0;it<ft[l.l];it++)et.push(ft[it])}),je(et)},each:function(et){return Jr(this,et)},animate:function(et,ft,it,_t){return this.each(function(){$t(this,et,ft,it,_t)})},stop:function(et,ft){return this.each(function(){ar(this,et,ft)})}},sr(je,{extend:sr,inArray:he,isEmptyObject:_r,isPlainObject:ze,each:Jr}),je}(),wr=function(){var Bt=[],Lt="__overlayScrollbars__";return function(Z,bt){var wt=arguments[l.l];if(wt<1)return Bt;if(bt)Z[Lt]=bt,Bt.push(Z);else{var At=G.inA(Z,Bt);if(At>-1)if(wt>1)delete Z[Lt],Bt.splice(At,1);else return Bt[At][Lt]}}}(),kr=function(){var Bt,Lt,Z,bt=[],wt=function(){var he=G.type,Te=[ht.b,ht.n,ht.s,ht.a,ht.o,ht.f,ht.z],_r=" ",ze=":",Jr=[ht.z,ht.s],Gt=ht.n,ke=[ht.z,ht.b],Xe=[!0,ht.b],ce=[!1,ht.b],fr=[null,[ht.z,ht.f]],nn=[["img"],[ht.s,ht.a,ht.z]],Ze=[["style","class"],[ht.s,ht.a,ht.z]],ei="n:none b:both h:horizontal v:vertical",$t="v-h:visible-hidden v-s:visible-scroll s:scroll h:hidden",ar="v:visible h:hidden a:auto",Sr="n:never s:scroll l:leave m:move",je={className:["os-theme-dark",Jr],resize:["none",ei],sizeAutoCapable:Xe,clipAlways:Xe,normalizeRTL:Xe,paddingAbsolute:ce,autoUpdate:[null,ke],autoUpdateInterval:[33,Gt],updateOnLoad:nn,nativeScrollbarsOverlaid:{showNativeScrollbars:ce,initialize:Xe},overflowBehavior:{x:["scroll",$t],y:["scroll",$t]},scrollbars:{visibility:["auto",ar],autoHide:["never",Sr],autoHideDelay:[800,Gt],dragScrolling:Xe,clickScrolling:ce,touchSupport:Xe,snapHandle:ce},textarea:{dynWidth:ce,dynHeight:ce,inheritedAttrs:Ze},callbacks:{onInitialized:fr,onInitializationWithdrawn:fr,onDestroyed:fr,onScrollStart:fr,onScroll:fr,onScrollStop:fr,onOverflowChanged:fr,onOverflowAmountChanged:fr,onDirectionChanged:fr,onContentSizeChanged:fr,onHostSizeChanged:fr,onUpdated:fr}},et=function(ft){var it=function(_t){var Et,de,Ee;for(Et in _t)!_t[l.hOP](Et)||(de=_t[Et],Ee=he(de),Ee==ht.a?_t[Et]=de[ft?1:0]:Ee==ht.o&&(_t[Et]=it(de)));return _t};return it(vt.extend(!0,{},je))};return{_defaults:et(),_template:et(!0),_validate:function(ft,it,_t,Et){var de={},Ee={},Fe=vt.extend(!0,{},ft),ee=vt.inArray,Se=vt.isEmptyObject,Ce=function(Rr,ai,Mr,_i,gr,an){for(var Gr in ai)if(ai[l.hOP](Gr)&&Rr[l.hOP](Gr)){var ri=!1,oi=!1,on=ai[Gr],tr=he(on),si=tr==ht.o,la=G.isA(on)?on:[on],Ji=Mr[Gr],Qi=Rr[Gr],zr=he(Qi),ua=an?an+".":"",Ga='The option "'+ua+Gr+`" wasn't set, because`,ki=[],Mi=[],bn,li,qi,cn,dr,Bi,zn,Ve;if(Ji=Ji===gt?{}:Ji,si&&zr==ht.o)_i[Gr]={},gr[Gr]={},Ce(Qi,on,Ji,_i[Gr],gr[Gr],ua+Gr),vt.each([Rr,_i,gr],function(Qr,mr){Se(mr[Gr])&&delete mr[Gr]});else if(!si){for(Bi=0;Bi<la[l.l];Bi++)if(dr=la[Bi],tr=he(dr),qi=tr==ht.s&&ee(dr,Te)===-1,qi)for(ki.push(ht.s),bn=dr.split(_r),Mi=Mi.concat(bn),zn=0;zn<bn[l.l];zn++){for(li=bn[zn].split(ze),cn=li[0],Ve=0;Ve<li[l.l];Ve++)if(Qi===li[Ve]){ri=!0;break}if(ri)break}else if(ki.push(dr),zr===dr){ri=!0;break}ri?(oi=Qi!==Ji,oi&&(_i[Gr]=Qi),(qi?ee(Ji,li)<0:oi)&&(gr[Gr]=qi?cn:Qi)):_t&&console.warn(Ga+" it doesn't accept the type [ "+zr.toUpperCase()+' ] with the value of "'+Qi+`".\r
Accepted types are: [ `+ki.join(", ").toUpperCase()+" ]."+(Mi[length]>0?`\r
Valid strings are: [ `+Mi.join(", ").split(ze).join(", ")+" ].":"")),delete Rr[Gr]}}};return Ce(Fe,it,Et||{},de,Ee),!Se(Fe)&&_t&&console.warn(`The following options are discarded due to invalidity:\r
`+Y.JSON.stringify(Fe,null,2)),{_default:de,_prepared:Ee}}}}();function At(){Lt||(Lt=new ue(wt._defaults)),Z||(Z=new pr(Lt))}function ue(he){var Te=this,_r="overflow",ze="hidden",Jr="scroll",Gt=vt("body"),ke=vt('<div id="os-dummy-scrollbar-size"><div></div></div>'),Xe=ke[0],ce=vt(ke.children("div").eq(0));Gt.append(ke),ke.hide().show();var fr=ei(Xe),nn={x:fr.x===0,y:fr.y===0},Ze=function(){var $t=Y.navigator.userAgent,ar="indexOf",Sr="substring",je=$t[ar]("MSIE "),et=$t[ar]("Trident/"),ft=$t[ar]("Edge/"),it=$t[ar]("rv:"),_t,Et=parseInt;return je>0?_t=Et($t[Sr](je+5,$t[ar](".",je)),10):et>0?_t=Et($t[Sr](it+3,$t[ar](".",it)),10):ft>0&&(_t=Et($t[Sr](ft+5,$t[ar](".",ft)),10)),_t}();vt.extend(Te,{defaultOptions:he,msie:Ze,autoUpdateLoop:!1,autoUpdateRecommended:!G.mO(),nativeScrollbarSize:fr,nativeScrollbarIsOverlaid:nn,nativeScrollbarStyling:function(){var $t=!1;ke.addClass("os-viewport-native-scrollbars-invisible");try{$t=ke.css("scrollbar-width")==="none"&&(Ze>9||!Ze)||Y.getComputedStyle(Xe,"::-webkit-scrollbar").getPropertyValue("display")==="none"}catch{}return $t}(),overlayScrollbarDummySize:{x:30,y:30},cssCalc:Ut._cssPropertyValue("width","calc","(1px)")||null,restrictedMeasuring:function(){ke.css(_r,ze);var $t={w:Xe[l.sW],h:Xe[l.sH]};ke.css(_r,"visible");var ar={w:Xe[l.sW],h:Xe[l.sH]};return $t.w-ar.w!=0||$t.h-ar.h!=0}(),rtlScrollBehavior:function(){ke.css({"overflow-y":ze,"overflow-x":Jr,direction:"rtl"}).scrollLeft(0);var $t=ke.offset(),ar=ce.offset();ke.scrollLeft(-999);var Sr=ce.offset();return{i:$t.left===ar.left,n:ar.left!==Sr.left}}(),supportTransform:!!Ut._cssProperty("transform"),supportTransition:!!Ut._cssProperty("transition"),supportPassiveEvents:function(){var $t=!1;try{Y.addEventListener("test",null,Object.defineProperty({},"passive",{get:function(){$t=!0}}))}catch{}return $t}(),supportResizeObserver:!!G.rO(),supportMutationObserver:!!G.mO()}),ke.removeAttr(l.s).remove(),function(){if(nn.x&&nn.y)return;var $t=St.abs,ar=G.wW(),Sr=G.wH(),je=it(),et=function(){if(wr().length>0){var _t=G.wW(),Et=G.wH(),de=_t-ar,Ee=Et-Sr;if(de===0&&Ee===0)return;var Fe=St.round(_t/(ar/100)),ee=St.round(Et/(Sr/100)),Se=$t(de),Ce=$t(Ee),Rr=$t(Fe),ai=$t(ee),Mr=it(),_i=Se>2&&Ce>2,gr=!ft(Rr,ai),an=Mr!==je&&je>0,Gr=_i&&gr&&an,ri=Te.nativeScrollbarSize,oi;Gr&&(Gt.append(ke),oi=Te.nativeScrollbarSize=ei(ke[0]),ke.remove(),(ri.x!==oi.x||ri.y!==oi.y)&&vt.each(wr(),function(){wr(this)&&wr(this).update("zoom")})),ar=_t,Sr=Et,je=Mr}};function ft(_t,Et){var de=$t(_t),Ee=$t(Et);return!(de===Ee||de+1===Ee||de-1===Ee)}function it(){var _t=Y.screen.deviceXDPI||0,Et=Y.screen.logicalXDPI||1;return Y.devicePixelRatio||_t/Et}vt(Y).on("resize",et)}();function ei($t){return{x:$t[l.oH]-$t[l.cH],y:$t[l.oW]-$t[l.cW]}}}function pr(he){var Te=this,_r=vt.inArray,ze=G.now,Jr="autoUpdate",Gt=Jr+"Interval",ke=l.l,Xe=[],ce=[],fr=!1,nn=33,Ze=nn,ei=ze(),$t,ar=function(){if(Xe[ke]>0&&fr){$t=G.rAF()(function(){ar()});var Sr=ze(),je=Sr-ei,et,ft,it,_t,Et,de;if(je>Ze){ei=Sr-je%Ze,et=nn;for(var Ee=0;Ee<Xe[ke];Ee++)ft=Xe[Ee],ft!==gt&&(it=ft.options(),_t=it[Jr],Et=St.max(1,it[Gt]),de=ze(),(_t===!0||_t===null)&&de-ce[Ee]>Et&&(ft.update("auto"),ce[Ee]=new Date(de+=Et)),et=St.max(1,St.min(et,Et)));Ze=et}}else Ze=nn};Te.add=function(Sr){_r(Sr,Xe)===-1&&(Xe.push(Sr),ce.push(ze()),Xe[ke]>0&&!fr&&(fr=!0,he.autoUpdateLoop=fr,ar()))},Te.remove=function(Sr){var je=_r(Sr,Xe);je>-1&&(ce.splice(je,1),Xe.splice(je,1),Xe[ke]===0&&fr&&(fr=!1,he.autoUpdateLoop=fr,$t!==gt&&(G.cAF()($t),$t=-1)))}}function sr(he,Te,_r,ze,Jr){var Gt=G.type,ke=vt.inArray,Xe=vt.each,ce=new Bt,fr=vt[l.p];if(!Ja(he))return;if(wr(he)){var nn=wr(he);return nn.options(Te),nn}var Ze,ei,$t,ar,Sr,je,et,ft,it,_t,Et,de,Ee,Fe,ee,Se,Ce,Rr,ai,Mr,_i,gr,an,Gr,ri,oi,on,tr,si,la={},Ji={},Qi={},zr={},ua={},Ga="-hidden",ki="margin-",Mi="padding-",bn="border-",li="top",qi="right",cn="bottom",dr="left",Bi="min-",zn="max-",Ve="width",Qr="height",mr="float",b="",T="auto",C="sync",k="scroll",U="100%",K="x",tt="y",W=".",M=" ",j="scrollbar",Dt="-horizontal",Ft="-vertical",lt=k+"Left",It=k+"Top",Xt="mousedown touchstart",Jt="mouseup touchend touchcancel",me="mousemove touchmove",Ct="mouseenter",qt="mouseleave",Pt="keydown",Ue="keyup",Oe="selectstart",ae="transitionend webkitTransitionEnd oTransitionEnd",Br="__overlayScrollbarsRO__",Me="os-",Hr=Me+"html",er=Me+"host",nr=er+"-foreign",Or=er+"-textarea",gi=er+"-"+j+Dt+Ga,Ur=er+"-"+j+Ft+Ga,Ke=er+"-transition",Bo=er+"-rtl",$e=er+"-resize-disabled",Ha=er+"-scrolling",go=er+"-overflow",go=er+"-overflow",$i=go+"-x",Pn=go+"-y",rs=Me+"textarea",Oo=rs+"-cover",Oi=Me+"padding",ca=Me+"viewport",Kn=ca+"-native-scrollbars-invisible",ii=ca+"-native-scrollbars-overlaid",wn=Me+"content",Sn=Me+"content-arrange",Yn=Me+"content-glue",ao=Me+"size-auto-observer",Fo=Me+"resize-observer",Nn=Me+"resize-observer-item",xl=Nn+"-final",wa=Me+"text-inherit",ui=Me+j,Fi=ui+"-track",Uo=Fi+"-off",ws=ui+"-handle",jl=ws+"-off",ql=ui+"-unusable",Vo=ui+"-"+T+Ga,bl=ui+"-corner",is=bl+"-resize",Zl=is+"-both",Js=is+Dt,Ss=is+Ft,Qs=ui+Dt,Ts=ui+Ft,xo=Me+"dragging",No=Me+"theme-none",Es=[Kn,ii,Uo,jl,ql,Vo,is,Zl,Js,Ss,xo].join(M),Tn=[],oo=[l.ti],so,bo,ci,kn={},lo="added removed on contract",Sa,ni={},Is,wl=42,Sl="load",As=[],ns,Ta,wo,uo,Tr,Ne,Da,jn,Mn,lr,ur,La,Di,Dn,Zi,pa,Ra,Ba,ha,Oa,as,Vr,Fa,Ua,Jn,Cs,zs,co,jo,pn,Ea,Ia,Tl,Va,qo,hn,Wa,So,To,Ps,$s,Wr,ks,El,Zo,Gl,os,Xa,tl,Eo,Ms,Ds,ss,Go,el,ls,fa,Il,Ka,Ho,po,Io,Wo,Hl,Ls,Wl,Na,rl={},Rs,Bs,us,cs,Aa,ps=["wrap","cols","rows"],il=[l.i,l.c,l.s,"open"].concat(oo),Os=[],Dr,Fs,Ao,Ya,Pr,Ye,fn,Ln,nl,da,Co,al,Xo,hs;function dn(V,Q,nt,pt,xt){var Tt=G.isA(Q)&&G.isA(nt),Rt=pt?"removeEventListener":"addEventListener",te=pt?"off":"on",Ht=Tt?!1:Q.split(M),ne=0,i=vt.isPlainObject(xt),a=Et&&(i?xt._passive:xt)||!1,n=i&&(xt._capture||!1),s=Et?{passive:a,capture:n}:n;if(Tt)for(;ne<Q[l.l];ne++)dn(V,Q[ne],nt[ne],pt,xt);else for(;ne<Ht[l.l];ne++)Et?V[0][Rt](Ht[ne],nt,s):V[te](Ht[ne],nt)}function pi(V,Q,nt,pt){dn(V,Q,nt,!1,pt),Os.push(G.bind(dn,0,V,Q,nt,!0,pt))}function Rn(V,Q){if(V){var nt=G.rO(),pt="animationstart mozAnimationStart webkitAnimationStart MSAnimationStart",xt="childNodes",Tt=3333333,Rt=function(){V[It](Tt)[lt](tr?$t.n?-Tt:$t.i?0:Tt:Tt),Q()};if(Q){if(de){var te=V.addClass("observed").append(Nr(Fo)).contents()[0],Ht=te[Br]=new nt(Rt);Ht.observe(te)}else if(Sr>9||!ar){V.prepend(Nr(Fo,Nr({c:Nn,dir:"ltr"},Nr(Nn,Nr(xl))+Nr(Nn,Nr({c:xl,style:"width: 200%; height: 200%"})))));var ne=V[0][xt][0][xt][0],i=vt(ne[xt][1]),a=vt(ne[xt][0]),n=vt(a[0][xt][0]),s=ne[l.oW],p=ne[l.oH],f,d,y,g,S=2,I=ze.nativeScrollbarSize,P=function(){a[lt](Tt)[It](Tt),i[lt](Tt)[It](Tt)},A=function(){d=0,!!f&&(s=y,p=g,Rt())},B=function(ot){return y=ne[l.oW],g=ne[l.oH],f=y!=s||g!=p,ot&&f&&!d?(G.cAF()(d),d=G.rAF()(A)):ot||A(),P(),ot&&(G.prvD(ot),G.stpP(ot)),!1},R={},N={};ya(N,b,[-((I.y+1)*S),I.x*-S,I.y*-S,-((I.x+1)*S)]),vt(ne).css(N),a.on(k,B),i.on(k,B),V.on(pt,function(){B(!1)}),R[Ve]=Tt,R[Qr]=Tt,n.css(R),P()}else{var L=Fa.attachEvent,q=Sr!==gt;if(L)V.prepend(Nr(Fo)),$a(V,W+Fo)[0].attachEvent("onresize",Rt);else{var X=Fa.createElement(ht.o);X.setAttribute(l.ti,"-1"),X.setAttribute(l.c,Fo),X.onload=function(){var ot=this.contentDocument.defaultView;ot.addEventListener("resize",Rt),ot.document.documentElement.style.display="none"},X.type="text/html",q&&V.prepend(X),X.data="about:blank",q||V.prepend(X),V.on(pt,Rt)}}if(V[0]===zs){var rt=function(){var ot=Ne.css("direction"),$={},yt=0,kt=!1;return ot!==ks&&(ot==="ltr"?($[dr]=0,$[qi]=T,yt=Tt):($[dr]=T,$[qi]=0,yt=$t.n?-Tt:$t.i?0:Tt),jn.children().eq(0).css($),jn[lt](yt)[It](Tt),ks=ot,kt=!0),kt};rt(),pi(V,k,function(ot){return rt()&&Si(),G.prvD(ot),G.stpP(ot),!1})}}else if(de){var te=V.contents()[0],ct=te[Br];ct&&(ct.disconnect(),delete te[Br])}else qa(V.children(W+Fo).eq(0))}}function Xl(){if(Ee){var V=11,Q=G.mO(),nt=G.now(),pt,xt,Tt,Rt,te,Ht,ne,i,a,n;us=function(s){var p=!1,f=!1,d,y=[];return Fe&&!si&&(Xe(s,function(){d=this,pt=d.target,xt=d.attributeName,Tt=xt===l.c,Rt=d.oldValue,te=pt.className,ai&&Tt&&!f&&Rt.indexOf(nr)>-1&&te.indexOf(nr)<0&&(Ht=Zn(!0),Jn.className=te.split(M).concat(Rt.split(M).filter(function(g){return g.match(Ht)})).join(M),p=f=!0),p||(p=Tt?Us(Rt,te):xt===l.s?Rt!==pt[l.s].cssText:!0),y.push(xt)}),ll(y),p&&ce.update(f||T)),p},cs=function(s){var p=!1,f;return Fe&&!si&&(Xe(s,function(){return f=this,p=ol(f),!p}),p&&(i=G.now(),a=Wa||hn,n=function(){ee||(nt=i,Se&&Vs(),a?Si():ce.update(T))},clearTimeout(ne),V<=0||i-nt>V||!a?n():ne=setTimeout(n,V))),p},Rs=new Q(us),Bs=new Q(cs)}}function tn(){Ee&&!Aa&&(Rs.observe(Jn,{attributes:!0,attributeOldValue:!0,attributeFilter:il}),Bs.observe(Se?Ua:pn,{attributes:!0,attributeOldValue:!0,subtree:!Se,childList:!Se,characterData:!Se,attributeFilter:Se?ps:il}),Aa=!0)}function Bn(){Ee&&Aa&&(Rs.disconnect(),Bs.disconnect(),Aa=!1)}function re(){if(!si){var V,Q={w:zs[l.sW],h:zs[l.sH]};V=Qa(Q,ss),ss=Q,V&&Si({_hostSizeChanged:!0})}}function fs(){Ln&&rr(!0)}function Ko(){Ln&&!uo.hasClass(xo)&&rr(!1)}function zo(){fn&&(rr(!0),clearTimeout(Ao),Ao=setTimeout(function(){fn&&!ee&&rr(!1)},100))}function mn(V){return G.prvD(V),!1}function Yo(V){var Q=vt(V.target);Gn(function(nt,pt){Q.is(pt)&&Si({_contentSizeChanged:!0})})}function En(V){V||En(!0),dn(Ne,me.split(M)[0],zo,!fn||V,!0),dn(Ne,[Ct,qt],[fs,Ko],!Ln||V,!0),!Fe&&!V&&Ne.one("mouseover",fs)}function ie(){var V={};return Ce&&La&&(V.w=Gi(La.css(Bi+Ve)),V.h=Gi(La.css(Bi+Qr)),V.c=Qa(V,Na),V.f=!0),Na=V,!!V.c}function Us(V,Q){var nt=typeof Q==ht.s?Q.split(M):[],pt=typeof V==ht.s?V.split(M):[],xt=ea(pt,nt),Tt=ke(No,xt),Rt,te;if(Tt>-1&&xt.splice(Tt,1),xt[l.l]>0){for(te=Zn(!0,!0),Rt=0;Rt<xt.length;Rt++)if(!xt[Rt].match(te))return!0}return!1}function ol(V){var Q=V.attributeName,nt=V.target,pt=V.type,xt="closest";if(nt===pn)return Q===null;if(pt==="attributes"&&(Q===l.c||Q===l.s)&&!Se){if(Q===l.c&&vt(nt).hasClass(er))return Us(V.oldValue,nt.className);if(typeof nt[xt]!=ht.f)return!0;if(nt[xt](W+Fo)!==null||nt[xt](W+ui)!==null||nt[xt](W+bl)!==null)return!1}return!0}function Ca(){if(si)return!1;var V=Xr(),Q=Se&&hn&&!Io?Tr.val().length:0,nt=!Aa&&hn&&!Se,pt={},xt,Tt,Rt,te;return nt&&(xt=ur.css(mr),pt[mr]=tr?qi:dr,pt[Ve]=T,ur.css(pt)),te={w:V[l.sW]+Q,h:V[l.sH]+Q},nt&&(pt[mr]=xt,pt[Ve]=U,ur.css(pt)),Tt=ie(),Rt=Qa(te,Ds),Ds=te,Rt||Tt}function qn(){if(!(si||Aa)){var V,Q,nt,pt=[],xt=[{_elem:Ne,_attrs:il.concat(":visible")},{_elem:Se?Tr:gt,_attrs:ps}];return Xe(xt,function(Tt,Rt){V=Rt._elem,V&&Xe(Rt._attrs,function(te,Ht){Q=Ht.charAt(0)===":"?V.is(Ht):V.attr(Ht),nt=rl[Ht],Qa(Q,nt)&&pt.push(Ht),rl[Ht]=Q})}),ll(pt),pt[l.l]>0}}function sl(V){if(!Fe)return!0;var Q="flex-grow",nt="flex-shrink",pt="flex-basis",xt=[Ve,Bi+Ve,zn+Ve,ki+dr,ki+qi,dr,qi,"font-weight","word-spacing",Q,nt,pt],Tt=[Mi+dr,Mi+qi,bn+dr+Ve,bn+qi+Ve],Rt=[Qr,Bi+Qr,zn+Qr,ki+li,ki+cn,li,cn,"line-height",Q,nt,pt],te=[Mi+li,Mi+cn,bn+li+Ve,bn+cn+Ve],Ht="s",ne="v-s",i=os.x===Ht||os.x===ne,a=os.y===Ht||os.y===ne,n=!1,s=function(p,f){for(var d=0;d<p[l.l];d++)if(p[d]===f)return!0;return!1};return a&&(n=s(Rt,V),!n&&!Mr&&(n=s(te,V))),i&&!n&&(n=s(xt,V),!n&&!Mr&&(n=s(Tt,V))),n}function ll(V){V=V||oo,Xe(V,function(Q,nt){if(G.inA(nt,oo)>-1){var pt=Tr.attr(nt);Gt(pt)==ht.s?lr.attr(nt,pt):lr.removeAttr(nt)}})}function Vs(){if(!si){var V=!Io,Q=zr.w,nt=zr.h,pt={},xt=hn||V,Tt,Rt,te,Ht;return pt[Bi+Ve]=b,pt[Bi+Qr]=b,pt[Ve]=T,Tr.css(pt),Tt=Ua[l.oW],Rt=xt?St.max(Tt,Ua[l.sW]-1):1,pt[Ve]=hn?T:U,pt[Bi+Ve]=U,pt[Qr]=T,Tr.css(pt),te=Ua[l.oH],Ht=St.max(te,Ua[l.sH]-1),pt[Ve]=Rt,pt[Qr]=Ht,Dn.css(pt),pt[Bi+Ve]=Q,pt[Bi+Qr]=nt,Tr.css(pt),{_originalWidth:Tt,_originalHeight:te,_dynamicWidth:Rt,_dynamicHeight:Ht}}}function Si(V){clearTimeout(Is),V=V||{},ni._hostSizeChanged|=V._hostSizeChanged,ni._contentSizeChanged|=V._contentSizeChanged,ni._force|=V._force;var Q=G.now(),nt=!!ni._hostSizeChanged,pt=!!ni._contentSizeChanged,xt=!!ni._force,Tt=V._changedOptions,Rt=Fe&&!ee&&!xt&&!Tt&&Q-Sa<wl&&!Wa&&!hn,te;if(Rt&&(Is=setTimeout(Si,wl)),!(ee||Rt||si&&!Tt||Fe&&!xt&&(te=Ne.is(":hidden"))||Ne.css("display")==="inline")){Sa=Q,ni={},je&&!(Ze.x&&Ze.y)?(ft.x=0,ft.y=0):ft=Hi({},ze.nativeScrollbarSize),ua={x:(ft.x+(Ze.x?0:3))*3,y:(ft.y+(Ze.y?0:3))*3},Tt=Tt||{};var Ht=function(){return Qa.apply(this,[].slice.call(arguments).concat([xt]))},ne={x:lr[lt](),y:lr[It]()},i=ci.scrollbars,a=ci.textarea,n=i.visibility,s=Ht(n,Go),p=i.autoHide,f=Ht(p,el),d=i.clickScrolling,y=Ht(d,ls),g=i.dragScrolling,S=Ht(g,fa),I=ci.className,P=Ht(I,Ho),A=ci.resize,B=Ht(A,Il)&&!Ce,R=ci.paddingAbsolute,N=Ht(R,El),L=ci.clipAlways,q=Ht(L,Zo),X=ci.sizeAutoCapable&&!Ce,rt=Ht(X,Ms),ct=ci.nativeScrollbarsOverlaid.showNativeScrollbars,ot=Ht(ct,tl),$=ci.autoUpdate,yt=Ht($,Eo),kt=ci.overflowBehavior,Mt=Ht(kt,os,xt),Nt=a.dynWidth,ye=Ht(Wl,Nt),le=a.dynHeight,pe=Ht(Ls,le);if(Pr=p==="n",Ye=p==="s",fn=p==="m",Ln=p==="l",Ya=i.autoHideDelay,po=Ho,Co=A==="n",al=A==="b",Xo=A==="h",hs=A==="v",Ka=ci.normalizeRTL,ct=ct&&Ze.x&&Ze.y,Go=n,el=p,ls=d,fa=g,Ho=I,Il=A,El=R,Zo=L,Ms=X,tl=ct,Eo=$,os=Hi({},kt),Wl=Nt,Ls=le,Va=Va||{x:!1,y:!1},P&&(Ui(Ne,po+M+No),$r(Ne,I!==gt&&I!==null&&I.length>0?I:No)),yt&&($===!0||$===null&&ar?(Bn(),Jr.add(ce)):(Jr.remove(ce),tn())),rt)if(X)if(Di?Di.show():(Di=vt(Nr(Yn)),Mn.before(Di)),_i)Da.show();else{Da=vt(Nr(ao)),Cs=Da[0],Di.before(Da);var Ge={w:-1,h:-1};Rn(Da,function(){var Zs={w:Cs[l.oW],h:Cs[l.oH]};Qa(Zs,Ge)&&(Fe&&Wa&&Zs.h>0||hn&&Zs.w>0||Fe&&!Wa&&Zs.h===0||!hn&&Zs.w===0)&&Si(),Ge=Zs}),_i=!0,et!==null&&Da.css(Qr,et+"(100% + 1px)")}else _i&&Da.hide(),Di&&Di.hide();xt&&(jn.find("*").trigger(k),_i&&Da.find("*").trigger(k)),te=te===gt?Ne.is(":hidden"):te;var jt=Se?Tr.attr("wrap")!=="off":!1,Re=Ht(jt,Io),Pe=Ne.css("direction"),_e=Ht(Pe,Wr),Ie=Ne.css("box-sizing"),ge=Ht(Ie,So),se=Kt(Mi),oe;try{oe=_i?Cs[l.bCR]():null}catch{return}tr=Pe==="rtl",Mr=Ie==="border-box";var He=tr?dr:qi,Be=tr?qi:dr,fi=!1,di=_i&&Ne.css(mr)!=="none"?St.round(oe.right-oe.left)===0&&(R?!0:Jn[l.cW]-gr>0):!1;if(X&&!di){var xi=Jn[l.oW],jr=Di.css(Ve);Di.css(Ve,T);var bi=Jn[l.oW];Di.css(Ve,jr),fi=xi!==bi,fi||(Di.css(Ve,xi+1),bi=Jn[l.oW],Di.css(Ve,jr),fi=xi!==bi)}var Qe=(di||fi)&&X&&!te,Lr=Ht(Qe,hn),Pi=!Qe&&hn,Ir=_i&&X&&!te?St.round(oe.bottom-oe.top)===0:!1,Kr=Ht(Ir,Wa),ra=!Ir&&Wa,Pa=Qe&&Mr||!Mr,mo=Ir&&Mr||!Mr,vn=Kt(bn,"-"+Ve,!Pa,!mo),ia=Kt(ki),Ae={},be={},mi=function(){return{w:Jn[l.cW],h:Jn[l.cH]}},Er=function(){return{w:co[l.oW]+St.max(0,pn[l.cW]-pn[l.sW]),h:co[l.oH]+St.max(0,pn[l.cH]-pn[l.sH])}},yr=gr=se.l+se.r,Vi=an=se.t+se.b;if(yr*=R?1:0,Vi*=R?1:0,se.c=Ht(se,To),Gr=vn.l+vn.r,ri=vn.t+vn.b,vn.c=Ht(vn,Ps),oi=ia.l+ia.r,on=ia.t+ia.b,ia.c=Ht(ia,$s),Io=jt,Wr=Pe,So=Ie,hn=Qe,Wa=Ir,To=se,Ps=vn,$s=ia,_e&&_i&&Da.css(mr,Be),se.c||_e||N||Lr||Kr||ge||rt){var yi={},xr={},qr=[se.t,se.r,se.b,se.l];ya(be,ki,[-se.t,-se.r,-se.b,-se.l]),R?(ya(yi,b,qr),ya(Se?xr:Ae,Mi)):(ya(yi,b),ya(Se?xr:Ae,Mi,qr)),Mn.css(yi),Tr.css(xr)}zr=Er();var cr=Se?Vs():!1,Fn=Se&&Ht(cr,Hl),_a=Se&&cr?{w:Nt?cr._dynamicWidth:cr._originalWidth,h:le?cr._dynamicHeight:cr._originalHeight}:{};if(Hl=cr,Ir&&(Kr||N||ge||se.c||vn.c)?Ae[Qr]=T:(Kr||N)&&(Ae[Qr]=U),Qe&&(Lr||N||ge||se.c||vn.c||_e)?(Ae[Ve]=T,be[zn+Ve]=U):(Lr||N)&&(Ae[Ve]=U,Ae[mr]=b,be[zn+Ve]=b),Qe?(be[Ve]=T,Ae[Ve]=Ut._cssPropertyValue(Ve,"max-content intrinsic")||T,Ae[mr]=Be):be[Ve]=b,Ir?be[Qr]=_a.h||pn[l.cH]:be[Qr]=b,X&&Di.css(be),ur.css(Ae),Ae={},be={},nt||pt||Fn||_e||ge||N||Lr||Qe||Kr||Ir||ot||Mt||q||B||s||f||S||y||ye||pe||Re){var sn="overflow",ka=sn+"-x",ga=sn+"-y",yo="hidden",Un="visible";if(!je){var na={},Kl=Va.y&&qo.ys&&!ct?Ze.y?lr.css(He):-ft.y:0,Eu=Va.x&&qo.xs&&!ct?Ze.x?lr.css(cn):-ft.x:0;ya(na,b),lr.css(na)}var Ma=Xr(),_n={w:_a.w||Ma[l.cW],h:_a.h||Ma[l.cH]},lc={w:Ma[l.sW],h:Ma[l.sH]};je||(na[cn]=ra?b:Eu,na[He]=Pi?b:Kl,lr.css(na)),zr=Er();var ul=mi(),Iu={w:ul.w-oi-Gr-(Mr?0:gr),h:ul.h-on-ri-(Mr?0:an)},cl={w:St.max((Qe?_n.w:lc.w)+yr,Iu.w),h:St.max((Ir?_n.h:lc.h)+Vi,Iu.h)};if(cl.c=Ht(cl,Gl),Gl=cl,X){(cl.c||Ir||Qe)&&(be[Ve]=cl.w,be[Qr]=cl.h,Se||(_n={w:Ma[l.cW],h:Ma[l.cH]}));var uc={},cc=function(en){var Vn=yn(en),Hn=Vn._w_h,Wi=Vn._width_height,Fr=en?Qe:Ir,eo=en?Gr:ri,ms=en?gr:an,Lu=en?oi:on,Ql=zr[Hn]-eo-Lu-(Mr?0:ms);(!Fr||!Fr&&vn.c)&&(be[Wi]=Iu[Hn]-1),Fr&&_n[Hn]<Ql&&(en&&Se?!jt:!0)&&(Se&&(uc[Wi]=Gi(Dn.css(Wi))-1),be[Wi]-=1),_n[Hn]>0&&(be[Wi]=St.max(1,be[Wi]))};cc(!0),cc(!1),Se&&Dn.css(uc),Di.css(be)}Qe&&(Ae[Ve]=U),Qe&&!Mr&&!Aa&&(Ae[mr]="none"),ur.css(Ae),Ae={};var Mo={w:Ma[l.sW],h:Ma[l.sH]};Mo.c=pt=Ht(Mo,Ia),Ia=Mo,zr=Er(),ul=mi(),nt=Ht(ul,Ea),Ea=ul;var Au=Se&&(zr.w===0||zr.h===0),js=Xa,qs={},to={},pl={},Do={},Li={},Ei={},zl={},pc=co[l.bCR](),hc=function(en){var Vn=yn(en),Hn=yn(!en),Wi=Hn._x_y,Fr=Vn._x_y,eo=Vn._w_h,ms=Vn._width_height,Lu=k+Vn._Left_Top+"Max",Ql=pc[ms]?St.abs(pc[ms]-zr[eo]):0,ml=js&&js[Fr]>0&&jo[Lu]===0;qs[Fr]=kt[Fr]==="v-s",to[Fr]=kt[Fr]==="v-h",pl[Fr]=kt[Fr]==="s",Do[Fr]=St.max(0,St.round((Mo[eo]-zr[eo])*100)/100),Do[Fr]*=Au||ml&&Ql>0&&Ql<1?0:1,Li[Fr]=Do[Fr]>0,Ei[Fr]=qs[Fr]||to[Fr]?Li[Wi]&&!qs[Wi]&&!to[Wi]:Li[Fr],Ei[Fr+"s"]=Ei[Fr]?pl[Fr]||qs[Fr]:!1,zl[Fr]=Li[Fr]&&Ei[Fr+"s"]};if(hc(!0),hc(!1),Do.c=Ht(Do,Xa),Xa=Do,Li.c=Ht(Li,Va),Va=Li,Ei.c=Ht(Ei,qo),qo=Ei,Ze.x||Ze.y){var Qc="px solid transparent",Pl={},Qo={},$o=xt,Cu;(Li.x||Li.y)&&(Qo.w=Ze.y&&Li.y?Mo.w+ei.y:b,Qo.h=Ze.x&&Li.x?Mo.h+ei.x:b,$o=Ht(Qo,Tl),Tl=Qo),(Li.c||Ei.c||Mo.c||_e||Lr||Kr||Qe||Ir||ot)&&(Ae[ki+Be]=Ae[bn+Be]=b,Cu=function(en){var Vn=yn(en),Hn=yn(!en),Wi=Vn._x_y,Fr=en?cn:He,eo=en?Ir:Qe;Ze[Wi]&&Li[Wi]&&Ei[Wi+"s"]?(Ae[ki+Fr]=eo?ct?b:ei[Wi]:b,Ae[bn+Fr]=(en?!eo:!0)&&!ct?ei[Wi]+Qc:b):(Qo[Hn._w_h]=Ae[ki+Fr]=Ae[bn+Fr]=b,$o=!0)},je?On(lr,Kn,!ct):(Cu(!0),Cu(!1))),ct&&(Qo.w=Qo.h=b,$o=!0),$o&&!je&&(Pl[Ve]=Ei.y?Qo.w:b,Pl[Qr]=Ei.x?Qo.h:b,La||(La=vt(Nr(Sn)),lr.prepend(La)),La.css(Pl)),ur.css(Ae)}var hr={},yi={},hl;if((nt||Li.c||Ei.c||Mo.c||Mt||ge||ot||_e||q||Kr)&&(hr[Be]=b,hl=function(en){var Vn=yn(en),Hn=yn(!en),Wi=Vn._x_y,Fr=Vn._X_Y,eo=en?cn:He,ms=function(){hr[eo]=b,la[Hn._w_h]=0};Li[Wi]&&Ei[Wi+"s"]?(hr[sn+Fr]=k,ct||je?ms():(hr[eo]=-(Ze[Wi]?ei[Wi]:ft[Wi]),la[Hn._w_h]=Ze[Wi]?ei[Hn._x_y]:0)):(hr[sn+Fr]=b,ms())},hl(!0),hl(!1),!je&&(zr.h<ua.x||zr.w<ua.y)&&(Li.x&&Ei.x&&!Ze.x||Li.y&&Ei.y&&!Ze.y)?(hr[Mi+li]=ua.x,hr[ki+li]=-ua.x,hr[Mi+Be]=ua.y,hr[ki+Be]=-ua.y):hr[Mi+li]=hr[ki+li]=hr[Mi+Be]=hr[ki+Be]=b,hr[Mi+He]=hr[ki+He]=b,Li.x&&Ei.x||Li.y&&Ei.y||Au?Se&&Au&&(yi[ka]=yi[ga]=yo):(!L||to.x||qs.x||to.y||qs.y)&&(Se&&(yi[ka]=yi[ga]=b),hr[ka]=hr[ga]=Un),Mn.css(yi),lr.css(hr),hr={},(Li.c||ge||Lr||Kr)&&!(Ze.x&&Ze.y))){var kl=pn[l.s];kl.webkitTransform="scale(1)",kl.display="run-in",kl.display=b,kl.webkitTransform=b}if(Ae={},_e||Lr||Kr)if(tr&&Qe){var Yl=ur.css(mr),Ml=St.round(ur.css(mr,b).css(dr,b).position().left);ur.css(mr,Yl);var Dl=St.round(ur.position().left);Ml!==Dl&&(Ae[dr]=Ml)}else Ae[dr]=b;if(ur.css(Ae),Se&&pt){var vo=Tu();if(vo){var zu=Wo===gt?!0:vo._rows!==Wo._rows,fl=vo._cursorRow,Pu=vo._cursorColumn,ku=vo._widestRow,$c=vo._rows,Ll=vo._columns,tp=vo._cursorPosition,Mu=vo._cursorMax,fc=tp>=Mu&&Dr,dl={x:!jt&&Pu===Ll&&fl===ku?Xa.x:-1,y:(jt?fc||zu&&(js?ne.y===js.y:!1):(fc||zu)&&fl===$c)?Xa.y:-1};ne.x=dl.x>-1?tr&&Ka&&$t.i?0:dl.x:ne.x,ne.y=dl.y>-1?dl.y:ne.y}Wo=vo}tr&&$t.i&&Ze.y&&Li.x&&Ka&&(ne.x+=la.w||0),Qe&&Ne[lt](0),Ir&&Ne[It](0),lr[lt](ne.x)[It](ne.y);var Du=n==="v",_o=n==="h",ep=n==="a",Jl=function(en,Vn){Vn=Vn===gt?en:Vn,hi(!0,en,zl.x),hi(!1,Vn,zl.y)};On(Ne,go,Ei.x||Ei.y),On(Ne,$i,Ei.x),On(Ne,Pn,Ei.y),_e&&!Ce&&On(Ne,Bo,tr),Ce&&$r(Ne,$e),B&&(On(Ne,$e,Co),On(Zi,is,!Co),On(Zi,Zl,al),On(Zi,Js,Xo),On(Zi,Ss,hs)),(s||Mt||Ei.c||Li.c||ot)&&(ct?ot&&(Ui(Ne,Ha),ct&&Jl(!1)):ep?Jl(zl.x,zl.y):Du?Jl(!0):_o&&Jl(!1)),(f||ot)&&(En(!Ln&&!fn),rr(Pr,!Pr)),(nt||Do.c||Kr||Lr||B||ge||N||ot||_e)&&(Qn(!0),zi(!0),Qn(!1),zi(!1)),y&&$n(!0,d),S&&$n(!1,g),Ti("onDirectionChanged",{isRTL:tr,dir:Pe},_e),Ti("onHostSizeChanged",{width:Ea.w,height:Ea.h},nt),Ti("onContentSizeChanged",{width:Ia.w,height:Ia.h},pt),Ti("onOverflowChanged",{x:Li.x,y:Li.y,xScrollable:Ei.xs,yScrollable:Ei.ys,clipped:Ei.x||Ei.y},Li.c||Ei.c),Ti("onOverflowAmountChanged",{x:Do.x,y:Do.y},Do.c)}Ce&&Na&&(Va.c||Na.c)&&(Na.f||ie(),Ze.y&&Va.x&&ur.css(Bi+Ve,Na.w+ei.y),Ze.x&&Va.y&&ur.css(Bi+Qr,Na.h+ei.x),Na.c=!1),Fe&&Tt.updateOnLoad&&ho(),Ti("onUpdated",{forced:xt})}}function ho(){Se||Gn(function(V,Q){ur.find(Q).each(function(nt,pt){G.inA(pt,As)<0&&(As.push(pt),vt(pt).off(Sl,Yo).on(Sl,Yo))})})}function ds(V){var Q=wt._validate(V,wt._template,!0,bo);return bo=Hi({},bo,Q._default),ci=Hi({},ci,Q._prepared),Q._prepared}function Ns(V){var Q="parent",nt="os-resize-observer-host",pt=rs+M+wa,xt=Se?M+wa:b,Tt=ci.textarea.inheritedAttrs,Rt={},te=function(){var i=V?Tr:Ne;Xe(Rt,function(a,n){Gt(n)==ht.s&&(a==l.c?i.addClass(n):i.attr(a,n))})},Ht=[er,nr,Or,$e,Bo,gi,Ur,Ke,Ha,go,$i,Pn,No,rs,wa,Ho].join(M),ne={};Ne=Ne||(Se?ai?Tr[Q]()[Q]()[Q]()[Q]():vt(Nr(Or)):Tr),ur=ur||ja(wn+xt),lr=lr||ja(ca+xt),Mn=Mn||ja(Oi+xt),jn=jn||ja(nt),Dn=Dn||(Se?ja(Oo):gt),ai&&$r(Ne,nr),V&&Ui(Ne,Ht),Tt=Gt(Tt)==ht.s?Tt.split(M):Tt,G.isA(Tt)&&Se&&Xe(Tt,function(i,a){Gt(a)==ht.s&&(Rt[a]=V?Ne.attr(a):Tr.attr(a))}),V?(ai&&Fe?(jn.children().remove(),Xe([Mn,lr,ur,Dn],function(i,a){a&&Ui(a.removeAttr(l.s),Es)}),$r(Ne,Se?Or:er)):(qa(jn),ur.contents().unwrap().unwrap().unwrap(),Se&&(Tr.unwrap(),qa(Ne),qa(Dn),te())),Se&&Tr.removeAttr(l.s),Ce&&Ui(wo,Hr)):(Se&&(ci.sizeAutoCapable||(ne[Ve]=Tr.css(Ve),ne[Qr]=Tr.css(Qr)),ai||Tr.addClass(wa).wrap(Ne),Ne=Tr[Q]().css(ne)),ai||($r(Tr,Se?pt:er),Ne.wrapInner(ur).wrapInner(lr).wrapInner(Mn).prepend(jn),ur=$a(Ne,W+wn),lr=$a(Ne,W+ca),Mn=$a(Ne,W+Oi),Se&&(ur.prepend(Dn),te())),je&&$r(lr,Kn),Ze.x&&Ze.y&&$r(lr,ii),Ce&&$r(wo,Hr),zs=jn[0],Jn=Ne[0],co=Mn[0],jo=lr[0],pn=ur[0],ll())}function Al(){var V=[112,113,114,115,116,117,118,119,120,121,123,33,34,37,38,39,40,16,17,18,19,20,144],Q=[],nt,pt,xt=175,Tt="focus";function Rt(f){Vs(),ce.update(T),f&&ar&&clearInterval(nt)}function te(f){return Tr[lt]($t.i&&Ka?9999999:0),Tr[It](0),G.prvD(f),G.stpP(f),!1}function Ht(f){setTimeout(function(){ee||Rt()},50)}function ne(){Dr=!0,$r(Ne,Tt)}function i(){Dr=!1,Q=[],Ui(Ne,Tt),Rt(!0)}function a(f){var d=f.keyCode;ke(d,V)<0&&(Q[l.l]||(Rt(),nt=setInterval(Rt,1e3/60)),ke(d,Q)<0&&Q.push(d))}function n(f){var d=f.keyCode,y=ke(d,Q);ke(d,V)<0&&(y>-1&&Q.splice(y,1),Q[l.l]||Rt(!0))}function s(f){Eo!==!0&&(f=f.originalEvent||f,sl(f.propertyName)&&ce.update(T))}function p(f){si||(pt!==gt?clearTimeout(pt):((Ye||fn)&&rr(!0),va()||$r(Ne,Ha),Ti("onScrollStart",f)),da||(zi(!0),zi(!1)),Ti("onScroll",f),pt=setTimeout(function(){ee||(clearTimeout(pt),pt=gt,(Ye||fn)&&rr(!1),va()||Ui(Ne,Ha),Ti("onScrollStop",f))},xt))}Se?(Sr>9||!ar?pi(Tr,"input",Rt):pi(Tr,[Pt,Ue],[a,n]),pi(Tr,[k,"drop",Tt,Tt+"out"],[te,Ht,ne,i])):pi(ur,ae,s),pi(lr,k,p,!0)}function ma(V){var Q=function(Tt){var Rt=Tt?Qs:Ts,te=ja(ui+M+Rt,!0),Ht=ja(Fi,te),ne=ja(ws,te);return!ai&&!V&&(te.append(Ht),Ht.append(ne)),{_scrollbar:te,_track:Ht,_handle:ne}};function nt(Tt){var Rt=yn(Tt),te=Rt._scrollbar,Ht=Rt._track,ne=Rt._handle;ai&&Fe?Xe([te,Ht,ne],function(i,a){Ui(a.removeAttr(l.s),Es)}):qa(te||Q(Tt)._scrollbar)}var pt,xt;V?(nt(!0),nt()):(pt=Q(!0),xt=Q(),pa=pt._scrollbar,Ra=pt._track,Ba=pt._handle,ha=xt._scrollbar,Oa=xt._track,as=xt._handle,ai||(Mn.after(ha),Mn.after(pa)))}function Cl(V){var Q=yn(V),nt=Q._info,pt=Vr.top!==Vr,xt=Q._x_y,Tt=Q._X_Y,Rt=k+Q._Left_Top,te="active",Ht="snapHandle",ne="click",i=1,a=[16,17],n,s,p,f;function d($){return Sr&&pt?$["screen"+Tt]:G.page($)[xt]}function y($){return ci.scrollbars[$]}function g(){i=.5}function S(){i=1}function I($){G.stpP($)}function P($){ke($.keyCode,a)>-1&&g()}function A($){ke($.keyCode,a)>-1&&S()}function B($){var yt=$.originalEvent||$,kt=yt.touches!==gt;return si||ee||va()||!fa||kt&&!y("touchSupport")?!1:G.mBtn($)===1||kt}function R($){if(B($)){var yt=nt._trackLength,kt=nt._handleLength,Mt=nt._maxScroll,Nt=(d($)-p)*f,ye=Nt/(yt-kt),le=Mt*ye;le=isFinite(le)?le:0,tr&&V&&!$t.i&&(le*=-1),lr[Rt](St.round(s+le)),da&&zi(V,s+le),Et||G.prvD($)}else N($)}function N($){if($=$||$.originalEvent,dn(Ta,[me,Jt,Pt,Ue,Oe],[R,N,P,A,mn],!0),G.rAF()(function(){dn(Ta,ne,I,!0,{_capture:!0})}),da&&zi(V,!0),da=!1,Ui(uo,xo),Ui(Q._handle,te),Ui(Q._track,te),Ui(Q._scrollbar,te),s=gt,p=gt,f=1,S(),n!==gt&&(ce.scrollStop(),clearTimeout(n),n=gt),$){var yt=Jn[l.bCR](),kt=$.clientX>=yt.left&&$.clientX<=yt.right&&$.clientY>=yt.top&&$.clientY<=yt.bottom;kt||Ko(),(Ye||fn)&&rr(!1)}}function L($){B($)&&q($)}function q($){s=lr[Rt](),s=isNaN(s)?0:s,(tr&&V&&!$t.n||!tr)&&(s=s<0?0:s),f=ta()[xt],p=d($),da=!y(Ht),$r(uo,xo),$r(Q._handle,te),$r(Q._scrollbar,te),dn(Ta,[me,Jt,Oe],[R,N,mn]),G.rAF()(function(){dn(Ta,ne,I,!1,{_capture:!0})}),(Sr||!Rr)&&G.prvD($),G.stpP($)}function X($){if(B($)){var yt=Q._info._handleLength/Math.round(St.min(1,zr[Q._w_h]/Ia[Q._w_h])*Q._info._trackLength),kt=St.round(zr[Q._w_h]*yt),Mt=270*yt,Nt=400*yt,ye=Q._track.offset()[Q._left_top],le=$.ctrlKey,pe=$.shiftKey,Ge=pe&&le,jt=!0,Re="linear",Pe,_e,Ie=function(oe){da&&zi(V,oe)},ge=function(){Ie(),q($)},se=function(){if(!ee){var oe=(p-ye)*f,He=nt._handleOffset,Be=nt._trackLength,fi=nt._handleLength,di=nt._maxScroll,xi=nt._currentScroll,jr=Mt*i,bi=jt?St.max(Nt,jr):jr,Qe=di*((oe-fi/2)/(Be-fi)),Lr=tr&&V&&(!$t.i&&!$t.n||Ka),Pi=Lr?He<oe:He>oe,Ir={},Kr={easing:Re,step:function(ra){da&&(lr[Rt](ra),zi(V,ra))}};Qe=isFinite(Qe)?Qe:0,Qe=tr&&V&&!$t.i?di-Qe:Qe,pe?(lr[Rt](Qe),Ge?(Qe=lr[Rt](),lr[Rt](xi),Qe=Lr&&$t.i?di-Qe:Qe,Qe=Lr&&$t.n?-Qe:Qe,Ir[xt]=Qe,ce.scroll(Ir,Hi(Kr,{duration:130,complete:ge}))):ge()):(Pe=jt?Pi:Pe,_e=Lr?Pe?He+fi>=oe:He<=oe:Pe?He<=oe:He+fi>=oe,_e?(clearTimeout(n),ce.scrollStop(),n=gt,Ie(!0)):(n=setTimeout(se,bi),Ir[xt]=(Pe?"-=":"+=")+kt,ce.scroll(Ir,Hi(Kr,{duration:jr}))),jt=!1)}};le&&g(),f=ta()[xt],p=G.page($)[xt],da=!y(Ht),$r(uo,xo),$r(Q._track,te),$r(Q._scrollbar,te),dn(Ta,[Jt,Pt,Ue,Oe],[N,P,A,mn]),se(),G.prvD($),G.stpP($)}}function rt($){nl=!0,(Ye||fn)&&rr(!0)}function ct($){nl=!1,(Ye||fn)&&rr(!1)}function ot($){G.stpP($)}pi(Q._handle,Xt,L),pi(Q._track,[Xt,Ct,qt],[X,rt,ct]),pi(Q._scrollbar,Xt,ot),it&&pi(Q._scrollbar,ae,function($){$.target===Q._scrollbar[0]&&(Qn(V),zi(V))})}function hi(V,Q,nt){var pt=V?gi:Ur,xt=V?pa:ha;On(Ne,pt,!Q),On(xt,ql,!nt)}function rr(V,Q){if(clearTimeout(Fs),V)Ui(pa,Vo),Ui(ha,Vo);else{var nt,pt="active",xt=function(){!nl&&!ee&&(nt=Ba.hasClass(pt)||as.hasClass(pt),!nt&&(Ye||fn||Ln)&&$r(pa,Vo),!nt&&(Ye||fn||Ln)&&$r(ha,Vo))};Ya>0&&Q!==!0?Fs=setTimeout(xt,Ya):xt()}}function Qn(V){var Q={},nt=yn(V),pt=nt._info,xt=1e6,Tt=St.min(1,zr[nt._w_h]/Ia[nt._w_h]);Q[nt._width_height]=St.floor(Tt*100*xt)/xt+"%",va()||nt._handle.css(Q),pt._handleLength=nt._handle[0]["offset"+nt._Width_Height],pt._handleLengthRatio=Tt}function zi(V,Q){var nt=Gt(Q)==ht.b,pt=250,xt=tr&&V,Tt=yn(V),Rt=Tt._info,te="translate(",Ht=Ut._cssProperty("transform"),ne=Ut._cssProperty("transition"),i=V?lr[lt]():lr[It](),a=Q===gt||nt?i:Q,n=Rt._handleLength,s=Tt._track[0]["offset"+Tt._Width_Height],p=s-n,f={},d,y,g=(jo[k+Tt._Width_Height]-jo["client"+Tt._Width_Height])*($t.n&&xt?-1:1),S=function(N){return isNaN(N/g)?0:St.max(0,St.min(1,N/g))},I=function(N){var L=p*N;return L=isNaN(L)?0:L,L=xt&&!$t.i?s-n-L:L,L=St.max(0,L),L},P=S(i),A=S(a),B=I(A),R=I(P);Rt._maxScroll=g,Rt._currentScroll=i,Rt._currentScrollRatio=P,_t?(d=xt?-(s-n-B):B,y=V?te+d+"px, 0)":te+"0, "+d+"px)",f[Ht]=y,it&&(f[ne]=nt&&St.abs(B-Rt._handleOffset)>1?De(Tt._handle)+", "+(Ht+M+pt+"ms"):b)):f[Tt._left_top]=B,va()||(Tt._handle.css(f),_t&&it&&nt&&Tt._handle.one(ae,function(){ee||Tt._handle.css(ne,b)})),Rt._handleOffset=B,Rt._snappedHandleOffset=R,Rt._trackLength=s}function $n(V,Q){var nt=Q?"removeClass":"addClass",pt=V?Ra:Ba,xt=V?Oa:as,Tt=V?Uo:jl;pt[nt](Tt),xt[nt](Tt)}function yn(V){return{_width_height:V?Ve:Qr,_Width_Height:V?"Width":"Height",_left_top:V?dr:li,_Left_Top:V?"Left":"Top",_x_y:V?K:tt,_X_Y:V?"X":"Y",_w_h:V?"w":"h",_l_t:V?"l":"t",_track:V?Ra:Oa,_handle:V?Ba:as,_scrollbar:V?pa:ha,_info:V?Ji:Qi}}function za(V){Zi=Zi||ja(bl,!0),V?ai&&Fe?Ui(Zi.removeAttr(l.s),Es):qa(Zi):ai||Ne.append(Zi)}function Po(){var V=Vr.top!==Vr,Q={},nt={},pt={},xt;function Tt(ne){if(te(ne)){var i=Ht(ne),a={};(Xo||al)&&(a[Ve]=nt.w+(i.x-Q.x)*pt.x),(hs||al)&&(a[Qr]=nt.h+(i.y-Q.y)*pt.y),Ne.css(a),G.stpP(ne)}else Rt(ne)}function Rt(ne){var i=ne!==gt;dn(Ta,[Oe,me,Jt],[mn,Tt,Rt],!0),Ui(uo,xo),Zi.releaseCapture&&Zi.releaseCapture(),i&&(xt&&tn(),ce.update(T)),xt=!1}function te(ne){var i=ne.originalEvent||ne,a=i.touches!==gt;return si||ee?!1:G.mBtn(ne)===1||a}function Ht(ne){return Sr&&V?{x:ne.screenX,y:ne.screenY}:G.page(ne)}pi(Zi,Xt,function(ne){te(ne)&&!Co&&(Aa&&(xt=!0,Bn()),Q=Ht(ne),nt.w=Jn[l.oW]-(Mr?0:gr),nt.h=Jn[l.oH]-(Mr?0:an),pt=ta(),dn(Ta,[Oe,me,Jt],[mn,Tt,Rt]),$r(uo,xo),Zi.setCapture&&Zi.setCapture(),G.prvD(ne),G.stpP(ne))})}function Ti(V,Q,nt){if(nt!==!1)if(Fe){var pt=ci.callbacks[V],xt=V,Tt;xt.substr(0,2)==="on"&&(xt=xt.substr(2,1).toLowerCase()+xt.substr(3)),Gt(pt)==ht.f&&pt.call(ce,Q),Xe(kn,function(){Tt=this,Gt(Tt.on)==ht.f&&Tt.on(xt,Q)})}else ee||Tn.push({n:V,a:Q})}function ya(V,Q,nt){Q=Q||b,nt=nt||[b,b,b,b],V[Q+li]=nt[0],V[Q+qi]=nt[1],V[Q+cn]=nt[2],V[Q+dr]=nt[3]}function Kt(V,Q,nt,pt){return Q=Q||b,V=V||b,{t:pt?0:Gi(Ne.css(V+li+Q)),r:nt?0:Gi(Ne.css(V+qi+Q)),b:pt?0:Gi(Ne.css(V+cn+Q)),l:nt?0:Gi(Ne.css(V+dr+Q))}}function De(V){var Q=Ut._cssProperty("transition"),nt=V.css(Q);if(nt)return nt;for(var pt="\\s*(([^,(]+(\\(.+?\\))?)+)[\\s,]*",xt=new RegExp(pt),Tt=new RegExp("^("+pt+")+$"),Rt="property duration timing-function delay".split(" "),te=[],Ht,ne,i=0,a,n=function(s){if(Ht=[],!s.match(Tt))return s;for(;s.match(xt);)Ht.push(RegExp.$1),s=s.replace(xt,b);return Ht};i<Rt[l.l];i++)for(ne=n(V.css(Q+"-"+Rt[i])),a=0;a<ne[l.l];a++)te[a]=(te[a]?te[a]+M:b)+ne[a];return te.join(", ")}function Zn(V,Q){var nt,pt,xt,Tt=function(Rt,te){if(xt="",te&&typeof Rt==ht.s)for(pt=Rt.split(M),nt=0;nt<pt[l.l];nt++)xt+="|"+pt[nt]+"$";return xt};return new RegExp("(^"+er+"([-_].+|)$)"+Tt(Ho,V)+Tt(po,Q),"g")}function ta(){var V=co[l.bCR]();return{x:_t&&1/(St.round(V.width)/co[l.oW])||1,y:_t&&1/(St.round(V.height)/co[l.oH])||1}}function Ja(V){var Q="ownerDocument",nt="HTMLElement",pt=V&&V[Q]&&V[Q].parentWindow||Y;return typeof pt[nt]==ht.o?V instanceof pt[nt]:V&&typeof V==ht.o&&V!==null&&V.nodeType===1&&typeof V.nodeName==ht.s}function ea(V,Q){var nt=[],pt=[],xt,Tt;for(xt=0;xt<V.length;xt++)nt[V[xt]]=!0;for(xt=0;xt<Q.length;xt++)nt[Q[xt]]?delete nt[Q[xt]]:nt[Q[xt]]=!0;for(Tt in nt)pt.push(Tt);return pt}function Gi(V,Q){var nt=Q?parseFloat(V):parseInt(V,10);return isNaN(nt)?0:nt}function Tu(){var V=Ua.selectionStart;if(V!==gt){var Q=Tr.val(),nt=Q[l.l],pt=Q.split(`
`),xt=pt[l.l],Tt=Q.substr(0,V).split(`
`),Rt=0,te=0,Ht=Tt[l.l],ne=Tt[Tt[l.l]-1][l.l],i,a;for(a=0;a<pt[l.l];a++)i=pt[a][l.l],i>te&&(Rt=a+1,te=i);return{_cursorRow:Ht,_cursorColumn:ne,_rows:xt,_columns:te,_widestRow:Rt,_cursorPosition:V,_cursorMax:nt}}}function va(){return tl&&Ze.x&&Ze.y}function Xr(){return Se?Dn[0]:pn}function Nr(V,Q){return"<div "+(V?Gt(V)==ht.s?'class="'+V+'"':function(){var nt,pt=b;if(vt.isPlainObject(V))for(nt in V)pt+=(nt==="c"?"class":nt)+'="'+V[nt]+'" ';return pt}():b)+">"+(Q||b)+"</div>"}function ja(V,Q){var nt=Gt(Q)==ht.b,pt=nt?Ne:Q||Ne;return ai&&!pt[l.l]?null:ai?pt[nt?"children":"find"](W+V.replace(/\s/g,W)).eq(0):vt(Nr(V))}function Jo(V,Q){for(var nt=Q.split(W),pt=0,xt;pt<nt.length;pt++){if(!V[l.hOP](nt[pt]))return;xt=V[nt[pt]],pt<nt.length&&Gt(xt)==ht.o&&(V=xt)}return xt}function fo(V,Q,nt){for(var pt=Q.split(W),xt=pt.length,Tt=0,Rt={},te=Rt;Tt<xt;Tt++)Rt=Rt[pt[Tt]]=Tt+1<xt?{}:nt;vt.extend(V,te,!0)}function Gn(V){var Q=ci.updateOnLoad;Q=Gt(Q)==ht.s?Q.split(M):Q,G.isA(Q)&&!ee&&Xe(Q,V)}function Qa(V,Q,nt){if(nt)return nt;if(Gt(V)==ht.o&&Gt(Q)==ht.o){for(var pt in V)if(pt!=="c")if(V[l.hOP](pt)&&Q[l.hOP](pt)){if(Qa(V[pt],Q[pt]))return!0}else return!0}else return V!==Q;return!1}function Hi(){return vt.extend.apply(this,[!0].concat([].slice.call(arguments)))}function $r(V,Q){return fr.addClass.call(V,Q)}function Ui(V,Q){return fr.removeClass.call(V,Q)}function On(V,Q,nt){return nt?$r(V,Q):Ui(V,Q)}function qa(V){return fr.remove.call(V)}function $a(V,Q){return fr.find.call(V,Q).eq(0)}ce.sleep=function(){si=!0},ce.update=function(V){if(!ee){var Q,nt,pt=Gt(V)==ht.s,xt,Tt,Rt;return pt?V===T?(Q=qn(),nt=Ca(),xt=Q||nt,xt&&Si({_contentSizeChanged:nt,_changedOptions:Fe?gt:ci})):V===C?Aa?(Tt=us(Rs.takeRecords()),Rt=cs(Bs.takeRecords())):Tt=ce.update(T):V==="zoom"&&Si({_hostSizeChanged:!0,_contentSizeChanged:!0}):(V=si||V,si=!1,(!ce.update(C)||V)&&Si({_force:V})),ho(),xt||Tt||Rt}},ce.options=function(V,Q){var nt={},pt;if(vt.isEmptyObject(V)||!vt.isPlainObject(V))if(Gt(V)==ht.s)if(arguments.length>1)fo(nt,V,Q),pt=ds(nt);else return Jo(bo,V);else return bo;else pt=ds(V);vt.isEmptyObject(pt)||Si({_changedOptions:pt})},ce.destroy=function(){if(!ee){Jr.remove(ce),Bn(),Rn(jn),Rn(Da);for(var V in kn)ce.removeExt(V);for(;Os[l.l]>0;)Os.pop()();En(!0),Di&&qa(Di),La&&qa(La),_i&&qa(Da),ma(!0),za(!0),Ns(!0);for(var Q=0;Q<As[l.l];Q++)vt(As[Q]).off(Sl,Yo);As=gt,ee=!0,si=!0,wr(he,0),Ti("onDestroyed")}},ce.scroll=function(V,Q,nt,pt){if(arguments.length===0||V===gt){var xt=Ji,Tt=Qi,Rt=Ka&&tr&&$t.i,te=Ka&&tr&&$t.n,Ht=xt._currentScroll,ne=xt._currentScrollRatio,i=xt._maxScroll;return ne=Rt?1-ne:ne,Ht=Rt?i-Ht:Ht,Ht*=te?-1:1,i*=te?-1:1,{position:{x:Ht,y:Tt._currentScroll},ratio:{x:ne,y:Tt._currentScrollRatio},max:{x:i,y:Tt._maxScroll},handleOffset:{x:xt._handleOffset,y:Tt._handleOffset},handleLength:{x:xt._handleLength,y:Tt._handleLength},handleLengthRatio:{x:xt._handleLengthRatio,y:Tt._handleLengthRatio},trackLength:{x:xt._trackLength,y:Tt._trackLength},snappedHandleOffset:{x:xt._snappedHandleOffset,y:Tt._snappedHandleOffset},isRTL:tr,isRTLNormalized:Ka}}ce.update(C);var a=Ka,n=[K,dr,"l"],s=[tt,li,"t"],p=["+=","-=","*=","/="],f=Gt(Q)==ht.o,d=f?Q.complete:pt,y,g={},S={},I,P,A,B="end",R="begin",N="center",L="nearest",q="always",X="never",rt="ifneeded",ct=l.l,ot,$,yt,kt,Mt,Nt=[K,tt,"xy","yx"],ye=[R,B,N,L],le=[q,X,rt],pe=V[l.hOP]("el"),Ge=pe?V.el:V,jt=Ge instanceof vt||Vt?Ge instanceof Vt:!1,Re=jt?!1:Ja(Ge),Pe=function(){I&&zi(!0),P&&zi(!1)},_e=Gt(d)!=ht.f?gt:function(){Pe(),d()};function Ie(Ae,be){for(y=0;y<be[ct];y++)if(Ae===be[y])return!0;return!1}function ge(Ae,be){var mi=Ae?n:s;if(be=Gt(be)==ht.s||Gt(be)==ht.n?[be,be]:be,G.isA(be))return Ae?be[0]:be[1];if(Gt(be)==ht.o){for(y=0;y<mi[ct];y++)if(mi[y]in be)return be[mi[y]]}}function se(Ae,be){var mi=Gt(be)==ht.s,Er,yr,Vi=Ae?Ji:Qi,yi=Vi._currentScroll,xr=Vi._maxScroll,qr=" * ",cr,Fn=tr&&Ae,_a=Fn&&$t.n&&!a,sn="replace",ka=eval,ga;if(mi?(be[ct]>2&&(ga=be.substr(0,2),ke(ga,p)>-1&&(Er=ga)),be=Er?be.substr(2):be,be=be[sn](/min/g,0)[sn](/</g,0)[sn](/max/g,(_a?"-":b)+U)[sn](/>/g,(_a?"-":b)+U)[sn](/px/g,b)[sn](/%/g,qr+xr*(Fn&&$t.n?-1:1)/100)[sn](/vw/g,qr+zr.w)[sn](/vh/g,qr+zr.h),yr=Gi(isNaN(be)?Gi(ka(be),!0).toFixed():be)):yr=be,yr!==gt&&!isNaN(yr)&&Gt(yr)==ht.n){var yo=a&&Fn,Un=yi*(yo&&$t.n?-1:1),na=yo&&$t.i,Kl=yo&&$t.n;switch(Un=na?xr-Un:Un,Er){case"+=":cr=Un+yr;break;case"-=":cr=Un-yr;break;case"*=":cr=Un*yr;break;case"/=":cr=Un/yr;break;default:cr=yr;break}cr=na?xr-cr:cr,cr*=Kl?-1:1,cr=Fn&&$t.n?St.min(0,St.max(xr,cr)):St.max(0,St.min(xr,cr))}return cr===yi?gt:cr}function oe(Ae,be,mi,Er){var yr=[mi,mi],Vi=Gt(Ae),yi,xr;if(Vi==be)Ae=[Ae,Ae];else if(Vi==ht.a){if(yi=Ae[ct],yi>2||yi<1)Ae=yr;else for(yi===1&&(Ae[1]=mi),y=0;y<yi;y++)if(xr=Ae[y],Gt(xr)!=be||!Ie(xr,Er)){Ae=yr;break}}else Vi==ht.o?Ae=[Ae[K]||mi,Ae[tt]||mi]:Ae=yr;return{x:Ae[0],y:Ae[1]}}function He(Ae){var be=[],mi,Er,yr=[li,qi,cn,dr];for(y=0;y<Ae[ct]&&y!==yr[ct];y++)mi=Ae[y],Er=Gt(mi),Er==ht.b?be.push(mi?Gi(Mt.css(ki+yr[y])):0):be.push(Er==ht.n?mi:0);return be}if(jt||Re){var Be=pe?V.margin:0,fi=pe?V.axis:0,di=pe?V.scroll:0,xi=pe?V.block:0,jr=[0,0,0,0],bi=Gt(Be),Qe;if(Mt=jt?Ge:vt(Ge),Mt[ct]>0){bi==ht.n||bi==ht.b?Be=He([Be,Be,Be,Be]):bi==ht.a?(Qe=Be[ct],Qe===2?Be=He([Be[0],Be[1],Be[0],Be[1]]):Qe>=4?Be=He(Be):Be=jr):bi==ht.o?Be=He([Be[li],Be[qi],Be[cn],Be[dr]]):Be=jr,ot=Ie(fi,Nt)?fi:"xy",$=oe(di,ht.s,q,le),yt=oe(xi,ht.s,R,ye),kt=Be;var Lr={l:Ji._currentScroll,t:Qi._currentScroll},Pi=Mn.offset(),Ir=Mt.offset(),Kr={x:$.x==X||ot==tt,y:$.y==X||ot==K};Ir[li]-=kt[0],Ir[dr]-=kt[3];var ra={x:St.round(Ir[dr]-Pi[dr]+Lr.l),y:St.round(Ir[li]-Pi[li]+Lr.t)};if(tr&&(!$t.n&&!$t.i&&(ra.x=St.round(Pi[dr]-Ir[dr]+Lr.l)),$t.n&&a&&(ra.x*=-1),$t.i&&a&&(ra.x=St.round(Pi[dr]-Ir[dr]+(Ji._maxScroll-Lr.l)))),yt.x!=R||yt.y!=R||$.x==rt||$.y==rt||tr){var Pa=Mt[0],mo=_t?Pa[l.bCR]():{width:Pa[l.oW],height:Pa[l.oH]},vn={w:mo[Ve]+kt[3]+kt[1],h:mo[Qr]+kt[0]+kt[2]},ia=function(Ae){var be=yn(Ae),mi=be._w_h,Er=be._left_top,yr=be._x_y,Vi=yt[yr]==(Ae&&tr?R:B),yi=yt[yr]==N,xr=yt[yr]==L,qr=$[yr]==X,cr=$[yr]==rt,Fn=zr[mi],_a=Pi[Er],sn=vn[mi],ka=Ir[Er],ga=yi?2:1,yo=ka+sn/2,Un=_a+Fn/2,na=sn<=Fn&&ka>=_a&&ka+sn<=_a+Fn;qr?Kr[yr]=!0:Kr[yr]||((xr||cr)&&(Kr[yr]=cr?na:!1,Vi=sn<Fn?yo>Un:yo<Un),ra[yr]-=Vi||yi?(Fn/ga-sn/ga)*(Ae&&tr&&a?-1:1):0)};ia(!0),ia(!1)}Kr.y&&delete ra.y,Kr.x&&delete ra.x,V=ra}}g[lt]=se(!0,ge(!0,V)),g[It]=se(!1,ge(!1,V)),I=g[lt]!==gt,P=g[It]!==gt,(I||P)&&(Q>0||f)?f?(Q.complete=_e,lr.animate(g,Q)):(A={duration:Q,complete:_e},G.isA(nt)||vt.isPlainObject(nt)?(S[lt]=nt[0]||nt.x,S[It]=nt[1]||nt.y,A.specialEasing=S):A.easing=nt,lr.animate(g,A)):(I&&lr[lt](g[lt]),P&&lr[It](g[It]),Pe())},ce.scrollStop=function(V,Q,nt){return lr.stop(V,Q,nt),ce},ce.getElements=function(V){var Q={target:Ua,host:Jn,padding:co,viewport:jo,content:pn,scrollbarHorizontal:{scrollbar:pa[0],track:Ra[0],handle:Ba[0]},scrollbarVertical:{scrollbar:ha[0],track:Oa[0],handle:as[0]},scrollbarCorner:Zi[0]};return Gt(V)==ht.s?Jo(Q,V):Q},ce.getState=function(V){function Q(pt){if(!vt.isPlainObject(pt))return pt;var xt=Hi({},pt),Tt=function(Rt,te){xt[l.hOP](Rt)&&(xt[te]=xt[Rt],delete xt[Rt])};return Tt("w",Ve),Tt("h",Qr),delete xt.c,xt}var nt={destroyed:!!Q(ee),sleeping:!!Q(si),autoUpdate:Q(!Aa),widthAuto:Q(hn),heightAuto:Q(Wa),padding:Q(To),overflowAmount:Q(Xa),hideOverflow:Q(qo),hasOverflow:Q(Va),contentScrollSize:Q(Ia),viewportSize:Q(zr),hostSize:Q(Ea),documentMixed:Q(Rr)};return Gt(V)==ht.s?Jo(nt,V):nt},ce.ext=function(V){var Q,nt=lo.split(" "),pt=0;if(Gt(V)==ht.s){if(kn[l.hOP](V))for(Q=Hi({},kn[V]);pt<nt.length;pt++)delete Q[nt[pt]]}else{Q={};for(pt in kn)Q[pt]=Hi({},ce.ext(pt))}return Q},ce.addExt=function(V,Q){var nt=Bt.extension(V),pt,xt,Tt,Rt,te=!0;if(nt){if(kn[l.hOP](V))return ce.ext(V);if(pt=nt.extensionFactory.call(ce,Hi({},nt.defaultOptions),vt,G),pt&&(Tt=pt.contract,Gt(Tt)==ht.f&&(Rt=Tt(Y),te=Gt(Rt)==ht.b?Rt:te),te))return kn[V]=pt,xt=pt.added,Gt(xt)==ht.f&&xt(Q),ce.ext(V)}else console.warn('A extension with the name "'+V+`" isn't registered.`)},ce.removeExt=function(V){var Q=kn[V],nt;return Q?(delete kn[V],nt=Q.removed,Gt(nt)==ht.f&&nt(),!0):!1};function ko(V,Q,nt){so=ze.defaultOptions,je=ze.nativeScrollbarStyling,ft=Hi({},ze.nativeScrollbarSize),Ze=Hi({},ze.nativeScrollbarIsOverlaid),ei=Hi({},ze.overlayScrollbarDummySize),$t=Hi({},ze.rtlScrollBehavior),ds(Hi({},so,Q)),et=ze.cssCalc,Sr=ze.msie,ar=ze.autoUpdateRecommended,it=ze.supportTransition,_t=ze.supportTransform,Et=ze.supportPassiveEvents,de=ze.supportResizeObserver,Ee=ze.supportMutationObserver,Ta=vt(V.ownerDocument),Fa=Ta[0],ns=vt(Fa.defaultView||Fa.parentWindow),Vr=ns[0],wo=$a(Ta,"html"),uo=$a(wo,"body"),Tr=vt(V),Ua=Tr[0],Se=Tr.is("textarea"),Ce=Tr.is("body"),Rr=Fa!==ut,ai=Se?Tr.hasClass(rs)&&Tr.parent().hasClass(wn):Tr.hasClass(er)&&Tr.children(W+Oi)[l.l];var pt,xt;return Ze.x&&Ze.y&&!ci.nativeScrollbarsOverlaid.initialize?(Ti("onInitializationWithdrawn"),ai&&(Ns(!0),ma(!0),za(!0)),ee=!0,si=!0,ce):(Ce&&(pt={},pt.l=St.max(Tr[lt](),wo[lt](),ns[lt]()),pt.t=St.max(Tr[It](),wo[It](),ns[It]()),xt=function(){lr.removeAttr(l.ti),dn(lr,Xt,xt,!0,!0)}),Ns(),ma(),za(),Al(),Cl(!0),Cl(!1),Po(),Xl(),Rn(jn,re),Ce&&(lr[lt](pt.l)[It](pt.t),ut.activeElement==V&&jo.focus&&(lr.attr(l.ti,"-1"),jo.focus(),dn(lr,Xt,xt,!1,!0))),ce.update(T),Fe=!0,Ti("onInitialized"),Xe(Tn,function(Tt,Rt){Ti(Rt.n,Rt.a)}),Tn=[],Gt(nt)==ht.s&&(nt=[nt]),G.isA(nt)?Xe(nt,function(Tt,Rt){ce.addExt(Rt)}):vt.isPlainObject(nt)&&Xe(nt,function(Tt,Rt){ce.addExt(Tt,Rt)}),setTimeout(function(){it&&!ee&&$r(Ne,Ke)},333),ce)}return Bt.valid(ko(he,Te,_r))&&wr(he,ce),ce}return Bt=Y[Yt]=function(he,Te,_r){if(arguments[l.l]===0)return this;var ze=[],Jr=vt.isPlainObject(Te),Gt,ke;return he?(he=he[l.l]!=gt?he:[he[0]||he],At(),he[l.l]>0&&(Jr?vt.each(he,function(Xe,ce){Gt=ce,Gt!==gt&&ze.push(sr(Gt,Te,_r,Lt,Z))}):vt.each(he,function(Xe,ce){Gt=wr(ce),(Te==="!"&&Bt.valid(Gt)||G.type(Te)==ht.f&&Te(ce,Gt)||Te===gt)&&ze.push(Gt)}),ke=ze[l.l]===1?ze[0]:ze),ke):Jr||!Te?ke:ze},Bt.globals=function(){At();var he=vt.extend(!0,{},Lt);return delete he.msie,he},Bt.defaultOptions=function(he){At();var Te=Lt.defaultOptions;if(he===gt)return vt.extend(!0,{},Te);Lt.defaultOptions=vt.extend(!0,{},Te,wt._validate(he,wt._template,!0,Te)._default)},Bt.valid=function(he){return he instanceof Bt&&!he.getState().destroyed},Bt.extension=function(he,Te,_r){var ze=G.type(he)==ht.s,Jr=arguments[l.l],Gt=0;if(Jr<1||!ze)return vt.extend(!0,{length:bt[l.l]},bt);if(ze){if(G.type(Te)==ht.f)bt.push({name:he,extensionFactory:Te,defaultOptions:_r});else for(;Gt<bt[l.l];Gt++)if(bt[Gt].name===he)if(Jr>1)bt.splice(Gt,1);else return vt.extend(!0,{},bt[Gt])}},Bt}();return Vt&&Vt.fn&&(Vt.fn.overlayScrollbars=function(Bt,Lt){var Z=this;return Vt.isPlainObject(Bt)?(Vt.each(Z,function(){kr(this,Bt,Lt)}),Z):kr(Z,Bt)}),kr})})(hf);var Um=hf.exports;function ff(D){return Object.prototype.toString.call(D)==="[object Date]"}function Mp(D,Y,ut,gt){if(typeof ut=="number"||ff(ut)){const Yt=gt-ut,ht=(ut-Y)/(D.dt||1/60),l=D.opts.stiffness*Yt,Ut=D.opts.damping*ht,G=(l-Ut)*D.inv_mass,St=(ht+G)*D.dt;return Math.abs(St)<D.opts.precision&&Math.abs(Yt)<D.opts.precision?gt:(D.settled=!1,ff(ut)?new Date(ut.getTime()+St):ut+St)}else{if(Array.isArray(ut))return ut.map((Yt,ht)=>Mp(D,Y[ht],ut[ht],gt[ht]));if(typeof ut=="object"){const Yt={};for(const ht in ut)Yt[ht]=Mp(D,Y[ht],ut[ht],gt[ht]);return Yt}else throw new Error(`Cannot spring ${typeof ut} values`)}}function Vm(D,Y={}){const ut=uf(D),{stiffness:gt=.15,damping:Yt=.8,precision:ht=.01}=Y;let l,Ut,G,St=D,Vt=D,We=1,vt=0,wr=!1;function kr(Lt,Z={}){Vt=Lt;const bt=G={};if(D==null||Z.hard||Bt.stiffness>=1&&Bt.damping>=1)return wr=!0,l=qc(),St=Lt,ut.set(D=Vt),Promise.resolve();if(Z.soft){const wt=Z.soft===!0?.5:+Z.soft;vt=1/(wt*60),We=0}return Ut||(l=qc(),wr=!1,Ut=Ap(wt=>{if(wr)return wr=!1,Ut=null,!1;We=Math.min(We+vt,1);const At={inv_mass:We,opts:Bt,settled:!0,dt:(wt-l)*60/1e3},ue=Mp(At,St,D,Vt);return l=wt,St=D,ut.set(D=ue),At.settled&&(Ut=null),!At.settled})),new Promise(wt=>{Ut.promise.then(()=>{bt===G&&wt()})})}const Bt={set:kr,update:(Lt,Z)=>kr(Lt(Vt,D),Z),subscribe:ut.subscribe,stiffness:gt,damping:Yt,precision:ht};return Bt}export{Qd as $,Im as A,Zd as B,xd as C,uf as D,gm as E,Md as F,cm as G,dm as H,Pd as I,sm as J,oc as K,Sm as L,Lm as M,Bm as N,Ro as O,Jd as P,Fm as Q,_m as R,Pm as S,km as T,Yd as U,lm as V,Tm as W,nm as X,tm as Y,em as Z,$d as _,Ld as a,Rm as a0,Hd as a1,Um as a2,Dm as a3,Om as a4,Mm as a5,Vm as a6,rm as a7,Nl as a8,Kd as a9,ef as aa,Dd as b,um as c,kd as d,Jh as e,fm as f,im as g,Bd as h,zm as i,hm as j,am as k,om as l,pm as m,xm as n,wm as o,bm as p,jd as q,vm as r,bd as s,Cp as t,ym as u,mm as v,Am as w,Cm as x,qd as y,Em as z};

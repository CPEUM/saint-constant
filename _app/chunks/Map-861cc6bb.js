import{S as X,i as W,s as T,C as J,e as C,O as V,t as le,c as N,a as P,P as G,d as w,h as fe,b as c,f as j,a1 as x,I as K,g as A,J as k,Q as ke,z as Ee,E as H,a2 as I,a3 as ze,a4 as Pe,k as q,m as O,j as Le,K as Me,R as Be,v as ce,a5 as Ce,a6 as ue,l as $,n as he,o as Z,p as me,w as de,x as pe,y as ge,q as B,B as _e,_ as Ne,a7 as De,a8 as ee,X as Ze,Y as Se,Z as Fe,N as F,a9 as Ve,aa as te}from"./index-8814b013.js";import{d as Ge,w as Re}from"./index-ff6a0fc0.js";import{d as qe,m as re,e as se,f as Oe,a as Ae,b as He,c as je,g as ae}from"./Map.svelte_svelte_type_style_lang-ad9468b4.js";import{e as Ke,s as Qe}from"./index-b9ab12a0.js";function Te(s,t,e){e===void 0&&(e={});var r={type:"Feature"};return(e.id===0||e.id)&&(r.id=e.id),e.bbox&&(r.bbox=e.bbox),r.properties=t||{},r.geometry=s,r}function Ue(s,t,e){e===void 0&&(e={});for(var r=0,a=s;r<a.length;r++){var i=a[r];if(i.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var o=0;o<i[i.length-1].length;o++)if(i[i.length-1][o]!==i[0][o])throw new Error("First and last Position are not equivalent.")}var l={type:"Polygon",coordinates:s};return Te(l,t,e)}function Ye(s,t){t===void 0&&(t={});var e={type:"FeatureCollection"};return t.id&&(e.id=t.id),t.bbox&&(e.bbox=t.bbox),e.features=s,e}function nt(s){return!isNaN(s)&&s!==null&&!Array.isArray(s)}function ve(s,t,e){if(s!==null)for(var r,a,i,o,l,n,d,b=0,m=0,f,_=s.type,p=_==="FeatureCollection",u=_==="Feature",y=p?s.features.length:1,v=0;v<y;v++){d=p?s.features[v].geometry:u?s.geometry:s,f=d?d.type==="GeometryCollection":!1,l=f?d.geometries.length:1;for(var E=0;E<l;E++){var z=0,M=0;if(o=f?d.geometries[E]:d,o!==null){n=o.coordinates;var L=o.type;switch(b=e&&(L==="Polygon"||L==="MultiPolygon")?1:0,L){case null:break;case"Point":if(t(n,m,v,z,M)===!1)return!1;m++,z++;break;case"LineString":case"MultiPoint":for(r=0;r<n.length;r++){if(t(n[r],m,v,z,M)===!1)return!1;m++,L==="MultiPoint"&&z++}L==="LineString"&&z++;break;case"Polygon":case"MultiLineString":for(r=0;r<n.length;r++){for(a=0;a<n[r].length-b;a++){if(t(n[r][a],m,v,z,M)===!1)return!1;m++}L==="MultiLineString"&&z++,L==="Polygon"&&M++}L==="Polygon"&&z++;break;case"MultiPolygon":for(r=0;r<n.length;r++){for(M=0,a=0;a<n[r].length;a++){for(i=0;i<n[r][a].length-b;i++){if(t(n[r][a][i],m,v,z,M)===!1)return!1;m++}M++}z++}break;case"GeometryCollection":for(r=0;r<o.geometries.length;r++)if(ve(o.geometries[r],t,e)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Q(s){var t=[1/0,1/0,-1/0,-1/0];return ve(s,function(e){t[0]>e[0]&&(t[0]=e[0]),t[1]>e[1]&&(t[1]=e[1]),t[2]<e[0]&&(t[2]=e[0]),t[3]<e[1]&&(t[3]=e[1])}),t}Q.default=Q;function Je(s,t){t===void 0&&(t={});var e=Number(s[0]),r=Number(s[1]),a=Number(s[2]),i=Number(s[3]);if(s.length===6)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var o=[e,r],l=[e,i],n=[a,i],d=[a,r];return Ue([[o,d,n,l,o]],t.properties,{bbox:s,id:t.id})}function Xe(s){let t,e,r,a,i,o,l=`rotate(${s[1]}deg)`,n,d,b=[s[2]],m={};for(let f=0;f<b.length;f+=1)m=J(m,b[f]);return{c(){t=C("div"),e=V("svg"),r=V("path"),a=V("path"),i=V("text"),o=le("N"),this.h()},l(f){t=N(f,"DIV",{});var _=P(t);e=G(_,"svg",{xmlns:!0,width:!0,height:!0,viewBox:!0,preserveAspectRatio:!0,class:!0});var p=P(e);r=G(p,"path",{"vector-effect":!0,d:!0,class:!0}),P(r).forEach(w),a=G(p,"path",{d:!0,id:!0,class:!0}),P(a).forEach(w),i=G(p,"text",{x:!0,y:!0,"text-anchor":!0,class:!0});var u=P(i);o=fe(u,"N"),u.forEach(w),p.forEach(w),_.forEach(w),this.h()},h(){c(r,"vector-effect","non-scaling-stroke"),c(r,"d","M35,50 L50,95 65,50Z"),c(r,"class","cpeum-1j5xfwi"),c(a,"d","M35,50 L50,5 65,50Z"),c(a,"id","north"),c(a,"class","cpeum-1j5xfwi"),c(i,"x","50"),c(i,"y","0"),c(i,"text-anchor","middle"),c(i,"class","cpeum-1j5xfwi"),c(e,"xmlns","http://www.w3.org/2000/svg"),c(e,"width","100"),c(e,"height","100"),c(e,"viewBox","0 0 100 100"),c(e,"preserveAspectRatio","xMidYMid"),c(e,"class","cpeum-1j5xfwi"),j(e,"transform",l,!1),x(t,m),j(t,"--size",s[0],!1),K(t,"cpeum-1j5xfwi",!0)},m(f,_){A(f,t,_),k(t,e),k(e,r),k(e,a),k(e,i),k(i,o),n||(d=ke(t,"click",s[3]),n=!0)},p(f,[_]){_&2&&l!==(l=`rotate(${f[1]}deg)`)&&j(e,"transform",l,!1),x(t,m=Ee(b,[_&4&&f[2]])),j(t,"--size",f[0],!1),K(t,"cpeum-1j5xfwi",!0)},i:H,o:H,d(f){f&&w(t),n=!1,d()}}}function We(s,t,e){const r=["size","bearing"];let a=I(t,r),{size:i="40px"}=t,{bearing:o}=t;function l(n){Pe.call(this,s,n)}return s.$$set=n=>{t=J(J({},t),ze(n)),e(2,a=I(t,r)),"size"in n&&e(0,i=n.size),"bearing"in n&&e(1,o=n.bearing)},[i,o,a,l]}class xe extends X{constructor(t){super(),W(this,t,We,Xe,T,{size:0,bearing:1})}}function Ie(s){let t,e,r,a,i,o,l,n;return{c(){t=C("div"),e=C("div"),r=C("div"),a=le(s[0]),i=q(),o=V("svg"),l=V("path"),this.h()},l(d){t=N(d,"DIV",{id:!0,class:!0});var b=P(t);e=N(b,"DIV",{id:!0,class:!0});var m=P(e);r=N(m,"DIV",{id:!0,class:!0});var f=P(r);a=fe(f,s[0]),f.forEach(w),i=O(m),o=G(m,"svg",{id:!0,viewBox:!0,width:!0,height:!0,class:!0});var _=P(o);l=G(_,"path",{d:!0,class:!0}),P(l).forEach(w),_.forEach(w),m.forEach(w),b.forEach(w),this.h()},h(){c(r,"id","content"),c(r,"class","cpeum-1mzxy9c"),c(l,"d","M 0,0 C 5,0 10,20 15,20 C 20,20 25,0 30,0 Z"),c(l,"class","cpeum-1mzxy9c"),c(o,"id","pin"),c(o,"viewBox","0 0 30 20"),c(o,"width","30"),c(o,"height","20"),c(o,"class","cpeum-1mzxy9c"),c(e,"id","inner"),c(e,"class","cpeum-1mzxy9c"),c(t,"id","wrap"),c(t,"class","cpeum-1mzxy9c")},m(d,b){A(d,t,b),k(t,e),k(e,r),k(r,a),k(e,i),k(e,o),k(o,l),s[4](t)},p(d,[b]){s=d,b&1&&Le(a,s[0])},i(d){n||Me(()=>{n=Be(e,Qe,{start:.8,opacity:0,duration:250,easing:Ke}),n.start()})},o:H,d(d){d&&w(t),s[4](null)}}}function $e(s,t,e){let{map:r}=t,{text:a}=t,{coords:i}=t,o;ce(()=>{new qe.exports.Marker({element:o,anchor:"bottom"}).setLngLat(i).addTo(r)}),Ce(()=>{});function l(n){ue[n?"unshift":"push"](()=>{o=n,e(1,o)})}return s.$$set=n=>{"map"in n&&e(2,r=n.map),"text"in n&&e(0,a=n.text),"coords"in n&&e(3,i=n.coords)},[a,o,r,i,l]}class et extends X{constructor(t){super(),W(this,t,$e,Ie,T,{map:2,text:0,coords:3})}}function ie(s){let t=s[3],e,r,a=oe(s);return{c(){a.c(),e=$()},l(i){a.l(i),e=$()},m(i,o){a.m(i,o),A(i,e,o),r=!0},p(i,o){o&8&&T(t,t=i[3])?(he(),Z(a,1,1,H),me(),a=oe(i),a.c(),B(a,1),a.m(e.parentNode,e)):a.p(i,o)},i(i){r||(B(a),r=!0)},o(i){Z(a),r=!1},d(i){i&&w(e),a.d(i)}}}function oe(s){let t,e;return t=new et({props:{map:g,text:s[3].text,coords:s[3].coords}}),{c(){de(t.$$.fragment)},l(r){pe(t.$$.fragment,r)},m(r,a){ge(t,r,a),e=!0},p(r,a){const i={};a&0&&(i.map=g),a&8&&(i.text=r[3].text),a&8&&(i.coords=r[3].coords),t.$set(i)},i(r){e||(B(t.$$.fragment,r),e=!0)},o(r){Z(t.$$.fragment,r),e=!1},d(r){_e(t,r)}}}function tt(s){let t,e,r,a,i,o,l,n,d,b,m,f=s[3]&&ie(s);n=new xe({props:{bearing:s[1]}}),n.$on("click",s[4]);const _=s[12].default,p=Ne(_,s,s[11],null);return{c(){t=C("link"),e=q(),r=C("figure"),f&&f.c(),a=q(),i=C("div"),o=q(),l=C("div"),de(n.$$.fragment),d=q(),p&&p.c(),this.h()},l(u){const y=De('[data-svelte="svelte-1yi8k0v"]',document.head);t=N(y,"LINK",{rel:!0,href:!0}),y.forEach(w),e=O(u),r=N(u,"FIGURE",{class:!0});var v=P(r);f&&f.l(v),a=O(v),i=N(v,"DIV",{id:!0,class:!0}),P(i).forEach(w),o=O(v),l=N(v,"DIV",{id:!0,class:!0});var E=P(l);pe(n.$$.fragment,E),d=O(E),p&&p.l(E),E.forEach(w),v.forEach(w),this.h()},h(){c(t,"rel","stylesheet"),c(t,"href","https://unpkg.com/maplibre-gl@2.1.7/dist/maplibre-gl.css"),c(i,"id","container"),c(i,"class","cpeum-1vymoz8"),c(l,"id","info"),c(l,"class","cpeum-1vymoz8"),c(r,"class",b=ee(s[2].class)+" cpeum-1vymoz8"),K(r,"full",s[2].full)},m(u,y){k(document.head,t),A(u,e,y),A(u,r,y),f&&f.m(r,null),k(r,a),k(r,i),s[13](i),k(r,o),k(r,l),ge(n,l,null),k(l,d),p&&p.m(l,null),m=!0},p(u,[y]){u[3]?f?(f.p(u,y),y&8&&B(f,1)):(f=ie(u),f.c(),B(f,1),f.m(r,a)):f&&(he(),Z(f,1,1,()=>{f=null}),me());const v={};y&2&&(v.bearing=u[1]),n.$set(v),p&&p.p&&(!m||y&2048)&&Ze(p,_,u,u[11],m?Fe(_,u[11],y,null):Se(u[11]),null),(!m||y&4&&b!==(b=ee(u[2].class)+" cpeum-1vymoz8"))&&c(r,"class",b),y&4&&K(r,"full",u[2].full)},i(u){m||(B(f),B(n.$$.fragment,u),B(p,u),m=!0)},o(u){Z(f),Z(n.$$.fragment,u),Z(p,u),m=!1},d(u){w(t),u&&w(e),u&&w(r),f&&f.d(),s[13](null),_e(n),p&&p.d(u)}}}const ne=Re(!1);let g;function Y(s,t){for(const e of s)g.setFeatureState(e,{highlight:t})}function rt(s,t,e){let r,a,i=H,o,l,n,d;F(s,Ae,h=>e(7,r=h)),F(s,ne,h=>e(8,a=h)),F(s,He,h=>e(10,l=h)),F(s,re,h=>e(2,n=h)),F(s,je,h=>e(3,d=h)),s.$$.on_destroy.push(()=>i());let{$$slots:b={},$$scope:m}=t;const f=Ve();let _,p=0,u=0,y=20,v=14,E;function z(){g.flyTo({center:E,pitch:y,zoom:v,bearing:u,duration:750})}function M(){e(1,p=0),g.flyTo({bearing:0})}const L=Ge(re,h=>h.full);F(s,L,h=>e(9,o=h));let D;ce(()=>{g=new se.Map({container:_,style:"https://api.maptiler.com/maps/856b4e05-cd2c-42db-9453-9cd7e156a083/style.json?key=dtV5LH1SmQB4VOb80qqI",bounds:Oe.fallback,fitBoundsOptions:{padding:100},bearing:p,pitch:y,zoom:v,minZoom:10,maxZoom:20}),g.on("error",h=>{f("error")}),g.once("load",()=>{ne.set(!0),f("load"),e(1,p=g.getBearing()),y=g.getPitch(),v=g.getZoom(),E=g.getCenter()}),g.on("rotate",h=>{e(1,p=g.getBearing()),h.originalEvent&&(u=g.getBearing())}),g.on("pitchend",h=>{h.originalEvent&&(y=g.getPitch())}),g.on("zoomend",h=>{h.originalEvent&&(v=g.getZoom(),E=g.getCenter())}),g.on("dragend",h=>{E=g.getCenter()})});function be(h){ue[h?"unshift":"push"](()=>{_=h,e(0,_)})}return s.$$set=h=>{"$$scope"in h&&e(11,m=h.$$scope)},s.$$.update=()=>{if(s.$$.dirty&1792&&a&&!o){if(!l)z();else if(l.bounds)g.fitBounds(l.bounds,{bearing:0,pitch:l.pitch!==void 0&&l.pitch!==null?l.pitch:20,duration:750});else if(l.center)g.flyTo({center:l.center.point,zoom:l.center.zoom,bearing:0,pitch:20,duration:750});else if(l.filter){const h=Object.entries(l.filter),S=te(ae).filter(R=>h.every(([ye,we])=>R.properties[ye]===we)),U=new se.LngLatBounds(Q(Ye(S.map(R=>Je(Q(R))))));g.fitBounds(U,{padding:200,maxZoom:15})}}if(s.$$.dirty&768&&a&&o&&z(),s.$$.dirty&448&&a)if(r){D&&Y(D,!1);const h=Object.entries(r);e(6,D=te(ae).filter(S=>h.every(([U,R])=>S.properties[U]===R)).map(S=>({id:S.id,source:S.properties.source}))),Y(D,!0)}else D&&Y(D,!1)},[_,p,n,d,M,L,D,r,a,o,l,m,b,be]}class lt extends X{constructor(t){super(),W(this,t,rt,tt,T,{})}}export{xe as F,lt as M,g as a,nt as i,ne as m};

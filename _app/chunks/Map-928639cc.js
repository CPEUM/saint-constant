import{S as ie,i as ae,s as x,D as se,l as q,P as T,r as _e,m as N,n as C,Q as H,h as y,u as ve,p as f,q as J,a4 as oe,K as X,b as Q,O as k,R as De,A as qe,F as U,a5 as le,a6 as Ne,a7 as Se,a as j,c as K,v as Ze,L as Re,T as Ve,o as be,a8 as Ge,a9 as ye,a0 as Oe,x as we,Y as Te,y as ke,aa as ce,z as Ee,f as D,g as Me,t as V,d as Ce,a1 as He,a2 as Ae,a3 as je,C as Le,J as O,ab as Ke,ac as ue,e as fe}from"./index-246e4404.js";import{w as A,d as Qe}from"./index-2b88267d.js";import{m as Ue,a as de,b as Ye}from"./map-9509ad70.js";import{e as Je,s as Xe}from"./index-7f5d761f.js";import{c as G}from"./singletons-d1fb5791.js";import{b as We}from"./paths-396f020f.js";const xe=A(null),Ie=function(){const{subscribe:s,update:r}=A(null);let e;return{subscribe:s,set:t=>{r(i=>(e=i,t))},getPrevious:()=>e}}(),te=function(){const{subscribe:s,set:r,update:e}=A({full:!1,class:""});return{subscribe:s,set:r,toggle:()=>{e(t=>({...t,full:!t.full}))},setFull:t=>{e(i=>({...i,full:t}))},setClass:t=>{e(i=>({...i,class:t}))},clearClass:()=>{e(t=>({...t,class:""}))}}}(),$e=A(null),he=function(){const{subscribe:s,set:r,update:e}=A([]);return{subscribe:s,add:(...t)=>e(i=>(i.push(...t),i)),removeById:(...t)=>e(i=>i.filter(a=>[...t].includes(!a.id)))}}();function et(s,r,e){e===void 0&&(e={});var t={type:"Feature"};return(e.id===0||e.id)&&(t.id=e.id),e.bbox&&(t.bbox=e.bbox),t.properties=r||{},t.geometry=s,t}function tt(s,r,e){e===void 0&&(e={});for(var t=0,i=s;t<i.length;t++){var a=i[t];if(a.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var n=0;n<a[a.length-1].length;n++)if(a[a.length-1][n]!==a[0][n])throw new Error("First and last Position are not equivalent.")}var l={type:"Polygon",coordinates:s};return et(l,r,e)}function rt(s,r){r===void 0&&(r={});var e={type:"FeatureCollection"};return r.id&&(e.id=r.id),r.bbox&&(e.bbox=r.bbox),e.features=s,e}function Be(s,r,e){if(s!==null)for(var t,i,a,n,l,o,p,m=0,h=0,c,b=s.type,_=b==="FeatureCollection",u=b==="Feature",w=_?s.features.length:1,v=0;v<w;v++){p=_?s.features[v].geometry:u?s.geometry:s,c=p?p.type==="GeometryCollection":!1,l=c?p.geometries.length:1;for(var M=0;M<l;M++){var E=0,B=0;if(n=c?p.geometries[M]:p,n!==null){o=n.coordinates;var P=n.type;switch(m=e&&(P==="Polygon"||P==="MultiPolygon")?1:0,P){case null:break;case"Point":if(r(o,h,v,E,B)===!1)return!1;h++,E++;break;case"LineString":case"MultiPoint":for(t=0;t<o.length;t++){if(r(o[t],h,v,E,B)===!1)return!1;h++,P==="MultiPoint"&&E++}P==="LineString"&&E++;break;case"Polygon":case"MultiLineString":for(t=0;t<o.length;t++){for(i=0;i<o[t].length-m;i++){if(r(o[t][i],h,v,E,B)===!1)return!1;h++}P==="MultiLineString"&&E++,P==="Polygon"&&B++}P==="Polygon"&&E++;break;case"MultiPolygon":for(t=0;t<o.length;t++){for(B=0,i=0;i<o[t].length;i++){for(a=0;a<o[t][i].length-m;a++){if(r(o[t][i][a],h,v,E,B)===!1)return!1;h++}B++}E++}break;case"GeometryCollection":for(t=0;t<n.geometries.length;t++)if(Be(n.geometries[t],r,e)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function W(s){var r=[1/0,1/0,-1/0,-1/0];return Be(s,function(e){r[0]>e[0]&&(r[0]=e[0]),r[1]>e[1]&&(r[1]=e[1]),r[2]<e[0]&&(r[2]=e[0]),r[3]<e[1]&&(r[3]=e[1])}),r}W.default=W;function st(s,r){r===void 0&&(r={});var e=Number(s[0]),t=Number(s[1]),i=Number(s[2]),a=Number(s[3]);if(s.length===6)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var n=[e,t],l=[e,a],o=[i,a],p=[i,t];return tt([[n,p,o,l,n]],r.properties,{bbox:s,id:r.id})}function it(s){let r,e,t,i,a,n,l=`rotate(${s[1]}deg)`,o,p,m=[s[2]],h={};for(let c=0;c<m.length;c+=1)h=se(h,m[c]);return{c(){r=q("div"),e=T("svg"),t=T("path"),i=T("path"),a=T("text"),n=_e("N"),this.h()},l(c){r=N(c,"DIV",{});var b=C(r);e=H(b,"svg",{xmlns:!0,width:!0,height:!0,viewBox:!0,preserveAspectRatio:!0,class:!0});var _=C(e);t=H(_,"path",{"vector-effect":!0,d:!0,class:!0}),C(t).forEach(y),i=H(_,"path",{d:!0,id:!0,class:!0}),C(i).forEach(y),a=H(_,"text",{x:!0,y:!0,"text-anchor":!0,class:!0});var u=C(a);n=ve(u,"N"),u.forEach(y),_.forEach(y),b.forEach(y),this.h()},h(){f(t,"vector-effect","non-scaling-stroke"),f(t,"d","M35,50 L50,95 65,50Z"),f(t,"class","cpeum-1uwcl8j"),f(i,"d","M35,50 L50,5 65,50Z"),f(i,"id","north"),f(i,"class","cpeum-1uwcl8j"),f(a,"x","50"),f(a,"y","0"),f(a,"text-anchor","middle"),f(a,"class","cpeum-1uwcl8j"),f(e,"xmlns","http://www.w3.org/2000/svg"),f(e,"width","100"),f(e,"height","100"),f(e,"viewBox","0 0 100 100"),f(e,"preserveAspectRatio","xMidYMid"),f(e,"class","cpeum-1uwcl8j"),J(e,"transform",l),oe(r,h),J(r,"--size",s[0]),X(r,"cpeum-1uwcl8j",!0)},m(c,b){Q(c,r,b),k(r,e),k(e,t),k(e,i),k(e,a),k(a,n),o||(p=De(r,"click",s[3]),o=!0)},p(c,[b]){b&2&&l!==(l=`rotate(${c[1]}deg)`)&&J(e,"transform",l),oe(r,h=qe(m,[b&4&&c[2]])),J(r,"--size",c[0]),X(r,"cpeum-1uwcl8j",!0)},i:U,o:U,d(c){c&&y(r),o=!1,p()}}}function at(s,r,e){const t=["size","bearing"];let i=le(r,t),{size:a="40px"}=r,{bearing:n}=r;function l(o){Se.call(this,s,o)}return s.$$set=o=>{r=se(se({},r),Ne(o)),e(2,i=le(r,t)),"size"in o&&e(0,a=o.size),"bearing"in o&&e(1,n=o.bearing)},[a,n,i,l]}class nt extends ie{constructor(r){super(),ae(this,r,at,it,x,{size:0,bearing:1})}}function ot(s){let r,e,t,i,a,n,l,o;return{c(){r=q("div"),e=q("div"),t=q("div"),i=_e(s[0]),a=j(),n=T("svg"),l=T("path"),this.h()},l(p){r=N(p,"DIV",{id:!0,class:!0});var m=C(r);e=N(m,"DIV",{id:!0,class:!0});var h=C(e);t=N(h,"DIV",{id:!0,class:!0});var c=C(t);i=ve(c,s[0]),c.forEach(y),a=K(h),n=H(h,"svg",{id:!0,viewBox:!0,width:!0,height:!0,class:!0});var b=C(n);l=H(b,"path",{d:!0,class:!0}),C(l).forEach(y),b.forEach(y),h.forEach(y),m.forEach(y),this.h()},h(){f(t,"id","content"),f(t,"class","cpeum-1x8mrdn"),f(l,"d","M 0,0 C 5,0 10,20 15,20 C 20,20 25,0 30,0 Z"),f(l,"class","cpeum-1x8mrdn"),f(n,"id","pin"),f(n,"viewBox","0 0 30 20"),f(n,"width","30"),f(n,"height","20"),f(n,"class","cpeum-1x8mrdn"),f(e,"id","inner"),f(e,"class","cpeum-1x8mrdn"),f(r,"id","wrap"),f(r,"class","cpeum-1x8mrdn")},m(p,m){Q(p,r,m),k(r,e),k(e,t),k(t,i),k(e,a),k(e,n),k(n,l),s[4](r)},p(p,[m]){s=p,m&1&&Ze(i,s[0])},i(p){o||Re(()=>{o=Ve(e,Xe,{start:.8,opacity:0,duration:250,easing:Je}),o.start()})},o:U,d(p){p&&y(r),s[4](null)}}}function lt(s,r,e){let{map:t}=r,{text:i}=r,{coords:a}=r,n;be(()=>{new Ue.exports.Marker({element:n,anchor:"bottom"}).setLngLat(a).addTo(t)}),Ge(()=>{});function l(o){ye[o?"unshift":"push"](()=>{n=o,e(1,n)})}return s.$$set=o=>{"map"in o&&e(2,t=o.map),"text"in o&&e(0,i=o.text),"coords"in o&&e(3,a=o.coords)},[i,n,t,a,l]}class ct extends ie{constructor(r){super(),ae(this,r,lt,ot,x,{map:2,text:0,coords:3})}}G.disable_scroll_handling;const ut=G.goto;G.invalidate;G.prefetch;G.prefetch_routes;const bt=G.before_navigate,yt=G.after_navigate;function pe(s){let r=s[3],e,t,i=me(s);return{c(){i.c(),e=fe()},l(a){i.l(a),e=fe()},m(a,n){i.m(a,n),Q(a,e,n),t=!0},p(a,n){n&8&&x(r,r=a[3])?(Me(),V(i,1,1,U),Ce(),i=me(a),i.c(),D(i,1),i.m(e.parentNode,e)):i.p(a,n)},i(a){t||(D(i),t=!0)},o(a){V(i),t=!1},d(a){a&&y(e),i.d(a)}}}function me(s){let r,e;return r=new ct({props:{map:g,text:s[3].text,coords:s[3].coords}}),{c(){we(r.$$.fragment)},l(t){ke(r.$$.fragment,t)},m(t,i){Ee(r,t,i),e=!0},p(t,i){const a={};i&0&&(a.map=g),i&8&&(a.text=t[3].text),i&8&&(a.coords=t[3].coords),r.$set(a)},i(t){e||(D(r.$$.fragment,t),e=!0)},o(t){V(r.$$.fragment,t),e=!1},d(t){Le(r,t)}}}function ft(s){let r,e,t,i,a,n,l,o,p,m,h,c=s[3]&&pe(s);o=new nt({props:{bearing:s[1]}}),o.$on("click",s[4]);const b=s[12].default,_=Oe(b,s,s[11],null);return{c(){r=q("link"),e=j(),t=q("figure"),c&&c.c(),i=j(),a=q("div"),n=j(),l=q("div"),we(o.$$.fragment),p=j(),_&&_.c(),this.h()},l(u){const w=Te("svelte-1yi8k0v",document.head);r=N(w,"LINK",{rel:!0,href:!0}),w.forEach(y),e=K(u),t=N(u,"FIGURE",{class:!0});var v=C(t);c&&c.l(v),i=K(v),a=N(v,"DIV",{id:!0,class:!0}),C(a).forEach(y),n=K(v),l=N(v,"DIV",{id:!0,class:!0});var M=C(l);ke(o.$$.fragment,M),p=K(M),_&&_.l(M),M.forEach(y),v.forEach(y),this.h()},h(){f(r,"rel","stylesheet"),f(r,"href","https://unpkg.com/maplibre-gl@2.1.7/dist/maplibre-gl.css"),f(a,"id","container"),f(a,"class","cpeum-hqy46t"),f(l,"id","info"),f(l,"class","cpeum-hqy46t"),f(t,"class",m=ce(s[2].class)+" cpeum-hqy46t"),X(t,"full",s[2].full)},m(u,w){k(document.head,r),Q(u,e,w),Q(u,t,w),c&&c.m(t,null),k(t,i),k(t,a),s[13](a),k(t,n),k(t,l),Ee(o,l,null),k(l,p),_&&_.m(l,null),h=!0},p(u,[w]){u[3]?c?(c.p(u,w),w&8&&D(c,1)):(c=pe(u),c.c(),D(c,1),c.m(t,i)):c&&(Me(),V(c,1,1,()=>{c=null}),Ce());const v={};w&2&&(v.bearing=u[1]),o.$set(v),_&&_.p&&(!h||w&2048)&&He(_,b,u,u[11],h?je(b,u[11],w,null):Ae(u[11]),null),(!h||w&4&&m!==(m=ce(u[2].class)+" cpeum-hqy46t"))&&f(t,"class",m),(!h||w&4)&&X(t,"full",u[2].full)},i(u){h||(D(c),D(o.$$.fragment,u),D(_,u),h=!0)},o(u){V(c),V(o.$$.fragment,u),V(_,u),h=!1},d(u){y(r),u&&y(e),u&&y(t),c&&c.d(),s[13](null),Le(o),_&&_.d(u)}}}globalThis&&globalThis.__awaiter;const ge=A(!1);let g;function re(s,r){for(const e of s)g.setFeatureState(e,{highlight:r})}function dt(s,r,e){let t,i,a=U,n,l,o,p;O(s,Ie,d=>e(7,t=d)),O(s,ge,d=>e(8,i=d)),O(s,xe,d=>e(10,l=d)),O(s,te,d=>e(2,o=d)),O(s,$e,d=>e(3,p=d)),s.$$.on_destroy.push(()=>a());let{$$slots:m={},$$scope:h}=r;var c=this&&this.__awaiter||function(d,F,L,z){function I(Z){return Z instanceof L?Z:new L(function(Y){Y(Z)})}return new(L||(L=Promise))(function(Z,Y){function ze(R){try{$(z.next(R))}catch(ee){Y(ee)}}function Fe(R){try{$(z.throw(R))}catch(ee){Y(ee)}}function $(R){R.done?Z(R.value):I(R.value).then(ze,Fe)}$((z=z.apply(d,F||[])).next())})};const b=Ke();let _,u=0,w=0,v=20,M=14,E;function B(){g.flyTo({center:E,pitch:v,zoom:M,bearing:w,duration:750})}function P(){e(1,u=0),g.flyTo({bearing:0})}const ne=Qe(te,d=>d.full);O(s,ne,d=>e(9,n=d));let S;be(()=>{g=new de.Map({container:_,style:"https://api.maptiler.com/maps/856b4e05-cd2c-42db-9453-9cd7e156a083/style.json?key=dtV5LH1SmQB4VOb80qqI",bounds:Ye.fallback,fitBoundsOptions:{padding:100},bearing:u,pitch:v,zoom:M,minZoom:10,maxZoom:20}),g.on("error",d=>{b("error")}),g.once("load",()=>{ge.set(!0),b("load"),e(1,u=g.getBearing()),v=g.getPitch(),M=g.getZoom(),E=g.getCenter()}),g.on("rotate",d=>{e(1,u=g.getBearing()),d.originalEvent&&(w=g.getBearing())}),g.on("pitchend",d=>{d.originalEvent&&(v=g.getPitch())}),g.on("zoomend",d=>{d.originalEvent&&(M=g.getZoom(),E=g.getCenter())}),g.on("dragend",d=>{E=g.getCenter()}),g.on("click",d=>c(void 0,void 0,void 0,function*(){const L=g.queryRenderedFeatures(d.point)[0].properties.url;L&&(yield ut(We+L),te.setFull(!1))}))});function Pe(d){ye[d?"unshift":"push"](()=>{_=d,e(0,_)})}return s.$$set=d=>{"$$scope"in d&&e(11,h=d.$$scope)},s.$$.update=()=>{if(s.$$.dirty&1792&&i&&!n){if(!l)B();else if(l.bounds)g.fitBounds(l.bounds,{bearing:0,pitch:l.pitch!==void 0&&l.pitch!==null?l.pitch:20,duration:750});else if(l.center)g.flyTo({center:l.center.point,zoom:l.center.zoom,bearing:0,pitch:20,duration:750});else if(l.filter){const d=Object.entries(l.filter),F=ue(he).filter(z=>d.every(([I,Z])=>z.properties[I]===Z)),L=new de.LngLatBounds(W(rt(F.map(z=>st(W(z))))));g.fitBounds(L,{padding:300,maxZoom:15})}}if(s.$$.dirty&768&&i&&n&&B(),s.$$.dirty&448&&i)if(t){S&&re(S,!1);const d=Object.entries(t);e(6,S=ue(he).filter(F=>d.every(([L,z])=>F.properties[L]===z)).map(F=>({id:F.id,source:F.properties.source}))),re(S,!0)}else S&&re(S,!1)},[_,u,o,p,P,ne,S,t,i,n,l,h,m,Pe]}class wt extends ie{constructor(r){super(),ae(this,r,dt,ft,x,{})}}export{nt as F,wt as M,Ie as a,bt as b,xe as c,yt as d,$e as e,ge as f,he as g,g as h,te as m};

import{S as X,i as W,s as Q,C as J,e as C,O as V,t as le,c as D,a as P,P as G,d as w,h as fe,b as c,f as T,a1 as x,I as A,g as j,J as k,Q as ke,z as Ee,E as H,a2 as I,a3 as ze,a4 as Pe,k as q,m as O,j as Le,K as Me,R as Be,v as ce,a5 as Ce,a6 as ue,l as $,n as me,o as N,p as he,w as de,x as pe,y as ge,q as B,B as _e,_ as De,a7 as Ze,a8 as ee,X as Ne,Y as Se,Z as Fe,N as F,a9 as Ve,aa as te}from"./index-8814b013.js";import{d as Ge,w as Re}from"./index-ff6a0fc0.js";import{d as qe,m as re,e as se,f as Oe,a as je,b as He,c as Te,g as ae}from"./Map.svelte_svelte_type_style_lang-ad9468b4.js";import{e as Ae,s as Ke}from"./index-b9ab12a0.js";import{b as Qe}from"./paths-396f020f.js";function Ue(s,e,t){t===void 0&&(t={});var r={type:"Feature"};return(t.id===0||t.id)&&(r.id=t.id),t.bbox&&(r.bbox=t.bbox),r.properties=e||{},r.geometry=s,r}function Ye(s,e,t){t===void 0&&(t={});for(var r=0,a=s;r<a.length;r++){var i=a[r];if(i.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var o=0;o<i[i.length-1].length;o++)if(i[i.length-1][o]!==i[0][o])throw new Error("First and last Position are not equivalent.")}var l={type:"Polygon",coordinates:s};return Ue(l,e,t)}function Je(s,e){e===void 0&&(e={});var t={type:"FeatureCollection"};return e.id&&(t.id=e.id),e.bbox&&(t.bbox=e.bbox),t.features=s,t}function ve(s,e,t){if(s!==null)for(var r,a,i,o,l,n,d,b=0,h=0,f,_=s.type,p=_==="FeatureCollection",u=_==="Feature",y=p?s.features.length:1,v=0;v<y;v++){d=p?s.features[v].geometry:u?s.geometry:s,f=d?d.type==="GeometryCollection":!1,l=f?d.geometries.length:1;for(var E=0;E<l;E++){var z=0,M=0;if(o=f?d.geometries[E]:d,o!==null){n=o.coordinates;var L=o.type;switch(b=t&&(L==="Polygon"||L==="MultiPolygon")?1:0,L){case null:break;case"Point":if(e(n,h,v,z,M)===!1)return!1;h++,z++;break;case"LineString":case"MultiPoint":for(r=0;r<n.length;r++){if(e(n[r],h,v,z,M)===!1)return!1;h++,L==="MultiPoint"&&z++}L==="LineString"&&z++;break;case"Polygon":case"MultiLineString":for(r=0;r<n.length;r++){for(a=0;a<n[r].length-b;a++){if(e(n[r][a],h,v,z,M)===!1)return!1;h++}L==="MultiLineString"&&z++,L==="Polygon"&&M++}L==="Polygon"&&z++;break;case"MultiPolygon":for(r=0;r<n.length;r++){for(M=0,a=0;a<n[r].length;a++){for(i=0;i<n[r][a].length-b;i++){if(e(n[r][a][i],h,v,z,M)===!1)return!1;h++}M++}z++}break;case"GeometryCollection":for(r=0;r<o.geometries.length;r++)if(ve(o.geometries[r],e,t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function K(s){var e=[1/0,1/0,-1/0,-1/0];return ve(s,function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])}),e}K.default=K;function Xe(s,e){e===void 0&&(e={});var t=Number(s[0]),r=Number(s[1]),a=Number(s[2]),i=Number(s[3]);if(s.length===6)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var o=[t,r],l=[t,i],n=[a,i],d=[a,r];return Ye([[o,d,n,l,o]],e.properties,{bbox:s,id:e.id})}function We(s){let e,t,r,a,i,o,l=`rotate(${s[1]}deg)`,n,d,b=[s[2]],h={};for(let f=0;f<b.length;f+=1)h=J(h,b[f]);return{c(){e=C("div"),t=V("svg"),r=V("path"),a=V("path"),i=V("text"),o=le("N"),this.h()},l(f){e=D(f,"DIV",{});var _=P(e);t=G(_,"svg",{xmlns:!0,width:!0,height:!0,viewBox:!0,preserveAspectRatio:!0,class:!0});var p=P(t);r=G(p,"path",{"vector-effect":!0,d:!0,class:!0}),P(r).forEach(w),a=G(p,"path",{d:!0,id:!0,class:!0}),P(a).forEach(w),i=G(p,"text",{x:!0,y:!0,"text-anchor":!0,class:!0});var u=P(i);o=fe(u,"N"),u.forEach(w),p.forEach(w),_.forEach(w),this.h()},h(){c(r,"vector-effect","non-scaling-stroke"),c(r,"d","M35,50 L50,95 65,50Z"),c(r,"class","cpeum-1j5xfwi"),c(a,"d","M35,50 L50,5 65,50Z"),c(a,"id","north"),c(a,"class","cpeum-1j5xfwi"),c(i,"x","50"),c(i,"y","0"),c(i,"text-anchor","middle"),c(i,"class","cpeum-1j5xfwi"),c(t,"xmlns","http://www.w3.org/2000/svg"),c(t,"width","100"),c(t,"height","100"),c(t,"viewBox","0 0 100 100"),c(t,"preserveAspectRatio","xMidYMid"),c(t,"class","cpeum-1j5xfwi"),T(t,"transform",l,!1),x(e,h),T(e,"--size",s[0],!1),A(e,"cpeum-1j5xfwi",!0)},m(f,_){j(f,e,_),k(e,t),k(t,r),k(t,a),k(t,i),k(i,o),n||(d=ke(e,"click",s[3]),n=!0)},p(f,[_]){_&2&&l!==(l=`rotate(${f[1]}deg)`)&&T(t,"transform",l,!1),x(e,h=Ee(b,[_&4&&f[2]])),T(e,"--size",f[0],!1),A(e,"cpeum-1j5xfwi",!0)},i:H,o:H,d(f){f&&w(e),n=!1,d()}}}function xe(s,e,t){const r=["size","bearing"];let a=I(e,r),{size:i="40px"}=e,{bearing:o}=e;function l(n){Pe.call(this,s,n)}return s.$$set=n=>{e=J(J({},e),ze(n)),t(2,a=I(e,r)),"size"in n&&t(0,i=n.size),"bearing"in n&&t(1,o=n.bearing)},[i,o,a,l]}class Ie extends X{constructor(e){super(),W(this,e,xe,We,Q,{size:0,bearing:1})}}function $e(s){let e,t,r,a,i,o,l,n;return{c(){e=C("div"),t=C("div"),r=C("div"),a=le(s[0]),i=q(),o=V("svg"),l=V("path"),this.h()},l(d){e=D(d,"DIV",{id:!0,class:!0});var b=P(e);t=D(b,"DIV",{id:!0,class:!0});var h=P(t);r=D(h,"DIV",{id:!0,class:!0});var f=P(r);a=fe(f,s[0]),f.forEach(w),i=O(h),o=G(h,"svg",{id:!0,viewBox:!0,width:!0,height:!0,class:!0});var _=P(o);l=G(_,"path",{d:!0,class:!0}),P(l).forEach(w),_.forEach(w),h.forEach(w),b.forEach(w),this.h()},h(){c(r,"id","content"),c(r,"class","cpeum-1mzxy9c"),c(l,"d","M 0,0 C 5,0 10,20 15,20 C 20,20 25,0 30,0 Z"),c(l,"class","cpeum-1mzxy9c"),c(o,"id","pin"),c(o,"viewBox","0 0 30 20"),c(o,"width","30"),c(o,"height","20"),c(o,"class","cpeum-1mzxy9c"),c(t,"id","inner"),c(t,"class","cpeum-1mzxy9c"),c(e,"id","wrap"),c(e,"class","cpeum-1mzxy9c")},m(d,b){j(d,e,b),k(e,t),k(t,r),k(r,a),k(t,i),k(t,o),k(o,l),s[4](e)},p(d,[b]){s=d,b&1&&Le(a,s[0])},i(d){n||Me(()=>{n=Be(t,Ke,{start:.8,opacity:0,duration:250,easing:Ae}),n.start()})},o:H,d(d){d&&w(e),s[4](null)}}}function et(s,e,t){let{map:r}=e,{text:a}=e,{coords:i}=e,o;ce(()=>{new qe.exports.Marker({element:o,anchor:"bottom"}).setLngLat(i).addTo(r)}),Ce(()=>{});function l(n){ue[n?"unshift":"push"](()=>{o=n,t(1,o)})}return s.$$set=n=>{"map"in n&&t(2,r=n.map),"text"in n&&t(0,a=n.text),"coords"in n&&t(3,i=n.coords)},[a,o,r,i,l]}class tt extends X{constructor(e){super(),W(this,e,et,$e,Q,{map:2,text:0,coords:3})}}function ie(s){let e=s[3],t,r,a=oe(s);return{c(){a.c(),t=$()},l(i){a.l(i),t=$()},m(i,o){a.m(i,o),j(i,t,o),r=!0},p(i,o){o&8&&Q(e,e=i[3])?(me(),N(a,1,1,H),he(),a=oe(i),a.c(),B(a,1),a.m(t.parentNode,t)):a.p(i,o)},i(i){r||(B(a),r=!0)},o(i){N(a),r=!1},d(i){i&&w(t),a.d(i)}}}function oe(s){let e,t;return e=new tt({props:{map:g,text:s[3].text,coords:s[3].coords}}),{c(){de(e.$$.fragment)},l(r){pe(e.$$.fragment,r)},m(r,a){ge(e,r,a),t=!0},p(r,a){const i={};a&0&&(i.map=g),a&8&&(i.text=r[3].text),a&8&&(i.coords=r[3].coords),e.$set(i)},i(r){t||(B(e.$$.fragment,r),t=!0)},o(r){N(e.$$.fragment,r),t=!1},d(r){_e(e,r)}}}function rt(s){let e,t,r,a,i,o,l,n,d,b,h,f=s[3]&&ie(s);n=new Ie({props:{bearing:s[1]}}),n.$on("click",s[4]);const _=s[12].default,p=De(_,s,s[11],null);return{c(){e=C("link"),t=q(),r=C("figure"),f&&f.c(),a=q(),i=C("div"),o=q(),l=C("div"),de(n.$$.fragment),d=q(),p&&p.c(),this.h()},l(u){const y=Ze('[data-svelte="svelte-1yi8k0v"]',document.head);e=D(y,"LINK",{rel:!0,href:!0}),y.forEach(w),t=O(u),r=D(u,"FIGURE",{class:!0});var v=P(r);f&&f.l(v),a=O(v),i=D(v,"DIV",{id:!0,class:!0}),P(i).forEach(w),o=O(v),l=D(v,"DIV",{id:!0,class:!0});var E=P(l);pe(n.$$.fragment,E),d=O(E),p&&p.l(E),E.forEach(w),v.forEach(w),this.h()},h(){c(e,"rel","stylesheet"),c(e,"href","https://unpkg.com/maplibre-gl@2.1.7/dist/maplibre-gl.css"),c(i,"id","container"),c(i,"class","cpeum-1vymoz8"),c(l,"id","info"),c(l,"class","cpeum-1vymoz8"),c(r,"class",b=ee(s[2].class)+" cpeum-1vymoz8"),A(r,"full",s[2].full)},m(u,y){k(document.head,e),j(u,t,y),j(u,r,y),f&&f.m(r,null),k(r,a),k(r,i),s[13](i),k(r,o),k(r,l),ge(n,l,null),k(l,d),p&&p.m(l,null),h=!0},p(u,[y]){u[3]?f?(f.p(u,y),y&8&&B(f,1)):(f=ie(u),f.c(),B(f,1),f.m(r,a)):f&&(me(),N(f,1,1,()=>{f=null}),he());const v={};y&2&&(v.bearing=u[1]),n.$set(v),p&&p.p&&(!h||y&2048)&&Ne(p,_,u,u[11],h?Fe(_,u[11],y,null):Se(u[11]),null),(!h||y&4&&b!==(b=ee(u[2].class)+" cpeum-1vymoz8"))&&c(r,"class",b),y&4&&A(r,"full",u[2].full)},i(u){h||(B(f),B(n.$$.fragment,u),B(p,u),h=!0)},o(u){N(f),N(n.$$.fragment,u),N(p,u),h=!1},d(u){w(e),u&&w(t),u&&w(r),f&&f.d(),s[13](null),_e(n),p&&p.d(u)}}}const ne=Re(!1);let g;function Y(s,e){for(const t of s)g.setFeatureState(t,{highlight:e})}function st(s,e,t){let r,a,i=H,o,l,n,d;F(s,je,m=>t(7,r=m)),F(s,ne,m=>t(8,a=m)),F(s,He,m=>t(10,l=m)),F(s,re,m=>t(2,n=m)),F(s,Te,m=>t(3,d=m)),s.$$.on_destroy.push(()=>i());let{$$slots:b={},$$scope:h}=e;const f=Ve();let _,p=0,u=0,y=20,v=14,E;function z(){g.flyTo({center:E,pitch:y,zoom:v,bearing:u,duration:750})}function M(){t(1,p=0),g.flyTo({bearing:0})}const L=Ge(re,m=>m.full);F(s,L,m=>t(9,o=m));let Z;ce(()=>{g=new se.Map({container:_,style:"https://api.maptiler.com/maps/856b4e05-cd2c-42db-9453-9cd7e156a083/style.json?key=dtV5LH1SmQB4VOb80qqI",bounds:Oe.fallback,fitBoundsOptions:{padding:100},bearing:p,pitch:y,zoom:v,minZoom:10,maxZoom:20}),g.on("error",m=>{f("error")}),g.once("load",()=>{ne.set(!0),f("load"),t(1,p=g.getBearing()),y=g.getPitch(),v=g.getZoom(),E=g.getCenter()}),g.on("rotate",m=>{t(1,p=g.getBearing()),m.originalEvent&&(u=g.getBearing())}),g.on("pitchend",m=>{m.originalEvent&&(y=g.getPitch())}),g.on("zoomend",m=>{m.originalEvent&&(v=g.getZoom(),E=g.getCenter())}),g.on("dragend",m=>{E=g.getCenter()})});function be(m){ue[m?"unshift":"push"](()=>{_=m,t(0,_)})}return s.$$set=m=>{"$$scope"in m&&t(11,h=m.$$scope)},s.$$.update=()=>{if(s.$$.dirty&1792&&a&&!o){if(!l)z();else if(l.bounds)g.fitBounds(l.bounds,{bearing:0,pitch:l.pitch!==void 0&&l.pitch!==null?l.pitch:20,duration:750});else if(l.center)g.flyTo({center:l.center.point,zoom:l.center.zoom,bearing:0,pitch:20,duration:750});else if(l.filter){const m=Object.entries(l.filter),S=te(ae).filter(R=>m.every(([ye,we])=>R.properties[ye]===we)),U=new se.LngLatBounds(K(Je(S.map(R=>Xe(K(R))))));g.fitBounds(U,{padding:200,maxZoom:15})}}if(s.$$.dirty&768&&a&&o&&z(),s.$$.dirty&448&&a)if(r){Z&&Y(Z,!1);const m=Object.entries(r);t(6,Z=te(ae).filter(S=>m.every(([U,R])=>S.properties[U]===R)).map(S=>({id:S.id,source:S.properties.source}))),Y(Z,!0)}else Z&&Y(Z,!1)},[_,p,n,d,M,L,Z,r,a,o,l,h,b,be]}class ft extends X{constructor(e){super(),W(this,e,st,rt,Q,{})}}async function ct(s){const e=await fetch(Qe+s);if(e.ok)return e.json();throw Error(e.status+": "+e.statusText)}export{Ie as F,ft as M,g as a,ct as g,ne as m};

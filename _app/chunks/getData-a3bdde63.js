import{S as W,i as x,s as U,C as X,e as C,O as R,t as le,c as q,a as z,P as V,d as w,h as fe,b as c,f as A,a3 as I,I as K,g as H,J as k,Q as Ee,z as Pe,E as T,a4 as $,a5 as ze,a6 as Le,k as O,m as j,j as Me,K as Be,R as Ce,v as ce,a7 as qe,a8 as ue,l as ee,n as he,o as Z,p as me,w as de,x as pe,y as ge,q as B,B as _e,a0 as De,_ as Fe,a9 as te,X as Ze,Y as Ne,Z as Se,N as S,aa as Re,ab as re}from"./index-3ec01f6b.js";import{d as Ve,w as Ge}from"./index-0353028f.js";import{a as Oe,c as je,m as Y,e as He,g as Te,f as se}from"./Map.svelte_svelte_type_style_lang-2f27db00.js";import{m as Ae,a as ae,b as Ke}from"./map-92890404.js";import{e as Qe,s as Ue}from"./index-ddb46137.js";import{b as ve}from"./paths-396f020f.js";function Ye(s,e,t){t===void 0&&(t={});var r={type:"Feature"};return(t.id===0||t.id)&&(r.id=t.id),t.bbox&&(r.bbox=t.bbox),r.properties=e||{},r.geometry=s,r}function Je(s,e,t){t===void 0&&(t={});for(var r=0,a=s;r<a.length;r++){var i=a[r];if(i.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var o=0;o<i[i.length-1].length;o++)if(i[i.length-1][o]!==i[0][o])throw new Error("First and last Position are not equivalent.")}var l={type:"Polygon",coordinates:s};return Ye(l,e,t)}function Xe(s,e){e===void 0&&(e={});var t={type:"FeatureCollection"};return e.id&&(t.id=e.id),e.bbox&&(t.bbox=e.bbox),t.features=s,t}function be(s,e,t){if(s!==null)for(var r,a,i,o,l,n,d,b=0,m=0,f,_=s.type,p=_==="FeatureCollection",u=_==="Feature",y=p?s.features.length:1,v=0;v<y;v++){d=p?s.features[v].geometry:u?s.geometry:s,f=d?d.type==="GeometryCollection":!1,l=f?d.geometries.length:1;for(var E=0;E<l;E++){var P=0,M=0;if(o=f?d.geometries[E]:d,o!==null){n=o.coordinates;var L=o.type;switch(b=t&&(L==="Polygon"||L==="MultiPolygon")?1:0,L){case null:break;case"Point":if(e(n,m,v,P,M)===!1)return!1;m++,P++;break;case"LineString":case"MultiPoint":for(r=0;r<n.length;r++){if(e(n[r],m,v,P,M)===!1)return!1;m++,L==="MultiPoint"&&P++}L==="LineString"&&P++;break;case"Polygon":case"MultiLineString":for(r=0;r<n.length;r++){for(a=0;a<n[r].length-b;a++){if(e(n[r][a],m,v,P,M)===!1)return!1;m++}L==="MultiLineString"&&P++,L==="Polygon"&&M++}L==="Polygon"&&P++;break;case"MultiPolygon":for(r=0;r<n.length;r++){for(M=0,a=0;a<n[r].length;a++){for(i=0;i<n[r][a].length-b;i++){if(e(n[r][a][i],m,v,P,M)===!1)return!1;m++}M++}P++}break;case"GeometryCollection":for(r=0;r<o.geometries.length;r++)if(be(o.geometries[r],e,t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Q(s){var e=[1/0,1/0,-1/0,-1/0];return be(s,function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])}),e}Q.default=Q;function We(s,e){e===void 0&&(e={});var t=Number(s[0]),r=Number(s[1]),a=Number(s[2]),i=Number(s[3]);if(s.length===6)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var o=[t,r],l=[t,i],n=[a,i],d=[a,r];return Je([[o,d,n,l,o]],e.properties,{bbox:s,id:e.id})}function xe(s){let e,t,r,a,i,o,l=`rotate(${s[1]}deg)`,n,d,b=[s[2]],m={};for(let f=0;f<b.length;f+=1)m=X(m,b[f]);return{c(){e=C("div"),t=R("svg"),r=R("path"),a=R("path"),i=R("text"),o=le("N"),this.h()},l(f){e=q(f,"DIV",{});var _=z(e);t=V(_,"svg",{xmlns:!0,width:!0,height:!0,viewBox:!0,preserveAspectRatio:!0,class:!0});var p=z(t);r=V(p,"path",{"vector-effect":!0,d:!0,class:!0}),z(r).forEach(w),a=V(p,"path",{d:!0,id:!0,class:!0}),z(a).forEach(w),i=V(p,"text",{x:!0,y:!0,"text-anchor":!0,class:!0});var u=z(i);o=fe(u,"N"),u.forEach(w),p.forEach(w),_.forEach(w),this.h()},h(){c(r,"vector-effect","non-scaling-stroke"),c(r,"d","M35,50 L50,95 65,50Z"),c(r,"class","cpeum-1j5xfwi"),c(a,"d","M35,50 L50,5 65,50Z"),c(a,"id","north"),c(a,"class","cpeum-1j5xfwi"),c(i,"x","50"),c(i,"y","0"),c(i,"text-anchor","middle"),c(i,"class","cpeum-1j5xfwi"),c(t,"xmlns","http://www.w3.org/2000/svg"),c(t,"width","100"),c(t,"height","100"),c(t,"viewBox","0 0 100 100"),c(t,"preserveAspectRatio","xMidYMid"),c(t,"class","cpeum-1j5xfwi"),A(t,"transform",l,!1),I(e,m),A(e,"--size",s[0],!1),K(e,"cpeum-1j5xfwi",!0)},m(f,_){H(f,e,_),k(e,t),k(t,r),k(t,a),k(t,i),k(i,o),n||(d=Ee(e,"click",s[3]),n=!0)},p(f,[_]){_&2&&l!==(l=`rotate(${f[1]}deg)`)&&A(t,"transform",l,!1),I(e,m=Pe(b,[_&4&&f[2]])),A(e,"--size",f[0],!1),K(e,"cpeum-1j5xfwi",!0)},i:T,o:T,d(f){f&&w(e),n=!1,d()}}}function Ie(s,e,t){const r=["size","bearing"];let a=$(e,r),{size:i="40px"}=e,{bearing:o}=e;function l(n){Le.call(this,s,n)}return s.$$set=n=>{e=X(X({},e),ze(n)),t(2,a=$(e,r)),"size"in n&&t(0,i=n.size),"bearing"in n&&t(1,o=n.bearing)},[i,o,a,l]}class $e extends W{constructor(e){super(),x(this,e,Ie,xe,U,{size:0,bearing:1})}}function et(s){let e,t,r,a,i,o,l,n;return{c(){e=C("div"),t=C("div"),r=C("div"),a=le(s[0]),i=O(),o=R("svg"),l=R("path"),this.h()},l(d){e=q(d,"DIV",{id:!0,class:!0});var b=z(e);t=q(b,"DIV",{id:!0,class:!0});var m=z(t);r=q(m,"DIV",{id:!0,class:!0});var f=z(r);a=fe(f,s[0]),f.forEach(w),i=j(m),o=V(m,"svg",{id:!0,viewBox:!0,width:!0,height:!0,class:!0});var _=z(o);l=V(_,"path",{d:!0,class:!0}),z(l).forEach(w),_.forEach(w),m.forEach(w),b.forEach(w),this.h()},h(){c(r,"id","content"),c(r,"class","cpeum-1mzxy9c"),c(l,"d","M 0,0 C 5,0 10,20 15,20 C 20,20 25,0 30,0 Z"),c(l,"class","cpeum-1mzxy9c"),c(o,"id","pin"),c(o,"viewBox","0 0 30 20"),c(o,"width","30"),c(o,"height","20"),c(o,"class","cpeum-1mzxy9c"),c(t,"id","inner"),c(t,"class","cpeum-1mzxy9c"),c(e,"id","wrap"),c(e,"class","cpeum-1mzxy9c")},m(d,b){H(d,e,b),k(e,t),k(t,r),k(r,a),k(t,i),k(t,o),k(o,l),s[4](e)},p(d,[b]){s=d,b&1&&Me(a,s[0])},i(d){n||Be(()=>{n=Ce(t,Ue,{start:.8,opacity:0,duration:250,easing:Qe}),n.start()})},o:T,d(d){d&&w(e),s[4](null)}}}function tt(s,e,t){let{map:r}=e,{text:a}=e,{coords:i}=e,o;ce(()=>{new Ae.exports.Marker({element:o,anchor:"bottom"}).setLngLat(i).addTo(r)}),qe(()=>{});function l(n){ue[n?"unshift":"push"](()=>{o=n,t(1,o)})}return s.$$set=n=>{"map"in n&&t(2,r=n.map),"text"in n&&t(0,a=n.text),"coords"in n&&t(3,i=n.coords)},[a,o,r,i,l]}class rt extends W{constructor(e){super(),x(this,e,tt,et,U,{map:2,text:0,coords:3})}}function ie(s){let e=s[3],t,r,a=oe(s);return{c(){a.c(),t=ee()},l(i){a.l(i),t=ee()},m(i,o){a.m(i,o),H(i,t,o),r=!0},p(i,o){o&8&&U(e,e=i[3])?(he(),Z(a,1,1,T),me(),a=oe(i),a.c(),B(a,1),a.m(t.parentNode,t)):a.p(i,o)},i(i){r||(B(a),r=!0)},o(i){Z(a),r=!1},d(i){i&&w(t),a.d(i)}}}function oe(s){let e,t;return e=new rt({props:{map:g,text:s[3].text,coords:s[3].coords}}),{c(){de(e.$$.fragment)},l(r){pe(e.$$.fragment,r)},m(r,a){ge(e,r,a),t=!0},p(r,a){const i={};a&0&&(i.map=g),a&8&&(i.text=r[3].text),a&8&&(i.coords=r[3].coords),e.$set(i)},i(r){t||(B(e.$$.fragment,r),t=!0)},o(r){Z(e.$$.fragment,r),t=!1},d(r){_e(e,r)}}}function st(s){let e,t,r,a,i,o,l,n,d,b,m,f=s[3]&&ie(s);n=new $e({props:{bearing:s[1]}}),n.$on("click",s[4]);const _=s[12].default,p=De(_,s,s[11],null);return{c(){e=C("link"),t=O(),r=C("figure"),f&&f.c(),a=O(),i=C("div"),o=O(),l=C("div"),de(n.$$.fragment),d=O(),p&&p.c(),this.h()},l(u){const y=Fe('[data-svelte="svelte-1yi8k0v"]',document.head);e=q(y,"LINK",{rel:!0,href:!0}),y.forEach(w),t=j(u),r=q(u,"FIGURE",{class:!0});var v=z(r);f&&f.l(v),a=j(v),i=q(v,"DIV",{id:!0,class:!0}),z(i).forEach(w),o=j(v),l=q(v,"DIV",{id:!0,class:!0});var E=z(l);pe(n.$$.fragment,E),d=j(E),p&&p.l(E),E.forEach(w),v.forEach(w),this.h()},h(){c(e,"rel","stylesheet"),c(e,"href","https://unpkg.com/maplibre-gl@2.1.7/dist/maplibre-gl.css"),c(i,"id","container"),c(i,"class","cpeum-hqy46t"),c(l,"id","info"),c(l,"class","cpeum-hqy46t"),c(r,"class",b=te(s[2].class)+" cpeum-hqy46t"),K(r,"full",s[2].full)},m(u,y){k(document.head,e),H(u,t,y),H(u,r,y),f&&f.m(r,null),k(r,a),k(r,i),s[13](i),k(r,o),k(r,l),ge(n,l,null),k(l,d),p&&p.m(l,null),m=!0},p(u,[y]){u[3]?f?(f.p(u,y),y&8&&B(f,1)):(f=ie(u),f.c(),B(f,1),f.m(r,a)):f&&(he(),Z(f,1,1,()=>{f=null}),me());const v={};y&2&&(v.bearing=u[1]),n.$set(v),p&&p.p&&(!m||y&2048)&&Ze(p,_,u,u[11],m?Se(_,u[11],y,null):Ne(u[11]),null),(!m||y&4&&b!==(b=te(u[2].class)+" cpeum-hqy46t"))&&c(r,"class",b),y&4&&K(r,"full",u[2].full)},i(u){m||(B(f),B(n.$$.fragment,u),B(p,u),m=!0)},o(u){Z(f),Z(n.$$.fragment,u),Z(p,u),m=!1},d(u){w(e),u&&w(t),u&&w(r),f&&f.d(),s[13](null),_e(n),p&&p.d(u)}}}const ne=Ge(!1);let g;function J(s,e){for(const t of s)g.setFeatureState(t,{highlight:e})}function at(s,e,t){let r,a,i=T,o,l,n,d;S(s,Oe,h=>t(7,r=h)),S(s,ne,h=>t(8,a=h)),S(s,je,h=>t(10,l=h)),S(s,Y,h=>t(2,n=h)),S(s,He,h=>t(3,d=h)),s.$$.on_destroy.push(()=>i());let{$$slots:b={},$$scope:m}=e;const f=Re();let _,p=0,u=0,y=20,v=14,E;function P(){g.flyTo({center:E,pitch:y,zoom:v,bearing:u,duration:750})}function M(){t(1,p=0),g.flyTo({bearing:0})}const L=Ve(Y,h=>h.full);S(s,L,h=>t(9,o=h));let D;ce(()=>{g=new ae.Map({container:_,style:"https://api.maptiler.com/maps/856b4e05-cd2c-42db-9453-9cd7e156a083/style.json?key=dtV5LH1SmQB4VOb80qqI",bounds:Ke.fallback,fitBoundsOptions:{padding:100},bearing:p,pitch:y,zoom:v,minZoom:10,maxZoom:20}),g.on("error",h=>{f("error")}),g.once("load",()=>{ne.set(!0),f("load"),t(1,p=g.getBearing()),y=g.getPitch(),v=g.getZoom(),E=g.getCenter()}),g.on("rotate",h=>{t(1,p=g.getBearing()),h.originalEvent&&(u=g.getBearing())}),g.on("pitchend",h=>{h.originalEvent&&(y=g.getPitch())}),g.on("zoomend",h=>{h.originalEvent&&(v=g.getZoom(),E=g.getCenter())}),g.on("dragend",h=>{E=g.getCenter()}),g.on("click",async h=>{const N=g.queryRenderedFeatures(h.point)[0].properties.url;N&&(await Te(ve+N),Y.setFull(!1))})});function ye(h){ue[h?"unshift":"push"](()=>{_=h,t(0,_)})}return s.$$set=h=>{"$$scope"in h&&t(11,m=h.$$scope)},s.$$.update=()=>{if(s.$$.dirty&1792&&a&&!o){if(!l)P();else if(l.bounds)g.fitBounds(l.bounds,{bearing:0,pitch:l.pitch!==void 0&&l.pitch!==null?l.pitch:20,duration:750});else if(l.center)g.flyTo({center:l.center.point,zoom:l.center.zoom,bearing:0,pitch:20,duration:750});else if(l.filter){const h=Object.entries(l.filter),F=re(se).filter(G=>h.every(([we,ke])=>G.properties[we]===ke)),N=new ae.LngLatBounds(Q(Xe(F.map(G=>We(Q(G))))));g.fitBounds(N,{padding:300,maxZoom:15})}}if(s.$$.dirty&768&&a&&o&&P(),s.$$.dirty&448&&a)if(r){D&&J(D,!1);const h=Object.entries(r);t(6,D=re(se).filter(F=>h.every(([N,G])=>F.properties[N]===G)).map(F=>({id:F.id,source:F.properties.source}))),J(D,!0)}else D&&J(D,!1)},[_,p,n,d,M,L,D,r,a,o,l,m,b,ye]}class ut extends W{constructor(e){super(),x(this,e,at,st,U,{})}}async function ht(s){const e=await fetch(ve+s);if(e.ok)return e.json();throw Error(e.status+": "+e.statusText)}export{$e as F,ut as M,g as a,ht as g,ne as m};
